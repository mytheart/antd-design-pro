(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(Le,E,i){var T=i("JHRd");function m(Z){var z=new Z.constructor(Z.byteLength);return new T(z).set(new T(Z)),z}Le.exports=m},"+Qka":function(Le,E,i){var T=i("fmRc"),m=i("t2Dn"),Z=i("cq/+"),z=i("T1AV"),o=i("GoyQ"),W=i("mTTR"),D=i("itsj");function Y(q,he,X,je,Ge){if(q===he)return;Z(he,function(ge,Ce){if(Ge||(Ge=new T),o(ge))z(q,he,Ce,X,Y,je,Ge);else{var ht=je?je(D(q,Ce),ge,Ce+"",q,he,Ge):void 0;ht===void 0&&(ht=ge),m(q,Ce,ht)}},W)}Le.exports=Y},"+VLl":function(Le,E,i){"use strict";i.d(E,"a",function(){return ge});var T=i("lSNA"),m=i.n(T),Z=i("J4zp"),z=i.n(Z),o=i("Hel2"),W=Math.PI/3,D=[0,W,2*W,3*W,4*W,5*W];function Y(Ce){return Ce[0]}function q(Ce){return Ce[1]}var he=function(){var Ce=0,ht=0,Ne=1,Et=1,He=Y,mt=q,Ye,xt,_t;function Ie(ze){var at={},Pe=[],ot,Bt=ze.length;for(ot=0;ot<Bt;++ot){if(isNaN(sr=+He.call(null,Wt=ze[ot],ot,ze))||isNaN(ne=+mt.call(null,Wt,ot,ze)))continue;var Wt,sr,ne,$=Math.round(ne=ne/_t),G=Math.round(sr=sr/xt-($&1)/2),Ae=ne-$;if(Math.abs(Ae)*3>1){var xe=sr-G,Se=G+(sr<G?-1:1)/2,ve=$+(ne<$?-1:1),et=sr-Se,Yt=ne-ve;xe*xe+Ae*Ae>et*et+Yt*Yt&&(G=Se+($&1?1:-1)/2,$=ve)}var At=G+"-"+$,ye=at[At];ye?ye.push(Wt):(Pe.push(ye=at[At]=[Wt]),ye.x=(G+($&1)/2)*xt,ye.y=$*_t)}return Pe}function De(ze){var at=0,Pe=0;return D.map(function(ot){var Bt=Math.sin(ot)*ze,Wt=-Math.cos(ot)*ze,sr=Bt-at,ne=Wt-Pe;return at=Bt,Pe=Wt,[sr,ne]})}return Ie.hexagon=function(ze){return"m"+De(ze==null?Ye:+ze).join("l")+"z"},Ie.centers=function(){for(var ze=[],at=Math.round(ht/_t),Pe=Math.round(Ce/xt),ot=at*_t;ot<Et+Ye;ot+=_t,++at)for(var Bt=Pe*xt+(at&1)*xt/2;Bt<Ne+xt/2;Bt+=xt)ze.push([Bt,ot]);return ze},Ie.mesh=function(){var ze=De(Ye).slice(0,4).join("l");return Ie.centers().map(function(at){return"M"+at+"m"+ze}).join("")},Ie.x=function(ze){return arguments.length?(He=ze,Ie):He},Ie.y=function(ze){return arguments.length?(mt=ze,Ie):mt},Ie.radius=function(ze){return arguments.length?(Ye=+ze,xt=Ye*2*Math.sin(W),_t=Ye*1.5,Ie):Ye},Ie.size=function(ze){return arguments.length?(Ce=ht=0,Ne=+ze[0],Et=+ze[1],Ie):[Ne-Ce,Et-ht]},Ie.extent=function(ze){return arguments.length?(Ce=+ze[0][0],ht=+ze[0][1],Ne=+ze[1][0],Et=+ze[1][1],Ie):[[Ce,ht],[Ne,Et]]},Ie.radius(1)};function X(Ce,ht){var Ne=Object.keys(Ce);if(Object.getOwnPropertySymbols){var Et=Object.getOwnPropertySymbols(Ce);ht&&(Et=Et.filter(function(He){return Object.getOwnPropertyDescriptor(Ce,He).enumerable})),Ne.push.apply(Ne,Et)}return Ne}function je(Ce){for(var ht=1;ht<arguments.length;ht++){var Ne=arguments[ht]!=null?arguments[ht]:{};ht%2?X(Object(Ne),!0).forEach(function(Et){m()(Ce,Et,Ne[Et])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ce,Object.getOwnPropertyDescriptors(Ne)):X(Object(Ne)).forEach(function(Et){Object.defineProperty(Ce,Et,Object.getOwnPropertyDescriptor(Ne,Et))})}return Ce}var Ge=6378e3;function ge(Ce,ht){var Ne=Ce.dataArray,Et=ht.size,He=Et===void 0?10:Et,mt=ht.method,Ye=mt===void 0?"sum":mt,xt=He/(2*Math.PI*Ge)*(256<<20)/2,_t=Ne.map(function(at){var Pe=Object(o.d)(at.coordinates),ot=z()(Pe,2),Bt=ot[0],Wt=ot[1];return je(je({},at),{},{coordinates:[Bt,Wt]})}),Ie=he().radius(xt).x(function(at){return at.coordinates[0]}).y(function(at){return at.coordinates[1]}),De=Ie(_t),ze={dataArray:De.map(function(at,Pe){var ot;if(ht.field&&Ye){var Bt=o.c.getColumn(at,ht.field);at[Ye]=o.c.statMap[Ye](Bt)}return ot={},m()(ot,ht.method,at[Ye]),m()(ot,"count",at.length),m()(ot,"rawData",at),m()(ot,"coordinates",[at.x,at.y]),m()(ot,"_id",Pe),ot}),radius:xt,xOffset:xt,yOffset:xt,type:"hexagon"};return ze}},"+em5":function(Le,E,i){"use strict";i.d(E,"a",function(){return ne});var T=i("lSNA"),m=i.n(T),Z=i("yG8O"),z=i.n(Z),o=i("lwsE"),W=i.n(o),D=i("W8MJ"),Y=i.n(D),q=i("U+yc"),he=i.n(q),X=i("1ABj"),je=i.n(X),Ge=i("gQMU"),ge=i.n(Ge),Ce=i("J2iB"),ht=i.n(Ce),Ne=i("u6S6"),Et=i.n(Ne),He=i("4cb6"),mt=i.n(He),Ye=i("h1nZ"),xt=i("bB6j"),_t=i("bPkA"),Ie,De,ze,at,Pe,ot;function Bt($,G){var Ae=Object.keys($);if(Object.getOwnPropertySymbols){var xe=Object.getOwnPropertySymbols($);G&&(xe=xe.filter(function(Se){return Object.getOwnPropertyDescriptor($,Se).enumerable})),Ae.push.apply(Ae,xe)}return Ae}function Wt($){for(var G=1;G<arguments.length;G++){var Ae=arguments[G]!=null?arguments[G]:{};G%2?Bt(Object(Ae),!0).forEach(function(xe){m()($,xe,Ae[xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(Ae)):Bt(Object(Ae)).forEach(function(xe){Object.defineProperty($,xe,Object.getOwnPropertyDescriptor(Ae,xe))})}return $}var sr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ne=(Ie=Object(He.injectable)(),De=Object(He.inject)(xt.a.IShaderModuleService),Ie(ze=(at=(ot=function(){function $(){W()(this,$),z()(this,"shaderModuleService",Pe,this),this.rendererService=void 0,this.config=void 0,this.quad=sr,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return Y()($,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Ae){this.name=Ae}},{key:"getType",value:function(){return _t.a.PostProcessing}},{key:"init",value:function(Ae,xe){this.config=xe,this.rendererService=Ae.getContainer().get(xt.a.IRendererService);var Se=this.rendererService,ve=Se.createAttribute,et=Se.createBuffer,Yt=Se.createModel,At=this.setupShaders(),ye=At.vs,be=At.fs,Ue=At.uniforms;this.model=Yt({vs:ye,fs:be,attributes:{a_Position:ve({buffer:et({data:[-4,-4,4,-4,0,4],type:Ye.gl.FLOAT}),size:2})},uniforms:Wt(Wt({u_Texture:null},Ue),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Ae){var xe=this,Se=Ae.multiPassRenderer.getPostProcessor(),ve=this.rendererService,et=ve.useFramebuffer,Yt=ve.getViewportSize,At=ve.clear,ye=Yt(),be=ye.width,Ue=ye.height;et(this.renderToScreen?null:Se.getWriteFBO(),function(){At({framebuffer:Se.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),xe.model.draw({uniforms:Wt({u_Texture:Se.getReadFBO(),u_ViewportSize:[be,Ue]},xe.convertOptionsToUniforms(xe.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Ae){this.enabled=Ae}},{key:"setRenderToScreen",value:function(Ae){this.renderToScreen=Ae}},{key:"updateOptions",value:function(Ae){this.optionsToUpdate=Wt(Wt({},this.optionsToUpdate),Ae)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Ae){var xe={};return Object.keys(Ae).forEach(function(Se){ht()(Ae[Se])||(xe["u_".concat(ge()(Et()(Se)))]=Ae[Se])}),xe}}]),$}(),ot),Pe=he()(at.prototype,"shaderModuleService",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at))||ze)},"+iFO":function(Le,E,i){var T=i("dTAl"),m=i("LcsW"),Z=i("6sVZ");function z(o){return typeof o.constructor=="function"&&!Z(o)?T(m(o)):{}}Le.exports=z},"/33/":function(Le,E){},"/Uc5":function(Le,E){},"/ezw":function(Le,E,i){"use strict";var T=i("lSNA"),m=i.n(T),Z=i("pVnL"),z=i.n(Z),o=i("cDf5"),W=i.n(o),D=i("q1tI"),Y=i("TSYQ"),q=i.n(Y),he=function(xe){var Se=xe.prefixCls,ve=xe.className,et=xe.width,Yt=xe.style;return D.createElement("h3",{className:q()(Se,ve),style:z()({width:et},Yt)})},X=he,je=i("RIqP"),Ge=i.n(je),ge=function(xe){var Se=function(Ue){var st=xe.width,Me=xe.rows,ft=Me===void 0?2:Me;return Array.isArray(st)?st[Ue]:ft-1===Ue?st:void 0},ve=xe.prefixCls,et=xe.className,Yt=xe.style,At=xe.rows,ye=Ge()(Array(At)).map(function(be,Ue){return D.createElement("li",{key:Ue,style:{width:Se(Ue)}})});return D.createElement("ul",{className:q()(ve,et),style:Yt},ye)},Ce=ge,ht=i("H84U"),Ne=function(xe){var Se,ve,et=xe.prefixCls,Yt=xe.className,At=xe.style,ye=xe.size,be=xe.shape,Ue=q()((Se={},m()(Se,"".concat(et,"-lg"),ye==="large"),m()(Se,"".concat(et,"-sm"),ye==="small"),Se)),st=q()((ve={},m()(ve,"".concat(et,"-circle"),be==="circle"),m()(ve,"".concat(et,"-square"),be==="square"),m()(ve,"".concat(et,"-round"),be==="round"),ve)),Me=typeof ye=="number"?{width:ye,height:ye,lineHeight:"".concat(ye,"px")}:{};return D.createElement("span",{className:q()(et,Ue,st,Yt),style:z()(z()({},Me),At)})},Et=Ne,He=i("BGR+"),mt=function(xe){var Se=function(et){var Yt=et.getPrefixCls,At=xe.prefixCls,ye=xe.className,be=xe.active,Ue=Yt("skeleton",At),st=Object(He.a)(xe,["prefixCls"]),Me=q()(Ue,"".concat(Ue,"-element"),m()({},"".concat(Ue,"-active"),be),ye);return D.createElement("div",{className:Me},D.createElement(Et,z()({prefixCls:"".concat(Ue,"-avatar")},st)))};return D.createElement(ht.a,null,Se)};mt.defaultProps={size:"default",shape:"circle"};var Ye=mt,xt=function(xe){var Se=function(et){var Yt=et.getPrefixCls,At=xe.prefixCls,ye=xe.className,be=xe.active,Ue=Yt("skeleton",At),st=Object(He.a)(xe,["prefixCls"]),Me=q()(Ue,"".concat(Ue,"-element"),m()({},"".concat(Ue,"-active"),be),ye);return D.createElement("div",{className:Me},D.createElement(Et,z()({prefixCls:"".concat(Ue,"-button")},st)))};return D.createElement(ht.a,null,Se)};xt.defaultProps={size:"default"};var _t=xt,Ie=function(xe){var Se=function(et){var Yt=et.getPrefixCls,At=xe.prefixCls,ye=xe.className,be=xe.active,Ue=Yt("skeleton",At),st=Object(He.a)(xe,["prefixCls"]),Me=q()(Ue,"".concat(Ue,"-element"),m()({},"".concat(Ue,"-active"),be),ye);return D.createElement("div",{className:Me},D.createElement(Et,z()({prefixCls:"".concat(Ue,"-input")},st)))};return D.createElement(ht.a,null,Se)};Ie.defaultProps={size:"default"};var De=Ie,ze="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",at=function(xe){var Se=function(et){var Yt=et.getPrefixCls,At=xe.prefixCls,ye=xe.className,be=xe.style,Ue=Yt("skeleton",At),st=q()(Ue,"".concat(Ue,"-element"),ye);return D.createElement("div",{className:st},D.createElement("div",{className:q()("".concat(Ue,"-image"),ye),style:be},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ue,"-image-svg")},D.createElement("path",{d:ze,className:"".concat(Ue,"-image-path")}))))};return D.createElement(ht.a,null,Se)},Pe=at;function ot(Ae){return Ae&&W()(Ae)==="object"?Ae:{}}function Bt(Ae,xe){return Ae&&!xe?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Wt(Ae,xe){return!Ae&&xe?{width:"38%"}:Ae&&xe?{width:"50%"}:{}}function sr(Ae,xe){var Se={};return(!Ae||!xe)&&(Se.width="61%"),!Ae&&xe?Se.rows=3:Se.rows=2,Se}var ne=function(xe){var Se=function(et){var Yt=et.getPrefixCls,At=et.direction,ye=xe.prefixCls,be=xe.loading,Ue=xe.className,st=xe.children,Me=xe.avatar,ft=xe.title,w=xe.paragraph,I=xe.active,J=xe.round,ce=Yt("skeleton",ye);if(be||!("loading"in xe)){var Be,Xe=!!Me,gt=!!ft,tt=!!w,It;if(Xe){var K=z()(z()({prefixCls:"".concat(ce,"-avatar")},Bt(gt,tt)),ot(Me));It=D.createElement("div",{className:"".concat(ce,"-header")},D.createElement(Et,K))}var Ze;if(gt||tt){var te;if(gt){var Je=z()(z()({prefixCls:"".concat(ce,"-title")},Wt(Xe,tt)),ot(ft));te=D.createElement(X,Je)}var zt;if(tt){var cr=z()(z()({prefixCls:"".concat(ce,"-paragraph")},sr(Xe,gt)),ot(w));zt=D.createElement(Ce,cr)}Ze=D.createElement("div",{className:"".concat(ce,"-content")},te,zt)}var lt=q()(ce,(Be={},m()(Be,"".concat(ce,"-with-avatar"),Xe),m()(Be,"".concat(ce,"-active"),I),m()(Be,"".concat(ce,"-rtl"),At==="rtl"),m()(Be,"".concat(ce,"-round"),J),Be),Ue);return D.createElement("div",{className:lt},It,Ze)}return st};return D.createElement(ht.a,null,Se)};ne.defaultProps={avatar:!1,title:!0,paragraph:!0},ne.Button=_t,ne.Avatar=Ye,ne.Input=De,ne.Image=Pe;var $=ne,G=E.a=$},"/rf6":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.earthRadius=63710088e-1,E.factors={centimeters:E.earthRadius*100,centimetres:E.earthRadius*100,degrees:E.earthRadius/111325,feet:E.earthRadius*3.28084,inches:E.earthRadius*39.37,kilometers:E.earthRadius/1e3,kilometres:E.earthRadius/1e3,meters:E.earthRadius,metres:E.earthRadius,miles:E.earthRadius/1609.344,millimeters:E.earthRadius*1e3,millimetres:E.earthRadius*1e3,nauticalmiles:E.earthRadius/1852,radians:1,yards:E.earthRadius/1.0936},E.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/E.earthRadius,yards:1/1.0936},E.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function T($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"Feature"};return(Ae.id===0||Ae.id)&&(xe.id=Ae.id),Ae.bbox&&(xe.bbox=Ae.bbox),xe.properties=G||{},xe.geometry=$,xe}E.feature=T;function m($,G,Ae){Ae===void 0&&(Ae={});switch($){case"Point":return Z(G).geometry;case"LineString":return D(G).geometry;case"Polygon":return o(G).geometry;case"MultiPoint":return X(G).geometry;case"MultiLineString":return he(G).geometry;case"MultiPolygon":return je(G).geometry;default:throw new Error($+" is invalid")}}E.geometry=m;function Z($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"Point",coordinates:$};return T(xe,G,Ae)}E.point=Z;function z($,G,Ae){return Ae===void 0&&(Ae={}),q($.map(function(xe){return Z(xe,G)}),Ae)}E.points=z;function o($,G,Ae){Ae===void 0&&(Ae={});for(var xe=0,Se=$;xe<Se.length;xe++){var ve=Se[xe];if(ve.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var et=0;et<ve[ve.length-1].length;et++)if(ve[ve.length-1][et]!==ve[0][et])throw new Error("First and last Position are not equivalent.")}var Yt={type:"Polygon",coordinates:$};return T(Yt,G,Ae)}E.polygon=o;function W($,G,Ae){return Ae===void 0&&(Ae={}),q($.map(function(xe){return o(xe,G)}),Ae)}E.polygons=W;function D($,G,Ae){if(Ae===void 0&&(Ae={}),$.length<2)throw new Error("coordinates must be an array of two or more positions");var xe={type:"LineString",coordinates:$};return T(xe,G,Ae)}E.lineString=D;function Y($,G,Ae){return Ae===void 0&&(Ae={}),q($.map(function(xe){return D(xe,G)}),Ae)}E.lineStrings=Y;function q($,G){G===void 0&&(G={});var Ae={type:"FeatureCollection"};return G.id&&(Ae.id=G.id),G.bbox&&(Ae.bbox=G.bbox),Ae.features=$,Ae}E.featureCollection=q;function he($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"MultiLineString",coordinates:$};return T(xe,G,Ae)}E.multiLineString=he;function X($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"MultiPoint",coordinates:$};return T(xe,G,Ae)}E.multiPoint=X;function je($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"MultiPolygon",coordinates:$};return T(xe,G,Ae)}E.multiPolygon=je;function Ge($,G,Ae){Ae===void 0&&(Ae={});var xe={type:"GeometryCollection",geometries:$};return T(xe,G,Ae)}E.geometryCollection=Ge;function ge($,G){if(G===void 0&&(G=0),G&&!(G>=0))throw new Error("precision must be a positive number");var Ae=Math.pow(10,G||0);return Math.round($*Ae)/Ae}E.round=ge;function Ce($,G){G===void 0&&(G="kilometers");var Ae=E.factors[G];if(!Ae)throw new Error(G+" units is invalid");return $*Ae}E.radiansToLength=Ce;function ht($,G){G===void 0&&(G="kilometers");var Ae=E.factors[G];if(!Ae)throw new Error(G+" units is invalid");return $/Ae}E.lengthToRadians=ht;function Ne($,G){return He(ht($,G))}E.lengthToDegrees=Ne;function Et($){var G=$%360;return G<0&&(G+=360),G}E.bearingToAzimuth=Et;function He($){var G=$%(2*Math.PI);return G*180/Math.PI}E.radiansToDegrees=He;function mt($){var G=$%360;return G*Math.PI/180}E.degreesToRadians=mt;function Ye($,G,Ae){if(G===void 0&&(G="kilometers"),Ae===void 0&&(Ae="kilometers"),!($>=0))throw new Error("length must be a positive number");return Ce(ht($,G),Ae)}E.convertLength=Ye;function xt($,G,Ae){if(G===void 0&&(G="meters"),Ae===void 0&&(Ae="kilometers"),!($>=0))throw new Error("area must be a positive number");var xe=E.areaFactors[G];if(!xe)throw new Error("invalid original units");var Se=E.areaFactors[Ae];if(!Se)throw new Error("invalid final units");return $/xe*Se}E.convertArea=xt;function _t($){return!isNaN($)&&$!==null&&!Array.isArray($)&&!/^\s*$/.test($)}E.isNumber=_t;function Ie($){return!!$&&$.constructor===Object}E.isObject=Ie;function De($){if(!$)throw new Error("bbox is required");if(!Array.isArray($))throw new Error("bbox must be an Array");if($.length!==4&&$.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");$.forEach(function(G){if(!_t(G))throw new Error("bbox must only contain numbers")})}E.validateBBox=De;function ze($){if(!$)throw new Error("id is required");if(["string","number"].indexOf(typeof $)===-1)throw new Error("id must be a number or a string")}E.validateId=ze;function at(){throw new Error("method has been renamed to `radiansToDegrees`")}E.radians2degrees=at;function Pe(){throw new Error("method has been renamed to `degreesToRadians`")}E.degrees2radians=Pe;function ot(){throw new Error("method has been renamed to `lengthToDegrees`")}E.distanceToDegrees=ot;function Bt(){throw new Error("method has been renamed to `lengthToRadians`")}E.distanceToRadians=Bt;function Wt(){throw new Error("method has been renamed to `radiansToLength`")}E.radiansToDistance=Wt;function sr(){throw new Error("method has been renamed to `bearingToAzimuth`")}E.bearingToAngle=sr;function ne(){throw new Error("method has been renamed to `convertLength`")}E.convertDistance=ne},"0JQy":function(Le,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",z=T+m+Z,o="\\ufe0e\\ufe0f",W="["+i+"]",D="["+z+"]",Y="\\ud83c[\\udffb-\\udfff]",q="(?:"+D+"|"+Y+")",he="[^"+i+"]",X="(?:\\ud83c[\\udde6-\\uddff]){2}",je="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="\\u200d",ge=q+"?",Ce="["+o+"]?",ht="(?:"+Ge+"(?:"+[he,X,je].join("|")+")"+Ce+ge+")*",Ne=Ce+ge+ht,Et="(?:"+[he+D+"?",D,X,je,W].join("|")+")",He=RegExp(Y+"(?="+Y+")|"+Et+Ne,"g");function mt(Ye){return Ye.match(He)||[]}Le.exports=mt},"0ZTe":function(Le,E,i){var T=i("wy8a"),m=i("quyA"),Z=i("Em2t"),z=i("dt0z");function o(W){return function(D){D=z(D);var Y=m(D)?Z(D):void 0,q=Y?Y[0]:D.charAt(0),he=Y?T(Y,1).join(""):D.slice(1);return q[W]()+he}}Le.exports=o},"0eqD":function(Le,E){},"0gSV":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("GXnB"),m=i("Ztfv");function Z(z,o){return function(W,D,Y){var q=new T.Metadata(z,o);typeof Y=="number"?m.tagParameter(W,D,Y,q):m.tagProperty(W,D,q)}}E.tagged=Z},"1+5i":function(Le,E,i){var T=i("w/wX"),m=i("sEf8"),Z=i("mdPL"),z=Z&&Z.isSet,o=z?m(z):T;Le.exports=o},"14J3":function(Le,E,i){"use strict";var T=i("cIOH"),m=i.n(T),Z=i("1GLa")},"1ABj":function(Le,E){function i(T,m){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Le.exports=i},"1XEM":function(Le,E,i){Le.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(Le,E){Le.exports=function(T){return T&&typeof T=="object"&&typeof T.copy=="function"&&typeof T.fill=="function"&&typeof T.readUInt8=="function"}},"1jvM":function(Le,E){},2:function(Le,E){},"2ajD":function(Le,E){function i(T){return T!==T}Le.exports=i},"3DfO":function(Le,E){function i(T){return T==null}Le.exports=i},"3L66":function(Le,E,i){var T=i("MMmD"),m=i("ExA7");function Z(z){return m(z)&&T(z)}Le.exports=Z},"3cYt":function(Le,E){function i(T){return function(m){return T==null?void 0:T[m]}}Le.exports=i},"406g":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("z4Hk"),m=function(){function Z(z){this._binding=z}return Z.prototype.onActivation=function(z){return this._binding.onActivation=z,new T.BindingWhenSyntax(this._binding)},Z}();E.BindingOnSyntax=m},"4U9+":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=function(Ce){return(0,m.default)((0,Y.default)(Ce)&&Ce.length>=1,"Must merge at least 1 JSON schema."),z.default.apply(void 0,[{}].concat(ge(Ce),[function(ht,Ne,Et){if((0,W.default)(ht))return;if(Et==="required")return(0,he.default)(ht.concat(Ne));if((0,je.default)(ht)){if(!(0,je.default)(Ne))throw new Error('Failed to merge schemas because "'+Et+'" has different values.');return}m.default.deepEqual(ht,Ne,'Failed to merge schemas because "'+Et+'" has different values: '+JSON.stringify(ht)+" and "+JSON.stringify(Ne)+".")}]))};var T=i("9lTW"),m=Ge(T),Z=i("qd8s"),z=Ge(Z),o=i("3DfO"),W=Ge(o),D=i("WFAs"),Y=Ge(D),q=i("w26f"),he=Ge(q),X=i("zZPE"),je=Ge(X);function Ge(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}function ge(Ce){if(Array.isArray(Ce)){for(var ht=0,Ne=Array(Ce.length);ht<Ce.length;ht++)Ne[ht]=Ce[ht];return Ne}else return Array.from(Ce)}Le.exports=E.default},"4ZJM":function(Le,E,i){(function(T,m){Le.exports=m()})(this,function(){"use strict";var T,m,Z;function z(o,W){if(!T)T=W;else if(!m)m=W;else{var D="var sharedChunk = {}; ("+T+")(sharedChunk); ("+m+")(sharedChunk);",Y={};T(Y),Z=W(Y),typeof window!="undefined"&&(Z.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(o){"use strict";function W(e,t){return e(t={exports:{}},t.exports),t.exports}var D=Y;function Y(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}Y.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},Y.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},Y.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},Y.prototype.solveCurveX=function(e,t){var r,u,f,g,A;for(t===void 0&&(t=1e-6),f=e,A=0;A<8;A++){if(g=this.sampleCurveX(f)-e,Math.abs(g)<t)return f;var P=this.sampleCurveDerivativeX(f);if(Math.abs(P)<1e-6)break;f-=g/P}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(g=this.sampleCurveX(f),Math.abs(g-e)<t)return f;e>g?r=f:u=f,f=.5*(u-r)+r}return f},Y.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var q=he;function he(e,t){this.x=e,this.y=t}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),g=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(e){return e instanceof he?e:Array.isArray(e)?new he(e[0],e[1]):e};var X=typeof self!="undefined"?self:{},je=Math.pow(2,53)-1;function Ge(e,t,r,u){var f=new D(e,t,r,u);return function(g){return f.solve(g)}}var ge=Ge(.25,.1,.25,1);function Ce(e,t,r){return Math.min(r,Math.max(t,e))}function ht(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function Ne(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var g=f[u];for(var A in g)e[A]=g[A]}return e}var Et=1;function He(){return Et++}function mt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Ye(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function xt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function _t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ie(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function De(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function ze(e){return Array.isArray(e)?e.map(ze):typeof e=="object"&&e?Ie(e,ze):e}var at={};function Pe(e){at[e]||(typeof console!="undefined"&&console.warn(e),at[e]=!0)}function ot(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Bt(e){for(var t=0,r=0,u=e.length,f=u-1,g=void 0,A=void 0;r<u;f=r++)t+=((A=e[f]).x-(g=e[r]).x)*(g.y+A.y);return t}function Wt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function sr(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,g,A){var P=g||A;return t[f]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var ne=null;function $(e){if(ne==null){var t=e.navigator?e.navigator.userAgent:null;ne=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ne}function G(e){try{var t=X[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Ae,xe,Se,ve,et=X.performance&&X.performance.now?X.performance.now.bind(X.performance):Date.now.bind(Date),Yt=X.requestAnimationFrame||X.mozRequestAnimationFrame||X.webkitRequestAnimationFrame||X.msRequestAnimationFrame,At=X.cancelAnimationFrame||X.mozCancelAnimationFrame||X.webkitCancelAnimationFrame||X.msCancelAnimationFrame,ye={now:et,frame:function(t){var r=Yt(t);return{cancel:function(){return At(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=X.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ae||(Ae=X.document.createElement("a")),Ae.href=t,Ae.href},hardwareConcurrency:X.navigator&&X.navigator.hardwareConcurrency||4,get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(xe==null&&(xe=X.matchMedia("(prefers-reduced-motion: reduce)")),xe.matches)}},be={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ue={supported:!1,testSupport:function(t){!st&&ve&&(Me?ft(t):Se=t)}},st=!1,Me=!1;function ft(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ve),e.isContextLost())return;Ue.supported=!0}catch(r){}e.deleteTexture(t),st=!0}X.document&&((ve=X.document.createElement("img")).onload=function(){Se&&ft(Se),Se=null,Me=!0},ve.onerror=function(){st=!0,Se=null},ve.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var w="01",I=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function J(e){return e.indexOf("mapbox:")===0}I.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",w,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},I.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},I.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},I.prototype.normalizeStyleURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeGlyphsURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSourceURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSpriteURL=function(e,t,r,u){var f=gt(e);return J(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,tt(f))},I.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!J(e))return e;var r=gt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ye.devicePixelRatio>=2||t===512?"@2x":"")+(Ue.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var g=0,A=f;g<A.length;g+=1){var P=A[g].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||be.ACCESS_TOKEN;return be.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},I.prototype.canonicalizeTileURL=function(e,t){var r=gt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(g){return!g.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},I.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&J(t),u=[],f=0,g=e.tiles||[];f<g.length;f+=1){var A=g[f];Be(A)?u.push(this.canonicalizeTileURL(A,r)):u.push(A)}return u},I.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=gt(be.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,u.path!=="/"&&(e.path=""+u.path+e.path),!be.REQUIRE_ACCESS_TOKEN)return tt(e);if(!(t=t||be.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(f){return f.indexOf("access_token")===-1}),e.params.push("access_token="+t),tt(e)};var ce=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Be(e){return ce.test(e)}var Xe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gt(e){var t=e.match(Xe);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function tt(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function It(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var K=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};K.prototype.getStorageKey=function(e){var t,r=It(be.ACCESS_TOKEN);return t=r&&r.u?X.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):be.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},K.prototype.fetchEventData=function(){var e=G("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=X.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=X.localStorage.getItem(r);f&&(this.anonId=f)}catch(g){Pe("Unable to read from LocalStorage")}},K.prototype.saveEventData=function(){var e=G("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{X.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Pe("Unable to write to LocalStorage")}},K.prototype.processRequests=function(e){},K.prototype.postEvent=function(e,t,r,u){var f=this;if(be.EVENTS_URL){var g=gt(be.EVENTS_URL);g.params.push("access_token="+(u||be.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.12.0",skuId:w,userId:this.anonId},P=t?Ne(A,t):A,B={url:tt(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=Wn(B,function(Q){f.pendingRequest=null,r(Q),f.saveEventData(),f.processRequests(u)})}},K.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ze,te,Je=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,g){this.skuToken=f,(be.EVENTS_URL&&g||be.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(A){return J(A)||Be(A)}))&&this.queueRequest({id:u,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),g=f.id,A=f.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),Ye(this.anonId)||(this.anonId=mt()),this.postEvent(A,{skuToken:this.skuToken},function(P){P||g&&(u.success[g]=!0)},r))}},t}(K),zt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){be.EVENTS_URL&&be.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return J(f)||Be(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=It(be.ACCESS_TOKEN),g=f?f.u:be.ACCESS_TOKEN,A=g!==this.eventData.tokenU;Ye(this.anonId)||(this.anonId=mt(),A=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var B=new Date(this.eventData.lastSuccess),Q=new Date(P),de=(P-this.eventData.lastSuccess)/864e5;A=A||de>=1||de<-1||B.getDate()!==Q.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(_e){_e||(u.eventData.lastSuccess=P,u.eventData.tokenU=g)},r)}},t}(K)),cr=zt.postTurnstileEvent.bind(zt),lt=new Je,dt=lt.postMapLoadEvent.bind(lt),Ct=500,pt=50;function we(){X.caches&&!Ze&&(Ze=X.caches.open("mapbox-tiles"))}function ut(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Ke,kt=1/0;function yr(){return Ke==null&&(Ke=X.OffscreenCanvas&&new X.OffscreenCanvas(1,1).getContext("2d")&&typeof X.createImageBitmap=="function"),Ke}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var hr=function(e){function t(r,u,f){u===401&&Be(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),jn=Wt()?function(){return self.worker&&self.worker.referrer}:function(){return(X.location.protocol==="blob:"?X.parent:X).location.href},yn,ta,ma=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(jn())&&!/^\w+:/.test(u))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return function(f,g){var A,P=new X.AbortController,B=new X.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:jn(),signal:P.signal}),Q=!1,de=!1,_e=(A=B.url).indexOf("sku=")>0&&Be(A);f.type==="json"&&B.headers.set("Accept","application/json");var Oe=function(bt,Vt,Ut){if(!de){if(bt&&bt.message!=="SecurityError"&&Pe(bt),Vt&&Ut)return nt(Vt);var or=Date.now();X.fetch(B).then(function(pr){if(pr.ok){var Sr=_e?pr.clone():null;return nt(pr,Sr,or)}return g(new hr(pr.statusText,pr.status,f.url))}).catch(function(pr){pr.code!==20&&g(new Error(pr.message))})}},nt=function(bt,Vt,Ut){(f.type==="arrayBuffer"?bt.arrayBuffer():f.type==="json"?bt.json():bt.text()).then(function(or){de||(Vt&&Ut&&function(pr,Sr,Vr){if(we(),Ze){var Nr={status:Sr.status,statusText:Sr.statusText,headers:new X.Headers};Sr.headers.forEach(function(En,Bn){return Nr.headers.set(Bn,En)});var mn=sr(Sr.headers.get("Cache-Control")||"");mn["no-store"]||(mn["max-age"]&&Nr.headers.set("Expires",new Date(Vr+1e3*mn["max-age"]).toUTCString()),new Date(Nr.headers.get("Expires")).getTime()-Vr<42e4||function(En,Bn){if(te===void 0)try{new Response(new ReadableStream),te=!0}catch(ea){te=!1}te?Bn(En.body):En.blob().then(Bn)}(Sr,function(En){var Bn=new X.Response(En,Nr);we(),Ze&&Ze.then(function(ea){return ea.put(ut(pr.url),Bn)}).catch(function(ea){return Pe(ea.message)})}))}}(B,Vt,Ut),Q=!0,g(null,or,bt.headers.get("Cache-Control"),bt.headers.get("Expires")))}).catch(function(or){de||g(new Error(or.message))})};return _e?function(St,bt){if(we(),!Ze)return bt(null);var Vt=ut(St.url);Ze.then(function(Ut){Ut.match(Vt).then(function(or){var pr=function(Sr){if(!Sr)return!1;var Vr=new Date(Sr.headers.get("Expires")||0),Nr=sr(Sr.headers.get("Cache-Control")||"");return Vr>Date.now()&&!Nr["no-cache"]}(or);Ut.delete(Vt),pr&&Ut.put(Vt,or.clone()),bt(null,or,pr)}).catch(bt)}).catch(bt)}(B,Oe):Oe(null,null),{cancel:function(){de=!0,Q||P.abort()}}}(t,r);if(Wt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,g){var A=new X.XMLHttpRequest;for(var P in A.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(A.responseType="arraybuffer"),f.headers)A.setRequestHeader(P,f.headers[P]);return f.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=f.credentials==="include",A.onerror=function(){g(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var B=A.response;if(f.type==="json")try{B=JSON.parse(A.response)}catch(Q){return g(Q)}g(null,B,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else g(new hr(A.statusText,A.status,f.url))},A.send(f.body),{cancel:function(){return A.abort()}}}(t,r)},Zn=function(t,r){return ma(Ne(t,{type:"arrayBuffer"}),r)},Wn=function(t,r){return ma(Ne(t,{method:"POST"}),r)};yn=[],ta=0;var F=function e(t,r){if(Ue.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ta>=be.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return yn.push(u),u}ta++;var f=!1,g=function(){if(!f)for(f=!0,ta--;yn.length&&ta<be.MAX_PARALLEL_IMAGE_REQUESTS;){var B=yn.shift();B.cancelled||(B.cancel=e(B.requestParameters,B.callback).cancel)}},A=Zn(t,function(P,B,Q,de){g(),P?r(P):B&&(yr()?function(_e,Oe){var nt=new X.Blob([new Uint8Array(_e)],{type:"image/png"});X.createImageBitmap(nt).then(function(St){Oe(null,St)}).catch(function(St){Oe(new Error("Could not load image because of "+St.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(B,r):function(_e,Oe,nt,St){var bt=new X.Image,Vt=X.URL;bt.onload=function(){Oe(null,bt),Vt.revokeObjectURL(bt.src)},bt.onerror=function(){return Oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ut=new X.Blob([new Uint8Array(_e)],{type:"image/png"});bt.cacheControl=nt,bt.expires=St,bt.src=_e.byteLength?Vt.createObjectURL(Ut):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(B,r,Q,de))});return{cancel:function(){A.cancel(),g()}}};function H(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function ue(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var pe=function(t,r){r===void 0&&(r={}),Ne(this,r),this.type=t},rt=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",Ne({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(pe),yt=function(){};yt.prototype.on=function(e,t){return this._listeners=this._listeners||{},H(e,t,this._listeners),this},yt.prototype.off=function(e,t){return ue(e,t,this._listeners),ue(e,t,this._oneTimeListeners),this},yt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},H(e,t,this._oneTimeListeners),this},yt.prototype.fire=function(e,t){typeof e=="string"&&(e=new pe(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var g=0,A=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<A.length;g+=1){var P=A[g];ue(r,P,this._oneTimeListeners),P.call(this,e)}var B=this._eventedParent;B&&(Ne(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(e))}else e instanceof rt&&console.error(e.error);return this},yt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},yt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ct=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function er(e){var t=e.value;return t?[new ct(e.key,t,"constants have been deprecated as of v8")]:[]}function rr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var g=f[u];for(var A in g)e[A]=g[A]}return e}function jr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nn(e){if(Array.isArray(e))return e.map(nn);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=nn(e[r]);return t}return jr(e)}var ur=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Wr=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var g=f[u];this.bindings[g[0]]=g[1]}};Wr.prototype.concat=function(e){return new Wr(this,e)},Wr.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Wr.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Tn={kind:"null"},mr={kind:"number"},Jr={kind:"string"},vn={kind:"boolean"},Kn={kind:"color"},_n={kind:"object"},Hr={kind:"value"},oa={kind:"collator"},Mr={kind:"formatted"},va={kind:"resolvedImage"};function ha(e,t){return{kind:"array",itemType:e,N:t}}function da(e){if(e.kind==="array"){var t=da(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Ki=[Tn,mr,Jr,vn,Kn,Mr,_n,ha(Hr),va];function Fi(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Fi(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Ki;r<u.length;r+=1)if(!Fi(u[r],t))return null}}return"Expected "+da(e)+" but found "+da(t)+" instead."}function xa(e,t){return t.some(function(r){return r.kind===e.kind})}function di(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var Ga=W(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(P){return(P=Math.round(P))<0?0:P>255?255:P}function f(P){return u(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function g(P){return(B=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:B>1?1:B;var B}function A(P,B,Q){return Q<0?Q+=1:Q>1&&(Q-=1),6*Q<1?P+(B-P)*Q*6:2*Q<1?B:3*Q<2?P+(B-P)*(2/3-Q)*6:P}try{t.parseCSSColor=function(P){var B,Q=P.replace(/ /g,"").toLowerCase();if(Q in r)return r[Q].slice();if(Q[0]==="#")return Q.length===4?(B=parseInt(Q.substr(1),16))>=0&&B<=4095?[(3840&B)>>4|(3840&B)>>8,240&B|(240&B)>>4,15&B|(15&B)<<4,1]:null:Q.length===7&&(B=parseInt(Q.substr(1),16))>=0&&B<=16777215?[(16711680&B)>>16,(65280&B)>>8,255&B,1]:null;var de=Q.indexOf("("),_e=Q.indexOf(")");if(de!==-1&&_e+1===Q.length){var Oe=Q.substr(0,de),nt=Q.substr(de+1,_e-(de+1)).split(","),St=1;switch(Oe){case"rgba":if(nt.length!==4)return null;St=g(nt.pop());case"rgb":return nt.length!==3?null:[f(nt[0]),f(nt[1]),f(nt[2]),St];case"hsla":if(nt.length!==4)return null;St=g(nt.pop());case"hsl":if(nt.length!==3)return null;var bt=(parseFloat(nt[0])%360+360)%360/360,Vt=g(nt[1]),Ut=g(nt[2]),or=Ut<=.5?Ut*(Vt+1):Ut+Vt-Ut*Vt,pr=2*Ut-or;return[u(255*A(pr,or,bt+1/3)),u(255*A(pr,or,bt)),u(255*A(pr,or,bt-1/3)),St];default:return null}}return null}}catch(P){}}).parseCSSColor,In=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};In.parse=function(e){if(e){if(e instanceof In)return e;if(typeof e=="string"){var t=Ga(e);if(t)return new In(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},In.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},In.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},In.black=new In(0,0,0,1),In.white=new In(1,1,1,1),In.transparent=new In(0,0,0,0),In.red=new In(1,0,0,1);var Oi=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Oi.prototype.compare=function(e,t){return this.collator.compare(e,t)},Oi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $i=function(t,r,u,f,g){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=g},Ti=function(t){this.sections=t};Ti.fromString=function(e){return new Ti([new $i(e,null,null,null,null)])},Ti.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Ti.factory=function(e){return e instanceof Ti?e:Ti.fromString(e)},Ti.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Ti.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Io=function(t){this.name=t.name,this.available=t.available};function fu(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function hu(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof In)return!0;if(e instanceof Oi)return!0;if(e instanceof Ti)return!0;if(e instanceof Io)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!hu(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!hu(e[u]))return!1;return!0}return!1}function pa(e){if(e===null)return Tn;if(typeof e=="string")return Jr;if(typeof e=="boolean")return vn;if(typeof e=="number")return mr;if(e instanceof In)return Kn;if(e instanceof Oi)return oa;if(e instanceof Ti)return Mr;if(e instanceof Io)return va;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var g=pa(f[u]);if(t){if(t===g)continue;t=Hr;break}t=g}return ha(t||Hr,r)}return _n}function ws(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof In||e instanceof Ti||e instanceof Io?e.toString():JSON.stringify(e)}Io.prototype.toString=function(){return this.name},Io.fromString=function(e){return e?new Io({name:e,available:!1}):null},Io.prototype.serialize=function(){return["image",this.name]};var po=function(t,r){this.type=t,this.value=r};po.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!hu(e[1]))return t.error("invalid value");var r=e[1],u=pa(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new po(u,r)},po.prototype.evaluate=function(){return this.value},po.prototype.eachChild=function(){},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof In?["rgba"].concat(this.value.toArray()):this.value instanceof Ti?this.value.serialize():this.value};var Za=function(t){this.name="ExpressionEvaluationError",this.message=t};Za.prototype.toJSON=function(){return this.message};var Pu={string:Jr,number:mr,boolean:vn,object:_n},Mi=function(t,r){this.type=t,this.args=r};Mi.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var g,A;if(e.length>2){var P=e[1];if(typeof P!="string"||!(P in Pu)||P==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=Pu[P],u++}else g=Hr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],u++}r=ha(g,A)}else r=Pu[f];for(var B=[];u<e.length;u++){var Q=t.parse(e[u],u,Hr);if(!Q)return null;B.push(Q)}return new Mi(r,B)},Mi.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!Fi(this.type,pa(r)))return r;if(t===this.args.length-1)throw new Za("Expected value to be of type "+da(this.type)+", but found "+da(pa(r))+" instead.")}return null},Mi.prototype.eachChild=function(e){this.args.forEach(e)},Mi.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Mi.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var _i=function(t){this.type=Mr,this.sections=t};_i.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,g=1;g<=e.length-1;++g){var A=e[g];if(f&&typeof A=="object"&&!Array.isArray(A)){f=!1;var P=null;if(A["font-scale"]&&!(P=t.parse(A["font-scale"],1,mr)))return null;var B=null;if(A["text-font"]&&!(B=t.parse(A["text-font"],1,ha(Jr))))return null;var Q=null;if(A["text-color"]&&!(Q=t.parse(A["text-color"],1,Kn)))return null;var de=u[u.length-1];de.scale=P,de.font=B,de.textColor=Q}else{var _e=t.parse(e[g],1,Hr);if(!_e)return null;var Oe=_e.type.kind;if(Oe!=="string"&&Oe!=="value"&&Oe!=="null"&&Oe!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:_e,scale:null,font:null,textColor:null})}}return new _i(u)},_i.prototype.evaluate=function(e){return new Ti(this.sections.map(function(t){var r=t.content.evaluate(e);return pa(r)===va?new $i("",r,null,null,null):new $i(ws(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},_i.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},_i.prototype.outputDefined=function(){return!1},_i.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var _o=function(t){this.type=va,this.input=t};_o.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Jr);return r?new _o(r):t.error("No image name provided.")},_o.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Io.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},_o.prototype.eachChild=function(e){e(this.input)},_o.prototype.outputDefined=function(){return!1},_o.prototype.serialize=function(){return["image",this.input.serialize()]};var as={"to-boolean":vn,"to-color":Kn,"to-number":mr,"to-string":Jr},So=function(t,r){this.type=t,this.args=r};So.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=as[r],f=[],g=1;g<e.length;g++){var A=t.parse(e[g],g,Hr);if(!A)return null;f.push(A)}return new So(u,f)},So.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof In)return t;if(typeof t=="string"){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":fu(t[0],t[1],t[2],t[3])))return new In(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Za(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var A=null,P=0,B=this.args;P<B.length;P+=1){if((A=B[P].evaluate(e))===null)return 0;var Q=Number(A);if(!isNaN(Q))return Q}throw new Za("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?Ti.fromString(ws(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Io.fromString(ws(this.args[0].evaluate(e))):ws(this.args[0].evaluate(e))},So.prototype.eachChild=function(e){this.args.forEach(e)},So.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},So.prototype.serialize=function(){if(this.type.kind==="formatted")return new _i([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _o(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ol=["Unknown","Point","LineString","Polygon"],Os=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Os.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Os.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ol[this.feature.type]:this.feature.type:null},Os.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Os.prototype.canonicalID=function(){return this.canonical},Os.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Os.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=In.parse(e)),t};var so=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};so.prototype.evaluate=function(e){return this._evaluate(e,this.args)},so.prototype.eachChild=function(e){this.args.forEach(e)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},so.parse=function(e,t){var r,u=e[0],f=so.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(f)?f[0]:f.type,A=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,P=A.filter(function(kn){var Nn=kn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),B=null,Q=0,de=P;Q<de.length;Q+=1){var _e=de[Q],Oe=_e[0],nt=_e[1];B=new Gu(t.registry,t.path,null,t.scope);for(var St=[],bt=!1,Vt=1;Vt<e.length;Vt++){var Ut=e[Vt],or=Array.isArray(Oe)?Oe[Vt-1]:Oe.type,pr=B.parse(Ut,1+St.length,or);if(!pr){bt=!0;break}St.push(pr)}if(!bt)if(Array.isArray(Oe)&&Oe.length!==St.length)B.error("Expected "+Oe.length+" arguments, but found "+St.length+" instead.");else{for(var Sr=0;Sr<St.length;Sr++){var Vr=Array.isArray(Oe)?Oe[Sr]:Oe.type,Nr=St[Sr];B.concat(Sr+1).checkSubtype(Vr,Nr.type)}if(B.errors.length===0)return new so(u,g,nt,St)}}if(P.length===1)(r=t.errors).push.apply(r,B.errors);else{for(var mn=(P.length?P:A).map(function(kn){var Nn;return Nn=kn[0],Array.isArray(Nn)?"("+Nn.map(da).join(", ")+")":"("+da(Nn.type)+"...)"}).join(" | "),En=[],Bn=1;Bn<e.length;Bn++){var ea=t.parse(e[Bn],1+En.length);if(!ea)return null;En.push(da(ea.type))}t.error("Expected arguments of type "+mn+", but found ("+En.join(", ")+") instead.")}return null},so.register=function(e,t){for(var r in so.definitions=t,t)e[r]=so};var du=function(t,r,u){this.type=oa,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Ft(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Re(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Mt(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function dr(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function en(e,t){for(var r,u,f,g,A,P,B,Q=!1,de=0,_e=t.length;de<_e;de++)for(var Oe=t[de],nt=0,St=Oe.length;nt<St-1;nt++){if((g=(r=e)[0]-(u=Oe[nt])[0])*(B=r[1]-(f=Oe[nt+1])[1])-(P=r[0]-f[0])*(A=r[1]-u[1])==0&&g*P<=0&&A*B<=0)return!1;dr(e,Oe[nt],Oe[nt+1])&&(Q=!Q)}return Q}function xn(e,t){for(var r=0;r<t.length;r++)if(en(e,t[r]))return!0;return!1}function zn(e,t,r,u){var f=u[0]-r[0],g=u[1]-r[1],A=(e[0]-r[0])*g-f*(e[1]-r[1]),P=(t[0]-r[0])*g-f*(t[1]-r[1]);return A>0&&P<0||A<0&&P>0}function Gi(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var g=f[u],A=0;A<g.length-1;++A)if((_e=[(de=g[A+1])[0]-(Q=g[A])[0],de[1]-Q[1]])[0]*(Oe=[(B=t)[0]-(P=e)[0],B[1]-P[1]])[1]-_e[1]*Oe[0]!=0&&zn(P,B,Q,de)&&zn(Q,de,P,B))return!0;var P,B,Q,de,_e,Oe;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!en(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(Gi(e[u],e[u+1],t))return!1;return!0}function Do(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function To(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var g=[],A=0;A<e[f].length;A++){var P=Mt(e[f][A],r);Ft(t,P),g.push(P)}u.push(g)}return u}function nl(e,t,r){for(var u=[],f=0;f<e.length;f++){var g=To(e[f],t,r);u.push(g)}return u}function Ml(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,g=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;g===0&&(g=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=g}Ft(t,e)}function eu(e,t,r,u){for(var f=8192*Math.pow(2,u.z),g=[8192*u.x,8192*u.y],A=[],P=0,B=e;P<B.length;P+=1)for(var Q=0,de=B[P];Q<de.length;Q+=1){var _e=de[Q],Oe=[_e.x+g[0],_e.y+g[1]];Ml(Oe,t,r,f),A.push(Oe)}return A}function uf(e,t,r,u){for(var f,g=8192*Math.pow(2,u.z),A=[8192*u.x,8192*u.y],P=[],B=0,Q=e;B<Q.length;B+=1){for(var de=[],_e=0,Oe=Q[B];_e<Oe.length;_e+=1){var nt=Oe[_e],St=[nt.x+A[0],nt.y+A[1]];Ft(t,St),de.push(St)}P.push(de)}if(t[2]-t[0]<=g/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var bt=0,Vt=P;bt<Vt.length;bt+=1)for(var Ut=0,or=Vt[bt];Ut<or.length;Ut+=1)Ml(or[Ut],t,r,g)}return P}du.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,vn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,vn);if(!f)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,Jr))?null:new du(u,f,g)},du.prototype.evaluate=function(e){return new Oi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},du.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},du.prototype.outputDefined=function(){return!1},du.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var bs=function(t,r){this.type=vn,this.geojson=t,this.geometries=r};function Vu(e){if(e instanceof so){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof bs)return!1;var t=!0;return e.eachChild(function(r){t&&!Vu(r)&&(t=!1)}),t}function tu(e){if(e instanceof so&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!tu(r)&&(t=!1)}),t}function Ao(e,t){if(e instanceof so&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!Ao(u,t)&&(r=!1)}),r}bs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(hu(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new bs(r,r.features[u].geometry)}else if(r.type==="Feature"){var g=r.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new bs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new bs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},bs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=To(r.coordinates,f,g),P=eu(t.geometry(),u,f,g);if(!Re(u,f))return!1;for(var B=0,Q=P;B<Q.length;B+=1)if(!en(Q[B],A))return!1}if(r.type==="MultiPolygon"){var de=nl(r.coordinates,f,g),_e=eu(t.geometry(),u,f,g);if(!Re(u,f))return!1;for(var Oe=0,nt=_e;Oe<nt.length;Oe+=1)if(!xn(nt[Oe],de))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=To(r.coordinates,f,g),P=uf(t.geometry(),u,f,g);if(!Re(u,f))return!1;for(var B=0,Q=P;B<Q.length;B+=1)if(!mo(Q[B],A))return!1}if(r.type==="MultiPolygon"){var de=nl(r.coordinates,f,g),_e=uf(t.geometry(),u,f,g);if(!Re(u,f))return!1;for(var Oe=0,nt=_e;Oe<nt.length;Oe+=1)if(!Do(nt[Oe],de))return!1}return!0}(e,this.geometries)}return!1},bs.prototype.eachChild=function(){},bs.prototype.outputDefined=function(){return!0},bs.prototype.serialize=function(){return["within",this.geojson]};var is=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};is.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new is(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},is.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},is.prototype.eachChild=function(){},is.prototype.outputDefined=function(){return!1},is.prototype.serialize=function(){return["var",this.name]};var Gu=function(t,r,u,f,g){r===void 0&&(r=[]),f===void 0&&(f=new Wr),g===void 0&&(g=[]),this.registry=t,this.path=r,this.key=r.map(function(A){return"["+A+"]"}).join(""),this.scope=f,this.errors=g,this.expectedType=u};function al(e,t){for(var r,u=e.length-1,f=0,g=u,A=0;f<=g;)if((r=e[A=Math.floor((f+g)/2)])<=t){if(A===u||t<e[A+1])return A;f=A+1}else{if(!(r>t))throw new Za("Input is not a number.");g=A-1}return 0}Gu.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},Gu.prototype._parse=function(e,t){function r(Q,de,_e){return _e==="assert"?new Mi(de,[Q]):_e==="coerce"?new So(de,[Q]):Q}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var g=f.parse(e,this);if(!g)return null;if(this.expectedType){var A=this.expectedType,P=g.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||P.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(A,P))return null}else g=r(g,A,t.typeAnnotation||"coerce");else g=r(g,A,t.typeAnnotation||"assert")}if(!(g instanceof po)&&g.type.kind!=="resolvedImage"&&function Q(de){if(de instanceof is)return Q(de.boundExpression);if(de instanceof so&&de.name==="error")return!1;if(de instanceof du)return!1;if(de instanceof bs)return!1;var _e=de instanceof So||de instanceof Mi,Oe=!0;return de.eachChild(function(nt){Oe=_e?Oe&&Q(nt):Oe&&nt instanceof po}),!!Oe&&Vu(de)&&Ao(de,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var B=new Os;try{g=new po(g.type,g.evaluate(B))}catch(Q){return this.error(Q.message),null}}return g}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Gu.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Gu(this.registry,u,t||null,f,this.errors)},Gu.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new ur(u,e))},Gu.prototype.checkSubtype=function(e,t){var r=Fi(e,t);return r&&this.error(r),r};var Ms=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,g=u;f<g.length;f+=1){var A=g[f],P=A[1];this.labels.push(A[0]),this.outputs.push(P)}};function $a(e,t,r){return e*(1-r)+t*r}Ms.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,mr);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var g=1;g<e.length;g+=2){var A=g===1?-1/0:e[g],P=e[g+1],B=g,Q=g+1;if(typeof A!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(u.length&&u[u.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);var de=t.parse(P,Q,f);if(!de)return null;f=f||de.type,u.push([A,de])}return new Ms(f,r,u)},Ms.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[al(t,u)].evaluate(e)},Ms.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ms.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ms.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Hu=Object.freeze({__proto__:null,number:$a,color:function(t,r,u){return new In($a(t.r,r.r,u),$a(t.g,r.g,u),$a(t.b,r.b,u),$a(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,g){return $a(f,r[g],u)})}}),Wu=6/29*3*(6/29),il=Math.PI/180,sc=180/Math.PI;function wt(e){return e>.008856451679035631?Math.pow(e,1/3):e/Wu+4/29}function qt(e){return e>6/29?e*e*e:Wu*(e-4/29)}function wr(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Xn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Xa(e){var t=Xn(e.r),r=Xn(e.g),u=Xn(e.b),f=wt((.4124564*t+.3575761*r+.1804375*u)/.95047),g=wt((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-wt((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function ni(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*qt(t),r=.95047*qt(r),u=1.08883*qt(u),new In(wr(3.2404542*r-1.5371385*t-.4985314*u),wr(-.969266*r+1.8760108*t+.041556*u),wr(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function to(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var Sa={forward:Xa,reverse:ni,interpolate:function(t,r,u){return{l:$a(t.l,r.l,u),a:$a(t.a,r.a,u),b:$a(t.b,r.b,u),alpha:$a(t.alpha,r.alpha,u)}}},Ii={forward:function(t){var r=Xa(t),u=r.l,f=r.a,g=r.b,A=Math.atan2(g,f)*sc;return{h:A<0?A+360:A,c:Math.sqrt(f*f+g*g),l:u,alpha:t.a}},reverse:function(t){var r=t.h*il,u=t.c;return ni({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:to(t.h,r.h,u),c:$a(t.c,r.c,u),l:$a(t.l,r.l,u),alpha:$a(t.alpha,r.alpha,u)}}},qo=Object.freeze({__proto__:null,lab:Sa,hcl:Ii}),gi=function(t,r,u,f,g){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var A=0,P=g;A<P.length;A+=1){var B=P[A],Q=B[1];this.labels.push(B[0]),this.outputs.push(Q)}};function os(e,t,r,u){var f=u-r,g=e-r;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}gi.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=os(t,e.base,r,u);else if(e.name==="linear")f=os(t,1,r,u);else if(e.name==="cubic-bezier"){var g=e.controlPoints;f=new D(g[0],g[1],g[2],g[3]).solve(os(t,1,r,u))}return f},gi.parse=function(e,t){var r=e[0],u=e[1],f=e[2],g=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var A=u[1];if(typeof A!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:A}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var P=u.slice(1);if(P.length!==4||P.some(function(Vt){return typeof Vt!="number"||Vt<0||Vt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,mr)))return null;var B=[],Q=null;r==="interpolate-hcl"||r==="interpolate-lab"?Q=Kn:t.expectedType&&t.expectedType.kind!=="value"&&(Q=t.expectedType);for(var de=0;de<g.length;de+=2){var _e=g[de],Oe=g[de+1],nt=de+3,St=de+4;if(typeof _e!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',nt);if(B.length&&B[B.length-1][0]>=_e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',nt);var bt=t.parse(Oe,St,Q);if(!bt)return null;Q=Q||bt.type,B.push([_e,bt])}return Q.kind==="number"||Q.kind==="color"||Q.kind==="array"&&Q.itemType.kind==="number"&&typeof Q.N=="number"?new gi(Q,r,u,f,B):t.error("Type "+da(Q)+" is not interpolatable.")},gi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var g=al(t,u),A=gi.interpolationFactor(this.interpolation,u,t[g],t[g+1]),P=r[g].evaluate(e),B=r[g+1].evaluate(e);return this.operator==="interpolate"?Hu[this.type.kind.toLowerCase()](P,B,A):this.operator==="interpolate-hcl"?Ii.reverse(Ii.interpolate(Ii.forward(P),Ii.forward(B),A)):Sa.reverse(Sa.interpolate(Sa.forward(P),Sa.forward(B),A))},gi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var ru=function(t,r){this.type=t,this.args=r};ru.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],g=0,A=e.slice(1);g<A.length;g+=1){var P=t.parse(A[g],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,f.push(P)}var B=u&&f.some(function(Q){return Fi(u,Q.type)});return new ru(B?Hr:r,f)},ru.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,g=this.args;f<g.length&&(u++,(r=g[f].evaluate(e))&&r instanceof Io&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},ru.prototype.eachChild=function(e){this.args.forEach(e)},ru.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ru.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var pu=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};pu.prototype.evaluate=function(e){return this.result.evaluate(e)},pu.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},pu.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var g=t.parse(e[u+1],u+1);if(!g)return null;r.push([f,g])}var A=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return A?new pu(r,A):null},pu.prototype.outputDefined=function(){return this.result.outputDefined()},pu.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var ss=function(t,r,u){this.type=t,this.index=r,this.input=u};ss.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,mr),u=t.parse(e[2],2,ha(t.expectedType||Hr));return r&&u?new ss(u.type.itemType,r,u):null},ss.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Za("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Za("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Za("Array index must be an integer, but found "+t+" instead.");return r[t]},ss.prototype.eachChild=function(e){e(this.index),e(this.input)},ss.prototype.outputDefined=function(){return!1},ss.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Zu=function(t,r){this.type=vn,this.needle=t,this.haystack=r};Zu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Hr),u=t.parse(e[2],2,Hr);return r&&u?xa(r.type,[vn,Jr,mr,Tn,Hr])?new Zu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+da(r.type)+" instead"):null},Zu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!di(t,["boolean","string","number","null"]))throw new Za("Expected first argument to be of type boolean, string, number or null, but found "+da(pa(t))+" instead.");if(!di(r,["string","array"]))throw new Za("Expected second argument to be of type array or string, but found "+da(pa(r))+" instead.");return r.indexOf(t)>=0},Zu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Zu.prototype.outputDefined=function(){return!0},Zu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var mu=function(t,r,u){this.type=mr,this.needle=t,this.haystack=r,this.fromIndex=u};mu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Hr),u=t.parse(e[2],2,Hr);if(!r||!u)return null;if(!xa(r.type,[vn,Jr,mr,Tn,Hr]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+da(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,mr);return f?new mu(r,u,f):null}return new mu(r,u)},mu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!di(t,["boolean","string","number","null"]))throw new Za("Expected first argument to be of type boolean, string, number or null, but found "+da(pa(t))+" instead.");if(!di(r,["string","array"]))throw new Za("Expected second argument to be of type array or string, but found "+da(pa(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},mu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},mu.prototype.outputDefined=function(){return!1},mu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ol=function(t,r,u,f,g,A){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=g,this.otherwise=A};ol.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},g=[],A=2;A<e.length-1;A+=2){var P=e[A],B=e[A+1];Array.isArray(P)||(P=[P]);var Q=t.concat(A);if(P.length===0)return Q.error("Expected at least one branch label.");for(var de=0,_e=P;de<_e.length;de+=1){var Oe=_e[de];if(typeof Oe!="number"&&typeof Oe!="string")return Q.error("Branch labels must be numbers or strings.");if(typeof Oe=="number"&&Math.abs(Oe)>Number.MAX_SAFE_INTEGER)return Q.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Oe=="number"&&Math.floor(Oe)!==Oe)return Q.error("Numeric branch labels must be integer values.");if(r){if(Q.checkSubtype(r,pa(Oe)))return null}else r=pa(Oe);if(f[String(Oe)]!==void 0)return Q.error("Branch labels must be unique.");f[String(Oe)]=g.length}var nt=t.parse(B,A,u);if(!nt)return null;u=u||nt.type,g.push(nt)}var St=t.parse(e[1],1,Hr);if(!St)return null;var bt=t.parse(e[e.length-1],e.length-1,u);return bt?St.type.kind!=="value"&&t.concat(1).checkSubtype(r,St.type)?null:new ol(r,u,St,f,g,bt):null},ol.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(pa(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},ol.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ol.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ol.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,g=Object.keys(this.cases).sort();f<g.length;f+=1){var A=g[f];(_e=u[this.cases[A]])===void 0?(u[this.cases[A]]=r.length,r.push([this.cases[A],[A]])):r[_e][1].push(A)}for(var P=function(St){return e.inputType.kind==="number"?Number(St):St},B=0,Q=r;B<Q.length;B+=1){var de=Q[B],_e=de[0],Oe=de[1];t.push(Oe.length===1?P(Oe[0]):Oe.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Lu=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};Lu.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var g=t.parse(e[f],f,vn);if(!g)return null;var A=t.parse(e[f+1],f+1,r);if(!A)return null;u.push([g,A]),r=r||A.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new Lu(r,u,P):null},Lu.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},Lu.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},Lu.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Lu.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Xu=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function uc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function lf(e,t,r,u){return u.compare(t,r)===0}function Ec(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(g,A,P){this.type=vn,this.lhs=g,this.rhs=A,this.collator=P,this.hasUntypedArgument=g.type.kind==="value"||A.type.kind==="value"}return f.parse=function(g,A){if(g.length!==3&&g.length!==4)return A.error("Expected two or three arguments.");var P=g[0],B=A.parse(g[1],1,Hr);if(!B)return null;if(!uc(P,B.type))return A.concat(1).error('"'+P+`" comparisons are not supported for type '`+da(B.type)+"'.");var Q=A.parse(g[2],2,Hr);if(!Q)return null;if(!uc(P,Q.type))return A.concat(2).error('"'+P+`" comparisons are not supported for type '`+da(Q.type)+"'.");if(B.type.kind!==Q.type.kind&&B.type.kind!=="value"&&Q.type.kind!=="value")return A.error("Cannot compare types '"+da(B.type)+"' and '"+da(Q.type)+"'.");u&&(B.type.kind==="value"&&Q.type.kind!=="value"?B=new Mi(Q.type,[B]):B.type.kind!=="value"&&Q.type.kind==="value"&&(Q=new Mi(B.type,[Q])));var de=null;if(g.length===4){if(B.type.kind!=="string"&&Q.type.kind!=="string"&&B.type.kind!=="value"&&Q.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(de=A.parse(g[3],3,oa)))return null}return new f(B,Q,de)},f.prototype.evaluate=function(g){var A=this.lhs.evaluate(g),P=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){var B=pa(A),Q=pa(P);if(B.kind!==Q.kind||B.kind!=="string"&&B.kind!=="number")throw new Za('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+B.kind+", "+Q.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var de=pa(A),_e=pa(P);if(de.kind!=="string"||_e.kind!=="string")return t(g,A,P)}return this.collator?r(g,A,P,this.collator.evaluate(g)):t(g,A,P)},f.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var g=[e];return this.eachChild(function(A){g.push(A.serialize())}),g},f}()}Xu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Hr),u=t.parse(e[2],2,mr);if(!r||!u)return null;if(!xa(r.type,[ha(Hr),Jr,Hr]))return t.error("Expected first argument to be of type array or string, but found "+da(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,mr);return f?new Xu(r.type,r,u,f):null}return new Xu(r.type,r,u)},Xu.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!di(t,["string","array"]))throw new Za("Expected first argument to be of type array or string, but found "+da(pa(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Xu.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Xu.prototype.outputDefined=function(){return!1},Xu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Hi=Ec("==",function(e,t,r){return t===r},lf),Vc=Ec("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!lf(0,t,r,u)}),Gc=Ec("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),Tf=Ec(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),Hc=Ec("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),_f=Ec(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Pi=function(t,r,u,f,g){this.type=Jr,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=g};Pi.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,mr);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,Jr)))return null;var g=null;if(u.currency&&!(g=t.parse(u.currency,1,Jr)))return null;var A=null;if(u["min-fraction-digits"]&&!(A=t.parse(u["min-fraction-digits"],1,mr)))return null;var P=null;return u["max-fraction-digits"]&&!(P=t.parse(u["max-fraction-digits"],1,mr))?null:new Pi(r,f,g,A,P)},Pi.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Pi.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Pi.prototype.outputDefined=function(){return!1},Pi.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ru=function(t){this.type=mr,this.input=t};Ru.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+da(r.type)+" instead."):new Ru(r):null},Ru.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Za("Expected value to be of type string or array, but found "+da(pa(t))+" instead.")},Ru.prototype.eachChild=function(e){e(this.input)},Ru.prototype.outputDefined=function(){return!1},Ru.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Pl={"==":Hi,"!=":Vc,">":Tf,"<":Gc,">=":_f,"<=":Hc,array:Mi,at:ss,boolean:Mi,case:Lu,coalesce:ru,collator:du,format:_i,image:_o,in:Zu,"index-of":mu,interpolate:gi,"interpolate-hcl":gi,"interpolate-lab":gi,length:Ru,let:pu,literal:po,match:ol,number:Mi,"number-format":Pi,object:Mi,slice:Xu,step:Ms,string:Mi,"to-boolean":So,"to-color":So,"to-number":So,"to-string":So,var:is,within:bs};function nu(e,t){var r=t[0],u=t[1],f=t[2],g=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var A=g?g.evaluate(e):1,P=fu(r,u,f,A);if(P)throw new Za(P);return new In(r/255*A,u/255*A,f/255*A,A)}function Wc(e,t){return e in t}function lc(e,t){var r=t[e];return r===void 0?null:r}function vu(e){return{type:e}}function Zc(e){return{result:"success",value:e}}function Fs(e){return{result:"error",value:e}}function au(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Ll(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Tc(e){return!!e.expression&&e.expression.interpolated}function yi(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function cc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Uf(e){return e}function fc(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Bf(e,t,r,u,f){return fc(typeof r===f?u[r]:void 0,e.default,t.default)}function _c(e,t,r){if(yi(r)!=="number")return fc(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=al(e.stops.map(function(g){return g[0]}),r);return e.stops[f][1]}function Rl(e,t,r){var u=e.base!==void 0?e.base:1;if(yi(r)!=="number")return fc(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var g=al(e.stops.map(function(_e){return _e[0]}),r),A=function(_e,Oe,nt,St){var bt=St-nt,Vt=_e-nt;return bt===0?0:Oe===1?Vt/bt:(Math.pow(Oe,Vt)-1)/(Math.pow(Oe,bt)-1)}(r,u,e.stops[g][0],e.stops[g+1][0]),P=e.stops[g][1],B=e.stops[g+1][1],Q=Hu[t.type]||Uf;if(e.colorSpace&&e.colorSpace!=="rgb"){var de=qo[e.colorSpace];Q=function(Oe,nt){return de.reverse(de.interpolate(de.forward(Oe),de.forward(nt),A))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var Oe=[],nt=arguments.length;nt--;)Oe[nt]=arguments[nt];var St=P.evaluate.apply(void 0,Oe),bt=B.evaluate.apply(void 0,Oe);if(St!==void 0&&bt!==void 0)return Q(St,bt,A)}}:Q(P,B,A)}function pl(e,t,r){return t.type==="color"?r=In.parse(r):t.type==="formatted"?r=Ti.fromString(r.toString()):t.type==="resolvedImage"?r=Io.fromString(r.toString()):yi(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),fc(r,e.default,t.default)}so.register(Pl,{error:[{kind:"error"},[Jr],function(e,t){throw new Za(t[0].evaluate(e))}],typeof:[Jr,[Hr],function(e,t){return da(pa(t[0].evaluate(e)))}],"to-rgba":[ha(mr,4),[Kn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Kn,[mr,mr,mr],nu],rgba:[Kn,[mr,mr,mr,mr],nu],has:{type:vn,overloads:[[[Jr],function(e,t){return Wc(t[0].evaluate(e),e.properties())}],[[Jr,_n],function(e,t){var r=t[1];return Wc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:Hr,overloads:[[[Jr],function(e,t){return lc(t[0].evaluate(e),e.properties())}],[[Jr,_n],function(e,t){var r=t[1];return lc(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[Hr,[Jr],function(e,t){return lc(t[0].evaluate(e),e.featureState||{})}],properties:[_n,[],function(e){return e.properties()}],"geometry-type":[Jr,[],function(e){return e.geometryType()}],id:[Hr,[],function(e){return e.id()}],zoom:[mr,[],function(e){return e.globals.zoom}],"heatmap-density":[mr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[mr,[],function(e){return e.globals.lineProgress||0}],accumulated:[Hr,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[mr,vu(mr),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[mr,vu(mr),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:mr,overloads:[[[mr,mr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[mr],function(e,t){return-t[0].evaluate(e)}]]},"/":[mr,[mr,mr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[mr,[mr,mr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[mr,[],function(){return Math.LN2}],pi:[mr,[],function(){return Math.PI}],e:[mr,[],function(){return Math.E}],"^":[mr,[mr,mr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[mr,[mr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[mr,[mr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[mr,[mr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[mr,[mr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[mr,[mr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[mr,[mr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[mr,[mr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[mr,[mr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[mr,[mr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[mr,[mr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[mr,vu(mr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[mr,vu(mr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[mr,[mr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[mr,[mr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[mr,[mr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[mr,[mr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[vn,[Jr,Hr],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[vn,[Hr],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[vn,[Jr],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[vn,[Jr,Hr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[vn,[Hr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[vn,[Jr,Hr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[vn,[Hr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[vn,[Jr,Hr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[vn,[Hr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[vn,[Jr,Hr],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[vn,[Hr],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[vn,[Hr],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[vn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[vn,[ha(Jr)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[vn,[ha(Hr)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[vn,[Jr,ha(Hr)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[vn,[Jr,ha(Hr)],function(e,t){var r=t[0],u=t[1];return function(f,g,A,P){for(;A<=P;){var B=A+P>>1;if(g[B]===f)return!0;g[B]>f?P=B-1:A=B+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[vu(vn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[vu(vn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[vn,[vn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[vn,[Jr],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Jr,[Jr],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Jr,[Jr],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Jr,vu(Hr),function(e,t){return t.map(function(r){return ws(r.evaluate(e))}).join("")}],"resolved-locale":[Jr,[oa],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Ps=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Os,this._defaultValue=r?function(u){return u.type==="color"&&cc(u.default)?new In(0,0,0,0):u.type==="color"?In.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function hc(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Pl}function Fo(e,t){var r=new Gu(Pl,[],t?function(f){var g={color:Kn,string:Jr,number:mr,enum:Jr,boolean:vn,formatted:Mr,resolvedImage:va};return f.type==="array"?ha(g[f.value]||Hr,f.length):g[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Zc(new Ps(u,t)):Fs(r.errors)}Ps.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},Ps.prototype.evaluate=function(e,t,r,u,f,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Za("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Il=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!tu(r.expression)};Il.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,g)},Il.prototype.evaluate=function(e,t,r,u,f,g){return this._styleExpression.evaluate(e,t,r,u,f,g)};var ml=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!tu(r.expression),this.interpolationType=f};function Xc(e,t){if((e=Fo(e,t)).result==="error")return e;var r=e.value.expression,u=Vu(r);if(!u&&!au(t))return Fs([new ur("","data expressions not supported")]);var f=Ao(r,["zoom"]);if(!f&&!Ll(t))return Fs([new ur("","zoom expressions not supported")]);var g=function A(P){var B=null;if(P instanceof pu)B=A(P.result);else if(P instanceof ru)for(var Q=0,de=P.args;Q<de.length&&!(B=A(de[Q]));Q+=1);else(P instanceof Ms||P instanceof gi)&&P.input instanceof so&&P.input.name==="zoom"&&(B=P);return B instanceof ur||P.eachChild(function(_e){var Oe=A(_e);Oe instanceof ur?B=Oe:!B&&Oe?B=new ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):B&&Oe&&B!==Oe&&(B=new ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),B}(r);return g||f?g instanceof ur?Fs([g]):g instanceof gi&&!Tc(t)?Fs([new ur("",'"interpolate" expressions cannot be used with this property')]):Zc(g?new ml(u?"camera":"composite",e.value,g.labels,g instanceof gi?g.interpolation:void 0):new Il(u?"constant":"source",e.value)):Fs([new ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}ml.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,g)},ml.prototype.evaluate=function(e,t,r,u,f,g){return this._styleExpression.evaluate(e,t,r,u,f,g)},ml.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?gi.interpolationFactor(this.interpolationType,e,t,r):0};var vl=function(t,r){this._parameters=t,this._specification=r,rr(this,function u(f,g){var A,P,B,Q=g.type==="color",de=f.stops&&typeof f.stops[0][0]=="object",_e=de||!(de||f.property!==void 0),Oe=f.type||(Tc(g)?"exponential":"interval");if(Q&&((f=rr({},f)).stops&&(f.stops=f.stops.map(function(kn){return[kn[0],In.parse(kn[1])]})),f.default=In.parse(f.default?f.default:g.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!qo[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Oe==="exponential")A=Rl;else if(Oe==="interval")A=_c;else if(Oe==="categorical"){A=Bf,P=Object.create(null);for(var nt=0,St=f.stops;nt<St.length;nt+=1){var bt=St[nt];P[bt[0]]=bt[1]}B=typeof f.stops[0][0]}else{if(Oe!=="identity")throw new Error('Unknown function type "'+Oe+'"');A=pl}if(de){for(var Vt={},Ut=[],or=0;or<f.stops.length;or++){var pr=f.stops[or],Sr=pr[0].zoom;Vt[Sr]===void 0&&(Vt[Sr]={zoom:Sr,type:f.type,property:f.property,default:f.default,stops:[]},Ut.push(Sr)),Vt[Sr].stops.push([pr[0].value,pr[1]])}for(var Vr=[],Nr=0,mn=Ut;Nr<mn.length;Nr+=1){var En=mn[Nr];Vr.push([Vt[En].zoom,u(Vt[En],g)])}var Bn={name:"linear"};return{kind:"composite",interpolationType:Bn,interpolationFactor:gi.interpolationFactor.bind(void 0,Bn),zoomStops:Vr.map(function(kn){return kn[0]}),evaluate:function(Nn,wa){var ua=Nn.zoom;return Rl({stops:Vr,base:f.base},g,ua).evaluate(ua,wa)}}}if(_e){var ea=Oe==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:ea,interpolationFactor:gi.interpolationFactor.bind(void 0,ea),zoomStops:f.stops.map(function(kn){return kn[0]}),evaluate:function(Nn){return A(f,g,Nn.zoom,P,B)}}}return{kind:"source",evaluate:function(Nn,wa){var ua=wa&&wa.properties?wa.properties[f.property]:void 0;return ua===void 0?fc(f.default,g.default):A(f,g,ua,P,B)}}}(this._parameters,this._specification))};function iu(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},g=e.style,A=e.styleSpec,P=[],B=yi(r);if(B!=="object")return[new ct(t,r,"object expected, "+B+" found")];for(var Q in r){var de=Q.split(".")[0],_e=u[de]||u["*"],Oe=void 0;if(f[de])Oe=f[de];else if(u[de])Oe=Bo;else if(f["*"])Oe=f["*"];else{if(!u["*"]){P.push(new ct(t,r[Q],'unknown property "'+Q+'"'));continue}Oe=Bo}P=P.concat(Oe({key:(t&&t+".")+Q,value:r[Q],valueSpec:_e,style:g,styleSpec:A,object:r,objectKey:Q},r))}for(var nt in u)f[nt]||u[nt].required&&u[nt].default===void 0&&r[nt]===void 0&&P.push(new ct(t,r,'missing required property "'+nt+'"'));return P}function Yc(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,g=e.key,A=e.arrayElementValidator||Bo;if(yi(t)!=="array")return[new ct(g,t,"array expected, "+yi(t)+" found")];if(r.length&&t.length!==r.length)return[new ct(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new ct(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};f.$version<7&&(P.function=r.function),yi(r.value)==="object"&&(P=r.value);for(var B=[],Q=0;Q<t.length;Q++)B=B.concat(A({array:t,arrayIndex:Q,value:t[Q],valueSpec:P,style:u,styleSpec:f,key:g+"["+Q+"]"}));return B}function Sf(e){var t=e.key,r=e.value,u=e.valueSpec,f=yi(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new ct(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new ct(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new ct(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function Af(e){var t,r,u,f=e.valueSpec,g=jr(e.value.type),A={},P=g!=="categorical"&&e.value.property===void 0,B=!P,Q=yi(e.value.stops)==="array"&&yi(e.value.stops[0])==="array"&&yi(e.value.stops[0][0])==="object",de=iu({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(St){if(g==="identity")return[new ct(St.key,St.value,'identity function may not have a "stops" property')];var bt=[],Vt=St.value;return bt=bt.concat(Yc({key:St.key,value:Vt,valueSpec:St.valueSpec,style:St.style,styleSpec:St.styleSpec,arrayElementValidator:_e})),yi(Vt)==="array"&&Vt.length===0&&bt.push(new ct(St.key,Vt,"array must have at least one stop")),bt},default:function(St){return Bo({key:St.key,value:St.value,valueSpec:f,style:St.style,styleSpec:St.styleSpec})}}});return g==="identity"&&P&&de.push(new ct(e.key,e.value,'missing required property "property"')),g==="identity"||e.value.stops||de.push(new ct(e.key,e.value,'missing required property "stops"')),g==="exponential"&&e.valueSpec.expression&&!Tc(e.valueSpec)&&de.push(new ct(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(B&&!au(e.valueSpec)?de.push(new ct(e.key,e.value,"property functions not supported")):P&&!Ll(e.valueSpec)&&de.push(new ct(e.key,e.value,"zoom functions not supported"))),g!=="categorical"&&!Q||e.value.property!==void 0||de.push(new ct(e.key,e.value,'"property" property is required')),de;function _e(nt){var St=[],bt=nt.value,Vt=nt.key;if(yi(bt)!=="array")return[new ct(Vt,bt,"array expected, "+yi(bt)+" found")];if(bt.length!==2)return[new ct(Vt,bt,"array length 2 expected, length "+bt.length+" found")];if(Q){if(yi(bt[0])!=="object")return[new ct(Vt,bt,"object expected, "+yi(bt[0])+" found")];if(bt[0].zoom===void 0)return[new ct(Vt,bt,"object stop key must have zoom")];if(bt[0].value===void 0)return[new ct(Vt,bt,"object stop key must have value")];if(u&&u>jr(bt[0].zoom))return[new ct(Vt,bt[0].zoom,"stop zoom values must appear in ascending order")];jr(bt[0].zoom)!==u&&(u=jr(bt[0].zoom),r=void 0,A={}),St=St.concat(iu({key:Vt+"[0]",value:bt[0],valueSpec:{zoom:{}},style:nt.style,styleSpec:nt.styleSpec,objectElementValidators:{zoom:Sf,value:Oe}}))}else St=St.concat(Oe({key:Vt+"[0]",value:bt[0],valueSpec:{},style:nt.style,styleSpec:nt.styleSpec},bt));return hc(nn(bt[1]))?St.concat([new ct(Vt+"[1]",bt[1],"expressions are not allowed in function stops.")]):St.concat(Bo({key:Vt+"[1]",value:bt[1],valueSpec:f,style:nt.style,styleSpec:nt.styleSpec}))}function Oe(nt,St){var bt=yi(nt.value),Vt=jr(nt.value),Ut=nt.value!==null?nt.value:St;if(t){if(bt!==t)return[new ct(nt.key,Ut,bt+" stop domain type must match previous stop domain type "+t)]}else t=bt;if(bt!=="number"&&bt!=="string"&&bt!=="boolean")return[new ct(nt.key,Ut,"stop domain value must be a number, string, or boolean")];if(bt!=="number"&&g!=="categorical"){var or="number expected, "+bt+" found";return au(f)&&g===void 0&&(or+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ct(nt.key,Ut,or)]}return g!=="categorical"||bt!=="number"||isFinite(Vt)&&Math.floor(Vt)===Vt?g!=="categorical"&&bt==="number"&&r!==void 0&&Vt<r?[new ct(nt.key,Ut,"stop domain values must appear in ascending order")]:(r=Vt,g==="categorical"&&Vt in A?[new ct(nt.key,Ut,"stop domain values must be unique")]:(A[Vt]=!0,[])):[new ct(nt.key,Ut,"integer expected, found "+Vt)]}}function Dl(e){var t=(e.expressionContext==="property"?Xc:Fo)(nn(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new ct(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new ct(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!tu(r))return[new ct(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!tu(r))return[new ct(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ao(r,["zoom","feature-state"]))return[new ct(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Vu(r))return[new ct(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dc(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(jr(r))===-1&&f.push(new ct(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(jr(r))===-1&&f.push(new ct(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function Sc(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!Sc(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}vl.deserialize=function(e){return new vl(e._parameters,e._specification)},vl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Nl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Yu(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Sc(e)||(e=gl(e));var t=Fo(e,Nl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,g){return t.value.evaluate(u,f,{},g)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function Cf(e,t){return e<t?-1:e>t?1:0}function gl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?pc(e[1],e[2],"=="):r==="!="?Kc(pc(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?pc(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(gl))):r==="all"?["all"].concat(e.slice(1).map(gl)):r==="none"?["all"].concat(e.slice(1).map(gl).map(Kc)):r==="in"?Co(e[1],e.slice(2)):r==="!in"?Kc(Co(e[1],e.slice(2))):r==="has"?Vf(e[1]):r==="!has"?Kc(Vf(e[1])):r!=="within"||e}function pc(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Co(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Cf)]]:["filter-in-small",e,["literal",t]]}}function Vf(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Kc(e){return["!",e]}function Ac(e){return Sc(nn(e.value))?Dl(rr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(yi(u)!=="array")return[new ct(f,u,"array expected, "+yi(u)+" found")];var g,A=r.styleSpec,P=[];if(u.length<1)return[new ct(f,u,"filter array must have at least 1 element")];switch(P=P.concat(dc({key:f+"[0]",value:u[0],valueSpec:A.filter_operator,style:r.style,styleSpec:r.styleSpec})),jr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&jr(u[1])==="$type"&&P.push(new ct(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&P.push(new ct(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(g=yi(u[1]))!=="string"&&P.push(new ct(f+"[1]",u[1],"string expected, "+g+" found"));for(var B=2;B<u.length;B++)g=yi(u[B]),jr(u[1])==="$type"?P=P.concat(dc({key:f+"["+B+"]",value:u[B],valueSpec:A.geometry_type,style:r.style,styleSpec:r.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&P.push(new ct(f+"["+B+"]",u[B],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var Q=1;Q<u.length;Q++)P=P.concat(t({key:f+"["+Q+"]",value:u[Q],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=yi(u[1]),u.length!==2?P.push(new ct(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="string"&&P.push(new ct(f+"[1]",u[1],"string expected, "+g+" found"));break;case"within":g=yi(u[1]),u.length!==2?P.push(new ct(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="object"&&P.push(new ct(f+"[1]",u[1],"object expected, "+g+" found"))}return P}(e)}function cf(e,t){var r=e.key,u=e.style,f=e.styleSpec,g=e.value,A=e.objectKey,P=f[t+"_"+e.layerType];if(!P)return[];var B=A.match(/^(.*)-transition$/);if(t==="paint"&&B&&P[B[1]]&&P[B[1]].transition)return Bo({key:r,value:g,valueSpec:f.transition,style:u,styleSpec:f});var Q,de=e.valueSpec||P[A];if(!de)return[new ct(r,g,'unknown property "'+A+'"')];if(yi(g)==="string"&&au(de)&&!de.tokens&&(Q=/^{([^}]+)}$/.exec(g)))return[new ct(r,g,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Q[1])+" }`.")];var _e=[];return e.layerType==="symbol"&&(A==="text-field"&&u&&!u.glyphs&&_e.push(new ct(r,g,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&cc(nn(g))&&jr(g.type)==="identity"&&_e.push(new ct(r,g,'"text-font" does not support identity functions'))),_e.concat(Bo({key:e.key,value:g,valueSpec:de,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:A}))}function ff(e){return cf(e,"paint")}function hf(e){return cf(e,"layout")}function kl(e){var t=[],r=e.value,u=e.key,f=e.style,g=e.styleSpec;r.type||r.ref||t.push(new ct(u,r,'either "type" or "ref" is required'));var A,P=jr(r.type),B=jr(r.ref);if(r.id)for(var Q=jr(r.id),de=0;de<e.arrayIndex;de++){var _e=f.layers[de];jr(_e.id)===Q&&t.push(new ct(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+_e.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(St){St in r&&t.push(new ct(u,r[St],'"'+St+'" is prohibited for ref layers'))}),f.layers.forEach(function(St){jr(St.id)===B&&(A=St)}),A?A.ref?t.push(new ct(u,r.ref,"ref cannot reference another ref layer")):P=jr(A.type):t.push(new ct(u,r.ref,'ref layer "'+B+'" not found'));else if(P!=="background")if(r.source){var Oe=f.sources&&f.sources[r.source],nt=Oe&&jr(Oe.type);Oe?nt==="vector"&&P==="raster"?t.push(new ct(u,r.source,'layer "'+r.id+'" requires a raster source')):nt==="raster"&&P!=="raster"?t.push(new ct(u,r.source,'layer "'+r.id+'" requires a vector source')):nt!=="vector"||r["source-layer"]?nt==="raster-dem"&&P!=="hillshade"?t.push(new ct(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!r.paint||!r.paint["line-gradient"]||nt==="geojson"&&Oe.lineMetrics||t.push(new ct(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new ct(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new ct(u,r.source,'source "'+r.source+'" not found'))}else t.push(new ct(u,r,'missing required property "source"'));return t=t.concat(iu({key:u,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Bo({key:u+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Ac,layout:function(bt){return iu({layer:r,key:bt.key,value:bt.value,style:bt.style,styleSpec:bt.styleSpec,objectElementValidators:{"*":function(Ut){return hf(rr({layerType:P},Ut))}}})},paint:function(bt){return iu({layer:r,key:bt.key,value:bt.value,style:bt.style,styleSpec:bt.styleSpec,objectElementValidators:{"*":function(Ut){return ff(rr({layerType:P},Ut))}}})}}}))}function jl(e){var t=e.value,r=e.key,u=yi(t);return u!=="string"?[new ct(r,t,"string expected, "+u+" found")]:[]}var zl={promoteId:function(t){var r=t.key,u=t.value;if(yi(u)==="string")return jl({key:r,value:u});var f=[];for(var g in u)f.push.apply(f,jl({key:r+"."+g,value:u[g]}));return f}};function Di(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new ct(r,t,'"type" is required')];var g,A=jr(t.type);switch(A){case"vector":case"raster":case"raster-dem":return iu({key:r,value:t,valueSpec:u["source_"+A.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:zl});case"geojson":if(g=iu({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:zl}),t.cluster)for(var P in t.clusterProperties){var B=t.clusterProperties[P],Q=B[0],de=typeof Q=="string"?[Q,["accumulated"],["get",P]]:Q;g.push.apply(g,Dl({key:r+"."+P+".map",value:B[1],expressionContext:"cluster-map"})),g.push.apply(g,Dl({key:r+"."+P+".reduce",value:de,expressionContext:"cluster-reduce"}))}return g;case"video":return iu({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return iu({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new ct(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dc({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function ou(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,g=[],A=yi(t);if(t===void 0)return g;if(A!=="object")return g.concat([new ct("light",t,"object expected, "+A+" found")]);for(var P in t){var B=P.match(/^(.*)-transition$/);g=g.concat(B&&u[B[1]]&&u[B[1]].transition?Bo({key:P,value:t[P],valueSpec:r.transition,style:f,styleSpec:r}):u[P]?Bo({key:P,value:t[P],valueSpec:u[P],style:f,styleSpec:r}):[new ct(P,t[P],'unknown property "'+P+'"')])}return g}var Uo={"*":function(){return[]},array:Yc,boolean:function(t){var r=t.value,u=t.key,f=yi(r);return f!=="boolean"?[new ct(u,r,"boolean expected, "+f+" found")]:[]},number:Sf,color:function(t){var r=t.key,u=t.value,f=yi(u);return f!=="string"?[new ct(r,u,"color expected, "+f+" found")]:Ga(u)===null?[new ct(r,u,'color expected, "'+u+'" found')]:[]},constants:er,enum:dc,filter:Ac,function:Af,layer:kl,object:iu,source:Di,light:ou,string:jl,formatted:function(t){return jl(t).length===0?[]:Dl(t)},resolvedImage:function(t){return jl(t).length===0?[]:Dl(t)}};function Bo(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&cc(jr(t))?Af(e):r.expression&&hc(nn(t))?Dl(e):r.type&&Uo[r.type]?Uo[r.type](e):iu(rr({},e,{valueSpec:r.type?u[r.type]:r}))}function ui(e){var t=e.value,r=e.key,u=jl(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new ct(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new ct(r,t,'"glyphs" url must include a "{range}" token'))),u}function li(e,t){t===void 0&&(t=Ve);var r=[];return r=r.concat(Bo({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ui,"*":function(){return[]}}})),e.constants&&(r=r.concat(er({key:"constants",value:e.constants,style:e,styleSpec:t}))),sl(r)}function sl(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function us(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return sl(e.apply(this,t))}}li.source=us(Di),li.light=us(ou),li.layer=us(kl),li.filter=us(Ac),li.paintProperty=us(ff),li.layoutProperty=us(hf);var mc=li,wf=mc.light,Of=mc.paintProperty,No=mc.layoutProperty;function yl(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new rt(new Error(f[u].message))),r=!0;return r}var oi=Ia;function Ia(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var g=0;g<this.d*this.d;g++){var A=f[3+g],P=f[3+g+1];u.push(A===P?null:f.subarray(A,P))}var B=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],B),this.bboxes=f.subarray(B),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var Q=0;Q<this.d*this.d;Q++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var de=r/t*e;this.min=-de,this.max=e+de}Ia.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},Ia.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ia.prototype._insertCell=function(e,t,r,u,f,g){this.cells[f].push(g)},Ia.prototype.query=function(e,t,r,u,f){var g=this.min,A=this.max;if(e<=g&&t<=g&&A<=r&&A<=u&&!f)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,u,this._queryCell,P,{},f),P},Ia.prototype._queryCell=function(e,t,r,u,f,g,A,P){var B=this.cells[f];if(B!==null)for(var Q=this.keys,de=this.bboxes,_e=0;_e<B.length;_e++){var Oe=B[_e];if(A[Oe]===void 0){var nt=4*Oe;(P?P(de[nt+0],de[nt+1],de[nt+2],de[nt+3]):e<=de[nt+2]&&t<=de[nt+3]&&r>=de[nt+0]&&u>=de[nt+1])?(A[Oe]=!0,g.push(Q[Oe])):A[Oe]=!1}}},Ia.prototype._forEachCell=function(e,t,r,u,f,g,A,P){for(var B=this._convertToCellCoord(e),Q=this._convertToCellCoord(t),de=this._convertToCellCoord(r),_e=this._convertToCellCoord(u),Oe=B;Oe<=de;Oe++)for(var nt=Q;nt<=_e;nt++){var St=this.d*nt+Oe;if((!P||P(this._convertFromCellCoord(Oe),this._convertFromCellCoord(nt),this._convertFromCellCoord(Oe+1),this._convertFromCellCoord(nt+1)))&&f.call(this,e,t,r,u,St,g,A,P))return}},Ia.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ia.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ia.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=t,A=0;A<e.length;A++){var P=e[A];f[3+A]=g,f.set(P,g),g+=P.length}return f[3+e.length]=g,f.set(this.keys,g),f[3+e.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var xs=X.ImageData,ls=X.ImageBitmap,Iu={};function bn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Iu[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Es in bn("Object",Object),oi.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},oi.deserialize=function(e){return new oi(e.buffer)},bn("Grid",oi),bn("Color",In),bn("Error",Error),bn("ResolvedImage",Io),bn("StylePropertyFunction",vl),bn("StyleExpression",Ps,{omit:["_evaluator"]}),bn("ZoomDependentExpression",ml),bn("ZoomConstantExpression",Il),bn("CompoundExpression",so,{omit:["_evaluate"]}),Pl)Pl[Es]._classRegistryKey||bn("Expression_"+Es,Pl[Es]);function Us(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Cc(e){return ls&&e instanceof ls}function gu(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Us(e)||Cc(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof xs)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,g=e;f<g.length;f+=1)u.push(gu(g[f],t));return u}if(typeof e=="object"){var A=e.constructor,P=A._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var B=A.serialize?A.serialize(e,t):{};if(!A.serialize){for(var Q in e)if(e.hasOwnProperty(Q)&&!(Iu[P].omit.indexOf(Q)>=0)){var de=e[Q];B[Q]=Iu[P].shallow.indexOf(Q)>=0?de:gu(de,t)}e instanceof Error&&(B.message=e.message)}if(B.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(B.$name=P),B}throw new Error("can't serialize object of type "+typeof e)}function yu(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Us(e)||Cc(e)||ArrayBuffer.isView(e)||e instanceof xs)return e;if(Array.isArray(e))return e.map(yu);if(typeof e=="object"){var t=e.$name||"Object",r=Iu[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,g=Object.keys(e);f<g.length;f+=1){var A=g[f];if(A!=="$name"){var P=e[A];u[A]=Iu[t].shallow.indexOf(A)>=0?P:yu(P)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var bu=function(){this.first=!0};bu.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Sn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Si(e){for(var t=0,r=e;t<r.length;t+=1)if($c(r[t].charCodeAt(0)))return!0;return!1}function $c(e){return!(e!==746&&e!==747&&(e<4352||!(Sn["Bopomofo Extended"](e)||Sn.Bopomofo(e)||Sn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Sn["CJK Compatibility Ideographs"](e)||Sn["CJK Compatibility"](e)||Sn["CJK Radicals Supplement"](e)||Sn["CJK Strokes"](e)||!(!Sn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Sn["CJK Unified Ideographs Extension A"](e)||Sn["CJK Unified Ideographs"](e)||Sn["Enclosed CJK Letters and Months"](e)||Sn["Hangul Compatibility Jamo"](e)||Sn["Hangul Jamo Extended-A"](e)||Sn["Hangul Jamo Extended-B"](e)||Sn["Hangul Jamo"](e)||Sn["Hangul Syllables"](e)||Sn.Hiragana(e)||Sn["Ideographic Description Characters"](e)||Sn.Kanbun(e)||Sn["Kangxi Radicals"](e)||Sn["Katakana Phonetic Extensions"](e)||Sn.Katakana(e)&&e!==12540||!(!Sn["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Sn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Sn["Unified Canadian Aboriginal Syllabics"](e)||Sn["Unified Canadian Aboriginal Syllabics Extended"](e)||Sn["Vertical Forms"](e)||Sn["Yijing Hexagram Symbols"](e)||Sn["Yi Syllables"](e)||Sn["Yi Radicals"](e))))}function wc(e){return!($c(e)||function(t){return!!(Sn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Sn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Sn["Letterlike Symbols"](t)||Sn["Number Forms"](t)||Sn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Sn["Control Pictures"](t)&&t!==9251||Sn["Optical Character Recognition"](t)||Sn["Enclosed Alphanumerics"](t)||Sn["Geometric Shapes"](t)||Sn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Sn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Sn["CJK Symbols and Punctuation"](t)||Sn.Katakana(t)||Sn["Private Use Area"](t)||Sn["CJK Compatibility Forms"](t)||Sn["Small Form Variants"](t)||Sn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function Fl(e){return e>=1424&&e<=2303||Sn["Arabic Presentation Forms-A"](e)||Sn["Arabic Presentation Forms-B"](e)}function Du(e,t){return!(!t&&Fl(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Sn.Khmer(e))}function Ua(e){for(var t=0,r=e;t<r.length;t+=1)if(Fl(r[t].charCodeAt(0)))return!0;return!1}var Oc=null,Bs="unavailable",bl=null,df=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Bs="error"),Oc&&Oc(t)};function Mc(){Ul.fire(new pe("pluginStateChange",{pluginStatus:Bs,pluginURL:bl}))}var Ul=new yt,Ls=function(){return Bs},Yo=function(){if(Bs!=="deferred"||!bl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bs="loading",Mc(),bl&&Zn({url:bl},function(t){t?df(t):(Bs="loaded",Mc())})},Ji={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bs==="loaded"||Ji.applyArabicShaping!=null},isLoading:function(){return Bs==="loading"},setState:function(t){Bs=t.pluginStatus,bl=t.pluginURL},isParsed:function(){return Ji.applyArabicShaping!=null&&Ji.processBidirectionalText!=null&&Ji.processStyledBidirectionalText!=null},getPluginURL:function(){return bl}},bi=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bu,this.transition={})};bi.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Du(f[u].charCodeAt(0),r))return!1;return!0}(e,Ji.isLoaded())},bi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},bi.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Qi=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(cc(u))return new vl(u,f);if(hc(u)){var g=Xc(u,f);if(g.result==="error")throw new Error(g.value.map(function(P){return P.key+": "+P.message}).join(", "));return g.value}var A=u;return typeof u=="string"&&f.type==="color"&&(A=In.parse(u)),{kind:"constant",evaluate:function(){return A}}}(r===void 0?t.specification.default:r,t.specification)};Qi.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Qi.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Ku=function(t){this.property=t,this.value=new Qi(t,void 0)};Ku.prototype.transitioned=function(e,t){return new es(this.property,this.value,t,Ne({},e.transition,this.transition),e.now)},Ku.prototype.untransitioned=function(){return new es(this.property,this.value,null,{},0)};var vo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};vo.prototype.getValue=function(e){return ze(this._values[e].value.value)},vo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ku(this._values[e].property)),this._values[e].value=new Qi(this._values[e].property,t===null?void 0:ze(t))},vo.prototype.getTransition=function(e){return ze(this._values[e].transition)},vo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ku(this._values[e].property)),this._values[e].transition=ze(t)||void 0},vo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var g=this.getTransition(u);g!==void 0&&(e[u+"-transition"]=g)}return e},vo.prototype.transitioned=function(e,t){for(var r=new xu(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var g=f[u];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},vo.prototype.untransitioned=function(){for(var e=new xu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var es=function(t,r,u,f,g){this.property=t,this.value=r,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};es.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return g.possiblyEvaluate(e,t,r);var A=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),f,function(P){if(P<=0)return 0;if(P>=1)return 1;var B=P*P,Q=B*P;return 4*(P<.5?Q:3*(P-B)+Q-.75)}(A))}return f};var xu=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};xu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xl(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var A=g[f];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u},xu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Nu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Nu.prototype.getValue=function(e){return ze(this._values[e].value)},Nu.prototype.setValue=function(e,t){this._values[e]=new Qi(this._values[e].property,t===null?void 0:ze(t))},Nu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},Nu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xl(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var A=g[f];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u};var Vo=function(t,r,u){this.property=t,this.value=r,this.parameters=u};Vo.prototype.isConstant=function(){return this.value.kind==="constant"},Vo.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Vo.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var xl=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};xl.prototype.get=function(e){return this._values[e]};var Vn=function(t){this.specification=t};Vn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Vn.prototype.interpolate=function(e,t,r){var u=Hu[this.specification.type];return u?u(e,t,r):e};var la=function(t,r){this.specification=t,this.overrides=r};la.prototype.possiblyEvaluate=function(e,t,r,u){return new Vo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},la.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Vo(this,{kind:"constant",value:void 0},e.parameters);var u=Hu[this.specification.type];return u?new Vo(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},la.prototype.evaluate=function(e,t,r,u,f,g){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,g)};var go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,g){if(r.value===void 0)return new Vo(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var A=r.expression.evaluate(u,null,{},f,g),P=r.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,B=this._calculate(P,P,P,u);return new Vo(this,{kind:"constant",value:B},u)}if(r.expression.kind==="camera"){var Q=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Vo(this,{kind:"constant",value:Q},u)}return new Vo(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,g,A,P){if(r.kind==="source"){var B=r.evaluate(u,f,g,A,P);return this._calculate(B,B,B,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,g),r.evaluate({zoom:Math.floor(u.zoom)},f,g),r.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):r.value},t.prototype._calculate=function(r,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(la),$u=function(t){this.specification=t};$u.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new bi(Math.floor(t.zoom-1),t)),e.expression.evaluate(new bi(Math.floor(t.zoom),t)),e.expression.evaluate(new bi(Math.floor(t.zoom+1),t)),t)}},$u.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},$u.prototype.interpolate=function(e){return e};var Vs=function(t){this.specification=t};Vs.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Vs.prototype.interpolate=function(){return!1};var Ui=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new Qi(u,void 0),g=this.defaultTransitionablePropertyValues[r]=new Ku(u);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};bn("DataDrivenProperty",la),bn("DataConstantProperty",Vn),bn("CrossFadedDataDrivenProperty",go),bn("CrossFadedProperty",$u),bn("ColorRampProperty",Vs);var cs=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new Nu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new vo(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xl(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(No,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return _t(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(Of,"layers."+this.id+".paint."+r,r,u,f))return!1;if(_t(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var g=this._transitionablePaint._values[r],A=g.property.specification["property-type"]==="cross-faded-data-driven",P=g.value.isDataDriven(),B=g.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var Q=this._transitionablePaint._values[r].value;return Q.isDataDriven()||P||A||this._handleOverridablePaintPropertyUpdate(r,B,Q)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),De(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,g,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&yl(this,r.call(mc,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Ve,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof Vo&&au(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(yt),Jc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gs=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Li=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ni(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var g=Jc[f.type].BYTES_PER_ELEMENT,A=r=Bl(r,Math.max(t,g)),P=f.components||1;return u=Math.max(u,g),r+=g*P,{name:f.name,type:f.type,components:P,offset:A}}),size:Bl(r,Math.max(u,t)),alignment:t}}function Bl(e,t){return Math.ceil(e/t)*t}Li.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Li.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Li.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Li.prototype.clear=function(){this.length=0},Li.prototype.resize=function(e){this.reserve(e),this.length=e},Li.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Li.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Eu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.int16[g+0]=u,this.int16[g+1]=f,r},t}(Li);Eu.prototype.bytesPerElement=4,bn("StructArrayLayout2i4",Eu);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var P=4*r;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=g,this.int16[P+3]=A,r},t}(Li);Vl.prototype.bytesPerElement=8,bn("StructArrayLayout4i8",Vl);var vc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,f,g,A,P)},t.prototype.emplace=function(r,u,f,g,A,P,B){var Q=6*r;return this.int16[Q+0]=u,this.int16[Q+1]=f,this.int16[Q+2]=g,this.int16[Q+3]=A,this.int16[Q+4]=P,this.int16[Q+5]=B,r},t}(Li);vc.prototype.bytesPerElement=12,bn("StructArrayLayout2i4i12",vc);var ku=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,f,g,A,P)},t.prototype.emplace=function(r,u,f,g,A,P,B){var Q=4*r,de=8*r;return this.int16[Q+0]=u,this.int16[Q+1]=f,this.uint8[de+4]=g,this.uint8[de+5]=A,this.uint8[de+6]=P,this.uint8[de+7]=B,r},t}(Li);ku.prototype.bytesPerElement=8,bn("StructArrayLayout2i4ub8",ku);var ts=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.float32[g+0]=u,this.float32[g+1]=f,r},t}(Li);ts.prototype.bytesPerElement=8,bn("StructArrayLayout2f8",ts);var Ju=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P,B,Q,de,_e){var Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,r,u,f,g,A,P,B,Q,de,_e)},t.prototype.emplace=function(r,u,f,g,A,P,B,Q,de,_e,Oe){var nt=10*r;return this.uint16[nt+0]=u,this.uint16[nt+1]=f,this.uint16[nt+2]=g,this.uint16[nt+3]=A,this.uint16[nt+4]=P,this.uint16[nt+5]=B,this.uint16[nt+6]=Q,this.uint16[nt+7]=de,this.uint16[nt+8]=_e,this.uint16[nt+9]=Oe,r},t}(Li);Ju.prototype.bytesPerElement=20,bn("StructArrayLayout10ui20",Ju);var ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt){var St=this.length;return this.resize(St+1),this.emplace(St,r,u,f,g,A,P,B,Q,de,_e,Oe,nt)},t.prototype.emplace=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St){var bt=12*r;return this.int16[bt+0]=u,this.int16[bt+1]=f,this.int16[bt+2]=g,this.int16[bt+3]=A,this.uint16[bt+4]=P,this.uint16[bt+5]=B,this.uint16[bt+6]=Q,this.uint16[bt+7]=de,this.int16[bt+8]=_e,this.int16[bt+9]=Oe,this.int16[bt+10]=nt,this.int16[bt+11]=St,r},t}(Li);ul.prototype.bytesPerElement=24,bn("StructArrayLayout4i4ui4i24",ul);var Mf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.float32[A+0]=u,this.float32[A+1]=f,this.float32[A+2]=g,r},t}(Li);Mf.prototype.bytesPerElement=12,bn("StructArrayLayout3f12",Mf);var Gl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(Li);Gl.prototype.bytesPerElement=4,bn("StructArrayLayout1ul4",Gl);var Qc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P,B,Q,de){var _e=this.length;return this.resize(_e+1),this.emplace(_e,r,u,f,g,A,P,B,Q,de)},t.prototype.emplace=function(r,u,f,g,A,P,B,Q,de,_e){var Oe=10*r,nt=5*r;return this.int16[Oe+0]=u,this.int16[Oe+1]=f,this.int16[Oe+2]=g,this.int16[Oe+3]=A,this.int16[Oe+4]=P,this.int16[Oe+5]=B,this.uint32[nt+3]=Q,this.uint16[Oe+8]=de,this.uint16[Oe+9]=_e,r},t}(Li);Qc.prototype.bytesPerElement=20,bn("StructArrayLayout6i1ul2ui20",Qc);var pf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,f,g,A,P)},t.prototype.emplace=function(r,u,f,g,A,P,B){var Q=6*r;return this.int16[Q+0]=u,this.int16[Q+1]=f,this.int16[Q+2]=g,this.int16[Q+3]=A,this.int16[Q+4]=P,this.int16[Q+5]=B,r},t}(Li);pf.prototype.bytesPerElement=12,bn("StructArrayLayout2i2i2i12",pf);var Ts=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A){var P=this.length;return this.resize(P+1),this.emplace(P,r,u,f,g,A)},t.prototype.emplace=function(r,u,f,g,A,P){var B=4*r,Q=8*r;return this.float32[B+0]=u,this.float32[B+1]=f,this.float32[B+2]=g,this.int16[Q+6]=A,this.int16[Q+7]=P,r},t}(Li);Ts.prototype.bytesPerElement=16,bn("StructArrayLayout2f1f2i16",Ts);var ju=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var P=12*r,B=3*r;return this.uint8[P+0]=u,this.uint8[P+1]=f,this.float32[B+1]=g,this.float32[B+2]=A,r},t}(Li);ju.prototype.bytesPerElement=12,bn("StructArrayLayout2ub2f12",ju);var ll=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.uint16[A+0]=u,this.uint16[A+1]=f,this.uint16[A+2]=g,r},t}(Li);ll.prototype.bytesPerElement=6,bn("StructArrayLayout3ui6",ll);var mf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or){var pr=this.length;return this.resize(pr+1),this.emplace(pr,r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or)},t.prototype.emplace=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or,pr){var Sr=24*r,Vr=12*r,Nr=48*r;return this.int16[Sr+0]=u,this.int16[Sr+1]=f,this.uint16[Sr+2]=g,this.uint16[Sr+3]=A,this.uint32[Vr+2]=P,this.uint32[Vr+3]=B,this.uint32[Vr+4]=Q,this.uint16[Sr+10]=de,this.uint16[Sr+11]=_e,this.uint16[Sr+12]=Oe,this.float32[Vr+7]=nt,this.float32[Vr+8]=St,this.uint8[Nr+36]=bt,this.uint8[Nr+37]=Vt,this.uint8[Nr+38]=Ut,this.uint32[Vr+10]=or,this.int16[Sr+22]=pr,r},t}(Li);mf.prototype.bytesPerElement=48,bn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",mf);var El=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or,pr,Sr,Vr,Nr,mn,En,Bn,ea,kn,Nn,wa){var ua=this.length;return this.resize(ua+1),this.emplace(ua,r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or,pr,Sr,Vr,Nr,mn,En,Bn,ea,kn,Nn,wa)},t.prototype.emplace=function(r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt,Vt,Ut,or,pr,Sr,Vr,Nr,mn,En,Bn,ea,kn,Nn,wa,ua){var Jn=34*r,mi=17*r;return this.int16[Jn+0]=u,this.int16[Jn+1]=f,this.int16[Jn+2]=g,this.int16[Jn+3]=A,this.int16[Jn+4]=P,this.int16[Jn+5]=B,this.int16[Jn+6]=Q,this.int16[Jn+7]=de,this.uint16[Jn+8]=_e,this.uint16[Jn+9]=Oe,this.uint16[Jn+10]=nt,this.uint16[Jn+11]=St,this.uint16[Jn+12]=bt,this.uint16[Jn+13]=Vt,this.uint16[Jn+14]=Ut,this.uint16[Jn+15]=or,this.uint16[Jn+16]=pr,this.uint16[Jn+17]=Sr,this.uint16[Jn+18]=Vr,this.uint16[Jn+19]=Nr,this.uint16[Jn+20]=mn,this.uint16[Jn+21]=En,this.uint16[Jn+22]=Bn,this.uint32[mi+12]=ea,this.float32[mi+13]=kn,this.float32[mi+14]=Nn,this.float32[mi+15]=wa,this.float32[mi+16]=ua,r},t}(Li);El.prototype.bytesPerElement=68,bn("StructArrayLayout8i15ui1ul4f68",El);var Hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(Li);Hl.prototype.bytesPerElement=4,bn("StructArrayLayout1f4",Hl);var cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=3*r;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=g,r},t}(Li);cl.prototype.bytesPerElement=6,bn("StructArrayLayout3i6",cl);var Rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,f)},t.prototype.emplace=function(r,u,f,g){var A=4*r;return this.uint32[2*r+0]=u,this.uint16[A+2]=f,this.uint16[A+3]=g,r},t}(Li);Rs.prototype.bytesPerElement=8,bn("StructArrayLayout1ul2ui8",Rs);var Tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var g=2*r;return this.uint16[g+0]=u,this.uint16[g+1]=f,r},t}(Li);Tl.prototype.bytesPerElement=4,bn("StructArrayLayout2ui4",Tl);var Wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(Li);Wl.prototype.bytesPerElement=2,bn("StructArrayLayout1ui2",Wl);var Qu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,f,g)},t.prototype.emplace=function(r,u,f,g,A){var P=4*r;return this.float32[P+0]=u,this.float32[P+1]=f,this.float32[P+2]=g,this.float32[P+3]=A,r},t}(Li);Qu.prototype.bytesPerElement=16,bn("StructArrayLayout4f16",Qu);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new q(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Gs);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Qc);bn("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Gs);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(mf);bn("PlacedSymbolArray",l);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Gs);y.prototype.size=68;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new y(this,r)},t}(El);bn("SymbolInstanceArray",O);var R=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Hl);bn("GlyphOffsetArray",R);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(cl);bn("SymbolLineVertexArray",k);var ie=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Gs);ie.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ie(this,r)},t}(Rs);bn("FeatureIndexArray",Ee);var We=Ni([{name:"a_pos",components:2,type:"Int16"}],4).members,$e=function(t){t===void 0&&(t=[]),this.segments=t};function qe(e,t){return 256*(e=Ce(Math.floor(e),0,255))+Ce(Math.floor(t),0,255)}$e.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>$e.MAX_VERTEX_ARRAY_LENGTH&&Pe("Max vertices per segment is "+$e.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>$e.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},$e.prototype.get=function(){return this.segments},$e.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},$e.simpleSegment=function(e,t,r,u){return new $e([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},$e.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bn("SegmentVector",$e);var Lt=Ni([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Rt=W(function(e){e.exports=function(t,r){var u,f,g,A,P,B,Q,de;for(f=t.length-(u=3&t.length),g=r,P=3432918353,B=461845907,de=0;de<f;)Q=255&t.charCodeAt(de)|(255&t.charCodeAt(++de))<<8|(255&t.charCodeAt(++de))<<16|(255&t.charCodeAt(++de))<<24,++de,g=27492+(65535&(A=5*(65535&(g=(g^=Q=(65535&(Q=(Q=(65535&Q)*P+(((Q>>>16)*P&65535)<<16)&4294967295)<<15|Q>>>17))*B+(((Q>>>16)*B&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(Q=0,u){case 3:Q^=(255&t.charCodeAt(de+2))<<16;case 2:Q^=(255&t.charCodeAt(de+1))<<8;case 1:g^=Q=(65535&(Q=(Q=(65535&(Q^=255&t.charCodeAt(de)))*P+(((Q>>>16)*P&65535)<<16)&4294967295)<<15|Q>>>17))*B+(((Q>>>16)*B&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Gt=W(function(e){e.exports=function(t,r){for(var u,f=t.length,g=r^f,A=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++A;switch(f){case 3:g^=(255&t.charCodeAt(A+2))<<16;case 2:g^=(255&t.charCodeAt(A+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(A)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),Dt=Rt,jt=Gt;Dt.murmur3=Rt,Dt.murmur2=jt;var ir=function(){this.ids=[],this.positions=[],this.indexed=!1};ir.prototype.add=function(e,t,r,u){this.ids.push(Lr(e)),this.positions.push(t,r,u)},ir.prototype.getPositions=function(e){for(var t=Lr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},ir.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(g,A,P,B){for(;P<B;){for(var Q=g[P+B>>1],de=P-1,_e=B+1;;){do de++;while(g[de]<Q);do _e--;while(g[_e]>Q);if(de>=_e)break;gr(g,de,_e),gr(A,3*de,3*_e),gr(A,3*de+1,3*_e+1),gr(A,3*de+2,3*_e+2)}_e-P<B-_e?(f(g,A,P,_e),P=_e+1):(f(g,A,_e+1,B),B=_e)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},ir.deserialize=function(e){var t=new ir;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Qt=Math.pow(2,53)-1;function Lr(e){var t=+e;return!isNaN(t)&&t<=Qt?t:Dt(String(e))}function gr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}bn("FeaturePositionMap",ir);var Ar=function(t,r){this.gl=t.gl,this.location=r},Or=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Ar),Kr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Ar),Qr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Ar),dn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Ar),wn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Ar),ra=function(e){function t(r,u){e.call(this,r,u),this.current=In.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Ar),ya=new Float32Array(16),Ta=function(e){function t(r,u){e.call(this,r,u),this.current=ya}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Ar);function Ja(e){return[qe(255*e.r,255*e.g),qe(255*e.b,255*e.a)]}var Mn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};Mn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Mn.prototype.getBinding=function(e,t,r){return this.type==="color"?new ra(e,t):new Kr(e,t)};var ba=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ba.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ba.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ba.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new wn(e,t):new Kr(e,t)};var ca=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(g){return{name:"a_"+g,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};ca.prototype.populatePaintArray=function(e,t,r,u,f){var g=this.paintVertexArray.length,A=this.expression.evaluate(new bi(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(g,e,A)},ca.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},ca.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Ja(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},ca.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ca.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Fn=function(t,r,u,f,g,A){this.expression=t,this.uniformNames=r.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(function(P){return{name:"a_"+P,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new A};Fn.prototype.populatePaintArray=function(e,t,r,u,f){var g=this.expression.evaluate(new bi(this.zoom),t,{},u,[],f),A=this.expression.evaluate(new bi(this.zoom+1),t,{},u,[],f),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,g,A)},Fn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),g=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,g)},Fn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Ja(r),g=Ja(u),A=e;A<t;A++)this.paintVertexArray.emplace(A,f[0],f[1],g[0],g[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Fn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Fn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Fn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=Ce(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Fn.prototype.getBinding=function(e,t,r){return new Kr(e,t)};var Ma=function(t,r,u,f,g,A){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=A,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};Ma.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Ma.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Ma.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],g=u[r.mid],A=u[r.max];if(f&&g&&A)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,g.tl[0],g.tl[1],g.br[0],g.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],g.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,g.tl[0],g.tl[1],g.br[0],g.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],g.pixelRatio,A.pixelRatio)}},Ma.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Lt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Lt.members,this.expression.isStateDependent))},Ma.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Qn=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var g in t.paint._values)if(u(g)){var A=t.paint.get(g);if(A instanceof Vo&&au(A.property.specification)){var P=ai(g,t.type),B=A.value,Q=A.property.specification.type,de=A.property.useIntegerZoom,_e=A.property.specification["property-type"],Oe=_e==="cross-faded"||_e==="cross-faded-data-driven";if(B.kind==="constant")this.binders[g]=Oe?new ba(B.value,P):new Mn(B.value,P,Q),f.push("/u_"+g);else if(B.kind==="source"||Oe){var nt=uo(g,Q,"source");this.binders[g]=Oe?new Ma(B,Q,de,r,nt,t.id):new ca(B,P,Q,nt),f.push("/a_"+g)}else{var St=uo(g,Q,"composite");this.binders[g]=new Fn(B,P,Q,de,r,St),f.push("/z_"+g)}}}this.cacheKey=f.sort().join("")};Qn.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof ca||t instanceof Fn?t.maxValue:0},Qn.prototype.populatePaintArrays=function(e,t,r,u,f){for(var g in this.binders){var A=this.binders[g];(A instanceof ca||A instanceof Fn||A instanceof Ma)&&A.populatePaintArray(e,t,r,u,f)}},Qn.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ba&&u.setConstantPatternPositions(e,t)}},Qn.prototype.updatePaintArrays=function(e,t,r,u,f){var g=!1;for(var A in e)for(var P=0,B=t.getPositions(A);P<B.length;P+=1){var Q=B[P],de=r.feature(Q.index);for(var _e in this.binders){var Oe=this.binders[_e];if((Oe instanceof ca||Oe instanceof Fn||Oe instanceof Ma)&&Oe.expression.isStateDependent===!0){var nt=u.paint.get(_e);Oe.expression=nt.value,Oe.updatePaintArray(Q.start,Q.end,de,e[A],f),g=!0}}}return g},Qn.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Mn||r instanceof ba)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},Qn.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof ca||r instanceof Fn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Ma)for(var f=0;f<Lt.members.length;f++)e.push(Lt.members[f].name)}return e},Qn.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Mn||r instanceof ba||r instanceof Fn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},Qn.prototype.getPaintVertexBuffers=function(){return this._buffers},Qn.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof Mn||f instanceof ba||f instanceof Fn)for(var g=0,A=f.uniformNames;g<A.length;g+=1){var P=A[g];if(t[P]){var B=f.getBinding(e,t[P],P);r.push({name:P,property:u,binding:B})}}}return r},Qn.prototype.setUniforms=function(e,t,r,u){for(var f=0,g=t;f<g.length;f+=1){var A=g[f],P=A.name,B=A.property;this.binders[B].setUniform(A.binding,u,r.get(B),P)}},Qn.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ma){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof ca||r instanceof Fn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Qn.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof ca||r instanceof Fn||r instanceof Ma)&&r.upload(e)}this.updatePaintBuffers()},Qn.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof ca||t instanceof Fn||t instanceof Ma)&&t.destroy()}};var Da=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,g=t;f<g.length;f+=1){var A=g[f];this.programConfigurations[A.id]=new Qn(A,r,u)}this.needsUpload=!1,this._featureMap=new ir,this._bufferOffset=0};function ai(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function uo(e,t,r){var u={color:{source:ts,composite:Qu},number:{source:Hl,composite:ts}},f=function(g){return{"line-pattern":{source:Ju,composite:Ju},"fill-pattern":{source:Ju,composite:Ju},"fill-extrusion-pattern":{source:Ju,composite:Ju}}[g]}(e);return f&&f[r]||u[t][r]}Da.prototype.populatePaintArrays=function(e,t,r,u,f,g){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(e,t,u,f,g);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Da.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,g=r;f<g.length;f+=1){var A=g[f];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(e,this._featureMap,t,A,u)||this.needsUpload}},Da.prototype.get=function(e){return this.programConfigurations[e]},Da.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Da.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},bn("ConstantBinder",Mn),bn("CrossFadedConstantBinder",ba),bn("SourceExpressionBinder",ca),bn("CrossFadedCompositeBinder",Ma),bn("CompositeExpressionBinder",Fn),bn("ProgramConfiguration",Qn,{omit:["_buffers"]}),bn("ProgramConfigurationSet",Da);var ro=Math.pow(2,14)-1,Wi=-ro-1;function xi(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],g=0;g<f.length;g++){var A=f[g],P=Math.round(A.x*t),B=Math.round(A.y*t);A.x=Ce(P,Wi,ro),A.y=Ce(B,Wi,ro),(P<A.x||P>A.x+1||B<A.y||B>A.y+1)&&Pe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function no(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var Go=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Eu,this.indexArray=new ll,this.segments=new $e,this.programConfigurations=new Da(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Tu(e,t){for(var r=0;r<e.length;r++)if(Su(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(Su(e,t[u]))return!0;return!!Ws(e,t)}function _l(e,t,r){return!!Su(e,t)||!!_u(t,e,r)}function Hs(e,t){if(e.length===1)return Xl(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(Su(e,u[f]))return!0;for(var g=0;g<e.length;g++)if(Xl(t,e[g]))return!0;for(var A=0;A<t.length;A++)if(Ws(e,t[A]))return!0;return!1}function fs(e,t,r){if(e.length>1){if(Ws(e,t))return!0;for(var u=0;u<t.length;u++)if(_u(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(_u(e[f],t,r))return!0;return!1}function Ws(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],g=0;g<t.length-1;g++)if(Zl(u,f,t[g],t[g+1]))return!0;return!1}function Zl(e,t,r,u){return ot(e,r,u)!==ot(t,r,u)&&ot(e,t,r)!==ot(e,t,u)}function _u(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Is(e,t[f-1],t[f])<u)return!0;return!1}function Is(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function Xl(e,t){for(var r,u,f,g=!1,A=0;A<e.length;A++)for(var P=0,B=(r=e[A]).length-1;P<r.length;B=P++)(u=r[P]).y>t.y!=(f=r[B]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(g=!g);return g}function Su(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var g=e[u],A=e[f];g.y>t.y!=A.y>t.y&&t.x<(A.x-g.x)*(t.y-g.y)/(A.y-g.y)+g.x&&(r=!r)}return r}function Yl(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var g=ot(e,t,r[0]);return g!==ot(e,t,r[1])||g!==ot(e,t,r[2])||g!==ot(e,t,r[3])}function Au(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function wo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function zu(e,t,r,u,f){if(!t[0]&&!t[1])return e;var g=q.convert(t)._mult(f);r==="viewport"&&g._rotate(-u);for(var A=[],P=0;P<e.length;P++)A.push(e[P].sub(g));return A}Go.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],g=null;u.type==="circle"&&(g=u.layout.get("circle-sort-key"));for(var A=0,P=e;A<P.length;A+=1){var B=P[A],Q=B.feature,de=B.id,_e=B.index,Oe=B.sourceLayerIndex,nt=this.layers[0]._featureFilter.needGeometry,St={type:Q.type,id:de,properties:Q.properties,geometry:nt?xi(Q):[]};if(this.layers[0]._featureFilter.filter(new bi(this.zoom),St,r)){nt||(St.geometry=xi(Q));var bt=g?g.evaluate(St,{},r):void 0;f.push({id:de,properties:Q.properties,type:Q.type,sourceLayerIndex:Oe,index:_e,geometry:St.geometry,patterns:{},sortKey:bt})}}g&&f.sort(function(mn,En){return mn.sortKey-En.sortKey});for(var Vt=0,Ut=f;Vt<Ut.length;Vt+=1){var or=Ut[Vt],pr=or.geometry,Sr=or.index,Vr=or.sourceLayerIndex,Nr=e[Sr].feature;this.addFeature(or,pr,Sr,r),t.featureIndex.insert(Nr,pr,Sr,Vr,this.index)}},Go.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Go.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Go.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Go.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,We),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Go.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Go.prototype.addFeature=function(e,t,r,u){for(var f=0,g=t;f<g.length;f+=1)for(var A=0,P=g[f];A<P.length;A+=1){var B=P[A],Q=B.x,de=B.y;if(!(Q<0||Q>=8192||de<0||de>=8192)){var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Oe=_e.vertexLength;no(this.layoutVertexArray,Q,de,-1,-1),no(this.layoutVertexArray,Q,de,1,-1),no(this.layoutVertexArray,Q,de,1,1),no(this.layoutVertexArray,Q,de,-1,1),this.indexArray.emplaceBack(Oe,Oe+1,Oe+2),this.indexArray.emplaceBack(Oe,Oe+3,Oe+2),_e.vertexLength+=4,_e.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},bn("CircleBucket",Go,{omit:["layers"]});var Kl=new Ui({"circle-sort-key":new la(Ve.layout_circle["circle-sort-key"])}),qc={paint:new Ui({"circle-radius":new la(Ve.paint_circle["circle-radius"]),"circle-color":new la(Ve.paint_circle["circle-color"]),"circle-blur":new la(Ve.paint_circle["circle-blur"]),"circle-opacity":new la(Ve.paint_circle["circle-opacity"]),"circle-translate":new Vn(Ve.paint_circle["circle-translate"]),"circle-translate-anchor":new Vn(Ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Vn(Ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Vn(Ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new la(Ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new la(Ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new la(Ve.paint_circle["circle-stroke-opacity"])}),layout:Kl},Oo=typeof Float32Array!="undefined"?Float32Array:Array;function Ds(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function rs(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3],P=t[4],B=t[5],Q=t[6],de=t[7],_e=t[8],Oe=t[9],nt=t[10],St=t[11],bt=t[12],Vt=t[13],Ut=t[14],or=t[15],pr=r[0],Sr=r[1],Vr=r[2],Nr=r[3];return e[0]=pr*u+Sr*P+Vr*_e+Nr*bt,e[1]=pr*f+Sr*B+Vr*Oe+Nr*Vt,e[2]=pr*g+Sr*Q+Vr*nt+Nr*Ut,e[3]=pr*A+Sr*de+Vr*St+Nr*or,e[4]=(pr=r[4])*u+(Sr=r[5])*P+(Vr=r[6])*_e+(Nr=r[7])*bt,e[5]=pr*f+Sr*B+Vr*Oe+Nr*Vt,e[6]=pr*g+Sr*Q+Vr*nt+Nr*Ut,e[7]=pr*A+Sr*de+Vr*St+Nr*or,e[8]=(pr=r[8])*u+(Sr=r[9])*P+(Vr=r[10])*_e+(Nr=r[11])*bt,e[9]=pr*f+Sr*B+Vr*Oe+Nr*Vt,e[10]=pr*g+Sr*Q+Vr*nt+Nr*Ut,e[11]=pr*A+Sr*de+Vr*St+Nr*or,e[12]=(pr=r[12])*u+(Sr=r[13])*P+(Vr=r[14])*_e+(Nr=r[15])*bt,e[13]=pr*f+Sr*B+Vr*Oe+Nr*Vt,e[14]=pr*g+Sr*Q+Vr*nt+Nr*Ut,e[15]=pr*A+Sr*de+Vr*St+Nr*or,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Zi,Zs=rs;function ao(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*g+r[12]*A,e[1]=r[1]*u+r[5]*f+r[9]*g+r[13]*A,e[2]=r[2]*u+r[6]*f+r[10]*g+r[14]*A,e[3]=r[3]*u+r[7]*f+r[11]*g+r[15]*A,e}Zi=new Oo(3),Oo!=Float32Array&&(Zi[0]=0,Zi[1]=0,Zi[2]=0),function(){var e=new Oo(4);Oo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Ns=(function(){var e=new Oo(2);Oo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,qc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Go(r)},t.prototype.queryRadius=function(r){var u=r;return Au("circle-radius",this,u)+Au("circle-stroke-width",this,u)+wo(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,P,B,Q){for(var de=zu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,B),_e=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),Oe=this.paint.get("circle-pitch-alignment")==="map",nt=Oe?de:function(mn,En){return mn.map(function(Bn){return Xs(Bn,En)})}(de,Q),St=Oe?_e*B:_e,bt=0,Vt=g;bt<Vt.length;bt+=1)for(var Ut=0,or=Vt[bt];Ut<or.length;Ut+=1){var pr=or[Ut],Sr=Oe?pr:Xs(pr,Q),Vr=St,Nr=ao([],[pr.x,pr.y,0,1],Q);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Vr*=Nr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Vr*=P.cameraToCenterDistance/Nr[3]),_l(nt,Sr,Vr))return!0}return!1},t}(cs));function Xs(e,t){var r=ao([],[e.x,e.y,0,1],t);return new q(r[0]/r[3],r[1]/r[3])}var qu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Go);function gc(e,t,r,u){var f=t.width,g=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*g*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*g*r);return e.width=f,e.height=g,e.data=u,e}function $l(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var g=gc({},{width:u,height:f},r);Jl(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=g.data}}function Jl(e,t,r,u,f,g){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=e.data,P=t.data,B=0;B<f.height;B++)for(var Q=((r.y+B)*e.width+r.x)*g,de=((u.y+B)*t.width+u.x)*g,_e=0;_e<f.width*g;_e++)P[de+_e]=A[Q+_e];return t}bn("HeatmapBucket",qu,{omit:["layers"]});var Ys=function(t,r){gc(this,t,1,r)};Ys.prototype.resize=function(e){$l(this,e,1)},Ys.prototype.clone=function(){return new Ys({width:this.width,height:this.height},new Uint8Array(this.data))},Ys.copy=function(e,t,r,u,f){Jl(e,t,r,u,f,1)};var Ho=function(t,r){gc(this,t,4,r)};Ho.prototype.resize=function(e){$l(this,e,4)},Ho.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Ho.prototype.clone=function(){return new Ho({width:this.width,height:this.height},new Uint8Array(this.data))},Ho.copy=function(e,t,r,u,f){Jl(e,t,r,u,f,4)},bn("AlphaImage",Ys),bn("RGBAImage",Ho);var ef={paint:new Ui({"heatmap-radius":new la(Ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new la(Ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Vn(Ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vs(Ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Vn(Ve.paint_heatmap["heatmap-opacity"])})};function Ql(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new Ho({width:r,height:u}),g=function(bt,Vt,Ut){t[e.evaluationKey]=Ut;var or=e.expression.evaluate(t);f.data[bt+Vt+0]=Math.floor(255*or.r/or.a),f.data[bt+Vt+1]=Math.floor(255*or.g/or.a),f.data[bt+Vt+2]=Math.floor(255*or.b/or.a),f.data[bt+Vt+3]=Math.floor(255*or.a)};if(e.clips)for(var A=0,P=0;A<u;++A,P+=4*r)for(var B=0,Q=0;B<r;B++,Q+=4){var de=B/(r-1),_e=e.clips[A];g(P,Q,_e.start*(1-de)+_e.end*de)}else for(var Oe=0,nt=0;Oe<r;Oe++,nt+=4)g(0,nt,Oe/(r-1));return f}var ql=function(e){function t(r){e.call(this,r,ef),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qu(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Ql({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(cs),_s={paint:new Ui({"hillshade-illumination-direction":new Vn(Ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Vn(Ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Vn(Ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Vn(Ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Vn(Ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Vn(Ve.paint_hillshade["hillshade-accent-color"])})},ec=function(e){function t(r){e.call(this,r,_s)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(cs),vf=Ni([{name:"a_pos",components:2,type:"Int16"}],4).members,Pf=el,oh=el;function el(e,t,r){r=r||2;var u,f,g,A,P,B,Q,de=t&&t.length,_e=de?t[0]*r:e.length,Oe=gf(e,0,_e,r,!0),nt=[];if(!Oe||Oe.next===Oe.prev)return nt;if(de&&(Oe=function(bt,Vt,Ut,or){var pr,Sr,Vr,Nr=[];for(pr=0,Sr=Vt.length;pr<Sr;pr++)(Vr=gf(bt,Vt[pr]*or,pr<Sr-1?Vt[pr+1]*or:bt.length,or,!1))===Vr.next&&(Vr.steiner=!0),Nr.push(Qf(Vr));for(Nr.sort(Lc),pr=0;pr<Nr.length;pr++)Rc(Nr[pr],Ut),Ut=tc(Ut,Ut.next);return Ut}(e,t,Oe,r)),e.length>80*r){u=g=e[0],f=A=e[1];for(var St=r;St<_e;St+=r)(P=e[St])<u&&(u=P),(B=e[St+1])<f&&(f=B),P>g&&(g=P),B>A&&(A=B);Q=(Q=Math.max(g-u,A-f))!==0?1/Q:0}return tf(Oe,nt,r,u,f,Q),nt}function gf(e,t,r,u,f){var g,A;if(f===xf(e,t,r,u)>0)for(g=t;g<r;g+=u)A=Nc(g,e[g],e[g+1],A);else for(g=r-u;g>=t;g-=u)A=Nc(g,e[g],e[g+1],A);return A&&rc(A,A.next)&&(kc(A),A=A.next),A}function tc(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!rc(u,u.next)&&yo(u.prev,u,u.next)!==0)u=u.next;else{if(kc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function tf(e,t,r,u,f,g,A){if(e){!A&&g&&function(de,_e,Oe,nt){var St=de;do St.z===null&&(St.z=Rf(St.x,St.y,_e,Oe,nt)),St.prevZ=St.prev,St.nextZ=St.next,St=St.next;while(St!==de);St.prevZ.nextZ=null,St.prevZ=null,function(bt){var Vt,Ut,or,pr,Sr,Vr,Nr,mn,En=1;do{for(Ut=bt,bt=null,Sr=null,Vr=0;Ut;){for(Vr++,or=Ut,Nr=0,Vt=0;Vt<En&&(Nr++,or=or.nextZ);Vt++);for(mn=En;Nr>0||mn>0&&or;)Nr!==0&&(mn===0||!or||Ut.z<=or.z)?(pr=Ut,Ut=Ut.nextZ,Nr--):(pr=or,or=or.nextZ,mn--),Sr?Sr.nextZ=pr:bt=pr,pr.prevZ=Sr,Sr=pr;Ut=or}Sr.nextZ=null,En*=2}while(Vr>1)}(St)}(e,u,f,g);for(var P,B,Q=e;e.prev!==e.next;)if(P=e.prev,B=e.next,g?Lf(e,u,f,g):rf(e))t.push(P.i/r),t.push(e.i/r),t.push(B.i/r),kc(e),e=B.next,Q=B.next;else if((e=B)===Q){A?A===1?tf(e=$f(tc(e),t,r),t,r,u,f,g,2):A===2&&Pc(e,t,r,u,f,g):tf(tc(e),t,r,u,f,g,1);break}}}function rf(e){var t=e.prev,r=e,u=e.next;if(yo(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Ic(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&yo(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Lf(e,t,r,u){var f=e.prev,g=e,A=e.next;if(yo(f,g,A)>=0)return!1;for(var P=f.x>g.x?f.x>A.x?f.x:A.x:g.x>A.x?g.x:A.x,B=f.y>g.y?f.y>A.y?f.y:A.y:g.y>A.y?g.y:A.y,Q=Rf(f.x<g.x?f.x<A.x?f.x:A.x:g.x<A.x?g.x:A.x,f.y<g.y?f.y<A.y?f.y:A.y:g.y<A.y?g.y:A.y,t,r,u),de=Rf(P,B,t,r,u),_e=e.prevZ,Oe=e.nextZ;_e&&_e.z>=Q&&Oe&&Oe.z<=de;){if(_e!==e.prev&&_e!==e.next&&Ic(f.x,f.y,g.x,g.y,A.x,A.y,_e.x,_e.y)&&yo(_e.prev,_e,_e.next)>=0)return!1;if(_e=_e.prevZ,Oe!==e.prev&&Oe!==e.next&&Ic(f.x,f.y,g.x,g.y,A.x,A.y,Oe.x,Oe.y)&&yo(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}for(;_e&&_e.z>=Q;){if(_e!==e.prev&&_e!==e.next&&Ic(f.x,f.y,g.x,g.y,A.x,A.y,_e.x,_e.y)&&yo(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Oe&&Oe.z<=de;){if(Oe!==e.prev&&Oe!==e.next&&Ic(f.x,f.y,g.x,g.y,A.x,A.y,Oe.x,Oe.y)&&yo(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function $f(e,t,r){var u=e;do{var f=u.prev,g=u.next.next;!rc(f,g)&&yf(f,u,u.next,g)&&Dc(f,g)&&Dc(g,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(g.i/r),kc(u),kc(u.next),u=e=g),u=u.next}while(u!==e);return tc(u)}function Pc(e,t,r,u,f,g){var A=e;do{for(var P=A.next.next;P!==A.prev;){if(A.i!==P.i&&sh(A,P)){var B=Fu(A,P);return A=tc(A,A.next),B=tc(B,B.next),tf(A,t,r,u,f,g),void tf(B,t,r,u,f,g)}P=P.next}A=A.next}while(A!==e)}function Lc(e,t){return e.x-t.x}function Rc(e,t){if(t=function(u,f){var g,A=f,P=u.x,B=u.y,Q=-1/0;do{if(B<=A.y&&B>=A.next.y&&A.next.y!==A.y){var de=A.x+(B-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(de<=P&&de>Q){if(Q=de,de===P){if(B===A.y)return A;if(B===A.next.y)return A.next}g=A.x<A.next.x?A:A.next}}A=A.next}while(A!==f);if(!g)return null;if(P===Q)return g;var _e,Oe=g,nt=g.x,St=g.y,bt=1/0;A=g;do P>=A.x&&A.x>=nt&&P!==A.x&&Ic(B<St?P:Q,B,nt,St,B<St?Q:P,B,A.x,A.y)&&(_e=Math.abs(B-A.y)/(P-A.x),Dc(A,u)&&(_e<bt||_e===bt&&(A.x>g.x||A.x===g.x&&Jf(g,A)))&&(g=A,bt=_e)),A=A.next;while(A!==Oe);return g}(e,t)){var r=Fu(t,e);tc(t,t.next),tc(r,r.next)}}function Jf(e,t){return yo(e.prev,e,t.prev)<0&&yo(t.next,e,e.next)<0}function Rf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Qf(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Ic(e,t,r,u,f,g,A,P){return(f-A)*(t-P)-(e-A)*(g-P)>=0&&(e-A)*(u-P)-(r-A)*(t-P)>=0&&(r-A)*(g-P)-(f-A)*(u-P)>=0}function sh(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&yf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Dc(e,t)&&Dc(t,e)&&function(r,u){var f=r,g=!1,A=(r.x+u.x)/2,P=(r.y+u.y)/2;do f.y>P!=f.next.y>P&&f.next.y!==f.y&&A<(f.next.x-f.x)*(P-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==r);return g}(e,t)&&(yo(e.prev,e,t.prev)||yo(e,t.prev,t))||rc(e,t)&&yo(e.prev,e,e.next)>0&&yo(t.prev,t,t.next)>0)}function yo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function rc(e,t){return e.x===t.x&&e.y===t.y}function yf(e,t,r,u){var f=nf(yo(e,t,r)),g=nf(yo(e,t,u)),A=nf(yo(r,u,e)),P=nf(yo(r,u,t));return f!==g&&A!==P||!(f!==0||!nc(e,r,t))||!(g!==0||!nc(e,u,t))||!(A!==0||!nc(r,e,u))||!(P!==0||!nc(r,t,u))}function nc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function nf(e){return e>0?1:e<0?-1:0}function Dc(e,t){return yo(e.prev,e,e.next)<0?yo(e,t,e.next)>=0&&yo(e,e.prev,t)>=0:yo(e,t,e.prev)<0||yo(e,e.next,t)<0}function Fu(e,t){var r=new bf(e.i,e.x,e.y),u=new bf(t.i,t.x,t.y),f=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,g.next=u,u.prev=g,u}function Nc(e,t,r,u){var f=new bf(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function kc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function bf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xf(e,t,r,u){for(var f=0,g=t,A=r-u;g<r;g+=u)f+=(e[A]-e[g])*(e[g+1]+e[A+1]),A=g;return f}function Gf(e,t,r,u,f){!function g(A,P,B,Q,de){for(;Q>B;){if(Q-B>600){var _e=Q-B+1,Oe=P-B+1,nt=Math.log(_e),St=.5*Math.exp(2*nt/3),bt=.5*Math.sqrt(nt*St*(_e-St)/_e)*(Oe-_e/2<0?-1:1);g(A,P,Math.max(B,Math.floor(P-Oe*St/_e+bt)),Math.min(Q,Math.floor(P+(_e-Oe)*St/_e+bt)),de)}var Vt=A[P],Ut=B,or=Q;for(yc(A,B,P),de(A[Q],Vt)>0&&yc(A,B,Q);Ut<or;){for(yc(A,Ut,or),Ut++,or--;de(A[Ut],Vt)<0;)Ut++;for(;de(A[or],Vt)>0;)or--}de(A[B],Vt)===0?yc(A,B,or):yc(A,++or,Q),or<=P&&(B=or+1),P<=or&&(Q=or-1)}}(e,t,r||0,u||e.length-1,f||Sl)}function yc(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function Sl(e,t){return e<t?-1:e>t?1:0}function ee(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,g=[],A=0;A<r;A++){var P=Bt(e[A]);P!==0&&(e[A].area=Math.abs(P),f===void 0&&(f=P<0),f===P<0?(u&&g.push(u),u=[e[A]]):u.push(e[A]))}if(u&&g.push(u),t>1)for(var B=0;B<g.length;B++)g[B].length<=t||(Gf(g[B],t,1,g[B].length-1,ae),g[B]=g[B].slice(0,t));return g}function ae(e,t){return t.area-e.area}function N(e,t,r){for(var u=r.patternDependencies,f=!1,g=0,A=t;g<A.length;g+=1){var P=A[g].paint.get(e+"-pattern");P.isConstant()||(f=!0);var B=P.constantOr(null);B&&(f=!0,u[B.to]=!0,u[B.from]=!0)}return f}function V(e,t,r,u,f){for(var g=f.patternDependencies,A=0,P=t;A<P.length;A+=1){var B=P[A],Q=B.paint.get(e+"-pattern").value;if(Q.kind!=="constant"){var de=Q.evaluate({zoom:u-1},r,{},f.availableImages),_e=Q.evaluate({zoom:u},r,{},f.availableImages),Oe=Q.evaluate({zoom:u+1},r,{},f.availableImages);_e=_e&&_e.name?_e.name:_e,Oe=Oe&&Oe.name?Oe.name:Oe,g[de=de&&de.name?de.name:de]=!0,g[_e]=!0,g[Oe]=!0,r.patterns[B.id]={min:de,mid:_e,max:Oe}}}return r}el.deviation=function(e,t,r,u){var f=t&&t.length,g=Math.abs(xf(e,0,f?t[0]*r:e.length,r));if(f)for(var A=0,P=t.length;A<P;A++)g-=Math.abs(xf(e,t[A]*r,A<P-1?t[A+1]*r:e.length,r));var B=0;for(A=0;A<u.length;A+=3){var Q=u[A]*r,de=u[A+1]*r,_e=u[A+2]*r;B+=Math.abs((e[Q]-e[_e])*(e[de+1]-e[Q+1])-(e[Q]-e[de])*(e[_e+1]-e[Q+1]))}return g===0&&B===0?0:Math.abs((B-g)/g)},el.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var g=0;g<e[f].length;g++)for(var A=0;A<t;A++)r.vertices.push(e[f][g][A]);f>0&&r.holes.push(u+=e[f-1].length)}return r},Pf.default=oh;var Te=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Eu,this.indexArray=new ll,this.indexArray2=new Tl,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new $e,this.segments2=new $e,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Te.prototype.populate=function(e,t,r){this.hasPattern=N("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],g=0,A=e;g<A.length;g+=1){var P=A[g],B=P.feature,Q=P.id,de=P.index,_e=P.sourceLayerIndex,Oe=this.layers[0]._featureFilter.needGeometry,nt={type:B.type,id:Q,properties:B.properties,geometry:Oe?xi(B):[]};if(this.layers[0]._featureFilter.filter(new bi(this.zoom),nt,r)){Oe||(nt.geometry=xi(B));var St=u?u.evaluate(nt,{},r,t.availableImages):void 0;f.push({id:Q,properties:B.properties,type:B.type,sourceLayerIndex:_e,index:de,geometry:nt.geometry,patterns:{},sortKey:St})}}u&&f.sort(function(Nr,mn){return Nr.sortKey-mn.sortKey});for(var bt=0,Vt=f;bt<Vt.length;bt+=1){var Ut=Vt[bt],or=Ut.geometry,pr=Ut.index,Sr=Ut.sourceLayerIndex;if(this.hasPattern){var Vr=V("fill",this.layers,Ut,this.zoom,t);this.patternFeatures.push(Vr)}else this.addFeature(Ut,or,pr,r,{});t.featureIndex.insert(e[pr].feature,or,pr,Sr,this.index)}},Te.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Te.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},Te.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Te.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Te.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Te.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Te.prototype.addFeature=function(e,t,r,u,f){for(var g=0,A=ee(t,500);g<A.length;g+=1){for(var P=A[g],B=0,Q=0,de=P;Q<de.length;Q+=1)B+=de[Q].length;for(var _e=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray),Oe=_e.vertexLength,nt=[],St=[],bt=0,Vt=P;bt<Vt.length;bt+=1){var Ut=Vt[bt];if(Ut.length!==0){Ut!==P[0]&&St.push(nt.length/2);var or=this.segments2.prepareSegment(Ut.length,this.layoutVertexArray,this.indexArray2),pr=or.vertexLength;this.layoutVertexArray.emplaceBack(Ut[0].x,Ut[0].y),this.indexArray2.emplaceBack(pr+Ut.length-1,pr),nt.push(Ut[0].x),nt.push(Ut[0].y);for(var Sr=1;Sr<Ut.length;Sr++)this.layoutVertexArray.emplaceBack(Ut[Sr].x,Ut[Sr].y),this.indexArray2.emplaceBack(pr+Sr-1,pr+Sr),nt.push(Ut[Sr].x),nt.push(Ut[Sr].y);or.vertexLength+=Ut.length,or.primitiveLength+=Ut.length}}for(var Vr=Pf(nt,St),Nr=0;Nr<Vr.length;Nr+=3)this.indexArray.emplaceBack(Oe+Vr[Nr],Oe+Vr[Nr+1],Oe+Vr[Nr+2]);_e.vertexLength+=B,_e.primitiveLength+=Vr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},bn("FillBucket",Te,{omit:["layers","patternFeatures"]});var it=new Ui({"fill-sort-key":new la(Ve.layout_fill["fill-sort-key"])}),Zt={paint:new Ui({"fill-antialias":new Vn(Ve.paint_fill["fill-antialias"]),"fill-opacity":new la(Ve.paint_fill["fill-opacity"]),"fill-color":new la(Ve.paint_fill["fill-color"]),"fill-outline-color":new la(Ve.paint_fill["fill-outline-color"]),"fill-translate":new Vn(Ve.paint_fill["fill-translate"]),"fill-translate-anchor":new Vn(Ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new go(Ve.paint_fill["fill-pattern"])}),layout:it},ar=function(e){function t(r){e.call(this,r,Zt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Te(r)},t.prototype.queryRadius=function(){return wo(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,P,B){return Hs(zu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,B),g)},t.prototype.isTileClipped=function(){return!0},t}(cs),nr=Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Dr=on;function on(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(Gn,this,t)}function Gn(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var g=u.readVarint()+u.pos;u.pos<g;){var A=f._keys[u.readVarint()],P=f._values[u.readVarint()];f.properties[A]=P}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function na(e){for(var t,r,u=0,f=0,g=e.length,A=g-1;f<g;A=f++)u+=((r=e[A]).x-(t=e[f]).x)*(t.y+r.y);return u}on.types=["Unknown","Point","LineString","Polygon"],on.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,g=0,A=0,P=[];e.pos<r;){if(f<=0){var B=e.readVarint();u=7&B,f=B>>3}if(f--,u===1||u===2)g+=e.readSVarint(),A+=e.readSVarint(),u===1&&(t&&P.push(t),t=[]),t.push(new q(g,A));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&P.push(t),P},on.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,g=0,A=1/0,P=-1/0,B=1/0,Q=-1/0;e.pos<t;){if(u<=0){var de=e.readVarint();r=7&de,u=de>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<A&&(A=f),f>P&&(P=f),(g+=e.readSVarint())<B&&(B=g),g>Q&&(Q=g);else if(r!==7)throw new Error("unknown command "+r)}return[A,B,P,Q]},on.prototype.toGeoJSON=function(e,t,r){var u,f,g=this.extent*Math.pow(2,r),A=this.extent*e,P=this.extent*t,B=this.loadGeometry(),Q=on.types[this.type];function de(nt){for(var St=0;St<nt.length;St++){var bt=nt[St];nt[St]=[360*(bt.x+A)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(bt.y+P)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(u=0;u<B.length;u++)_e[u]=B[u][0];de(B=_e);break;case 2:for(u=0;u<B.length;u++)de(B[u]);break;case 3:for(B=function(nt){var St=nt.length;if(St<=1)return[nt];for(var bt,Vt,Ut=[],or=0;or<St;or++){var pr=na(nt[or]);pr!==0&&(Vt===void 0&&(Vt=pr<0),Vt===pr<0?(bt&&Ut.push(bt),bt=[nt[or]]):bt.push(nt[or]))}return bt&&Ut.push(bt),Ut}(B),u=0;u<B.length;u++)for(f=0;f<B[u].length;f++)de(B[u][f])}B.length===1?B=B[0]:Q="Multi"+Q;var Oe={type:"Feature",geometry:{type:Q,coordinates:B},properties:this.properties};return"id"in this&&(Oe.id=this.id),Oe};var aa=si;function si(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ya,this,t),this.length=this._features.length}function Ya(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,g=u.readVarint()+u.pos;u.pos<g;){var A=u.readVarint()>>3;f=A===1?u.readString():A===2?u.readFloat():A===3?u.readDouble():A===4?u.readVarint64():A===5?u.readVarint():A===6?u.readSVarint():A===7?u.readBoolean():null}return f}(r))}function Ri(e,t,r){if(e===3){var u=new aa(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}si.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Dr(this._pbf,t,this.extent,this._keys,this._values)};var Ha={VectorTile:function(t,r){this.layers=t.readFields(Ri,{},r)},VectorTileFeature:Dr,VectorTileLayer:aa},qi=Ha.VectorTileFeature.types,hs=Math.pow(2,13);function Xi(e,t,r,u,f,g,A,P){e.emplaceBack(t,r,2*Math.floor(u*hs)+A,f*hs*2,g*hs*2,Math.round(P))}var pi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new vc,this.indexArray=new ll,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new $e,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function ks(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}pi.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=N("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var g=f[u],A=g.feature,P=g.id,B=g.index,Q=g.sourceLayerIndex,de=this.layers[0]._featureFilter.needGeometry,_e={type:A.type,id:P,properties:A.properties,geometry:de?xi(A):[]};if(this.layers[0]._featureFilter.filter(new bi(this.zoom),_e,r)){var Oe={id:P,sourceLayerIndex:Q,index:B,geometry:de?_e.geometry:xi(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(V("fill-extrusion",this.layers,Oe,this.zoom,t)):this.addFeature(Oe,Oe.geometry,B,r,{}),t.featureIndex.insert(A,Oe.geometry,B,Q,this.index,!0)}}},pi.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},pi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},pi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},pi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},pi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},pi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},pi.prototype.addFeature=function(e,t,r,u,f){for(var g=0,A=ee(t,500);g<A.length;g+=1){for(var P=A[g],B=0,Q=0,de=P;Q<de.length;Q+=1)B+=de[Q].length;for(var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Oe=0,nt=P;Oe<nt.length;Oe+=1){var St=nt[Oe];if(St.length!==0&&!((mi=St).every(function(za){return za.x<0})||mi.every(function(za){return za.x>8192})||mi.every(function(za){return za.y<0})||mi.every(function(za){return za.y>8192})))for(var bt=0,Vt=0;Vt<St.length;Vt++){var Ut=St[Vt];if(Vt>=1){var or=St[Vt-1];if(!ks(Ut,or)){_e.vertexLength+4>$e.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var pr=Ut.sub(or)._perp()._unit(),Sr=or.dist(Ut);bt+Sr>32768&&(bt=0),Xi(this.layoutVertexArray,Ut.x,Ut.y,pr.x,pr.y,0,0,bt),Xi(this.layoutVertexArray,Ut.x,Ut.y,pr.x,pr.y,0,1,bt),Xi(this.layoutVertexArray,or.x,or.y,pr.x,pr.y,0,0,bt+=Sr),Xi(this.layoutVertexArray,or.x,or.y,pr.x,pr.y,0,1,bt);var Vr=_e.vertexLength;this.indexArray.emplaceBack(Vr,Vr+2,Vr+1),this.indexArray.emplaceBack(Vr+1,Vr+2,Vr+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+B>$e.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray)),qi[e.type]==="Polygon"){for(var Nr=[],mn=[],En=_e.vertexLength,Bn=0,ea=P;Bn<ea.length;Bn+=1){var kn=ea[Bn];if(kn.length!==0){kn!==P[0]&&mn.push(Nr.length/2);for(var Nn=0;Nn<kn.length;Nn++){var wa=kn[Nn];Xi(this.layoutVertexArray,wa.x,wa.y,0,0,1,1,0),Nr.push(wa.x),Nr.push(wa.y)}}}for(var ua=Pf(Nr,mn),Jn=0;Jn<ua.length;Jn+=3)this.indexArray.emplaceBack(En+ua[Jn],En+ua[Jn+2],En+ua[Jn+1]);_e.primitiveLength+=ua.length/3,_e.vertexLength+=B}}var mi;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},bn("FillExtrusionBucket",pi,{omit:["layers","features"]});var Yi={paint:new Ui({"fill-extrusion-opacity":new Vn(Ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new la(Ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Vn(Ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Vn(Ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new go(Ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new la(Ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new la(Ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Vn(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},bo=function(e){function t(r){e.call(this,r,Yi)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new pi(r)},t.prototype.queryRadius=function(){return wo(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,P,B,Q){var de=zu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,B),_e=this.paint.get("fill-extrusion-height").evaluate(u,f),Oe=this.paint.get("fill-extrusion-base").evaluate(u,f),nt=function(bt,Vt,Ut,or){for(var pr=[],Sr=0,Vr=bt;Sr<Vr.length;Sr+=1){var Nr=Vr[Sr],mn=[Nr.x,Nr.y,0,1];ao(mn,mn,Vt),pr.push(new q(mn[0]/mn[3],mn[1]/mn[3]))}return pr}(de,Q),St=function(bt,Vt,Ut,or){for(var pr=[],Sr=[],Vr=or[8]*Vt,Nr=or[9]*Vt,mn=or[10]*Vt,En=or[11]*Vt,Bn=or[8]*Ut,ea=or[9]*Ut,kn=or[10]*Ut,Nn=or[11]*Ut,wa=0,ua=bt;wa<ua.length;wa+=1){for(var Jn=[],mi=[],za=0,Vi=ua[wa];za<Vi.length;za+=1){var ga=Vi[za],vi=ga.x,Ro=ga.y,Qo=or[0]*vi+or[4]*Ro+or[12],cu=or[1]*vi+or[5]*Ro+or[13],ki=or[2]*vi+or[6]*Ro+or[14],As=or[3]*vi+or[7]*Ro+or[15],Zo=ki+mn,ps=As+En,tl=Qo+Bn,zs=cu+ea,hl=ki+kn,Ou=As+Nn,ms=new q((Qo+Vr)/ps,(cu+Nr)/ps);ms.z=Zo/ps,Jn.push(ms);var Bu=new q(tl/Ou,zs/Ou);Bu.z=hl/Ou,mi.push(Bu)}pr.push(Jn),Sr.push(mi)}return[pr,Sr]}(g,Oe,_e,Q);return function(bt,Vt,Ut){var or=1/0;Hs(Ut,Vt)&&(or=Ai(Ut,Vt[0]));for(var pr=0;pr<Vt.length;pr++)for(var Sr=Vt[pr],Vr=bt[pr],Nr=0;Nr<Sr.length-1;Nr++){var mn=Sr[Nr],En=[mn,Sr[Nr+1],Vr[Nr+1],Vr[Nr],mn];Tu(Ut,En)&&(or=Math.min(or,Ai(Ut,En)))}return or!==1/0&&or}(St[0],St[1],nt)},t}(cs);function ds(e,t){return e.x*t.x+e.y*t.y}function Ai(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var g=t[u],A=e[0],P=r.sub(f),B=g.sub(f),Q=A.sub(f),de=ds(P,P),_e=ds(P,B),Oe=ds(B,B),nt=ds(Q,P),St=ds(Q,B),bt=de*Oe-_e*_e,Vt=(Oe*nt-_e*St)/bt,Ut=(de*St-_e*nt)/bt,or=f.z*(1-Vt-Ut)+r.z*Vt+g.z*Ut;if(isFinite(or))return or}return 1/0}for(var pr=1/0,Sr=0,Vr=t;Sr<Vr.length;Sr+=1)pr=Math.min(pr,Vr[Sr].z);return pr}var xo=Ni([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Aa=Ni([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ko=Ha.VectorTileFeature.types,bc=Math.cos(Math.PI/180*37.5),Hf=Math.pow(2,14)/.5,Ks=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new ku,this.layoutVertexArray2=new ts,this.indexArray=new ll,this.programConfigurations=new Da(t.layers,t.zoom),this.segments=new $e,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Ks.prototype.populate=function(e,t,r){this.hasPattern=N("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],g=0,A=e;g<A.length;g+=1){var P=A[g],B=P.feature,Q=P.id,de=P.index,_e=P.sourceLayerIndex,Oe=this.layers[0]._featureFilter.needGeometry,nt={type:B.type,id:Q,properties:B.properties,geometry:Oe?xi(B):[]};if(this.layers[0]._featureFilter.filter(new bi(this.zoom),nt,r)){Oe||(nt.geometry=xi(B));var St=u?u.evaluate(nt,{},r):void 0;f.push({id:Q,properties:B.properties,type:B.type,sourceLayerIndex:_e,index:de,geometry:nt.geometry,patterns:{},sortKey:St})}}u&&f.sort(function(Nr,mn){return Nr.sortKey-mn.sortKey});for(var bt=0,Vt=f;bt<Vt.length;bt+=1){var Ut=Vt[bt],or=Ut.geometry,pr=Ut.index,Sr=Ut.sourceLayerIndex;if(this.hasPattern){var Vr=V("line",this.layers,Ut,this.zoom,t);this.patternFeatures.push(Vr)}else this.addFeature(Ut,or,pr,r,{});t.featureIndex.insert(e[pr].feature,or,pr,Sr,this.index)}},Ks.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ks.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var g=f[u];this.addFeature(g,g.geometry,g.index,t,r)}},Ks.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ks.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ks.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Aa)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ks.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ks.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Ks.prototype.addFeature=function(e,t,r,u,f){var g=this.layers[0].layout,A=g.get("line-join").evaluate(e,{}),P=g.get("line-cap"),B=g.get("line-miter-limit"),Q=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var de=0,_e=t;de<_e.length;de+=1)this.addLine(_e[de],e,A,P,B,Q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Ks.prototype.addLine=function(e,t,r,u,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=ko[t.type]==="Polygon",B=e.length;B>=2&&e[B-1].equals(e[B-2]);)B--;for(var Q=0;Q<B-1&&e[Q].equals(e[Q+1]);)Q++;if(!(B<(P?3:2))){r==="bevel"&&(f=1.05);var de,_e=this.overscaling<=16?122880/(512*this.overscaling):0,Oe=this.segments.prepareSegment(10*B,this.layoutVertexArray,this.indexArray),nt=void 0,St=void 0,bt=void 0,Vt=void 0;this.e1=this.e2=-1,P&&(Vt=e[Q].sub(de=e[B-2])._unit()._perp());for(var Ut=Q;Ut<B;Ut++)if(!(St=Ut===B-1?P?e[Q+1]:void 0:e[Ut+1])||!e[Ut].equals(St)){Vt&&(bt=Vt),de&&(nt=de),de=e[Ut],Vt=St?St.sub(de)._unit()._perp():bt;var or=(bt=bt||Vt).add(Vt);or.x===0&&or.y===0||or._unit();var pr=bt.x*Vt.x+bt.y*Vt.y,Sr=or.x*Vt.x+or.y*Vt.y,Vr=Sr!==0?1/Sr:1/0,Nr=2*Math.sqrt(2-2*Sr),mn=Sr<bc&&nt&&St,En=bt.x*Vt.y-bt.y*Vt.x>0;if(mn&&Ut>Q){var Bn=de.dist(nt);if(Bn>2*_e){var ea=de.sub(de.sub(nt)._mult(_e/Bn)._round());this.updateDistance(nt,ea),this.addCurrentVertex(ea,bt,0,0,Oe),nt=ea}}var kn=nt&&St,Nn=kn?r:P?"butt":u;if(kn&&Nn==="round"&&(Vr<g?Nn="miter":Vr<=2&&(Nn="fakeround")),Nn==="miter"&&Vr>f&&(Nn="bevel"),Nn==="bevel"&&(Vr>2&&(Nn="flipbevel"),Vr<f&&(Nn="miter")),nt&&this.updateDistance(nt,de),Nn==="miter")or._mult(Vr),this.addCurrentVertex(de,or,0,0,Oe);else if(Nn==="flipbevel"){if(Vr>100)or=Vt.mult(-1);else{var wa=Vr*bt.add(Vt).mag()/bt.sub(Vt).mag();or._perp()._mult(wa*(En?-1:1))}this.addCurrentVertex(de,or,0,0,Oe),this.addCurrentVertex(de,or.mult(-1),0,0,Oe)}else if(Nn==="bevel"||Nn==="fakeround"){var ua=-Math.sqrt(Vr*Vr-1),Jn=En?ua:0,mi=En?0:ua;if(nt&&this.addCurrentVertex(de,bt,Jn,mi,Oe),Nn==="fakeround")for(var za=Math.round(180*Nr/Math.PI/20),Vi=1;Vi<za;Vi++){var ga=Vi/za;if(ga!==.5){var vi=ga-.5;ga+=ga*vi*(ga-1)*((1.0904+pr*(pr*(3.55645-1.43519*pr)-3.2452))*vi*vi+(.848013+pr*(.215638*pr-1.06021)))}var Ro=Vt.sub(bt)._mult(ga)._add(bt)._unit()._mult(En?-1:1);this.addHalfVertex(de,Ro.x,Ro.y,!1,En,0,Oe)}St&&this.addCurrentVertex(de,Vt,-Jn,-mi,Oe)}else if(Nn==="butt")this.addCurrentVertex(de,or,0,0,Oe);else if(Nn==="square"){var Qo=nt?1:-1;this.addCurrentVertex(de,or,Qo,Qo,Oe)}else Nn==="round"&&(nt&&(this.addCurrentVertex(de,bt,0,0,Oe),this.addCurrentVertex(de,bt,1,1,Oe,!0)),St&&(this.addCurrentVertex(de,Vt,-1,-1,Oe,!0),this.addCurrentVertex(de,Vt,0,0,Oe)));if(mn&&Ut<B-1){var cu=de.dist(St);if(cu>2*_e){var ki=de.add(St.sub(de)._mult(_e/cu)._round());this.updateDistance(de,ki),this.addCurrentVertex(ki,Vt,0,0,Oe),de=ki}}}}},Ks.prototype.addCurrentVertex=function(e,t,r,u,f,g){g===void 0&&(g=!1);var A=t.y*u-t.x,P=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,f),this.addHalfVertex(e,A,P,g,!0,-u,f),this.distance>Hf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,g))},Ks.prototype.addHalfVertex=function(e,t,r,u,f,g,A){var P=.5*(this.lineClips?this.scaledDistance*(Hf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(g===0?0:g<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var B=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),A.primitiveLength++),f?this.e2=B:this.e1=B},Ks.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ks.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},bn("LineBucket",Ks,{omit:["layers","patternFeatures"]});var uh=new Ui({"line-cap":new Vn(Ve.layout_line["line-cap"]),"line-join":new la(Ve.layout_line["line-join"]),"line-miter-limit":new Vn(Ve.layout_line["line-miter-limit"]),"line-round-limit":new Vn(Ve.layout_line["line-round-limit"]),"line-sort-key":new la(Ve.layout_line["line-sort-key"])}),Vh={paint:new Ui({"line-opacity":new la(Ve.paint_line["line-opacity"]),"line-color":new la(Ve.paint_line["line-color"]),"line-translate":new Vn(Ve.paint_line["line-translate"]),"line-translate-anchor":new Vn(Ve.paint_line["line-translate-anchor"]),"line-width":new la(Ve.paint_line["line-width"]),"line-gap-width":new la(Ve.paint_line["line-gap-width"]),"line-offset":new la(Ve.paint_line["line-offset"]),"line-blur":new la(Ve.paint_line["line-blur"]),"line-dasharray":new $u(Ve.paint_line["line-dasharray"]),"line-pattern":new go(Ve.paint_line["line-pattern"]),"line-gradient":new Vs(Ve.paint_line["line-gradient"])}),layout:uh},Wf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new bi(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,g){return u=Ne({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,g)},t}(la))(Vh.paint.properties["line-width"].specification);Wf.useIntegerZoom=!0;var If=function(e){function t(r){e.call(this,r,Vh),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ms,this.gradientVersion=(this.gradientVersion+1)%je)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=Wf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Ks(r)},t.prototype.queryRadius=function(r){var u=r,f=qf(Au("line-width",this,u),Au("line-gap-width",this,u)),g=Au("line-offset",this,u);return f/2+Math.abs(g)+wo(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,g,A,P,B){var Q=zu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,B),de=B/2*qf(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),_e=this.paint.get("line-offset").evaluate(u,f);return _e&&(g=function(Oe,nt){for(var St=[],bt=new q(0,0),Vt=0;Vt<Oe.length;Vt++){for(var Ut=Oe[Vt],or=[],pr=0;pr<Ut.length;pr++){var Sr=Ut[pr],Vr=Ut[pr+1],Nr=pr===0?bt:Sr.sub(Ut[pr-1])._unit()._perp(),mn=pr===Ut.length-1?bt:Vr.sub(Sr)._unit()._perp(),En=Nr._add(mn)._unit();En._mult(1/(En.x*mn.x+En.y*mn.y)),or.push(En._mult(nt)._add(Sr))}St.push(or)}return St}(g,_e*B)),function(Oe,nt,St){for(var bt=0;bt<nt.length;bt++){var Vt=nt[bt];if(Oe.length>=3){for(var Ut=0;Ut<Vt.length;Ut++)if(Su(Oe,Vt[Ut]))return!0}if(fs(Oe,Vt,St))return!0}return!1}(Q,g,de)},t.prototype.isTileClipped=function(){return!0},t}(cs);function qf(e,t){return t>0?t+2*e:e}var Ch=Ni([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wh=Ni([{name:"a_projected_pos",components:3,type:"Float32"}],4),Df=(Ni([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ni([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),eh=(Ni([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),th=Ni([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Oh(e,t,r){return e.sections.forEach(function(u){u.text=function(f,g,A){var P=g.layout.get("text-transform").evaluate(A,{});return P==="uppercase"?f=f.toLocaleUpperCase():P==="lowercase"&&(f=f.toLocaleLowerCase()),Ji.applyArabicShaping&&(f=Ji.applyArabicShaping(f)),f}(u.text,t,r)}),e}Ni([{name:"triangle",components:3,type:"Uint16"}]),Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ni([{type:"Float32",name:"offsetX"}]),Ni([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var rh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Nf=function(t,r,u,f,g){var A,P,B=8*g-f-1,Q=(1<<B)-1,de=Q>>1,_e=-7,Oe=u?g-1:0,nt=u?-1:1,St=t[r+Oe];for(Oe+=nt,A=St&(1<<-_e)-1,St>>=-_e,_e+=B;_e>0;A=256*A+t[r+Oe],Oe+=nt,_e-=8);for(P=A&(1<<-_e)-1,A>>=-_e,_e+=f;_e>0;P=256*P+t[r+Oe],Oe+=nt,_e-=8);if(A===0)A=1-de;else{if(A===Q)return P?NaN:1/0*(St?-1:1);P+=Math.pow(2,f),A-=de}return(St?-1:1)*P*Math.pow(2,A-f)},vh=function(t,r,u,f,g,A){var P,B,Q,de=8*A-g-1,_e=(1<<de)-1,Oe=_e>>1,nt=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,St=f?0:A-1,bt=f?1:-1,Vt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(B=isNaN(r)?1:0,P=_e):(P=Math.floor(Math.log(r)/Math.LN2),r*(Q=Math.pow(2,-P))<1&&(P--,Q*=2),(r+=P+Oe>=1?nt/Q:nt*Math.pow(2,1-Oe))*Q>=2&&(P++,Q/=2),P+Oe>=_e?(B=0,P=_e):P+Oe>=1?(B=(r*Q-1)*Math.pow(2,g),P+=Oe):(B=r*Math.pow(2,Oe-1)*Math.pow(2,g),P=0));g>=8;t[u+St]=255&B,St+=bt,B/=256,g-=8);for(P=P<<g|B,de+=g;de>0;t[u+St]=255&P,St+=bt,P/=256,de-=8);t[u+St-bt]|=128*Vt},lh=fe;function fe(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}fe.Varint=0,fe.Fixed64=1,fe.Bytes=2,fe.Fixed32=5;var ke=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Nt(e){return e.type===fe.Bytes?e.readVarint()+e.pos:e.pos+1}function vr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Ur(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Rr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Er(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Yr(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function qr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function sn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function an(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function An(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function pn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function un(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Tr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function xr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function tn(e,t,r){e===1&&r.readMessage(Ln,t)}function Ln(e,t,r){if(e===3){var u=r.readMessage(kr,{}),f=u.width,g=u.height,A=u.left,P=u.top,B=u.advance;t.push({id:u.id,bitmap:new Ys({width:f+6,height:g+6},u.bitmap),metrics:{width:f,height:g,left:A,top:P,advance:B}})}}function kr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Yn(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var g=f[u];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(bt,Vt){return Vt.h-bt.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,B=0,Q=0,de=e;Q<de.length;Q+=1)for(var _e=de[Q],Oe=A.length-1;Oe>=0;Oe--){var nt=A[Oe];if(!(_e.w>nt.w||_e.h>nt.h)){if(_e.x=nt.x,_e.y=nt.y,B=Math.max(B,_e.y+_e.h),P=Math.max(P,_e.x+_e.w),_e.w===nt.w&&_e.h===nt.h){var St=A.pop();Oe<A.length&&(A[Oe]=St)}else _e.h===nt.h?(nt.x+=_e.w,nt.w-=_e.w):_e.w===nt.w?(nt.y+=_e.h,nt.h-=_e.h):(A.push({x:nt.x+_e.w,y:nt.y,w:nt.w-_e.w,h:_e.h}),nt.y+=_e.h,nt.h-=_e.h);break}}return{w:P,h:B,fill:t/(P*B)||0}}fe.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,A=this.pos;this.type=7&f,t(g,r,this),this.pos===A&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=un(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=xr(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=un(this.buf,this.pos)+4294967296*un(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=un(this.buf,this.pos)+4294967296*xr(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Nf(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Nf(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(g,A,P){var B,Q,de=P.buf;if(B=(112&(Q=de[P.pos++]))>>4,Q<128)return vr(g,B,A);if(B|=(127&(Q=de[P.pos++]))<<3,Q<128)return vr(g,B,A);if(B|=(127&(Q=de[P.pos++]))<<10,Q<128)return vr(g,B,A);if(B|=(127&(Q=de[P.pos++]))<<17,Q<128)return vr(g,B,A);if(B|=(127&(Q=de[P.pos++]))<<24,Q<128)return vr(g,B,A);if(B|=(1&(Q=de[P.pos++]))<<31,Q<128)return vr(g,B,A);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&ke?function(u,f,g){return ke.decode(u.subarray(f,g))}(this.buf,r,t):function(u,f,g){for(var A="",P=f;P<g;){var B,Q,de,_e=u[P],Oe=null,nt=_e>239?4:_e>223?3:_e>191?2:1;if(P+nt>g)break;nt===1?_e<128&&(Oe=_e):nt===2?(192&(B=u[P+1]))==128&&(Oe=(31&_e)<<6|63&B)<=127&&(Oe=null):nt===3?(Q=u[P+2],(192&(B=u[P+1]))==128&&(192&Q)==128&&((Oe=(15&_e)<<12|(63&B)<<6|63&Q)<=2047||Oe>=55296&&Oe<=57343)&&(Oe=null)):nt===4&&(Q=u[P+2],de=u[P+3],(192&(B=u[P+1]))==128&&(192&Q)==128&&(192&de)==128&&((Oe=(15&_e)<<18|(63&B)<<12|(63&Q)<<6|63&de)<=65535||Oe>=1114112)&&(Oe=null)),Oe===null?(Oe=65533,nt=1):Oe>65535&&(Oe-=65536,A+=String.fromCharCode(Oe>>>10&1023|55296),Oe=56320|1023&Oe),A+=String.fromCharCode(Oe),P+=nt}return A}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==fe.Bytes)return t.push(this.readVarint(r));var u=Nt(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==fe.Bytes)return t.push(this.readSVarint());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==fe.Bytes)return t.push(this.readBoolean());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==fe.Bytes)return t.push(this.readFloat());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==fe.Bytes)return t.push(this.readDouble());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==fe.Bytes)return t.push(this.readFixed32());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==fe.Bytes)return t.push(this.readSFixed32());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==fe.Bytes)return t.push(this.readFixed64());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==fe.Bytes)return t.push(this.readSFixed64());var r=Nt(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===fe.Varint)for(;this.buf[this.pos++]>127;);else if(r===fe.Bytes)this.pos=this.readVarint()+this.pos;else if(r===fe.Fixed32)this.pos+=4;else{if(r!==fe.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Tr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Tr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Tr(this.buf,-1&t,this.pos),Tr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Tr(this.buf,-1&t,this.pos),Tr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,g;if(r>=0?(f=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(A,P,B){B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,B.buf[B.pos]=127&(A>>>=7)}(f,0,u),function(A,P){var B=(7&A)<<4;P.buf[P.pos++]|=B|((A>>>=3)?128:0),A&&(P.buf[P.pos++]=127&A|((A>>>=7)?128:0),A&&(P.buf[P.pos++]=127&A|((A>>>=7)?128:0),A&&(P.buf[P.pos++]=127&A|((A>>>=7)?128:0),A&&(P.buf[P.pos++]=127&A|((A>>>=7)?128:0),A&&(P.buf[P.pos++]=127&A)))))}(g,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,g,A){for(var P,B,Q=0;Q<g.length;Q++){if((P=g.charCodeAt(Q))>55295&&P<57344){if(!B){P>56319||Q+1===g.length?(f[A++]=239,f[A++]=191,f[A++]=189):B=P;continue}if(P<56320){f[A++]=239,f[A++]=191,f[A++]=189,B=P;continue}P=B-55296<<10|P-56320|65536,B=null}else B&&(f[A++]=239,f[A++]=191,f[A++]=189,B=null);P<128?f[A++]=P:(P<2048?f[A++]=P>>6|192:(P<65536?f[A++]=P>>12|224:(f[A++]=P>>18|240,f[A++]=P>>12&63|128),f[A++]=P>>6&63|128),f[A++]=63&P|128)}return A}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&Ur(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),vh(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),vh(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&Ur(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,fe.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Rr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,Er,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,sn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Yr,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,qr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,an,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,An,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,pn,r)},writeBytesField:function(t,r){this.writeTag(t,fe.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,fe.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,fe.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,fe.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,fe.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,fe.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,fe.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,fe.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,fe.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,fe.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var $r=function(t,r){var u=r.pixelRatio,f=r.version,g=r.stretchX,A=r.stretchY,P=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=g,this.stretchY=A,this.content=P,this.version=f},Br={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Br.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Br.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Br.tlbr.get=function(){return this.tl.concat(this.br)},Br.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties($r.prototype,Br);var Gr=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var g=[];this.addImages(t,u,g),this.addImages(r,f,g);var A=Yn(g),P=new Ho({width:A.w||1,height:A.h||1});for(var B in t){var Q=t[B],de=u[B].paddedRect;Ho.copy(Q.data,P,{x:0,y:0},{x:de.x+1,y:de.y+1},Q.data)}for(var _e in r){var Oe=r[_e],nt=f[_e].paddedRect,St=nt.x+1,bt=nt.y+1,Vt=Oe.data.width,Ut=Oe.data.height;Ho.copy(Oe.data,P,{x:0,y:0},{x:St,y:bt},Oe.data),Ho.copy(Oe.data,P,{x:0,y:Ut-1},{x:St,y:bt-1},{width:Vt,height:1}),Ho.copy(Oe.data,P,{x:0,y:0},{x:St,y:bt+Ut},{width:Vt,height:1}),Ho.copy(Oe.data,P,{x:Vt-1,y:0},{x:St-1,y:bt},{width:1,height:Ut}),Ho.copy(Oe.data,P,{x:0,y:0},{x:St+Vt,y:bt},{width:1,height:Ut})}this.image=P,this.iconPositions=u,this.patternPositions=f};Gr.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],g={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(g),t[u]=new $r(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Gr.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Gr.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},bn("ImagePosition",$r),bn("ImageAtlas",Gr);var Xr={horizontal:1,vertical:2,horizontalOnly:3},Hn=function(){this.scale=1,this.fontStack="",this.imageName=null};Hn.forText=function(e,t){var r=new Hn;return r.scale=e||1,r.fontStack=t,r},Hn.forImage=function(e){var t=new Hn;return t.imageName=e,t};var qn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function fn(e,t,r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt){var Vt,Ut=qn.fromFeature(e,f);_e===Xr.vertical&&Ut.verticalizePunctuation();var or=Ji.processBidirectionalText,pr=Ji.processStyledBidirectionalText;if(or&&Ut.sections.length===1){Vt=[];for(var Sr=0,Vr=or(Ut.toString(),Pa(Ut,Q,g,t,u,nt,St));Sr<Vr.length;Sr+=1){var Nr=Vr[Sr],mn=new qn;mn.text=Nr,mn.sections=Ut.sections;for(var En=0;En<Nr.length;En++)mn.sectionIndex.push(0);Vt.push(mn)}}else if(pr){Vt=[];for(var Bn=0,ea=pr(Ut.text,Ut.sectionIndex,Pa(Ut,Q,g,t,u,nt,St));Bn<ea.length;Bn+=1){var kn=ea[Bn],Nn=new qn;Nn.text=kn[0],Nn.sectionIndex=kn[1],Nn.sections=Ut.sections,Vt.push(Nn)}}else Vt=function(Jn,mi){for(var za=[],Vi=Jn.text,ga=0,vi=0,Ro=mi;vi<Ro.length;vi+=1){var Qo=Ro[vi];za.push(Jn.substring(ga,Qo)),ga=Qo}return ga<Vi.length&&za.push(Jn.substring(ga,Vi.length)),za}(Ut,Pa(Ut,Q,g,t,u,nt,St));var wa=[],ua={positionedLines:wa,text:Ut.toString(),top:de[1],bottom:de[1],left:de[0],right:de[0],writingMode:_e,iconsInText:!1,verticalizable:!1};return function(Jn,mi,za,Vi,ga,vi,Ro,Qo,cu,ki,As,Zo){for(var ps=0,tl=-17,zs=0,hl=0,Ou=Qo==="right"?1:Qo==="left"?0:.5,ms=0,Bu=0,Ei=ga;Bu<Ei.length;Bu+=1){var ji=Ei[Bu];ji.trim();var co=ji.getMaxScale(),zi=24*(co-1),rl={positionedGlyphs:[],lineOffset:0};Jn.positionedLines[ms]=rl;var Js=rl.positionedGlyphs,Eo=0;if(ji.length()){for(var Qs=0;Qs<ji.length();Qs++){var fo=ji.getSection(Qs),Cs=ji.getSectionIndex(Qs),Fc=ji.getCharCode(Qs),Ff=0,Uc=null,Mu=null,Zf=null,ih=24,Xf=!(cu===Xr.horizontal||!As&&!$c(Fc)||As&&(rn[Fc]||(hh=Fc,Sn.Arabic(hh)||Sn["Arabic Supplement"](hh)||Sn["Arabic Extended-A"](hh)||Sn["Arabic Presentation Forms-A"](hh)||Sn["Arabic Presentation Forms-B"](hh))));if(fo.imageName){var Mh=Vi[fo.imageName];if(!Mh)continue;Zf=fo.imageName,Jn.iconsInText=Jn.iconsInText||!0,Mu=Mh.paddedRect;var Yf=Mh.displaySize;fo.scale=24*fo.scale/Zo,Ff=zi+(24-Yf[1]*fo.scale),ih=(Uc={width:Yf[0],height:Yf[1],left:1,top:-3,advance:Xf?Yf[1]:Yf[0]}).advance;var Ph=Xf?Yf[0]*fo.scale-24*co:Yf[1]*fo.scale-24*co;Ph>0&&Ph>Eo&&(Eo=Ph)}else{var Lh=za[fo.fontStack],yh=Lh&&Lh[Fc];if(yh&&yh.rect)Mu=yh.rect,Uc=yh.metrics;else{var fh=mi[fo.fontStack],Rh=fh&&fh[Fc];if(!Rh)continue;Uc=Rh.metrics}Ff=24*(co-fo.scale)}Xf?(Jn.verticalizable=!0,Js.push({glyph:Fc,imageName:Zf,x:ps,y:tl+Ff,vertical:Xf,scale:fo.scale,fontStack:fo.fontStack,sectionIndex:Cs,metrics:Uc,rect:Mu}),ps+=ih*fo.scale+ki):(Js.push({glyph:Fc,imageName:Zf,x:ps,y:tl+Ff,vertical:Xf,scale:fo.scale,fontStack:fo.fontStack,sectionIndex:Cs,metrics:Uc,rect:Mu}),ps+=Uc.advance*fo.scale+ki)}Js.length!==0&&(zs=Math.max(ps-ki,zs),Ci(Js,0,Js.length-1,Ou,Eo)),ps=0;var Qh=vi*co+Eo;rl.lineOffset=Math.max(Eo,zi),tl+=Qh,hl=Math.max(Qh,hl),++ms}else tl+=vi,++ms}var hh,Ih=tl- -17,ad=Na(Ro),Dh=ad.horizontalAlign,dh=ad.verticalAlign;(function(Nh,Hh,bh,kh,Wh,Zh,xh,jh,zh){var Fh,Xh=(Hh-bh)*Wh;Fh=Zh!==xh?-jh*kh- -17:(-kh*zh+.5)*xh;for(var Eh=0,Uh=Nh;Eh<Uh.length;Eh+=1)for(var Th=0,_h=Uh[Eh].positionedGlyphs;Th<_h.length;Th+=1){var Bh=_h[Th];Bh.x+=Xh,Bh.y+=Fh}})(Jn.positionedLines,Ou,Dh,dh,zs,hl,vi,Ih,ga.length),Jn.top+=-dh*Ih,Jn.bottom=Jn.top+Ih,Jn.left+=-Dh*zs,Jn.right=Jn.left+zs}(ua,t,r,u,Vt,A,P,B,_e,Q,Oe,bt),!function(Jn){for(var mi=0,za=Jn;mi<za.length;mi+=1)if(za[mi].positionedGlyphs.length!==0)return!1;return!0}(wa)&&ua}qn.fromFeature=function(e,t){for(var r=new qn,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},qn.prototype.length=function(){return this.text.length},qn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},qn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},qn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},qn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&wc(u)&&!rh[e[r+1]]||f&&wc(f)&&!rh[e[r-1]]||!rh[e[r]]?e[r]:rh[e[r]]}return t}(this.text)},qn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&rn[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&rn[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},qn.prototype.substring=function(e,t){var r=new qn;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},qn.prototype.toString=function(){return this.text},qn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},qn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Hn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},qn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(Hn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Pe("Reached maximum number of images 6401")}else Pe("Can't add FormattedSection with an empty image.")},qn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var rn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},zr={};function Ea(e,t,r,u,f,g){if(t.imageName){var A=u[t.imageName];return A?A.displaySize[0]*t.scale*24/g+f:0}var P=r[t.fontStack],B=P&&P[e];return B?B.metrics.advance*t.scale+f:0}function Wa(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function Un(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Fa(e,t,r,u,f,g){for(var A=null,P=Wa(t,r,f,g),B=0,Q=u;B<Q.length;B+=1){var de=Q[B],_e=Wa(t-de.x,r,f,g)+de.badness;_e<=P&&(A=de,P=_e)}return{index:e,x:t,priorBreak:A,badness:P}}function Pa(e,t,r,u,f,g,A){if(g!=="point")return[];if(!e)return[];for(var P,B=[],Q=function(Vt,Ut,or,pr,Sr,Vr){for(var Nr=0,mn=0;mn<Vt.length();mn++){var En=Vt.getSection(mn);Nr+=Ea(Vt.getCharCode(mn),En,pr,Sr,Ut,Vr)}return Nr/Math.max(1,Math.ceil(Nr/or))}(e,t,r,u,f,A),de=e.text.indexOf("\u200B")>=0,_e=0,Oe=0;Oe<e.length();Oe++){var nt=e.getSection(Oe),St=e.getCharCode(Oe);if(rn[St]||(_e+=Ea(St,nt,u,f,t,A)),Oe<e.length()-1){var bt=!((P=St)<11904||!(Sn["Bopomofo Extended"](P)||Sn.Bopomofo(P)||Sn["CJK Compatibility Forms"](P)||Sn["CJK Compatibility Ideographs"](P)||Sn["CJK Compatibility"](P)||Sn["CJK Radicals Supplement"](P)||Sn["CJK Strokes"](P)||Sn["CJK Symbols and Punctuation"](P)||Sn["CJK Unified Ideographs Extension A"](P)||Sn["CJK Unified Ideographs"](P)||Sn["Enclosed CJK Letters and Months"](P)||Sn["Halfwidth and Fullwidth Forms"](P)||Sn.Hiragana(P)||Sn["Ideographic Description Characters"](P)||Sn["Kangxi Radicals"](P)||Sn["Katakana Phonetic Extensions"](P)||Sn.Katakana(P)||Sn["Vertical Forms"](P)||Sn["Yi Radicals"](P)||Sn["Yi Syllables"](P)));(zr[St]||bt||nt.imageName)&&B.push(Fa(Oe+1,_e,Q,B,Un(St,e.getCharCode(Oe+1),bt&&de),!1))}}return function Vt(Ut){return Ut?Vt(Ut.priorBreak).concat(Ut.index):[]}(Fa(e.length(),_e,Q,B,0,!0))}function Na(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ci(e,t,r,u,f){if(u||f)for(var g=e[r],A=(e[r].x+g.metrics.advance*g.scale)*u,P=t;P<=r;P++)e[P].x-=A,e[P].y+=f}function Wo(e,t,r,u,f,g){var A,P=e.image;if(P.content){var B=P.content,Q=P.pixelRatio||1;A=[B[0]/Q,B[1]/Q,P.displaySize[0]-B[2]/Q,P.displaySize[1]-B[3]/Q]}var de,_e,Oe,nt,St=t.left*g,bt=t.right*g;r==="width"||r==="both"?(nt=f[0]+St-u[3],_e=f[0]+bt+u[1]):_e=(nt=f[0]+(St+bt-P.displaySize[0])/2)+P.displaySize[0];var Vt=t.top*g,Ut=t.bottom*g;return r==="height"||r==="both"?(de=f[1]+Vt-u[0],Oe=f[1]+Ut+u[2]):Oe=(de=f[1]+(Vt+Ut-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:de,right:_e,bottom:Oe,left:nt,collisionPadding:A}}zr[10]=!0,zr[32]=!0,zr[38]=!0,zr[40]=!0,zr[41]=!0,zr[43]=!0,zr[45]=!0,zr[47]=!0,zr[173]=!0,zr[183]=!0,zr[8203]=!0,zr[8208]=!0,zr[8211]=!0,zr[8231]=!0;var Mo=function(e){function t(r,u,f,g){e.call(this,r,u),this.angle=f,g!==void 0&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(q);function ti(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new bi(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,g=0;g<u.length&&u[g]<=e;)g++;for(var A=g=Math.max(0,g-1);A<u.length&&u[A]<e+1;)A++;A=Math.min(u.length-1,A);var P=u[g],B=u[A];return r.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:B,interpolationType:f}:{kind:"camera",minZoom:P,maxZoom:B,minSize:r.evaluate(new bi(P)),maxSize:r.evaluate(new bi(B)),interpolationType:f}}function jo(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?$a(f/128,r.upperSize/128,t.uSizeT):u}function Bi(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,g=f?Ce(gi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=$a(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:u}}bn("Anchor",Mo);var Ss=Object.freeze({__proto__:null,getSizeData:ti,evaluateSizeForFeature:jo,evaluateSizeForZoom:Bi,SIZE_PACK_FACTOR:128});function Ko(e,t,r,u,f){if(t.segment===void 0)return!0;for(var g=t,A=t.segment+1,P=0;P>-r/2;){if(--A<0)return!1;P-=e[A].dist(g),g=e[A]}P+=e[A].dist(e[A+1]),A++;for(var B=[],Q=0;P<r/2;){var de=e[A],_e=e[A+1];if(!_e)return!1;var Oe=e[A-1].angleTo(de)-de.angleTo(_e);for(Oe=Math.abs((Oe+3*Math.PI)%(2*Math.PI)-Math.PI),B.push({distance:P,angleDelta:Oe}),Q+=Oe;P-B[0].distance>u;)Q-=B.shift().angleDelta;if(Q>f)return!1;A++,P+=de.dist(_e)}return!0}function $o(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Po(e,t,r){return e?.6*t*r:0}function su(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Jo(e,t,r,u,f,g){for(var A=Po(r,f,g),P=su(r,u)*g,B=0,Q=$o(e)/2,de=0;de<e.length-1;de++){var _e=e[de],Oe=e[de+1],nt=_e.dist(Oe);if(B+nt>Q){var St=(Q-B)/nt,bt=$a(_e.x,Oe.x,St),Vt=$a(_e.y,Oe.y,St),Ut=new Mo(bt,Vt,Oe.angleTo(_e),de);return Ut._round(),!A||Ko(e,Ut,P,A,t)?Ut:void 0}B+=nt}}function ia(e,t,r,u,f,g,A,P,B){var Q=Po(u,g,A),de=su(u,f),_e=de*A,Oe=e[0].x===0||e[0].x===B||e[0].y===0||e[0].y===B;return t-_e<t/4&&(t=_e+t/4),function nt(St,bt,Vt,Ut,or,pr,Sr,Vr,Nr){for(var mn=pr/2,En=$o(St),Bn=0,ea=bt-Vt,kn=[],Nn=0;Nn<St.length-1;Nn++){for(var wa=St[Nn],ua=St[Nn+1],Jn=wa.dist(ua),mi=ua.angleTo(wa);ea+Vt<Bn+Jn;){var za=((ea+=Vt)-Bn)/Jn,Vi=$a(wa.x,ua.x,za),ga=$a(wa.y,ua.y,za);if(Vi>=0&&Vi<Nr&&ga>=0&&ga<Nr&&ea-mn>=0&&ea+mn<=En){var vi=new Mo(Vi,ga,mi,Nn);vi._round(),Ut&&!Ko(St,vi,pr,Ut,or)||kn.push(vi)}}Bn+=Jn}return Vr||kn.length||Sr||(kn=nt(St,Bn/2,Vt,Ut,or,pr,Sr,!0,Nr)),kn}(e,Oe?t/2*P%t:(de/2+2*g)*A*P%t,t,Q,r,_e,Oe,!1,B)}function uu(e,t,r,u,f){for(var g=[],A=0;A<e.length;A++)for(var P=e[A],B=void 0,Q=0;Q<P.length-1;Q++){var de=P[Q],_e=P[Q+1];de.x<t&&_e.x<t||(de.x<t?de=new q(t,de.y+(t-de.x)/(_e.x-de.x)*(_e.y-de.y))._round():_e.x<t&&(_e=new q(t,de.y+(t-de.x)/(_e.x-de.x)*(_e.y-de.y))._round()),de.y<r&&_e.y<r||(de.y<r?de=new q(de.x+(r-de.y)/(_e.y-de.y)*(_e.x-de.x),r)._round():_e.y<r&&(_e=new q(de.x+(r-de.y)/(_e.y-de.y)*(_e.x-de.x),r)._round()),de.x>=u&&_e.x>=u||(de.x>=u?de=new q(u,de.y+(u-de.x)/(_e.x-de.x)*(_e.y-de.y))._round():_e.x>=u&&(_e=new q(u,de.y+(u-de.x)/(_e.x-de.x)*(_e.y-de.y))._round()),de.y>=f&&_e.y>=f||(de.y>=f?de=new q(de.x+(f-de.y)/(_e.y-de.y)*(_e.x-de.x),f)._round():_e.y>=f&&(_e=new q(de.x+(f-de.y)/(_e.y-de.y)*(_e.x-de.x),f)._round()),B&&de.equals(B[B.length-1])||g.push(B=[de]),B.push(_e)))))}return g}function wi(e,t,r,u){var f=[],g=e.image,A=g.pixelRatio,P=g.paddedRect.w-2,B=g.paddedRect.h-2,Q=e.right-e.left,de=e.bottom-e.top,_e=g.stretchX||[[0,P]],Oe=g.stretchY||[[0,B]],nt=function(ga,vi){return ga+vi[1]-vi[0]},St=_e.reduce(nt,0),bt=Oe.reduce(nt,0),Vt=P-St,Ut=B-bt,or=0,pr=St,Sr=0,Vr=bt,Nr=0,mn=Vt,En=0,Bn=Ut;if(g.content&&u){var ea=g.content;or=Cn(_e,0,ea[0]),Sr=Cn(Oe,0,ea[1]),pr=Cn(_e,ea[0],ea[2]),Vr=Cn(Oe,ea[1],ea[3]),Nr=ea[0]-or,En=ea[1]-Sr,mn=ea[2]-ea[0]-pr,Bn=ea[3]-ea[1]-Vr}var kn=function(ga,vi,Ro,Qo){var cu=Qa(ga.stretch-or,pr,Q,e.left),ki=Lo(ga.fixed-Nr,mn,ga.stretch,St),As=Qa(vi.stretch-Sr,Vr,de,e.top),Zo=Lo(vi.fixed-En,Bn,vi.stretch,bt),ps=Qa(Ro.stretch-or,pr,Q,e.left),tl=Lo(Ro.fixed-Nr,mn,Ro.stretch,St),zs=Qa(Qo.stretch-Sr,Vr,de,e.top),hl=Lo(Qo.fixed-En,Bn,Qo.stretch,bt),Ou=new q(cu,As),ms=new q(ps,As),Bu=new q(ps,zs),Ei=new q(cu,zs),ji=new q(ki/A,Zo/A),co=new q(tl/A,hl/A),zi=t*Math.PI/180;if(zi){var rl=Math.sin(zi),Js=Math.cos(zi),Eo=[Js,-rl,rl,Js];Ou._matMult(Eo),ms._matMult(Eo),Ei._matMult(Eo),Bu._matMult(Eo)}var Qs=ga.stretch+ga.fixed,fo=vi.stretch+vi.fixed;return{tl:Ou,tr:ms,bl:Ei,br:Bu,tex:{x:g.paddedRect.x+1+Qs,y:g.paddedRect.y+1+fo,w:Ro.stretch+Ro.fixed-Qs,h:Qo.stretch+Qo.fixed-fo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ji,pixelOffsetBR:co,minFontScaleX:mn/A/Q,minFontScaleY:Bn/A/de,isSDF:r}};if(u&&(g.stretchX||g.stretchY))for(var Nn=ka(_e,Vt,St),wa=ka(Oe,Ut,bt),ua=0;ua<Nn.length-1;ua++)for(var Jn=Nn[ua],mi=Nn[ua+1],za=0;za<wa.length-1;za++)f.push(kn(Jn,wa[za],mi,wa[za+1]));else f.push(kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:B+1}));return f}function Cn(e,t,r){for(var u=0,f=0,g=e;f<g.length;f+=1){var A=g[f];u+=Math.max(t,Math.min(r,A[1]))-Math.max(t,Math.min(r,A[0]))}return u}function ka(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,g=e;f<g.length;f+=1){var A=g[f],P=A[0],B=A[1],Q=u[u.length-1];u.push({fixed:P-Q.stretch,stretch:Q.stretch}),u.push({fixed:P-Q.stretch,stretch:Q.stretch+(B-P)})}return u.push({fixed:t+1,stretch:r}),u}function Qa(e,t,r,u){return e/t*r+u}function Lo(e,t,r,u){return e-t*r/u}var Cu=function(t,r,u,f,g,A,P,B,Q,de){if(this.boxStartIndex=t.length,Q){var _e=A.top,Oe=A.bottom,nt=A.collisionPadding;nt&&(_e-=nt[1],Oe+=nt[3]);var St=Oe-_e;St>0&&(St=Math.max(10,St),this.circleDiameter=St)}else{var bt=A.top*P-B,Vt=A.bottom*P+B,Ut=A.left*P-B,or=A.right*P+B,pr=A.collisionPadding;if(pr&&(Ut-=pr[0]*P,bt-=pr[1]*P,or+=pr[2]*P,Vt+=pr[3]*P),de){var Sr=new q(Ut,bt),Vr=new q(or,bt),Nr=new q(Ut,Vt),mn=new q(or,Vt),En=de*Math.PI/180;Sr._rotate(En),Vr._rotate(En),Nr._rotate(En),mn._rotate(En),Ut=Math.min(Sr.x,Vr.x,Nr.x,mn.x),or=Math.max(Sr.x,Vr.x,Nr.x,mn.x),bt=Math.min(Sr.y,Vr.y,Nr.y,mn.y),Vt=Math.max(Sr.y,Vr.y,Nr.y,mn.y)}t.emplaceBack(r.x,r.y,Ut,bt,or,Vt,u,f,g)}this.boxEndIndex=t.length},Al=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=Ot),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Ot(e,t){return e<t?-1:e>t?1:0}function _r(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,g=-1/0,A=-1/0,P=e[0],B=0;B<P.length;B++){var Q=P[B];(!B||Q.x<u)&&(u=Q.x),(!B||Q.y<f)&&(f=Q.y),(!B||Q.x>g)&&(g=Q.x),(!B||Q.y>A)&&(A=Q.y)}var de=Math.min(g-u,A-f),_e=de/2,Oe=new Al([],br);if(de===0)return new q(u,f);for(var nt=u;nt<g;nt+=de)for(var St=f;St<A;St+=de)Oe.push(new On(nt+_e,St+_e,_e,e));for(var bt=function(or){for(var pr=0,Sr=0,Vr=0,Nr=or[0],mn=0,En=Nr.length,Bn=En-1;mn<En;Bn=mn++){var ea=Nr[mn],kn=Nr[Bn],Nn=ea.x*kn.y-kn.x*ea.y;Sr+=(ea.x+kn.x)*Nn,Vr+=(ea.y+kn.y)*Nn,pr+=3*Nn}return new On(Sr/pr,Vr/pr,0,or)}(e),Vt=Oe.length;Oe.length;){var Ut=Oe.pop();(Ut.d>bt.d||!bt.d)&&(bt=Ut,r&&console.log("found best %d after %d probes",Math.round(1e4*Ut.d)/1e4,Vt)),Ut.max-bt.d<=t||(Oe.push(new On(Ut.p.x-(_e=Ut.h/2),Ut.p.y-_e,_e,e)),Oe.push(new On(Ut.p.x+_e,Ut.p.y-_e,_e,e)),Oe.push(new On(Ut.p.x-_e,Ut.p.y+_e,_e,e)),Oe.push(new On(Ut.p.x+_e,Ut.p.y+_e,_e,e)),Vt+=4)}return r&&(console.log("num probes: "+Vt),console.log("best distance: "+bt.d)),bt.p}function br(e,t){return t.max-e.max}function On(e,t,r,u){this.p=new q(e,t),this.h=r,this.d=function(f,g){for(var A=!1,P=1/0,B=0;B<g.length;B++)for(var Q=g[B],de=0,_e=Q.length,Oe=_e-1;de<_e;Oe=de++){var nt=Q[de],St=Q[Oe];nt.y>f.y!=St.y>f.y&&f.x<(St.x-nt.x)*(f.y-nt.y)/(St.y-nt.y)+nt.x&&(A=!A),P=Math.min(P,Is(f,nt,St))}return(A?1:-1)*Math.sqrt(P)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}Al.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Al.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Al.prototype.peek=function(){return this.data[0]},Al.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,g=t[f];if(r(u,g)>=0)break;t[e]=g,e=f}t[e]=u},Al.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var g=1+(e<<1),A=t[g],P=g+1;if(P<this.length&&r(t[P],A)<0&&(g=P,A=t[P]),r(A,f)>=0)break;t[e]=A,e=g}t[e]=f};var Ra=Number.POSITIVE_INFINITY;function vt(e,t){return t[1]!==Ra?function(r,u,f){var g=0,A=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":A=f-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-f}switch(r){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,A]}(e,t[0],t[1]):function(r,u){var f=0,g=0;u<0&&(u=0);var A=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=A-7;break;case"bottom-right":case"bottom-left":g=7-A;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(r){case"top-right":case"bottom-right":f=-A;break;case"top-left":case"bottom-left":f=A;break;case"left":f=u;break;case"right":f=-u}return[f,g]}(e,t[0])}function Qe(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ht(e,t,r,u,f,g,A,P,B,Q,de,_e,Oe,nt,St){var bt=function(Sr,Vr,Nr,mn,En,Bn,ea,kn){for(var Nn=mn.layout.get("text-rotate").evaluate(Bn,{})*Math.PI/180,wa=[],ua=0,Jn=Vr.positionedLines;ua<Jn.length;ua+=1)for(var mi=Jn[ua],za=0,Vi=mi.positionedGlyphs;za<Vi.length;za+=1){var ga=Vi[za];if(ga.rect){var vi=ga.rect||{},Ro=4,Qo=!0,cu=1,ki=0,As=(En||kn)&&ga.vertical,Zo=ga.metrics.advance*ga.scale/2;if(kn&&Vr.verticalizable&&(ki=mi.lineOffset/2-(ga.imageName?-(24-ga.metrics.width*ga.scale)/2:24*(ga.scale-1))),ga.imageName){var ps=ea[ga.imageName];Qo=ps.sdf,Ro=1/(cu=ps.pixelRatio)}var tl=En?[ga.x+Zo,ga.y]:[0,0],zs=En?[0,0]:[ga.x+Zo+Nr[0],ga.y+Nr[1]-ki],hl=[0,0];As&&(hl=zs,zs=[0,0]);var Ou=(ga.metrics.left-Ro)*ga.scale-Zo+zs[0],ms=(-ga.metrics.top-Ro)*ga.scale+zs[1],Bu=Ou+vi.w*ga.scale/cu,Ei=ms+vi.h*ga.scale/cu,ji=new q(Ou,ms),co=new q(Bu,ms),zi=new q(Ou,Ei),rl=new q(Bu,Ei);if(As){var Js=new q(-Zo,Zo- -17),Eo=-Math.PI/2,Qs=12-Zo,fo=new q(22-Qs,-(ga.imageName?Qs:0)),Cs=new(Function.prototype.bind.apply(q,[null].concat(hl)));ji._rotateAround(Eo,Js)._add(fo)._add(Cs),co._rotateAround(Eo,Js)._add(fo)._add(Cs),zi._rotateAround(Eo,Js)._add(fo)._add(Cs),rl._rotateAround(Eo,Js)._add(fo)._add(Cs)}if(Nn){var Fc=Math.sin(Nn),Ff=Math.cos(Nn),Uc=[Ff,-Fc,Fc,Ff];ji._matMult(Uc),co._matMult(Uc),zi._matMult(Uc),rl._matMult(Uc)}var Mu=new q(0,0),Zf=new q(0,0);wa.push({tl:ji,tr:co,bl:zi,br:rl,tex:vi,writingMode:Vr.writingMode,glyphOffset:tl,sectionIndex:ga.sectionIndex,isSDF:Qo,pixelOffsetTL:Mu,pixelOffsetBR:Zf,minFontScaleX:0,minFontScaleY:0})}}return wa}(0,r,P,f,g,A,u,e.allowVerticalPlacement),Vt=e.textSizeData,Ut=null;Vt.kind==="source"?(Ut=[128*f.layout.get("text-size").evaluate(A,{})])[0]>32640&&Pe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Vt.kind==="composite"&&((Ut=[128*nt.compositeTextSizes[0].evaluate(A,{},St),128*nt.compositeTextSizes[1].evaluate(A,{},St)])[0]>32640||Ut[1]>32640)&&Pe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,bt,Ut,P,g,A,Q,t,B.lineStartIndex,B.lineLength,Oe,St);for(var or=0,pr=de;or<pr.length;or+=1)_e[pr[or]]=e.text.placedSymbolArray.length-1;return 4*bt.length}function lr(e){for(var t in e)return e[t];return null}function fr(e,t,r,u){var f=e.compareText;if(t in f){for(var g=f[t],A=g.length-1;A>=0;A--)if(u.dist(g[A])<r)return!0}else f[t]=[];return f[t].push(u),!1}var $t=Ha.VectorTileFeature.types,b=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function p(e,t,r,u,f,g,A,P,B,Q,de,_e,Oe){var nt=P?Math.min(32640,Math.round(P[0])):0,St=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),g,A,(nt<<1)+(B?1:0),St,16*Q,16*de,256*_e,256*Oe)}function c(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function d(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Ua(r[t].text))return!0;return!1}var v=function(t){this.layoutVertexArray=new ul,this.indexArray=new ll,this.programConfigurations=t,this.segments=new $e,this.dynamicLayoutVertexArray=new Mf,this.opacityVertexArray=new Gl,this.placedSymbolArray=new l};v.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},v.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ch.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,wh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,b,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},v.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},bn("SymbolBuffers",v);var L=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new $e,this.collisionVertexArray=new ju};L.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Df.members,!0)},L.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},bn("CollisionBuffers",L);var j=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ds([]),this.placementViewportMatrix=Ds([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ti(this.zoom,r["text-size"]),this.iconSizeData=ti(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&(u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement")),u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(A){return Xr[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=t.sourceID};j.prototype.createArrays=function(){this.text=new v(new Da(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new v(new Da(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new R,this.lineVertexArray=new k,this.symbolInstances=new O},j.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||u)&&f){var A=rh[e.charAt(g)];A&&(t[A.charCodeAt(0)]=!0)}},j.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,g=f.get("text-font"),A=f.get("text-field"),P=f.get("icon-image"),B=(A.value.kind!=="constant"||A.value.value instanceof Ti&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),Q=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,de=f.get("symbol-sort-key");if(this.features=[],B||Q){for(var _e=t.iconDependencies,Oe=t.glyphDependencies,nt=t.availableImages,St=new bi(this.zoom),bt=0,Vt=e;bt<Vt.length;bt+=1){var Ut=Vt[bt],or=Ut.feature,pr=Ut.id,Sr=Ut.index,Vr=Ut.sourceLayerIndex,Nr=u._featureFilter.needGeometry,mn={type:or.type,id:pr,properties:or.properties,geometry:Nr?xi(or):[]};if(u._featureFilter.filter(St,mn,r)){Nr||(mn.geometry=xi(or));var En=void 0;if(B){var Bn=u.getValueAndResolveTokens("text-field",mn,r,nt),ea=Ti.factory(Bn);d(ea)&&(this.hasRTLText=!0),(!this.hasRTLText||Ls()==="unavailable"||this.hasRTLText&&Ji.isParsed())&&(En=Oh(ea,u,mn))}var kn=void 0;if(Q){var Nn=u.getValueAndResolveTokens("icon-image",mn,r,nt);kn=Nn instanceof Io?Nn:Io.fromString(Nn)}if(En||kn){var wa=this.sortFeaturesByKey?de.evaluate(mn,{},r):void 0,ua={id:pr,text:En,icon:kn,index:Sr,sourceLayerIndex:Vr,geometry:xi(or),properties:or.properties,type:$t[or.type],sortKey:wa};if(this.features.push(ua),kn&&(_e[kn.name]=!0),En){var Jn=g.evaluate(mn,{},r).join(","),mi=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Xr.vertical)>=0;for(var za=0,Vi=En.sections;za<Vi.length;za+=1){var ga=Vi[za];if(ga.image)_e[ga.image.name]=!0;else{var vi=Si(En.toString()),Ro=ga.fontStack||Jn,Qo=Oe[Ro]=Oe[Ro]||{};this.calculateGlyphDependencies(ga.text,Qo,mi,this.allowVerticalPlacement,vi)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(cu){var ki={},As={},Zo=[],ps=0;function tl(Eo){Zo.push(cu[Eo]),ps++}function zs(Eo,Qs,fo){var Cs=As[Eo];return delete As[Eo],As[Qs]=Cs,Zo[Cs].geometry[0].pop(),Zo[Cs].geometry[0]=Zo[Cs].geometry[0].concat(fo[0]),Cs}function hl(Eo,Qs,fo){var Cs=ki[Qs];return delete ki[Qs],ki[Eo]=Cs,Zo[Cs].geometry[0].shift(),Zo[Cs].geometry[0]=fo[0].concat(Zo[Cs].geometry[0]),Cs}function Ou(Eo,Qs,fo){var Cs=fo?Qs[0][Qs[0].length-1]:Qs[0][0];return Eo+":"+Cs.x+":"+Cs.y}for(var ms=0;ms<cu.length;ms++){var Bu=cu[ms],Ei=Bu.geometry,ji=Bu.text?Bu.text.toString():null;if(ji){var co=Ou(ji,Ei),zi=Ou(ji,Ei,!0);if(co in As&&zi in ki&&As[co]!==ki[zi]){var rl=hl(co,zi,Ei),Js=zs(co,zi,Zo[rl].geometry);delete ki[co],delete As[zi],As[Ou(ji,Zo[Js].geometry,!0)]=Js,Zo[rl].geometry=null}else co in As?zs(co,zi,Ei):zi in ki?hl(co,zi,Ei):(tl(ms),ki[co]=ps-1,As[zi]=ps-1)}else tl(ms)}return Zo.filter(function(Eo){return Eo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(cu,ki){return cu.sortKey-ki.sortKey})}},j.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},j.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},j.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},j.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},j.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},j.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},j.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),g={},A=e.segment+1;A<t.length;A++)g[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:u},A<t.length-1&&(u+=t[A+1].dist(t[A]));for(var P=e.segment||0;P>=0;P--)g[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:f},P>0&&(f+=t[P-1].dist(t[P]));for(var B=0;B<t.length;B++){var Q=g[B];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},j.prototype.addSymbols=function(e,t,r,u,f,g,A,P,B,Q,de,_e){for(var Oe=e.indexArray,nt=e.layoutVertexArray,St=e.segments.prepareSegment(4*t.length,nt,Oe,g.sortKey),bt=this.glyphOffsetArray.length,Vt=St.vertexLength,Ut=this.allowVerticalPlacement&&A===Xr.vertical?Math.PI/2:0,or=g.text&&g.text.sections,pr=0;pr<t.length;pr++){var Sr=t[pr],Vr=Sr.tl,Nr=Sr.tr,mn=Sr.bl,En=Sr.br,Bn=Sr.tex,ea=Sr.pixelOffsetTL,kn=Sr.pixelOffsetBR,Nn=Sr.minFontScaleX,wa=Sr.minFontScaleY,ua=Sr.glyphOffset,Jn=Sr.isSDF,mi=Sr.sectionIndex,za=St.vertexLength,Vi=ua[1];p(nt,P.x,P.y,Vr.x,Vi+Vr.y,Bn.x,Bn.y,r,Jn,ea.x,ea.y,Nn,wa),p(nt,P.x,P.y,Nr.x,Vi+Nr.y,Bn.x+Bn.w,Bn.y,r,Jn,kn.x,ea.y,Nn,wa),p(nt,P.x,P.y,mn.x,Vi+mn.y,Bn.x,Bn.y+Bn.h,r,Jn,ea.x,kn.y,Nn,wa),p(nt,P.x,P.y,En.x,Vi+En.y,Bn.x+Bn.w,Bn.y+Bn.h,r,Jn,kn.x,kn.y,Nn,wa),c(e.dynamicLayoutVertexArray,P,Ut),Oe.emplaceBack(za,za+1,za+2),Oe.emplaceBack(za+1,za+2,za+3),St.vertexLength+=4,St.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ua[0]),pr!==t.length-1&&mi===t[pr+1].sectionIndex||e.programConfigurations.populatePaintArrays(nt.length,g,g.index,{},_e,or&&or[mi])}e.placedSymbolArray.emplaceBack(P.x,P.y,bt,this.glyphOffsetArray.length-bt,Vt,B,Q,P.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],A,0,!1,0,de)},j.prototype._addCollisionDebugVertex=function(e,t,r,u,f,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(g.x),Math.round(g.y))},j.prototype.addCollisionDebugVertices=function(e,t,r,u,f,g,A){var P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),B=P.vertexLength,Q=f.layoutVertexArray,de=f.collisionVertexArray,_e=A.anchorX,Oe=A.anchorY;this._addCollisionDebugVertex(Q,de,g,_e,Oe,new q(e,t)),this._addCollisionDebugVertex(Q,de,g,_e,Oe,new q(r,t)),this._addCollisionDebugVertex(Q,de,g,_e,Oe,new q(r,u)),this._addCollisionDebugVertex(Q,de,g,_e,Oe,new q(e,u)),P.vertexLength+=4;var nt=f.indexArray;nt.emplaceBack(B,B+1),nt.emplaceBack(B+1,B+2),nt.emplaceBack(B+2,B+3),nt.emplaceBack(B+3,B),P.primitiveLength+=4},j.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var g=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,u?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},j.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new L(pf,eh.members,Tl),this.iconCollisionBox=new L(pf,eh.members,Tl);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},j.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,g,A,P,B){for(var Q={},de=t;de<r;de++){var _e=e.get(de);Q.textBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},Q.textFeatureIndex=_e.featureIndex;break}for(var Oe=u;Oe<f;Oe++){var nt=e.get(Oe);Q.verticalTextBox={x1:nt.x1,y1:nt.y1,x2:nt.x2,y2:nt.y2,anchorPointX:nt.anchorPointX,anchorPointY:nt.anchorPointY},Q.verticalTextFeatureIndex=nt.featureIndex;break}for(var St=g;St<A;St++){var bt=e.get(St);Q.iconBox={x1:bt.x1,y1:bt.y1,x2:bt.x2,y2:bt.y2,anchorPointX:bt.anchorPointX,anchorPointY:bt.anchorPointY},Q.iconFeatureIndex=bt.featureIndex;break}for(var Vt=P;Vt<B;Vt++){var Ut=e.get(Vt);Q.verticalIconBox={x1:Ut.x1,y1:Ut.y1,x2:Ut.x2,y2:Ut.y2,anchorPointX:Ut.anchorPointX,anchorPointY:Ut.anchorPointY},Q.verticalIconFeatureIndex=Ut.featureIndex;break}return Q},j.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},j.prototype.hasTextData=function(){return this.text.segments.get().length>0},j.prototype.hasIconData=function(){return this.icon.segments.get().length>0},j.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},j.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},j.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},j.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},j.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],g=[],A=0;A<this.symbolInstances.length;++A){g.push(A);var P=this.symbolInstances.get(A);u.push(0|Math.round(t*P.anchorX+r*P.anchorY)),f.push(P.featureIndex)}return g.sort(function(B,Q){return u[B]-u[Q]||f[Q]-f[B]}),g},j.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},j.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(g,A,P){g>=0&&P.indexOf(g)===A&&t.addIndicesForPlacedSymbol(t.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},bn("SymbolBucket",j,{omit:["layers","collisionBoxArray","features","compareText"]}),j.MAX_GLYPHS=65535,j.addDynamicAttributes=c;var se=new Ui({"symbol-placement":new Vn(Ve.layout_symbol["symbol-placement"]),"symbol-spacing":new Vn(Ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Vn(Ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new la(Ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Vn(Ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Vn(Ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Vn(Ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new Vn(Ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Vn(Ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new la(Ve.layout_symbol["icon-size"]),"icon-text-fit":new Vn(Ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Vn(Ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new la(Ve.layout_symbol["icon-image"]),"icon-rotate":new la(Ve.layout_symbol["icon-rotate"]),"icon-padding":new Vn(Ve.layout_symbol["icon-padding"]),"icon-keep-upright":new Vn(Ve.layout_symbol["icon-keep-upright"]),"icon-offset":new la(Ve.layout_symbol["icon-offset"]),"icon-anchor":new la(Ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Vn(Ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Vn(Ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Vn(Ve.layout_symbol["text-rotation-alignment"]),"text-field":new la(Ve.layout_symbol["text-field"]),"text-font":new la(Ve.layout_symbol["text-font"]),"text-size":new la(Ve.layout_symbol["text-size"]),"text-max-width":new la(Ve.layout_symbol["text-max-width"]),"text-line-height":new Vn(Ve.layout_symbol["text-line-height"]),"text-letter-spacing":new la(Ve.layout_symbol["text-letter-spacing"]),"text-justify":new la(Ve.layout_symbol["text-justify"]),"text-radial-offset":new la(Ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Vn(Ve.layout_symbol["text-variable-anchor"]),"text-anchor":new la(Ve.layout_symbol["text-anchor"]),"text-max-angle":new Vn(Ve.layout_symbol["text-max-angle"]),"text-writing-mode":new Vn(Ve.layout_symbol["text-writing-mode"]),"text-rotate":new la(Ve.layout_symbol["text-rotate"]),"text-padding":new Vn(Ve.layout_symbol["text-padding"]),"text-keep-upright":new Vn(Ve.layout_symbol["text-keep-upright"]),"text-transform":new la(Ve.layout_symbol["text-transform"]),"text-offset":new la(Ve.layout_symbol["text-offset"]),"text-allow-overlap":new Vn(Ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Vn(Ve.layout_symbol["text-ignore-placement"]),"text-optional":new Vn(Ve.layout_symbol["text-optional"])}),oe={paint:new Ui({"icon-opacity":new la(Ve.paint_symbol["icon-opacity"]),"icon-color":new la(Ve.paint_symbol["icon-color"]),"icon-halo-color":new la(Ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new la(Ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new la(Ve.paint_symbol["icon-halo-blur"]),"icon-translate":new Vn(Ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new Vn(Ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new la(Ve.paint_symbol["text-opacity"]),"text-color":new la(Ve.paint_symbol["text-color"],{runtimeType:Kn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new la(Ve.paint_symbol["text-halo-color"]),"text-halo-width":new la(Ve.paint_symbol["text-halo-width"]),"text-halo-blur":new la(Ve.paint_symbol["text-halo-blur"]),"text-translate":new Vn(Ve.paint_symbol["text-translate"]),"text-translate-anchor":new Vn(Ve.paint_symbol["text-translate-anchor"])}),layout:se},le=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Tn,this.defaultValue=t};le.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},le.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},le.prototype.outputDefined=function(){return!1},le.prototype.serialize=function(){return null},bn("FormatSectionOverride",le,{omit:["defaultValue"]});var Tt=function(e){function t(r){e.call(this,r,oe)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var g=[],A=0,P=f;A<P.length;A+=1){var B=P[A];g.indexOf(B)<0&&g.push(B)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,g){var A=this.layout.get(r).evaluate(u,{},f,g),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||hc(P.value)||!A?A:function(B,Q){return Q.replace(/{([^{}]+)}/g,function(de,_e){return _e in B?String(B[_e]):""})}(u.properties,A)},t.prototype.createBucket=function(r){return new j(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=oe.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var g,A=this.paint.get(f),P=new le(A),B=new Ps(P,A.property.specification);g=A.value.kind==="constant"||A.value.kind==="source"?new Il("source",B):new ml("composite",B,A.value.zoomStops,A.value._interpolationType),this.paint._values[f]=new Vo(A.property,g,A.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),g=oe.paint.properties[u],A=!1,P=function(_e){for(var Oe=0,nt=_e;Oe<nt.length;Oe+=1)if(g.overrides&&g.overrides.hasOverride(nt[Oe]))return void(A=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Ti)P(f.value.value.sections);else if(f.value.kind==="source"){var B=function de(_e){A||(_e instanceof po&&pa(_e.value)===Mr?P(_e.value.sections):_e instanceof _i?P(_e.sections):_e.eachChild(de))},Q=f.value;Q._styleExpression&&B(Q._styleExpression.expression)}return A},t}(cs),Xt={paint:new Ui({"background-color":new Vn(Ve.paint_background["background-color"]),"background-pattern":new $u(Ve.paint_background["background-pattern"]),"background-opacity":new Vn(Ve.paint_background["background-opacity"])})},Kt=function(e){function t(r){e.call(this,r,Xt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(cs),tr={paint:new Ui({"raster-opacity":new Vn(Ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new Vn(Ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Vn(Ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Vn(Ve.paint_raster["raster-brightness-max"]),"raster-saturation":new Vn(Ve.paint_raster["raster-saturation"]),"raster-contrast":new Vn(Ve.paint_raster["raster-contrast"]),"raster-resampling":new Vn(Ve.paint_raster["raster-resampling"]),"raster-fade-duration":new Vn(Ve.paint_raster["raster-fade-duration"])})},Cr=function(e){function t(r){e.call(this,r,tr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(cs),Fr=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(cs),ln={circle:Ns,heatmap:ql,hillshade:ec,fill:ar,"fill-extrusion":bo,line:If,symbol:Tt,background:Kt,raster:Cr},hn=X.HTMLImageElement,$n=X.HTMLCanvasElement,sa=X.HTMLVideoElement,fa=X.ImageData,ja=X.ImageBitmap,_a=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};_a.prototype.update=function(e,t,r){var u=e.width,f=e.height,g=!(this.size&&this.size[0]===u&&this.size[1]===f||r),A=this.context,P=A.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||t.premultiply!==!1)),g)this.size=[u,f],e instanceof hn||e instanceof $n||e instanceof sa||e instanceof fa||ja&&e instanceof ja?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,u,f,0,this.format,P.UNSIGNED_BYTE,e.data);else{var B=r||{x:0,y:0},Q=B.x,de=B.y;e instanceof hn||e instanceof $n||e instanceof sa||e instanceof fa||ja&&e instanceof ja?P.texSubImage2D(P.TEXTURE_2D,0,Q,de,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,Q,de,u,f,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},_a.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},_a.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},_a.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ii=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};ii.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ii.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ka=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},xt(["receive","process"],this),this.invoker=new ii(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Wt()?t:X};function io(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}Ka.prototype.send=function(e,t,r,u,f){var g=this;f===void 0&&(f=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);var P=$(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:gu(t,P)},P),{cancel:function(){r&&delete g.callbacks[A],g.target.postMessage({id:A,type:"<cancel>",targetMapId:u,sourceMapId:g.mapId})}}},Ka.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Wt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Ka.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Ka.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(yu(t.error)):u(null,yu(t.data)))}else{var f=!1,g=$(this.globalScope)?void 0:[],A=t.hasCallback?function(de,_e){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:de?gu(de):null,data:gu(_e,g)},g)}:function(de){f=!0},P=null,B=yu(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,B,A);else if(this.parent.getWorkerSource){var Q=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,Q[0],B.source)[Q[1]](B,A)}else A(new Error("Could not find function "+t.type));!f&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},Ka.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ca=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ca.prototype.setNorthEast=function(e){return this._ne=e instanceof Ba?new Ba(e.lng,e.lat):Ba.convert(e),this},Ca.prototype.setSouthWest=function(e){return this._sw=e instanceof Ba?new Ba(e.lng,e.lat):Ba.convert(e),this},Ca.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof Ba)t=e,r=e;else{if(!(e instanceof Ca))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ca.convert(e)):this.extend(Ba.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new Ba(t.lng,t.lat),this._ne=new Ba(r.lng,r.lat)),this},Ca.prototype.getCenter=function(){return new Ba((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ca.prototype.getSouthWest=function(){return this._sw},Ca.prototype.getNorthEast=function(){return this._ne},Ca.prototype.getNorthWest=function(){return new Ba(this.getWest(),this.getNorth())},Ca.prototype.getSouthEast=function(){return new Ba(this.getEast(),this.getSouth())},Ca.prototype.getWest=function(){return this._sw.lng},Ca.prototype.getSouth=function(){return this._sw.lat},Ca.prototype.getEast=function(){return this._ne.lng},Ca.prototype.getNorth=function(){return this._ne.lat},Ca.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ca.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ca.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ca.prototype.contains=function(e){var t=Ba.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Ca.convert=function(e){return!e||e instanceof Ca?e:new Ca(e)};var Ba=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ba.prototype.wrap=function(){return new Ba(ht(this.lng,-180,180),this.lat)},Ba.prototype.toArray=function(){return[this.lng,this.lat]},Ba.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ba.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Ba.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Ca(new Ba(this.lng-r,this.lat-t),new Ba(this.lng+r,this.lat+t))},Ba.convert=function(e){if(e instanceof Ba)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ba(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ba(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ac=2*Math.PI*63710088e-1;function ic(e){return ac*Math.cos(e*Math.PI/180)}function lu(e){return(180+e)/360}function Cl(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function nh(e,t){return e/ic(t)}function jc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var wl=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};wl.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Ba.convert(e);return new wl(lu(r.lng),Cl(r.lat),nh(t,r.lat))},wl.prototype.toLngLat=function(){return new Ba(360*this.x-180,jc(this.y))},wl.prototype.toAltitude=function(){return this.z*ic(jc(this.y))},wl.prototype.meterInMercatorCoordinateUnits=function(){return 1/ac*(e=jc(this.y),1/Math.cos(e*Math.PI/180));var e};var js=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=wu(0,t,t,r,u)};js.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},js.prototype.url=function(e,t){var r,u,f,g,A,P=(u=this.y,f=this.z,g=io(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),A=io(256*(r+1),256*(u+1),f),g[0]+","+g[1]+","+A[0]+","+A[1]),B=function(Q,de,_e){for(var Oe,nt="",St=Q;St>0;St--)nt+=(de&(Oe=1<<St-1)?1:0)+(_e&Oe?2:0);return nt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",B).replace("{bbox-epsg-3857}",P)},js.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new q(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},js.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var kf=function(t,r){this.wrap=t,this.canonical=r,this.key=wu(t,r.z,r.z,r.x,r.y)},oo=function(t,r,u,f,g){this.overscaledZ=t,this.wrap=r,this.canonical=new js(u,+f,+g),this.key=wu(r,t,u,f,g)};function wu(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*f+u).toString(36)+r.toString(36)+t.toString(36)}oo.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},oo.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new oo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new oo(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},oo.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?wu(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):wu(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},oo.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},oo.prototype.children=function(e){if(this.overscaledZ>=e)return[new oo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new oo(t,this.wrap,t,r,u),new oo(t,this.wrap,t,r+1,u),new oo(t,this.wrap,t,r,u+1),new oo(t,this.wrap,t,r+1,u+1)]},oo.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},oo.prototype.wrapped=function(){return new oo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},oo.prototype.unwrapTo=function(e){return new oo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},oo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},oo.prototype.toUnwrapped=function(){return new kf(this.wrap,this.canonical)},oo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},oo.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new wl(e.x-this.wrap,e.y))},bn("CanonicalTileID",js),bn("OverscaledTileID",oo,{omit:["posMatrix"]});var Uu=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Pe('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var g=0;g<f;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(f,g)]=this.data[this._idx(f-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,f)]=this.data[this._idx(g,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Uu.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},Uu.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Uu.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Uu.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Uu.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Uu.prototype.getPixels=function(){return new Ho({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Uu.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,g=r*this.dim,A=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:g=A-1;break;case 1:A=g+1}for(var P=-t*this.dim,B=-r*this.dim,Q=g;Q<A;Q++)for(var de=u;de<f;de++)this.data[this._idx(de,Q)]=e.data[this._idx(de+P,Q+B)]},bn("DEMData",Uu);var jf=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};jf.prototype.encode=function(e){return this._stringToNumber[e]},jf.prototype.decode=function(e){return this._numberToString[e]};var lo=function(t,r,u,f,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=g},fl={geometry:{configurable:!0}};fl.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},fl.geometry.set=function(e){this._geometry=e},lo.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(lo.prototype,fl);var zf=function(){this.state={},this.stateChanges={},this.deletedStates={}};zf.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Ne(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var g in this.deletedStates[e][u]={},this.state[e][u])r[g]||(this.deletedStates[e][u][g]=null);else for(var A in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][A]===null&&delete this.deletedStates[e][u][A]},zf.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},zf.prototype.getState=function(e,t){var r=String(t),u=Ne({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var g in f)delete u[g]}return u},zf.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},zf.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),Ne(this.state[u][g],this.stateChanges[u][g]),f[g]=this.state[u][g];r[u]=f}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var P={};if(this.deletedStates[A]===null)for(var B in this.state[A])P[B]={},this.state[A][B]={};else for(var Q in this.deletedStates[A]){if(this.deletedStates[A][Q]===null)this.state[A][Q]={};else for(var de=0,_e=Object.keys(this.deletedStates[A][Q]);de<_e.length;de+=1)delete this.state[A][Q][_e[de]];P[Q]=this.state[A][Q]}r[A]=r[A]||{},Ne(r[A],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Oe in e)e[Oe].setFeatureState(r,t)};var zc=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new oi(8192,16,0),this.grid3D=new oi(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function Gh(e,t,r,u,f){return Ie(e,function(g,A){var P=t instanceof xl?t.get(A):null;return P&&P.evaluate?P.evaluate(r,u,f):P})}function xc(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,g=0,A=e;g<A.length;g+=1){var P=A[g];t=Math.min(t,P.x),r=Math.min(r,P.y),u=Math.max(u,P.x),f=Math.max(f,P.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ch(e,t){return t-e}zc.prototype.insert=function(e,t,r,u,f,g){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var P=g?this.grid3D:this.grid,B=0;B<t.length;B++){for(var Q=t[B],de=[1/0,1/0,-1/0,-1/0],_e=0;_e<Q.length;_e++){var Oe=Q[_e];de[0]=Math.min(de[0],Oe.x),de[1]=Math.min(de[1],Oe.y),de[2]=Math.max(de[2],Oe.x),de[3]=Math.max(de[3],Oe.y)}de[0]<8192&&de[1]<8192&&de[2]>=0&&de[3]>=0&&P.insert(A,de[0],de[1],de[2],de[3])}},zc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ha.VectorTile(new lh(this.rawTileData)).layers,this.sourceLayerCoder=new jf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},zc.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var g=e.params||{},A=8192/e.tileSize/e.scale,P=Yu(g.filter),B=e.queryGeometry,Q=e.queryPadding*A,de=xc(B),_e=this.grid.query(de.minX-Q,de.minY-Q,de.maxX+Q,de.maxY+Q),Oe=xc(e.cameraQueryGeometry),nt=this.grid3D.query(Oe.minX-Q,Oe.minY-Q,Oe.maxX+Q,Oe.maxY+Q,function(Sr,Vr,Nr,mn){return function(En,Bn,ea,kn,Nn){for(var wa=0,ua=En;wa<ua.length;wa+=1){var Jn=ua[wa];if(Bn<=Jn.x&&ea<=Jn.y&&kn>=Jn.x&&Nn>=Jn.y)return!0}var mi=[new q(Bn,ea),new q(Bn,Nn),new q(kn,Nn),new q(kn,ea)];if(En.length>2){for(var za=0,Vi=mi;za<Vi.length;za+=1)if(Su(En,Vi[za]))return!0}for(var ga=0;ga<En.length-1;ga++)if(Yl(En[ga],En[ga+1],mi))return!0;return!1}(e.cameraQueryGeometry,Sr-Q,Vr-Q,Nr+Q,mn+Q)}),St=0,bt=nt;St<bt.length;St+=1)_e.push(bt[St]);_e.sort(ch);for(var Vt,Ut={},or=function(Vr){var Nr=_e[Vr];if(Nr!==Vt){Vt=Nr;var mn=f.featureIndexArray.get(Nr),En=null;f.loadMatchingFeature(Ut,mn.bucketIndex,mn.sourceLayerIndex,mn.featureIndex,P,g.layers,g.availableImages,t,r,u,function(Bn,ea,kn){return En||(En=xi(Bn)),ea.queryIntersectsFeature(B,Bn,kn,En,f.z,e.transform,A,e.pixelPosMatrix)})}},pr=0;pr<_e.length;pr++)or(pr);return Ut},zc.prototype.loadMatchingFeature=function(e,t,r,u,f,g,A,P,B,Q,de){var _e=this.bucketLayerIDs[t];if(!g||function(mn,En){for(var Bn=0;Bn<mn.length;Bn++)if(En.indexOf(mn[Bn])>=0)return!0;return!1}(g,_e)){var Oe=this.sourceLayerCoder.decode(r),nt=this.vtLayers[Oe].feature(u);if(f.filter(new bi(this.tileID.overscaledZ),nt))for(var St=this.getId(nt,Oe),bt=0;bt<_e.length;bt++){var Vt=_e[bt];if(!(g&&g.indexOf(Vt)<0)){var Ut=P[Vt];if(Ut){var or={};St!==void 0&&Q&&(or=Q.getState(Ut.sourceLayer||"_geojsonTileLayer",St));var pr=B[Vt];pr.paint=Gh(pr.paint,Ut.paint,nt,or,A),pr.layout=Gh(pr.layout,Ut.layout,nt,or,A);var Sr=!de||de(nt,Ut,or);if(Sr){var Vr=new lo(nt,this.z,this.x,this.y,St);Vr.layer=pr;var Nr=e[Vt];Nr===void 0&&(Nr=e[Vt]=[]),Nr.push({featureIndex:u,feature:Vr,intersectionZ:Sr})}}}}}},zc.prototype.lookupSymbolFeatures=function(e,t,r,u,f,g,A,P){var B={};this.loadVTLayers();for(var Q=Yu(f),de=0,_e=e;de<_e.length;de+=1)this.loadMatchingFeature(B,r,u,_e[de],Q,g,A,P,t);return B},zc.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},zc.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},bn("FeatureIndex",zc,{omit:["rawTileData","sourceLayerCoder"]});var $s=function(t,r){this.tileID=t,this.uid=He(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};$s.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ye.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},$s.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},$s.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(Q,de){var _e={};if(!de)return _e;for(var Oe=function(){var Vt=St[nt],Ut=Vt.layerIds.map(function(Sr){return de.getLayer(Sr)}).filter(Boolean);if(Ut.length!==0){Vt.layers=Ut,Vt.stateDependentLayerIds&&(Vt.stateDependentLayers=Vt.stateDependentLayerIds.map(function(Sr){return Ut.filter(function(Vr){return Vr.id===Sr})[0]}));for(var or=0,pr=Ut;or<pr.length;or+=1)_e[pr[or].id]=Vt}},nt=0,St=Q;nt<St.length;nt+=1)Oe();return _e}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof j){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var A=this.buckets[g];if(A instanceof j&&A.hasRTLText){this.hasRTLText=!0,Ji.isLoading()||Ji.isLoaded()||Ls()!=="deferred"||Yo();break}}for(var P in this.queryPadding=0,this.buckets){var B=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(B))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},$s.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},$s.prototype.getBucket=function(e){return this.buckets[e.id]},$s.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _a(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _a(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},$s.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},$s.prototype.queryRenderedFeatures=function(e,t,r,u,f,g,A,P,B,Q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:g,tileSize:this.tileSize,pixelPosMatrix:Q,transform:P,params:A,queryPadding:this.queryPadding*B},e,t,r):{}},$s.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",g=u._geojsonTileLayer||u[f];if(g)for(var A=Yu(t&&t.filter),P=this.tileID.canonical,B=P.z,Q=P.x,de=P.y,_e={z:B,x:Q,y:de},Oe=0;Oe<g.length;Oe++){var nt=g.feature(Oe);if(A.filter(new bi(this.tileID.overscaledZ),nt)){var St=r.getId(nt,f),bt=new lo(nt,B,Q,de,St);bt.tile=_e,e.push(bt)}}}},$s.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},$s.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},$s.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=sr(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var g=this.expirationTime-t;g?this.expirationTime=u+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},$s.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},$s.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],g=f.layers[0].sourceLayer||"_geojsonTileLayer",A=r[g],P=e[g];if(A&&P&&Object.keys(P).length!==0){f.update(P,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var B=t&&t.style&&t.style.getLayer(u);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(f)))}}}},$s.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},$s.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ye.now()},$s.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},$s.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ye.now()+e},$s.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},$s.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var g=0,A=t;g<A.length;g+=1)if(f[A[g]])return!0}}return!1};var ah=X.performance,gh=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},ah.mark(this._marks.start)};gh.prototype.finish=function(){ah.mark(this._marks.end);var e=ah.getEntriesByName(this._marks.measure);return e.length===0&&(ah.measure(this._marks.measure,this._marks.start,this._marks.end),e=ah.getEntriesByName(this._marks.measure),ah.clearMarks(this._marks.start),ah.clearMarks(this._marks.end),ah.clearMeasures(this._marks.measure)),e},o.Actor=Ka,o.AlphaImage=Ys,o.CanonicalTileID=js,o.CollisionBoxArray=a,o.Color=In,o.DEMData=Uu,o.DataConstantProperty=Vn,o.DictionaryCoder=jf,o.EXTENT=8192,o.ErrorEvent=rt,o.EvaluationParameters=bi,o.Event=pe,o.Evented=yt,o.FeatureIndex=zc,o.FillBucket=Te,o.FillExtrusionBucket=pi,o.ImageAtlas=Gr,o.ImagePosition=$r,o.LineBucket=Ks,o.LngLat=Ba,o.LngLatBounds=Ca,o.MercatorCoordinate=wl,o.ONE_EM=24,o.OverscaledTileID=oo,o.Point=q,o.Point$1=q,o.Properties=Ui,o.Protobuf=lh,o.RGBAImage=Ho,o.RequestManager=I,o.RequestPerformance=gh,o.ResourceType=Zr,o.SegmentVector=$e,o.SourceFeatureState=zf,o.StructArrayLayout1ui2=Wl,o.StructArrayLayout2f1f2i16=Ts,o.StructArrayLayout2i4=Eu,o.StructArrayLayout3ui6=ll,o.StructArrayLayout4i8=Vl,o.SymbolBucket=j,o.Texture=_a,o.Tile=$s,o.Transitionable=vo,o.Uniform1f=Kr,o.Uniform1i=Or,o.Uniform2f=Qr,o.Uniform3f=dn,o.Uniform4f=wn,o.UniformColor=ra,o.UniformMatrix4f=Ta,o.UnwrappedTileID=kf,o.ValidationError=ct,o.WritingMode=Xr,o.ZoomHistory=bu,o.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},o.addDynamicAttributes=c,o.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),g=null;e.forEach(function(A,P){t(A,function(B,Q){B&&(g=B),f[P]=Q,--u==0&&r(g,f)})})},o.bezier=Ge,o.bindAll=xt,o.browser=ye,o.cacheEntryPossiblyAdded=function(e){++kt>pt&&(e.getActor().send("enforceCacheSizeLimit",Ct),kt=0)},o.clamp=Ce,o.clearTileCache=function(e){var t=X.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},o.clipLine=uu,o.clone=function(e){var t=new Oo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.clone$1=ze,o.clone$2=function(e){var t=new Oo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.collisionCircleLayout=th,o.config=be,o.create=function(){var e=new Oo(16);return Oo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new Oo(9);return Oo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new Oo(4);return Oo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=W,o.createExpression=Fo,o.createLayout=Ni,o.createStyleLayer=function(e){return e.type==="custom"?new Fr(e):new ln[e.type](e)},o.cross=function(e,t,r){var u=t[0],f=t[1],g=t[2],A=r[0],P=r[1],B=r[2];return e[0]=f*B-g*P,e[1]=g*A-u*B,e[2]=u*P-f*A,e},o.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.ease=ge,o.emitValidationErrors=yl,o.endsWith=_t,o.enforceCacheSizeLimit=function(e){we(),Ze&&Ze.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},o.evaluateSizeForFeature=jo,o.evaluateSizeForZoom=Bi,o.evaluateVariableOffset=vt,o.evented=Ul,o.extend=Ne,o.featureFilter=Yu,o.filterObject=De,o.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=Na,o.getAnchorJustification=Qe,o.getArrayBuffer=Zn,o.getImage=F,o.getJSON=function(e,t){return ma(Ne(e,{type:"json"}),t)},o.getRTLTextPluginStatus=Ls,o.getReferrer=jn,o.getVideo=function(e,t){var r,u,f=X.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var g=0;g<e.length;g++){var A=X.document.createElement("source");r=e[g],u=void 0,(u=X.document.createElement("a")).href=r,(u.protocol!==X.document.location.protocol||u.host!==X.document.location.host)&&(f.crossOrigin="Anonymous"),A.src=e[g],f.appendChild(A)}return{cancel:function(){}}},o.identity=Ds,o.invert=function(e,t){var r=t[0],u=t[1],f=t[2],g=t[3],A=t[4],P=t[5],B=t[6],Q=t[7],de=t[8],_e=t[9],Oe=t[10],nt=t[11],St=t[12],bt=t[13],Vt=t[14],Ut=t[15],or=r*P-u*A,pr=r*B-f*A,Sr=r*Q-g*A,Vr=u*B-f*P,Nr=u*Q-g*P,mn=f*Q-g*B,En=de*bt-_e*St,Bn=de*Vt-Oe*St,ea=de*Ut-nt*St,kn=_e*Vt-Oe*bt,Nn=_e*Ut-nt*bt,wa=Oe*Ut-nt*Vt,ua=or*wa-pr*Nn+Sr*kn+Vr*ea-Nr*Bn+mn*En;return ua?(e[0]=(P*wa-B*Nn+Q*kn)*(ua=1/ua),e[1]=(f*Nn-u*wa-g*kn)*ua,e[2]=(bt*mn-Vt*Nr+Ut*Vr)*ua,e[3]=(Oe*Nr-_e*mn-nt*Vr)*ua,e[4]=(B*ea-A*wa-Q*Bn)*ua,e[5]=(r*wa-f*ea+g*Bn)*ua,e[6]=(Vt*Sr-St*mn-Ut*pr)*ua,e[7]=(de*mn-Oe*Sr+nt*pr)*ua,e[8]=(A*Nn-P*ea+Q*En)*ua,e[9]=(u*ea-r*Nn-g*En)*ua,e[10]=(St*Nr-bt*Sr+Ut*or)*ua,e[11]=(_e*Sr-de*Nr-nt*or)*ua,e[12]=(P*Bn-A*kn-B*En)*ua,e[13]=(r*kn-u*Bn+f*En)*ua,e[14]=(bt*pr-St*Vr-Vt*or)*ua,e[15]=(de*Vr-_e*pr+Oe*or)*ua,e):null},o.isChar=Sn,o.isMapboxURL=J,o.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},o.makeRequest=ma,o.mapObject=Ie,o.mercatorXfromLng=lu,o.mercatorYfromLat=Cl,o.mercatorZfromAltitude=nh,o.mul=Zs,o.multiply=rs,o.mvt=Ha,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],g=r*r+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},o.number=$a,o.offscreenCanvasSupported=yr,o.ortho=function(e,t,r,u,f,g,A){var P=1/(t-r),B=1/(u-f),Q=1/(g-A);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*B,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*Q,e[11]=0,e[12]=(t+r)*P,e[13]=(f+u)*B,e[14]=(A+g)*Q,e[15]=1,e},o.parseGlyphPBF=function(e){return new lh(e).readFields(tn,[])},o.pbf=lh,o.performSymbolLayout=function(e,t,r,u,f,g,A){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,B=e.layers[0]._unevaluatedLayout._values,Q={};if(e.textSizeData.kind==="composite"){var de=e.textSizeData,_e=de.maxZoom;Q.compositeTextSizes=[B["text-size"].possiblyEvaluate(new bi(de.minZoom),A),B["text-size"].possiblyEvaluate(new bi(_e),A)]}if(e.iconSizeData.kind==="composite"){var Oe=e.iconSizeData,nt=Oe.maxZoom;Q.compositeIconSizes=[B["icon-size"].possiblyEvaluate(new bi(Oe.minZoom),A),B["icon-size"].possiblyEvaluate(new bi(nt),A)]}Q.layoutTextSize=B["text-size"].possiblyEvaluate(new bi(e.zoom+1),A),Q.layoutIconSize=B["icon-size"].possiblyEvaluate(new bi(e.zoom+1),A),Q.textMaxSize=B["text-size"].possiblyEvaluate(new bi(18));for(var St=24*P.get("text-line-height"),bt=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",Vt=P.get("text-keep-upright"),Ut=P.get("text-size"),or=function(){var Nr=Sr[pr],mn=P.get("text-font").evaluate(Nr,{},A).join(","),En=Ut.evaluate(Nr,{},A),Bn=Q.layoutTextSize.evaluate(Nr,{},A),ea=Q.layoutIconSize.evaluate(Nr,{},A),kn={horizontal:{},vertical:void 0},Nn=Nr.text,wa=[0,0];if(Nn){var ua=Nn.toString(),Jn=24*P.get("text-letter-spacing").evaluate(Nr,{},A),mi=function(Ei){for(var ji=0,co=Ei;ji<co.length;ji+=1)if(zi=co[ji].charCodeAt(0),Sn.Arabic(zi)||Sn["Arabic Supplement"](zi)||Sn["Arabic Extended-A"](zi)||Sn["Arabic Presentation Forms-A"](zi)||Sn["Arabic Presentation Forms-B"](zi))return!1;var zi;return!0}(ua)?Jn:0,za=P.get("text-anchor").evaluate(Nr,{},A),Vi=P.get("text-variable-anchor");if(!Vi){var ga=P.get("text-radial-offset").evaluate(Nr,{},A);wa=ga?vt(za,[24*ga,Ra]):P.get("text-offset").evaluate(Nr,{},A).map(function(Ei){return 24*Ei})}var vi=bt?"center":P.get("text-justify").evaluate(Nr,{},A),Ro=P.get("symbol-placement"),Qo=Ro==="point"?24*P.get("text-max-width").evaluate(Nr,{},A):0,cu=function(){e.allowVerticalPlacement&&Si(ua)&&(kn.vertical=fn(Nn,t,r,f,mn,Qo,St,za,"left",mi,wa,Xr.vertical,!0,Ro,Bn,En))};if(!bt&&Vi){for(var ki=vi==="auto"?Vi.map(function(Ei){return Qe(Ei)}):[vi],As=!1,Zo=0;Zo<ki.length;Zo++){var ps=ki[Zo];if(!kn.horizontal[ps])if(As)kn.horizontal[ps]=kn.horizontal[0];else{var tl=fn(Nn,t,r,f,mn,Qo,St,"center",ps,mi,wa,Xr.horizontal,!1,Ro,Bn,En);tl&&(kn.horizontal[ps]=tl,As=tl.positionedLines.length===1)}}cu()}else{vi==="auto"&&(vi=Qe(za));var zs=fn(Nn,t,r,f,mn,Qo,St,za,vi,mi,wa,Xr.horizontal,!1,Ro,Bn,En);zs&&(kn.horizontal[vi]=zs),cu(),Si(ua)&&bt&&Vt&&(kn.vertical=fn(Nn,t,r,f,mn,Qo,St,za,vi,mi,wa,Xr.vertical,!1,Ro,Bn,En))}}var hl=void 0,Ou=!1;if(Nr.icon&&Nr.icon.name){var ms=u[Nr.icon.name];ms&&(hl=function(Ei,ji,co){var zi=Na(co),rl=ji[0]-Ei.displaySize[0]*zi.horizontalAlign,Js=ji[1]-Ei.displaySize[1]*zi.verticalAlign;return{image:Ei,top:Js,bottom:Js+Ei.displaySize[1],left:rl,right:rl+Ei.displaySize[0]}}(f[Nr.icon.name],P.get("icon-offset").evaluate(Nr,{},A),P.get("icon-anchor").evaluate(Nr,{},A)),Ou=ms.sdf,e.sdfIcons===void 0?e.sdfIcons=ms.sdf:e.sdfIcons!==ms.sdf&&Pe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ms.pixelRatio!==e.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Bu=lr(kn.horizontal)||kn.vertical;e.iconsInText=!!Bu&&Bu.iconsInText,(Bu||hl)&&function(Ei,ji,co,zi,rl,Js,Eo,Qs,fo,Cs,Fc){var Ff=Js.textMaxSize.evaluate(ji,{});Ff===void 0&&(Ff=Eo);var Uc,Mu=Ei.layers[0].layout,Zf=Mu.get("icon-offset").evaluate(ji,{},Fc),ih=lr(co.horizontal),Xf=Eo/24,Mh=Ei.tilePixelRatio*Xf,Yf=Ei.tilePixelRatio*Ff/24,Ph=Ei.tilePixelRatio*Qs,Lh=Ei.tilePixelRatio*Mu.get("symbol-spacing"),yh=Mu.get("text-padding")*Ei.tilePixelRatio,fh=Mu.get("icon-padding")*Ei.tilePixelRatio,Rh=Mu.get("text-max-angle")/180*Math.PI,Qh=Mu.get("text-rotation-alignment")==="map"&&Mu.get("symbol-placement")!=="point",hh=Mu.get("icon-rotation-alignment")==="map"&&Mu.get("symbol-placement")!=="point",Ih=Mu.get("symbol-placement"),ad=Lh/2,Dh=Mu.get("icon-text-fit");zi&&Dh!=="none"&&(Ei.allowVerticalPlacement&&co.vertical&&(Uc=Wo(zi,co.vertical,Dh,Mu.get("icon-text-fit-padding"),Zf,Xf)),ih&&(zi=Wo(zi,ih,Dh,Mu.get("icon-text-fit-padding"),Zf,Xf)));var dh=function(cd,Yh){Yh.x<0||Yh.x>=8192||Yh.y<0||Yh.y>=8192||function(vs,Ef,fd,Kf,td,ud,rd,h,S,_,x,C,M,U,re,me,Fe,Pt,Jt,Ir,Pr,gn,Pn,Rn,Oa){var qa,ci,ri,fi,ho,La=vs.addToLineVertexArray(Ef,fd),zo=0,ns=0,qs=0,ei=0,gs=-1,Xo=-1,dl={},Kh=Dt(""),ph=0,mh=0;if(h._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ph=(qa=h.layout.get("text-offset").evaluate(Pr,{},Rn).map(function(Ed){return 24*Ed}))[0],mh=qa[1]):(ph=24*h.layout.get("text-radial-offset").evaluate(Pr,{},Rn),mh=Ra),vs.allowVerticalPlacement&&Kf.vertical){var Ah=h.layout.get("text-rotate").evaluate(Pr,{},Rn)+90;fi=new Cu(S,Ef,_,x,C,Kf.vertical,M,U,re,Ah),rd&&(ho=new Cu(S,Ef,_,x,C,rd,Fe,Pt,re,Ah))}if(td){var af=h.layout.get("icon-rotate").evaluate(Pr,{}),hd=h.layout.get("icon-text-fit")!=="none",dd=wi(td,af,Pn,hd),ld=rd?wi(rd,af,Pn,hd):void 0;ri=new Cu(S,Ef,_,x,C,td,Fe,Pt,!1,af),zo=4*dd.length;var pd=vs.iconSizeData,$h=null;pd.kind==="source"?($h=[128*h.layout.get("icon-size").evaluate(Pr,{})])[0]>32640&&Pe(vs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&(($h=[128*gn.compositeIconSizes[0].evaluate(Pr,{},Rn),128*gn.compositeIconSizes[1].evaluate(Pr,{},Rn)])[0]>32640||$h[1]>32640)&&Pe(vs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),vs.addSymbols(vs.icon,dd,$h,Ir,Jt,Pr,!1,Ef,La.lineStartIndex,La.lineLength,-1,Rn),gs=vs.icon.placedSymbolArray.length-1,ld&&(ns=4*ld.length,vs.addSymbols(vs.icon,ld,$h,Ir,Jt,Pr,Xr.vertical,Ef,La.lineStartIndex,La.lineLength,-1,Rn),Xo=vs.icon.placedSymbolArray.length-1)}for(var md in Kf.horizontal){var nd=Kf.horizontal[md];if(!ci){Kh=Dt(nd.text);var yd=h.layout.get("text-rotate").evaluate(Pr,{},Rn);ci=new Cu(S,Ef,_,x,C,nd,M,U,re,yd)}var vd=nd.positionedLines.length===1;if(qs+=Ht(vs,Ef,nd,ud,h,re,Pr,me,La,Kf.vertical?Xr.horizontal:Xr.horizontalOnly,vd?Object.keys(Kf.horizontal):[md],dl,gs,gn,Rn),vd)break}Kf.vertical&&(ei+=Ht(vs,Ef,Kf.vertical,ud,h,re,Pr,me,La,Xr.vertical,["vertical"],dl,Xo,gn,Rn));var Va=ci?ci.boxStartIndex:vs.collisionBoxArray.length,eo=ci?ci.boxEndIndex:vs.collisionBoxArray.length,hi=fi?fi.boxStartIndex:vs.collisionBoxArray.length,Dn=fi?fi.boxEndIndex:vs.collisionBoxArray.length,Bc=ri?ri.boxStartIndex:vs.collisionBoxArray.length,ys=ri?ri.boxEndIndex:vs.collisionBoxArray.length,of=ho?ho.boxStartIndex:vs.collisionBoxArray.length,sf=ho?ho.boxEndIndex:vs.collisionBoxArray.length,oc=-1,Jh=function(bd,Td){return bd&&bd.circleDiameter?Math.max(bd.circleDiameter,Td):Td};oc=Jh(ci,oc),oc=Jh(fi,oc),oc=Jh(ri,oc);var xd=(oc=Jh(ho,oc))>-1?1:0;xd&&(oc*=Oa/24),vs.glyphOffsetArray.length>=j.MAX_GLYPHS&&Pe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Pr.sortKey!==void 0&&vs.addToSortKeyRanges(vs.symbolInstances.length,Pr.sortKey),vs.symbolInstances.emplaceBack(Ef.x,Ef.y,dl.right>=0?dl.right:-1,dl.center>=0?dl.center:-1,dl.left>=0?dl.left:-1,dl.vertical||-1,gs,Xo,Kh,Va,eo,hi,Dn,Bc,ys,of,sf,_,qs,ei,zo,ns,xd,0,M,ph,mh,oc)}(Ei,Yh,cd,co,zi,rl,Uc,Ei.layers[0],Ei.collisionBoxArray,ji.index,ji.sourceLayerIndex,Ei.index,Mh,yh,Qh,fo,Ph,fh,hh,Zf,ji,Js,Cs,Fc,Eo)};if(Ih==="line")for(var Nh=0,Hh=uu(ji.geometry,0,0,8192,8192);Nh<Hh.length;Nh+=1)for(var bh=Hh[Nh],kh=0,Wh=ia(bh,Lh,Rh,co.vertical||ih,zi,24,Yf,Ei.overscaling,8192);kh<Wh.length;kh+=1){var Zh=Wh[kh];ih&&fr(Ei,ih.text,ad,Zh)||dh(bh,Zh)}else if(Ih==="line-center")for(var xh=0,jh=ji.geometry;xh<jh.length;xh+=1){var zh=jh[xh];if(zh.length>1){var Fh=Jo(zh,Rh,co.vertical||ih,zi,24,Yf);Fh&&dh(zh,Fh)}}else if(ji.type==="Polygon")for(var Xh=0,Eh=ee(ji.geometry,0);Xh<Eh.length;Xh+=1){var Uh=Eh[Xh],Th=_r(Uh,16);dh(Uh[0],new Mo(Th.x,Th.y,0))}else if(ji.type==="LineString")for(var _h=0,Bh=ji.geometry;_h<Bh.length;_h+=1){var Sh=Bh[_h];dh(Sh,new Mo(Sh[0].x,Sh[0].y,0))}else if(ji.type==="Point")for(var qh=0,id=ji.geometry;qh<id.length;qh+=1)for(var ed=0,od=id[qh];ed<od.length;ed+=1){var sd=od[ed];dh([sd],new Mo(sd.x,sd.y,0))}}(e,Nr,kn,hl,u,Q,Bn,ea,wa,Ou,A)},pr=0,Sr=e.features;pr<Sr.length;pr+=1)or();g&&e.generateCollisionDebugBuffers()},o.perspective=function(e,t,r,u,f){var g,A=1/Math.tan(t/2);return e[0]=A/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(g=1/(u-f)),e[14]=2*f*u*g):(e[10]=-1,e[14]=-2*u),e},o.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},o.plugin=Ji,o.polygonIntersectsPolygon=Tu,o.postMapLoadEvent=dt,o.postTurnstileEvent=cr,o.potpack=Yn,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=bn,o.registerForPluginStateChange=function(e){return e({pluginStatus:Bs,pluginURL:bl}),Ul.on("pluginStateChange",e),e},o.renderColorRamp=Ql,o.rotate=function(e,t,r){var u=t[0],f=t[1],g=t[2],A=t[3],P=Math.sin(r),B=Math.cos(r);return e[0]=u*B+g*P,e[1]=f*B+A*P,e[2]=u*-P+g*B,e[3]=f*-P+A*B,e},o.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),g=t[4],A=t[5],P=t[6],B=t[7],Q=t[8],de=t[9],_e=t[10],Oe=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*f+Q*u,e[5]=A*f+de*u,e[6]=P*f+_e*u,e[7]=B*f+Oe*u,e[8]=Q*f-g*u,e[9]=de*f-A*u,e[10]=_e*f-P*u,e[11]=Oe*f-B*u,e},o.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),g=t[0],A=t[1],P=t[2],B=t[3],Q=t[4],de=t[5],_e=t[6],Oe=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*f+Q*u,e[1]=A*f+de*u,e[2]=P*f+_e*u,e[3]=B*f+Oe*u,e[4]=Q*f-g*u,e[5]=de*f-A*u,e[6]=_e*f-P*u,e[7]=Oe*f-B*u,e},o.scale=function(e,t,r){var u=r[0],f=r[1],g=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},o.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},o.setCacheLimits=function(e,t){Ct=e,pt=t},o.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Bs==="deferred"||Bs==="loading"||Bs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");bl=ye.resolveURL(e),Bs="deferred",Oc=t,Mc(),r||Yo()},o.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},o.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},o.styleSpec=Ve,o.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},o.symbolSize=Ss,o.transformMat3=function(e,t,r){var u=t[0],f=t[1],g=t[2];return e[0]=u*r[0]+f*r[3]+g*r[6],e[1]=u*r[1]+f*r[4]+g*r[7],e[2]=u*r[2]+f*r[5]+g*r[8],e},o.transformMat4=ao,o.translate=function(e,t,r){var u,f,g,A,P,B,Q,de,_e,Oe,nt,St,bt=r[0],Vt=r[1],Ut=r[2];return t===e?(e[12]=t[0]*bt+t[4]*Vt+t[8]*Ut+t[12],e[13]=t[1]*bt+t[5]*Vt+t[9]*Ut+t[13],e[14]=t[2]*bt+t[6]*Vt+t[10]*Ut+t[14],e[15]=t[3]*bt+t[7]*Vt+t[11]*Ut+t[15]):(f=t[1],g=t[2],A=t[3],P=t[4],B=t[5],Q=t[6],de=t[7],_e=t[8],Oe=t[9],nt=t[10],St=t[11],e[0]=u=t[0],e[1]=f,e[2]=g,e[3]=A,e[4]=P,e[5]=B,e[6]=Q,e[7]=de,e[8]=_e,e[9]=Oe,e[10]=nt,e[11]=St,e[12]=u*bt+P*Vt+_e*Ut+t[12],e[13]=f*bt+B*Vt+Oe*Ut+t[13],e[14]=g*bt+Q*Vt+nt*Ut+t[14],e[15]=A*bt+de*Vt+St*Ut+t[15]),e},o.triggerPluginCompletionEvent=df,o.uniqueId=He,o.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},o.validateLight=wf,o.validateStyle=mc,o.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},o.vectorTile=Ha,o.version="1.12.0",o.warnOnce=Pe,o.webpSupported=Ue,o.window=X,o.wrap=ht}),z(["./shared"],function(o){"use strict";function W(F){var H=typeof F;if(H==="number"||H==="boolean"||H==="string"||F==null)return JSON.stringify(F);if(Array.isArray(F)){for(var ue="[",pe=0,rt=F;pe<rt.length;pe+=1)ue+=W(rt[pe])+",";return ue+"]"}for(var yt=Object.keys(F).sort(),Ve="{",ct=0;ct<yt.length;ct++)Ve+=JSON.stringify(yt[ct])+":"+W(F[yt[ct]])+",";return Ve+"}"}function D(F){for(var H="",ue=0,pe=o.refProperties;ue<pe.length;ue+=1)H+="/"+W(F[pe[ue]]);return H}var Y=function(H){this.keyCache={},H&&this.replace(H)};Y.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},Y.prototype.update=function(F,H){for(var ue=this,pe=0,rt=F;pe<rt.length;pe+=1){var yt=rt[pe];this._layerConfigs[yt.id]=yt;var Ve=this._layers[yt.id]=o.createStyleLayer(yt);Ve._featureFilter=o.featureFilter(Ve.filter),this.keyCache[yt.id]&&delete this.keyCache[yt.id]}for(var ct=0,er=H;ct<er.length;ct+=1){var rr=er[ct];delete this.keyCache[rr],delete this._layerConfigs[rr],delete this._layers[rr]}this.familiesBySource={};for(var jr=0,nn=function(Kn,_n){for(var Hr={},oa=0;oa<Kn.length;oa++){var Mr=_n&&_n[Kn[oa].id]||D(Kn[oa]);_n&&(_n[Kn[oa].id]=Mr);var va=Hr[Mr];va||(va=Hr[Mr]=[]),va.push(Kn[oa])}var ha=[];for(var da in Hr)ha.push(Hr[da]);return ha}(o.values(this._layerConfigs),this.keyCache);jr<nn.length;jr+=1){var ur=nn[jr].map(function(Kn){return ue._layers[Kn.id]}),Wr=ur[0];if(Wr.visibility!=="none"){var Tn=Wr.source||"",mr=this.familiesBySource[Tn];mr||(mr=this.familiesBySource[Tn]={});var Jr=Wr.sourceLayer||"_geojsonTileLayer",vn=mr[Jr];vn||(vn=mr[Jr]=[]),vn.push(ur)}}};var q=function(H){var ue={},pe=[];for(var rt in H){var yt=H[rt],Ve=ue[rt]={};for(var ct in yt){var er=yt[+ct];if(er&&er.bitmap.width!==0&&er.bitmap.height!==0){var rr={x:0,y:0,w:er.bitmap.width+2,h:er.bitmap.height+2};pe.push(rr),Ve[ct]={rect:rr,metrics:er.metrics}}}}var jr=o.potpack(pe),nn=new o.AlphaImage({width:jr.w||1,height:jr.h||1});for(var ur in H){var Wr=H[ur];for(var Tn in Wr){var mr=Wr[+Tn];if(mr&&mr.bitmap.width!==0&&mr.bitmap.height!==0){var Jr=ue[ur][Tn].rect;o.AlphaImage.copy(mr.bitmap,nn,{x:0,y:0},{x:Jr.x+1,y:Jr.y+1},mr.bitmap)}}}this.image=nn,this.positions=ue};o.register("GlyphAtlas",q);var he=function(H){this.tileID=new o.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId};function X(F,H,ue){for(var pe=new o.EvaluationParameters(H),rt=0,yt=F;rt<yt.length;rt+=1)yt[rt].recalculate(pe,ue)}function je(F,H){var ue=o.getArrayBuffer(F.request,function(pe,rt,yt,Ve){pe?H(pe):rt&&H(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(rt)),rawData:rt,cacheControl:yt,expires:Ve})});return function(){ue.cancel(),H()}}he.prototype.parse=function(F,H,ue,pe,rt){var yt=this;this.status="parsing",this.data=F,this.collisionBoxArray=new o.CollisionBoxArray;var Ve=new o.DictionaryCoder(Object.keys(F.layers).sort()),ct=new o.FeatureIndex(this.tileID,this.promoteId);ct.bucketLayerIDs=[];var er,rr,jr,nn,ur={},Wr={featureIndex:ct,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue},Tn=H.familiesBySource[this.source];for(var mr in Tn){var Jr=F.layers[mr];if(Jr){Jr.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+mr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var vn=Ve.encode(mr),Kn=[],_n=0;_n<Jr.length;_n++){var Hr=Jr.feature(_n),oa=ct.getId(Hr,mr);Kn.push({feature:Hr,id:oa,index:_n,sourceLayerIndex:vn})}for(var Mr=0,va=Tn[mr];Mr<va.length;Mr+=1){var ha=va[Mr],da=ha[0];da.minzoom&&this.zoom<Math.floor(da.minzoom)||da.maxzoom&&this.zoom>=da.maxzoom||da.visibility!=="none"&&(X(ha,this.zoom,ue),(ur[da.id]=da.createBucket({index:ct.bucketLayerIDs.length,layers:ha,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vn,sourceID:this.source})).populate(Kn,Wr,this.tileID.canonical),ct.bucketLayerIDs.push(ha.map(function(Ga){return Ga.id})))}}}var Ki=o.mapObject(Wr.glyphDependencies,function(Ga){return Object.keys(Ga).map(Number)});Object.keys(Ki).length?pe.send("getGlyphs",{uid:this.uid,stacks:Ki},function(Ga,In){er||(er=Ga,rr=In,di.call(yt))}):rr={};var Fi=Object.keys(Wr.iconDependencies);Fi.length?pe.send("getImages",{icons:Fi,source:this.source,tileID:this.tileID,type:"icons"},function(Ga,In){er||(er=Ga,jr=In,di.call(yt))}):jr={};var xa=Object.keys(Wr.patternDependencies);function di(){if(er)return rt(er);if(rr&&jr&&nn){var Ga=new q(rr),In=new o.ImageAtlas(jr,nn);for(var Oi in ur){var $i=ur[Oi];$i instanceof o.SymbolBucket?(X($i.layers,this.zoom,ue),o.performSymbolLayout($i,rr,Ga.positions,jr,In.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):$i.hasPattern&&($i instanceof o.LineBucket||$i instanceof o.FillBucket||$i instanceof o.FillExtrusionBucket)&&(X($i.layers,this.zoom,ue),$i.addFeatures(Wr,this.tileID.canonical,In.patternPositions))}this.status="done",rt(null,{buckets:o.values(ur).filter(function(Ti){return!Ti.isEmpty()}),featureIndex:ct,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ga.image,imageAtlas:In,glyphMap:this.returnDependencies?rr:null,iconMap:this.returnDependencies?jr:null,glyphPositions:this.returnDependencies?Ga.positions:null})}}xa.length?pe.send("getImages",{icons:xa,source:this.source,tileID:this.tileID,type:"patterns"},function(Ga,In){er||(er=Ga,nn=In,di.call(yt))}):nn={},di.call(this)};var Ge=function(H,ue,pe,rt){this.actor=H,this.layerIndex=ue,this.availableImages=pe,this.loadVectorData=rt||je,this.loading={},this.loaded={}};Ge.prototype.loadTile=function(F,H){var ue=this,pe=F.uid;this.loading||(this.loading={});var rt=!!(F&&F.request&&F.request.collectResourceTiming)&&new o.RequestPerformance(F.request),yt=this.loading[pe]=new he(F);yt.abort=this.loadVectorData(F,function(Ve,ct){if(delete ue.loading[pe],Ve||!ct)return yt.status="done",ue.loaded[pe]=yt,H(Ve);var er=ct.rawData,rr={};ct.expires&&(rr.expires=ct.expires),ct.cacheControl&&(rr.cacheControl=ct.cacheControl);var jr={};if(rt){var nn=rt.finish();nn&&(jr.resourceTiming=JSON.parse(JSON.stringify(nn)))}yt.vectorTile=ct.vectorTile,yt.parse(ct.vectorTile,ue.layerIndex,ue.availableImages,ue.actor,function(ur,Wr){if(ur||!Wr)return H(ur);H(null,o.extend({rawTileData:er.slice(0)},Wr,rr,jr))}),ue.loaded=ue.loaded||{},ue.loaded[pe]=yt})},Ge.prototype.reloadTile=function(F,H){var ue=this,pe=this.loaded,rt=F.uid,yt=this;if(pe&&pe[rt]){var Ve=pe[rt];Ve.showCollisionBoxes=F.showCollisionBoxes;var ct=function(rr,jr){var nn=Ve.reloadCallback;nn&&(delete Ve.reloadCallback,Ve.parse(Ve.vectorTile,yt.layerIndex,ue.availableImages,yt.actor,nn)),H(rr,jr)};Ve.status==="parsing"?Ve.reloadCallback=ct:Ve.status==="done"&&(Ve.vectorTile?Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,ct):ct())}},Ge.prototype.abortTile=function(F,H){var ue=this.loading,pe=F.uid;ue&&ue[pe]&&ue[pe].abort&&(ue[pe].abort(),delete ue[pe]),H()},Ge.prototype.removeTile=function(F,H){var ue=this.loaded,pe=F.uid;ue&&ue[pe]&&delete ue[pe],H()};var ge=o.window.ImageBitmap,Ce=function(){this.loaded={}};function ht(F,H){if(F.length!==0){Ne(F[0],H);for(var ue=1;ue<F.length;ue++)Ne(F[ue],!H)}}function Ne(F,H){for(var ue=0,pe=0,rt=F.length,yt=rt-1;pe<rt;yt=pe++)ue+=(F[pe][0]-F[yt][0])*(F[yt][1]+F[pe][1]);ue>=0!=!!H&&F.reverse()}Ce.prototype.loadTile=function(F,H){var ue=F.uid,pe=F.encoding,rt=F.rawImageData,yt=ge&&rt instanceof ge?this.getImageData(rt):rt,Ve=new o.DEMData(ue,yt,pe);this.loaded=this.loaded||{},this.loaded[ue]=Ve,H(null,Ve)},Ce.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var H=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:H.width,height:H.height},H.data)},Ce.prototype.removeTile=function(F){var H=this.loaded,ue=F.uid;H&&H[ue]&&delete H[ue]};var Et=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,He=function(H){this._feature=H,this.extent=o.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))};He.prototype.loadGeometry=function(){if(this._feature.type===1){for(var F=[],H=0,ue=this._feature.geometry;H<ue.length;H+=1){var pe=ue[H];F.push([new o.Point$1(pe[0],pe[1])])}return F}for(var rt=[],yt=0,Ve=this._feature.geometry;yt<Ve.length;yt+=1){for(var ct=[],er=0,rr=Ve[yt];er<rr.length;er+=1){var jr=rr[er];ct.push(new o.Point$1(jr[0],jr[1]))}rt.push(ct)}return rt},He.prototype.toGeoJSON=function(F,H,ue){return Et.call(this,F,H,ue)};var mt=function(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=H.length,this._features=H};mt.prototype.feature=function(F){return new He(this._features[F])};var Ye=o.vectorTile.VectorTileFeature,xt=_t;function _t(F,H){this.options=H||{},this.features=F,this.length=F.length}function Ie(F,H){this.id=typeof F.id=="number"?F.id:void 0,this.type=F.type,this.rawGeometry=F.type===1?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=H||4096}_t.prototype.feature=function(F){return new Ie(this.features[F],this.options.extent)},Ie.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var H=0;H<F.length;H++){for(var ue=F[H],pe=[],rt=0;rt<ue.length;rt++)pe.push(new o.Point$1(ue[rt][0],ue[rt][1]));this.geometry.push(pe)}return this.geometry},Ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,H=1/0,ue=-1/0,pe=1/0,rt=-1/0,yt=0;yt<F.length;yt++)for(var Ve=F[yt],ct=0;ct<Ve.length;ct++){var er=Ve[ct];H=Math.min(H,er.x),ue=Math.max(ue,er.x),pe=Math.min(pe,er.y),rt=Math.max(rt,er.y)}return[H,pe,ue,rt]},Ie.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var De=at,ze=xt;function at(F){var H=new o.pbf;return function(ue,pe){for(var rt in ue.layers)pe.writeMessage(3,Pe,ue.layers[rt])}(F,H),H.finish()}function Pe(F,H){var ue;H.writeVarintField(15,F.version||1),H.writeStringField(1,F.name||""),H.writeVarintField(5,F.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(ue=0;ue<F.length;ue++)pe.feature=F.feature(ue),H.writeMessage(2,ot,pe);var rt=pe.keys;for(ue=0;ue<rt.length;ue++)H.writeStringField(3,rt[ue]);var yt=pe.values;for(ue=0;ue<yt.length;ue++)H.writeMessage(4,$,yt[ue])}function ot(F,H){var ue=F.feature;ue.id!==void 0&&H.writeVarintField(1,ue.id),H.writeMessage(2,Bt,F),H.writeVarintField(3,ue.type),H.writeMessage(4,ne,ue)}function Bt(F,H){var ue=F.feature,pe=F.keys,rt=F.values,yt=F.keycache,Ve=F.valuecache;for(var ct in ue.properties){var er=yt[ct];er===void 0&&(pe.push(ct),yt[ct]=er=pe.length-1),H.writeVarint(er);var rr=ue.properties[ct],jr=typeof rr;jr!=="string"&&jr!=="boolean"&&jr!=="number"&&(rr=JSON.stringify(rr));var nn=jr+":"+rr,ur=Ve[nn];ur===void 0&&(rt.push(rr),Ve[nn]=ur=rt.length-1),H.writeVarint(ur)}}function Wt(F,H){return(H<<3)+(7&F)}function sr(F){return F<<1^F>>31}function ne(F,H){for(var ue=F.loadGeometry(),pe=F.type,rt=0,yt=0,Ve=ue.length,ct=0;ct<Ve;ct++){var er=ue[ct],rr=1;pe===1&&(rr=er.length),H.writeVarint(Wt(1,rr));for(var jr=pe===3?er.length-1:er.length,nn=0;nn<jr;nn++){nn===1&&pe!==1&&H.writeVarint(Wt(2,jr-1));var ur=er[nn].x-rt,Wr=er[nn].y-yt;H.writeVarint(sr(ur)),H.writeVarint(sr(Wr)),rt+=ur,yt+=Wr}pe===3&&H.writeVarint(Wt(7,1))}}function $(F,H){var ue=typeof F;ue==="string"?H.writeStringField(1,F):ue==="boolean"?H.writeBooleanField(7,F):ue==="number"&&(F%1!=0?H.writeDoubleField(3,F):F<0?H.writeSVarintField(6,F):H.writeVarintField(5,F))}function G(F,H,ue,pe){Ae(F,ue,pe),Ae(H,2*ue,2*pe),Ae(H,2*ue+1,2*pe+1)}function Ae(F,H,ue){var pe=F[H];F[H]=F[ue],F[ue]=pe}function xe(F,H,ue,pe){var rt=F-ue,yt=H-pe;return rt*rt+yt*yt}De.fromVectorTileJs=at,De.fromGeojsonVt=function(F,H){H=H||{};var ue={};for(var pe in F)ue[pe]=new xt(F[pe].features,H),ue[pe].name=pe,ue[pe].version=H.version,ue[pe].extent=H.extent;return at({layers:ue})},De.GeoJSONWrapper=ze;var Se=function(H){return H[0]},ve=function(H){return H[1]},et=function(H,ue,pe,rt,yt){ue===void 0&&(ue=Se),pe===void 0&&(pe=ve),rt===void 0&&(rt=64),yt===void 0&&(yt=Float64Array),this.nodeSize=rt,this.points=H;for(var Ve=H.length<65536?Uint16Array:Uint32Array,ct=this.ids=new Ve(H.length),er=this.coords=new yt(2*H.length),rr=0;rr<H.length;rr++)ct[rr]=rr,er[2*rr]=ue(H[rr]),er[2*rr+1]=pe(H[rr]);!function jr(nn,ur,Wr,Tn,mr,Jr){if(!(mr-Tn<=Wr)){var vn=Tn+mr>>1;!function Kn(_n,Hr,oa,Mr,va,ha){for(;va>Mr;){if(va-Mr>600){var da=va-Mr+1,Ki=oa-Mr+1,Fi=Math.log(da),xa=.5*Math.exp(2*Fi/3),di=.5*Math.sqrt(Fi*xa*(da-xa)/da)*(Ki-da/2<0?-1:1);Kn(_n,Hr,oa,Math.max(Mr,Math.floor(oa-Ki*xa/da+di)),Math.min(va,Math.floor(oa+(da-Ki)*xa/da+di)),ha)}var Ga=Hr[2*oa+ha],In=Mr,Oi=va;for(G(_n,Hr,Mr,oa),Hr[2*va+ha]>Ga&&G(_n,Hr,Mr,va);In<Oi;){for(G(_n,Hr,In,Oi),In++,Oi--;Hr[2*In+ha]<Ga;)In++;for(;Hr[2*Oi+ha]>Ga;)Oi--}Hr[2*Mr+ha]===Ga?G(_n,Hr,Mr,Oi):G(_n,Hr,++Oi,va),Oi<=oa&&(Mr=Oi+1),oa<=Oi&&(va=Oi-1)}}(nn,ur,vn,Tn,mr,Jr%2),jr(nn,ur,Wr,Tn,vn-1,Jr+1),jr(nn,ur,Wr,vn+1,mr,Jr+1)}}(ct,er,rt,0,ct.length-1,0)};et.prototype.range=function(F,H,ue,pe){return function(rt,yt,Ve,ct,er,rr,jr){for(var nn,ur,Wr=[0,rt.length-1,0],Tn=[];Wr.length;){var mr=Wr.pop(),Jr=Wr.pop(),vn=Wr.pop();if(Jr-vn<=jr)for(var Kn=vn;Kn<=Jr;Kn++)ur=yt[2*Kn+1],(nn=yt[2*Kn])>=Ve&&nn<=er&&ur>=ct&&ur<=rr&&Tn.push(rt[Kn]);else{var _n=Math.floor((vn+Jr)/2);ur=yt[2*_n+1],(nn=yt[2*_n])>=Ve&&nn<=er&&ur>=ct&&ur<=rr&&Tn.push(rt[_n]);var Hr=(mr+1)%2;(mr===0?Ve<=nn:ct<=ur)&&(Wr.push(vn),Wr.push(_n-1),Wr.push(Hr)),(mr===0?er>=nn:rr>=ur)&&(Wr.push(_n+1),Wr.push(Jr),Wr.push(Hr))}}return Tn}(this.ids,this.coords,F,H,ue,pe,this.nodeSize)},et.prototype.within=function(F,H,ue){return function(pe,rt,yt,Ve,ct,er){for(var rr=[0,pe.length-1,0],jr=[],nn=ct*ct;rr.length;){var ur=rr.pop(),Wr=rr.pop(),Tn=rr.pop();if(Wr-Tn<=er)for(var mr=Tn;mr<=Wr;mr++)xe(rt[2*mr],rt[2*mr+1],yt,Ve)<=nn&&jr.push(pe[mr]);else{var Jr=Math.floor((Tn+Wr)/2),vn=rt[2*Jr],Kn=rt[2*Jr+1];xe(vn,Kn,yt,Ve)<=nn&&jr.push(pe[Jr]);var _n=(ur+1)%2;(ur===0?yt-ct<=vn:Ve-ct<=Kn)&&(rr.push(Tn),rr.push(Jr-1),rr.push(_n)),(ur===0?yt+ct>=vn:Ve+ct>=Kn)&&(rr.push(Jr+1),rr.push(Wr),rr.push(_n))}}return jr}(this.ids,this.coords,F,H,ue,this.nodeSize)};var Yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(H){return H}},At=function(H){this.options=w(Object.create(Yt),H),this.trees=new Array(this.options.maxZoom+1)};function ye(F,H,ue,pe,rt){return{x:F,y:H,zoom:1/0,id:ue,parentId:-1,numPoints:pe,properties:rt}}function be(F,H){var ue=F.geometry.coordinates,pe=ue[1];return{x:Me(ue[0]),y:ft(pe),zoom:1/0,index:H,parentId:-1}}function Ue(F){return{type:"Feature",id:F.id,properties:st(F),geometry:{type:"Point",coordinates:[(pe=F.x,360*(pe-.5)),(H=F.y,ue=(180-360*H)*Math.PI/180,360*Math.atan(Math.exp(ue))/Math.PI-90)]}};var H,ue,pe}function st(F){var H=F.numPoints,ue=H>=1e4?Math.round(H/1e3)+"k":H>=1e3?Math.round(H/100)/10+"k":H;return w(w({},F.properties),{cluster:!0,cluster_id:F.id,point_count:H,point_count_abbreviated:ue})}function Me(F){return F/360+.5}function ft(F){var H=Math.sin(F*Math.PI/180),ue=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ue<0?0:ue>1?1:ue}function w(F,H){for(var ue in H)F[ue]=H[ue];return F}function I(F){return F.x}function J(F){return F.y}function ce(F,H,ue,pe,rt,yt){var Ve=rt-ue,ct=yt-pe;if(Ve!==0||ct!==0){var er=((F-ue)*Ve+(H-pe)*ct)/(Ve*Ve+ct*ct);er>1?(ue=rt,pe=yt):er>0&&(ue+=Ve*er,pe+=ct*er)}return(Ve=F-ue)*Ve+(ct=H-pe)*ct}function Be(F,H,ue,pe){var rt={id:F===void 0?null:F,type:H,geometry:ue,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(yt){var Ve=yt.geometry,ct=yt.type;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")Xe(yt,Ve);else if(ct==="Polygon"||ct==="MultiLineString")for(var er=0;er<Ve.length;er++)Xe(yt,Ve[er]);else if(ct==="MultiPolygon")for(er=0;er<Ve.length;er++)for(var rr=0;rr<Ve[er].length;rr++)Xe(yt,Ve[er][rr])}(rt),rt}function Xe(F,H){for(var ue=0;ue<H.length;ue+=3)F.minX=Math.min(F.minX,H[ue]),F.minY=Math.min(F.minY,H[ue+1]),F.maxX=Math.max(F.maxX,H[ue]),F.maxY=Math.max(F.maxY,H[ue+1])}function gt(F,H,ue,pe){if(H.geometry){var rt=H.geometry.coordinates,yt=H.geometry.type,Ve=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2),ct=[],er=H.id;if(ue.promoteId?er=H.properties[ue.promoteId]:ue.generateId&&(er=pe||0),yt==="Point")tt(rt,ct);else if(yt==="MultiPoint")for(var rr=0;rr<rt.length;rr++)tt(rt[rr],ct);else if(yt==="LineString")It(rt,ct,Ve,!1);else if(yt==="MultiLineString"){if(ue.lineMetrics){for(rr=0;rr<rt.length;rr++)It(rt[rr],ct=[],Ve,!1),F.push(Be(er,"LineString",ct,H.properties));return}K(rt,ct,Ve,!1)}else if(yt==="Polygon")K(rt,ct,Ve,!0);else{if(yt!=="MultiPolygon"){if(yt==="GeometryCollection"){for(rr=0;rr<H.geometry.geometries.length;rr++)gt(F,{id:er,geometry:H.geometry.geometries[rr],properties:H.properties},ue,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(rr=0;rr<rt.length;rr++){var jr=[];K(rt[rr],jr,Ve,!0),ct.push(jr)}}F.push(Be(er,yt,ct,H.properties))}}function tt(F,H){H.push(Ze(F[0])),H.push(te(F[1])),H.push(0)}function It(F,H,ue,pe){for(var rt,yt,Ve=0,ct=0;ct<F.length;ct++){var er=Ze(F[ct][0]),rr=te(F[ct][1]);H.push(er),H.push(rr),H.push(0),ct>0&&(Ve+=pe?(rt*rr-er*yt)/2:Math.sqrt(Math.pow(er-rt,2)+Math.pow(rr-yt,2))),rt=er,yt=rr}var jr=H.length-3;H[2]=1,function nn(ur,Wr,Tn,mr){for(var Jr,vn=mr,Kn=Tn-Wr>>1,_n=Tn-Wr,Hr=ur[Wr],oa=ur[Wr+1],Mr=ur[Tn],va=ur[Tn+1],ha=Wr+3;ha<Tn;ha+=3){var da=ce(ur[ha],ur[ha+1],Hr,oa,Mr,va);if(da>vn)Jr=ha,vn=da;else if(da===vn){var Ki=Math.abs(ha-Kn);Ki<_n&&(Jr=ha,_n=Ki)}}vn>mr&&(Jr-Wr>3&&nn(ur,Wr,Jr,mr),ur[Jr+2]=vn,Tn-Jr>3&&nn(ur,Jr,Tn,mr))}(H,0,jr,ue),H[jr+2]=1,H.size=Math.abs(Ve),H.start=0,H.end=H.size}function K(F,H,ue,pe){for(var rt=0;rt<F.length;rt++){var yt=[];It(F[rt],yt,ue,pe),H.push(yt)}}function Ze(F){return F/360+.5}function te(F){var H=Math.sin(F*Math.PI/180),ue=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return ue<0?0:ue>1?1:ue}function Je(F,H,ue,pe,rt,yt,Ve,ct){if(pe/=H,yt>=(ue/=H)&&Ve<pe)return F;if(Ve<ue||yt>=pe)return null;for(var er=[],rr=0;rr<F.length;rr++){var jr=F[rr],nn=jr.geometry,ur=jr.type,Wr=rt===0?jr.minX:jr.minY,Tn=rt===0?jr.maxX:jr.maxY;if(Wr>=ue&&Tn<pe)er.push(jr);else if(!(Tn<ue||Wr>=pe)){var mr=[];if(ur==="Point"||ur==="MultiPoint")zt(nn,mr,ue,pe,rt);else if(ur==="LineString")cr(nn,mr,ue,pe,rt,!1,ct.lineMetrics);else if(ur==="MultiLineString")dt(nn,mr,ue,pe,rt,!1);else if(ur==="Polygon")dt(nn,mr,ue,pe,rt,!0);else if(ur==="MultiPolygon")for(var Jr=0;Jr<nn.length;Jr++){var vn=[];dt(nn[Jr],vn,ue,pe,rt,!0),vn.length&&mr.push(vn)}if(mr.length){if(ct.lineMetrics&&ur==="LineString"){for(Jr=0;Jr<mr.length;Jr++)er.push(Be(jr.id,ur,mr[Jr],jr.tags));continue}ur!=="LineString"&&ur!=="MultiLineString"||(mr.length===1?(ur="LineString",mr=mr[0]):ur="MultiLineString"),ur!=="Point"&&ur!=="MultiPoint"||(ur=mr.length===3?"Point":"MultiPoint"),er.push(Be(jr.id,ur,mr,jr.tags))}}}return er.length?er:null}function zt(F,H,ue,pe,rt){for(var yt=0;yt<F.length;yt+=3){var Ve=F[yt+rt];Ve>=ue&&Ve<=pe&&(H.push(F[yt]),H.push(F[yt+1]),H.push(F[yt+2]))}}function cr(F,H,ue,pe,rt,yt,Ve){for(var ct,er,rr=lt(F),jr=rt===0?pt:we,nn=F.start,ur=0;ur<F.length-3;ur+=3){var Wr=F[ur],Tn=F[ur+1],mr=F[ur+2],Jr=F[ur+3],vn=F[ur+4],Kn=rt===0?Wr:Tn,_n=rt===0?Jr:vn,Hr=!1;Ve&&(ct=Math.sqrt(Math.pow(Wr-Jr,2)+Math.pow(Tn-vn,2))),Kn<ue?_n>ue&&(er=jr(rr,Wr,Tn,Jr,vn,ue),Ve&&(rr.start=nn+ct*er)):Kn>pe?_n<pe&&(er=jr(rr,Wr,Tn,Jr,vn,pe),Ve&&(rr.start=nn+ct*er)):Ct(rr,Wr,Tn,mr),_n<ue&&Kn>=ue&&(er=jr(rr,Wr,Tn,Jr,vn,ue),Hr=!0),_n>pe&&Kn<=pe&&(er=jr(rr,Wr,Tn,Jr,vn,pe),Hr=!0),!yt&&Hr&&(Ve&&(rr.end=nn+ct*er),H.push(rr),rr=lt(F)),Ve&&(nn+=ct)}var oa=F.length-3;Wr=F[oa],Tn=F[oa+1],mr=F[oa+2],(Kn=rt===0?Wr:Tn)>=ue&&Kn<=pe&&Ct(rr,Wr,Tn,mr),oa=rr.length-3,yt&&oa>=3&&(rr[oa]!==rr[0]||rr[oa+1]!==rr[1])&&Ct(rr,rr[0],rr[1],rr[2]),rr.length&&H.push(rr)}function lt(F){var H=[];return H.size=F.size,H.start=F.start,H.end=F.end,H}function dt(F,H,ue,pe,rt,yt){for(var Ve=0;Ve<F.length;Ve++)cr(F[Ve],H,ue,pe,rt,yt,!1)}function Ct(F,H,ue,pe){F.push(H),F.push(ue),F.push(pe)}function pt(F,H,ue,pe,rt,yt){var Ve=(yt-H)/(pe-H);return F.push(yt),F.push(ue+(rt-ue)*Ve),F.push(1),Ve}function we(F,H,ue,pe,rt,yt){var Ve=(yt-ue)/(rt-ue);return F.push(H+(pe-H)*Ve),F.push(yt),F.push(1),Ve}function ut(F,H){for(var ue=[],pe=0;pe<F.length;pe++){var rt,yt=F[pe],Ve=yt.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")rt=Ke(yt.geometry,H);else if(Ve==="MultiLineString"||Ve==="Polygon"){rt=[];for(var ct=0;ct<yt.geometry.length;ct++)rt.push(Ke(yt.geometry[ct],H))}else if(Ve==="MultiPolygon")for(rt=[],ct=0;ct<yt.geometry.length;ct++){for(var er=[],rr=0;rr<yt.geometry[ct].length;rr++)er.push(Ke(yt.geometry[ct][rr],H));rt.push(er)}ue.push(Be(yt.id,Ve,rt,yt.tags))}return ue}function Ke(F,H){var ue=[];ue.size=F.size,F.start!==void 0&&(ue.start=F.start,ue.end=F.end);for(var pe=0;pe<F.length;pe+=3)ue.push(F[pe]+H,F[pe+1],F[pe+2]);return ue}function kt(F,H){if(F.transformed)return F;var ue,pe,rt,yt=1<<F.z,Ve=F.x,ct=F.y;for(ue=0;ue<F.features.length;ue++){var er=F.features[ue],rr=er.geometry,jr=er.type;if(er.geometry=[],jr===1)for(pe=0;pe<rr.length;pe+=2)er.geometry.push(yr(rr[pe],rr[pe+1],H,yt,Ve,ct));else for(pe=0;pe<rr.length;pe++){var nn=[];for(rt=0;rt<rr[pe].length;rt+=2)nn.push(yr(rr[pe][rt],rr[pe][rt+1],H,yt,Ve,ct));er.geometry.push(nn)}}return F.transformed=!0,F}function yr(F,H,ue,pe,rt,yt){return[Math.round(ue*(F*pe-rt)),Math.round(ue*(H*pe-yt))]}function Zr(F,H,ue,pe,rt){for(var yt=H===rt.maxZoom?0:rt.tolerance/((1<<H)*rt.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ue,y:pe,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ct=0;ct<F.length;ct++){Ve.numFeatures++,hr(Ve,F[ct],yt,rt);var er=F[ct].minX,rr=F[ct].minY,jr=F[ct].maxX,nn=F[ct].maxY;er<Ve.minX&&(Ve.minX=er),rr<Ve.minY&&(Ve.minY=rr),jr>Ve.maxX&&(Ve.maxX=jr),nn>Ve.maxY&&(Ve.maxY=nn)}return Ve}function hr(F,H,ue,pe){var rt=H.geometry,yt=H.type,Ve=[];if(yt==="Point"||yt==="MultiPoint")for(var ct=0;ct<rt.length;ct+=3)Ve.push(rt[ct]),Ve.push(rt[ct+1]),F.numPoints++,F.numSimplified++;else if(yt==="LineString")jn(Ve,rt,F,ue,!1,!1);else if(yt==="MultiLineString"||yt==="Polygon")for(ct=0;ct<rt.length;ct++)jn(Ve,rt[ct],F,ue,yt==="Polygon",ct===0);else if(yt==="MultiPolygon")for(var er=0;er<rt.length;er++){var rr=rt[er];for(ct=0;ct<rr.length;ct++)jn(Ve,rr[ct],F,ue,!0,ct===0)}if(Ve.length){var jr=H.tags||null;if(yt==="LineString"&&pe.lineMetrics){for(var nn in jr={},H.tags)jr[nn]=H.tags[nn];jr.mapbox_clip_start=rt.start/rt.size,jr.mapbox_clip_end=rt.end/rt.size}var ur={geometry:Ve,type:yt==="Polygon"||yt==="MultiPolygon"?3:yt==="LineString"||yt==="MultiLineString"?2:1,tags:jr};H.id!==null&&(ur.id=H.id),F.features.push(ur)}}function jn(F,H,ue,pe,rt,yt){var Ve=pe*pe;if(pe>0&&H.size<(rt?Ve:pe))ue.numPoints+=H.length/3;else{for(var ct=[],er=0;er<H.length;er+=3)(pe===0||H[er+2]>Ve)&&(ue.numSimplified++,ct.push(H[er]),ct.push(H[er+1])),ue.numPoints++;rt&&function(rr,jr){for(var nn=0,ur=0,Wr=rr.length,Tn=Wr-2;ur<Wr;Tn=ur,ur+=2)nn+=(rr[ur]-rr[Tn])*(rr[ur+1]+rr[Tn+1]);if(nn>0===jr)for(ur=0,Wr=rr.length;ur<Wr/2;ur+=2){var mr=rr[ur],Jr=rr[ur+1];rr[ur]=rr[Wr-2-ur],rr[ur+1]=rr[Wr-1-ur],rr[Wr-2-ur]=mr,rr[Wr-1-ur]=Jr}}(ct,yt),F.push(ct)}}function yn(F,H){var ue=(H=this.options=function(rt,yt){for(var Ve in yt)rt[Ve]=yt[Ve];return rt}(Object.create(this.options),H)).debug;if(ue&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var pe=function(rt,yt){var Ve=[];if(rt.type==="FeatureCollection")for(var ct=0;ct<rt.features.length;ct++)gt(Ve,rt.features[ct],yt,ct);else gt(Ve,rt.type==="Feature"?rt:{geometry:rt},yt);return Ve}(F,H);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(pe=function(rt,yt){var Ve=yt.buffer/yt.extent,ct=rt,er=Je(rt,1,-1-Ve,Ve,0,-1,2,yt),rr=Je(rt,1,1-Ve,2+Ve,0,-1,2,yt);return(er||rr)&&(ct=Je(rt,1,-Ve,1+Ve,0,-1,2,yt)||[],er&&(ct=ut(er,1).concat(ct)),rr&&(ct=ct.concat(ut(rr,-1)))),ct}(pe,H)).length&&this.splitTile(pe,0,0,0),ue&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ta(F,H,ue){return 32*((1<<F)*ue+H)+F}function ma(F,H){var ue=F.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);var pe=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!pe)return H(null,null);var rt=new mt(pe.features),yt=De(rt);yt.byteOffset===0&&yt.byteLength===yt.buffer.byteLength||(yt=new Uint8Array(yt)),H(null,{vectorTile:rt,rawData:yt.buffer})}At.prototype.load=function(F){var H=this.options,ue=H.log,pe=H.minZoom,rt=H.maxZoom,yt=H.nodeSize;ue&&console.time("total time");var Ve="prepare "+F.length+" points";ue&&console.time(Ve),this.points=F;for(var ct=[],er=0;er<F.length;er++)F[er].geometry&&ct.push(be(F[er],er));this.trees[rt+1]=new et(ct,I,J,yt,Float32Array),ue&&console.timeEnd(Ve);for(var rr=rt;rr>=pe;rr--){var jr=+Date.now();ct=this._cluster(ct,rr),this.trees[rr]=new et(ct,I,J,yt,Float32Array),ue&&console.log("z%d: %d clusters in %dms",rr,ct.length,+Date.now()-jr)}return ue&&console.timeEnd("total time"),this},At.prototype.getClusters=function(F,H){var ue=((F[0]+180)%360+360)%360-180,pe=Math.max(-90,Math.min(90,F[1])),rt=F[2]===180?180:((F[2]+180)%360+360)%360-180,yt=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)ue=-180,rt=180;else if(ue>rt){var Ve=this.getClusters([ue,pe,180,yt],H),ct=this.getClusters([-180,pe,rt,yt],H);return Ve.concat(ct)}for(var er=this.trees[this._limitZoom(H)],rr=[],jr=0,nn=er.range(Me(ue),ft(yt),Me(rt),ft(pe));jr<nn.length;jr+=1){var ur=er.points[nn[jr]];rr.push(ur.numPoints?Ue(ur):this.points[ur.index])}return rr},At.prototype.getChildren=function(F){var H=this._getOriginId(F),ue=this._getOriginZoom(F),pe="No cluster with the specified id.",rt=this.trees[ue];if(!rt)throw new Error(pe);var yt=rt.points[H];if(!yt)throw new Error(pe);for(var Ve=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),ct=[],er=0,rr=rt.within(yt.x,yt.y,Ve);er<rr.length;er+=1){var jr=rt.points[rr[er]];jr.parentId===F&&ct.push(jr.numPoints?Ue(jr):this.points[jr.index])}if(ct.length===0)throw new Error(pe);return ct},At.prototype.getLeaves=function(F,H,ue){var pe=[];return this._appendLeaves(pe,F,H=H||10,ue=ue||0,0),pe},At.prototype.getTile=function(F,H,ue){var pe=this.trees[this._limitZoom(F)],rt=Math.pow(2,F),yt=this.options,Ve=yt.radius/yt.extent,ct=(ue-Ve)/rt,er=(ue+1+Ve)/rt,rr={features:[]};return this._addTileFeatures(pe.range((H-Ve)/rt,ct,(H+1+Ve)/rt,er),pe.points,H,ue,rt,rr),H===0&&this._addTileFeatures(pe.range(1-Ve/rt,ct,1,er),pe.points,rt,ue,rt,rr),H===rt-1&&this._addTileFeatures(pe.range(0,ct,Ve/rt,er),pe.points,-1,ue,rt,rr),rr.features.length?rr:null},At.prototype.getClusterExpansionZoom=function(F){for(var H=this._getOriginZoom(F)-1;H<=this.options.maxZoom;){var ue=this.getChildren(F);if(H++,ue.length!==1)break;F=ue[0].properties.cluster_id}return H},At.prototype._appendLeaves=function(F,H,ue,pe,rt){for(var yt=0,Ve=this.getChildren(H);yt<Ve.length;yt+=1){var ct=Ve[yt],er=ct.properties;if(er&&er.cluster?rt+er.point_count<=pe?rt+=er.point_count:rt=this._appendLeaves(F,er.cluster_id,ue,pe,rt):rt<pe?rt++:F.push(ct),F.length===ue)break}return rt},At.prototype._addTileFeatures=function(F,H,ue,pe,rt,yt){for(var Ve=0,ct=F;Ve<ct.length;Ve+=1){var er=H[ct[Ve]],rr=er.numPoints,jr={type:1,geometry:[[Math.round(this.options.extent*(er.x*rt-ue)),Math.round(this.options.extent*(er.y*rt-pe))]],tags:rr?st(er):this.points[er.index].properties},nn=void 0;rr?nn=er.id:this.options.generateId?nn=er.index:this.points[er.index].id&&(nn=this.points[er.index].id),nn!==void 0&&(jr.id=nn),yt.features.push(jr)}},At.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},At.prototype._cluster=function(F,H){for(var ue=[],pe=this.options,rt=pe.reduce,yt=pe.minPoints,Ve=pe.radius/(pe.extent*Math.pow(2,H)),ct=0;ct<F.length;ct++){var er=F[ct];if(!(er.zoom<=H)){er.zoom=H;for(var rr=this.trees[H+1],jr=rr.within(er.x,er.y,Ve),nn=er.numPoints||1,ur=nn,Wr=0,Tn=jr;Wr<Tn.length;Wr+=1){var mr=rr.points[Tn[Wr]];mr.zoom>H&&(ur+=mr.numPoints||1)}if(ur>=yt){for(var Jr=er.x*nn,vn=er.y*nn,Kn=rt&&nn>1?this._map(er,!0):null,_n=(ct<<5)+(H+1)+this.points.length,Hr=0,oa=jr;Hr<oa.length;Hr+=1){var Mr=rr.points[oa[Hr]];if(!(Mr.zoom<=H)){Mr.zoom=H;var va=Mr.numPoints||1;Jr+=Mr.x*va,vn+=Mr.y*va,Mr.parentId=_n,rt&&(Kn||(Kn=this._map(er,!0)),rt(Kn,this._map(Mr)))}}er.parentId=_n,ue.push(ye(Jr/ur,vn/ur,_n,ur,Kn))}else if(ue.push(er),ur>1)for(var ha=0,da=jr;ha<da.length;ha+=1){var Ki=rr.points[da[ha]];Ki.zoom<=H||(Ki.zoom=H,ue.push(Ki))}}}return ue},At.prototype._getOriginId=function(F){return F-this.points.length>>5},At.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},At.prototype._map=function(F,H){if(F.numPoints)return H?w({},F.properties):F.properties;var ue=this.points[F.index].properties,pe=this.options.map(ue);return H&&pe===ue?w({},pe):pe},yn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yn.prototype.splitTile=function(F,H,ue,pe,rt,yt,Ve){for(var ct=[F,H,ue,pe],er=this.options,rr=er.debug;ct.length;){pe=ct.pop(),ue=ct.pop(),H=ct.pop(),F=ct.pop();var jr=1<<H,nn=ta(H,ue,pe),ur=this.tiles[nn];if(!ur&&(rr>1&&console.time("creation"),ur=this.tiles[nn]=Zr(F,H,ue,pe,er),this.tileCoords.push({z:H,x:ue,y:pe}),rr)){rr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,ue,pe,ur.numFeatures,ur.numPoints,ur.numSimplified),console.timeEnd("creation"));var Wr="z"+H;this.stats[Wr]=(this.stats[Wr]||0)+1,this.total++}if(ur.source=F,rt){if(H===er.maxZoom||H===rt)continue;var Tn=1<<rt-H;if(ue!==Math.floor(yt/Tn)||pe!==Math.floor(Ve/Tn))continue}else if(H===er.indexMaxZoom||ur.numPoints<=er.indexMaxPoints)continue;if(ur.source=null,F.length!==0){rr>1&&console.time("clipping");var mr,Jr,vn,Kn,_n,Hr,oa=.5*er.buffer/er.extent,Mr=.5-oa,va=.5+oa,ha=1+oa;mr=Jr=vn=Kn=null,_n=Je(F,jr,ue-oa,ue+va,0,ur.minX,ur.maxX,er),Hr=Je(F,jr,ue+Mr,ue+ha,0,ur.minX,ur.maxX,er),F=null,_n&&(mr=Je(_n,jr,pe-oa,pe+va,1,ur.minY,ur.maxY,er),Jr=Je(_n,jr,pe+Mr,pe+ha,1,ur.minY,ur.maxY,er),_n=null),Hr&&(vn=Je(Hr,jr,pe-oa,pe+va,1,ur.minY,ur.maxY,er),Kn=Je(Hr,jr,pe+Mr,pe+ha,1,ur.minY,ur.maxY,er),Hr=null),rr>1&&console.timeEnd("clipping"),ct.push(mr||[],H+1,2*ue,2*pe),ct.push(Jr||[],H+1,2*ue,2*pe+1),ct.push(vn||[],H+1,2*ue+1,2*pe),ct.push(Kn||[],H+1,2*ue+1,2*pe+1)}}},yn.prototype.getTile=function(F,H,ue){var pe=this.options,rt=pe.extent,yt=pe.debug;if(F<0||F>24)return null;var Ve=1<<F,ct=ta(F,H=(H%Ve+Ve)%Ve,ue);if(this.tiles[ct])return kt(this.tiles[ct],rt);yt>1&&console.log("drilling down to z%d-%d-%d",F,H,ue);for(var er,rr=F,jr=H,nn=ue;!er&&rr>0;)rr--,jr=Math.floor(jr/2),nn=Math.floor(nn/2),er=this.tiles[ta(rr,jr,nn)];return er&&er.source?(yt>1&&console.log("found parent tile z%d-%d-%d",rr,jr,nn),yt>1&&console.time("drilling down"),this.splitTile(er.source,rr,jr,nn,F,H,ue),yt>1&&console.timeEnd("drilling down"),this.tiles[ct]?kt(this.tiles[ct],rt):null):null};var Zn=function(F){function H(ue,pe,rt,yt){F.call(this,ue,pe,rt,ma),yt&&(this.loadGeoJSON=yt)}return F&&(H.__proto__=F),(H.prototype=Object.create(F&&F.prototype)).constructor=H,H.prototype.loadData=function(ue,pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=pe,this._pendingLoadDataParams=ue,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},H.prototype._loadData=function(){var ue=this;if(this._pendingCallback&&this._pendingLoadDataParams){var pe=this._pendingCallback,rt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var yt=!!(rt&&rt.request&&rt.request.collectResourceTiming)&&new o.RequestPerformance(rt.request);this.loadGeoJSON(rt,function(Ve,ct){if(Ve||!ct)return pe(Ve);if(typeof ct!="object")return pe(new Error("Input data given to '"+rt.source+"' is not a valid GeoJSON object."));!function ur(Wr,Tn){var mr,Jr=Wr&&Wr.type;if(Jr==="FeatureCollection")for(mr=0;mr<Wr.features.length;mr++)ur(Wr.features[mr],Tn);else if(Jr==="GeometryCollection")for(mr=0;mr<Wr.geometries.length;mr++)ur(Wr.geometries[mr],Tn);else if(Jr==="Feature")ur(Wr.geometry,Tn);else if(Jr==="Polygon")ht(Wr.coordinates,Tn);else if(Jr==="MultiPolygon")for(mr=0;mr<Wr.coordinates.length;mr++)ht(Wr.coordinates[mr],Tn);return Wr}(ct,!0);try{if(rt.filter){var er=o.createExpression(rt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(er.result==="error")throw new Error(er.value.map(function(ur){return ur.key+": "+ur.message}).join(", "));var rr=ct.features.filter(function(ur){return er.value.evaluate({zoom:0},ur)});ct={type:"FeatureCollection",features:rr}}ue._geoJSONIndex=rt.cluster?new At(function(ur){var Wr=ur.superclusterOptions,Tn=ur.clusterProperties;if(!Tn||!Wr)return Wr;for(var mr={},Jr={},vn={accumulated:null,zoom:0},Kn={properties:null},_n=Object.keys(Tn),Hr=0,oa=_n;Hr<oa.length;Hr+=1){var Mr=oa[Hr],va=Tn[Mr],ha=va[0],da=o.createExpression(va[1]),Ki=o.createExpression(typeof ha=="string"?[ha,["accumulated"],["get",Mr]]:ha);mr[Mr]=da.value,Jr[Mr]=Ki.value}return Wr.map=function(Fi){Kn.properties=Fi;for(var xa={},di=0,Ga=_n;di<Ga.length;di+=1){var In=Ga[di];xa[In]=mr[In].evaluate(vn,Kn)}return xa},Wr.reduce=function(Fi,xa){Kn.properties=xa;for(var di=0,Ga=_n;di<Ga.length;di+=1){var In=Ga[di];vn.accumulated=Fi[In],Fi[In]=Jr[In].evaluate(vn,Kn)}},Wr}(rt)).load(ct.features):function(ur,Wr){return new yn(ur,Wr)}(ct,rt.geojsonVtOptions)}catch(ur){return pe(ur)}ue.loaded={};var jr={};if(yt){var nn=yt.finish();nn&&(jr.resourceTiming={},jr.resourceTiming[rt.source]=JSON.parse(JSON.stringify(nn)))}pe(null,jr)})}},H.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},H.prototype.reloadTile=function(ue,pe){var rt=this.loaded;return rt&&rt[ue.uid]?F.prototype.reloadTile.call(this,ue,pe):this.loadTile(ue,pe)},H.prototype.loadGeoJSON=function(ue,pe){if(ue.request)o.getJSON(ue.request,pe);else{if(typeof ue.data!="string")return pe(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."));try{return pe(null,JSON.parse(ue.data))}catch(rt){return pe(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."))}}},H.prototype.removeSource=function(ue,pe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),pe()},H.prototype.getClusterExpansionZoom=function(ue,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(rt){pe(rt)}},H.prototype.getClusterChildren=function(ue,pe){try{pe(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(rt){pe(rt)}},H.prototype.getClusterLeaves=function(ue,pe){try{pe(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(rt){pe(rt)}},H}(Ge),Wn=function(H){var ue=this;this.self=H,this.actor=new o.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ge,geojson:Zn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(pe,rt){if(ue.workerSourceTypes[pe])throw new Error('Worker source with name "'+pe+'" already registered.');ue.workerSourceTypes[pe]=rt},this.self.registerRTLTextPlugin=function(pe){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=pe.applyArabicShaping,o.plugin.processBidirectionalText=pe.processBidirectionalText,o.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}};return Wn.prototype.setReferrer=function(F,H){this.referrer=H},Wn.prototype.setImages=function(F,H,ue){for(var pe in this.availableImages[F]=H,this.workerSources[F]){var rt=this.workerSources[F][pe];for(var yt in rt)rt[yt].availableImages=H}ue()},Wn.prototype.setLayers=function(F,H,ue){this.getLayerIndex(F).replace(H),ue()},Wn.prototype.updateLayers=function(F,H,ue){this.getLayerIndex(F).update(H.layers,H.removedIds),ue()},Wn.prototype.loadTile=function(F,H,ue){this.getWorkerSource(F,H.type,H.source).loadTile(H,ue)},Wn.prototype.loadDEMTile=function(F,H,ue){this.getDEMWorkerSource(F,H.source).loadTile(H,ue)},Wn.prototype.reloadTile=function(F,H,ue){this.getWorkerSource(F,H.type,H.source).reloadTile(H,ue)},Wn.prototype.abortTile=function(F,H,ue){this.getWorkerSource(F,H.type,H.source).abortTile(H,ue)},Wn.prototype.removeTile=function(F,H,ue){this.getWorkerSource(F,H.type,H.source).removeTile(H,ue)},Wn.prototype.removeDEMTile=function(F,H){this.getDEMWorkerSource(F,H.source).removeTile(H)},Wn.prototype.removeSource=function(F,H,ue){if(this.workerSources[F]&&this.workerSources[F][H.type]&&this.workerSources[F][H.type][H.source]){var pe=this.workerSources[F][H.type][H.source];delete this.workerSources[F][H.type][H.source],pe.removeSource!==void 0?pe.removeSource(H,ue):ue()}},Wn.prototype.loadWorkerSource=function(F,H,ue){try{this.self.importScripts(H.url),ue()}catch(pe){ue(pe.toString())}},Wn.prototype.syncRTLPluginState=function(F,H,ue){try{o.plugin.setState(H);var pe=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&pe!=null){this.self.importScripts(pe);var rt=o.plugin.isParsed();ue(rt?void 0:new Error("RTL Text Plugin failed to import scripts from "+pe),rt)}}catch(yt){ue(yt.toString())}},Wn.prototype.getAvailableImages=function(F){var H=this.availableImages[F];return H||(H=[]),H},Wn.prototype.getLayerIndex=function(F){var H=this.layerIndexes[F];return H||(H=this.layerIndexes[F]=new Y),H},Wn.prototype.getWorkerSource=function(F,H,ue){var pe=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][H]||(this.workerSources[F][H]={}),this.workerSources[F][H][ue]||(this.workerSources[F][H][ue]=new this.workerSourceTypes[H]({send:function(yt,Ve,ct){pe.actor.send(yt,Ve,ct,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][H][ue]},Wn.prototype.getDEMWorkerSource=function(F,H){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][H]||(this.demWorkerSources[F][H]=new Ce),this.demWorkerSources[F][H]},Wn.prototype.enforceCacheSizeLimit=function(F,H){o.enforceCacheSizeLimit(H)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Wn(self)),Wn}),z(["./shared"],function(o){"use strict";var W=o.createCommonjsModule(function(s){function a(y){return!n(y)}function n(y){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var R,k,ie=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ie);try{k=new Worker(Ee),R=!0}catch(We){R=!1}return k&&k.terminate(),URL.revokeObjectURL(Ee),R}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var R=document.createElement("canvas");R.width=R.height=1;var k=R.getContext("2d");if(!k)return!1;var ie=k.getImageData(0,0,1,1);return ie&&ie.width===R.width}()?(l[O=y&&y.failIfMajorPerformanceCaveat]===void 0&&(l[O]=function(R){var k=function(Ee){var We=document.createElement("canvas"),$e=Object.create(a.webGLContextAttributes);return $e.failIfMajorPerformanceCaveat=Ee,We.probablySupportsContext?We.probablySupportsContext("webgl",$e)||We.probablySupportsContext("experimental-webgl",$e):We.supportsContext?We.supportsContext("webgl",$e)||We.supportsContext("experimental-webgl",$e):We.getContext("webgl",$e)||We.getContext("experimental-webgl",$e)}(R);if(!k)return!1;var ie=k.createShader(k.VERTEX_SHADER);return!(!ie||k.isContextLost())&&(k.shaderSource(ie,"void main() {}"),k.compileShader(ie),k.getShaderParameter(ie,k.COMPILE_STATUS)===!0)}(O)),l[O]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var O}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var y=o.window.document.createElement(a);return n!==void 0&&(y.className=n),l&&l.appendChild(y),y},createNS:function(a,n){return o.window.document.createElementNS(a,n)}},Y=o.window.document&&o.window.document.documentElement.style;function q(s){if(!Y)return s[0];for(var a=0;a<s.length;a++)if(s[a]in Y)return s[a];return s[0]}var he,X=q(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){Y&&X&&(he=Y[X],Y[X]="none")},D.enableDrag=function(){Y&&X&&(Y[X]=he)};var je=q(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[je]=a};var Ge=!1;try{var ge=Object.defineProperty({},"passive",{get:function(){Ge=!0}});o.window.addEventListener("test",ge,ge),o.window.removeEventListener("test",ge,ge)}catch(s){Ge=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&Ge?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&Ge?l:l.capture)};var Ce=function s(a){a.preventDefault(),a.stopPropagation(),o.window.removeEventListener("click",s,!0)};function ht(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){o.window.addEventListener("click",Ce,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",Ce,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new o.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],y=0;y<a.length;y++)l.push(new o.Point(a[y].clientX-n.left-s.clientLeft,a[y].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return o.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var Ne=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,y=this.requestors;l<y.length;l+=1){var O=y[l];this._notify(O.ids,O.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var y=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),y=!1),this._validateContent(l.content,l)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),y=!1),y},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var y=0,O=0,R=n;O<R.length;O+=1){var k=R[O];if(k[0]<y||k[1]<k[0]||l<k[1])return!1;y=k[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var y=!0;if(!this.isLoaded())for(var O=0,R=n;O<R.length;O+=1)this.images[R[O]]||(y=!1);this.isLoaded()||y?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var y={},O=0,R=n;O<R.length;O+=1){var k=R[O];this.images[k]||this.fire(new o.Event("styleimagemissing",{id:k}));var ie=this.images[k];ie?y[k]={data:ie.data.clone(),pixelRatio:ie.pixelRatio,sdf:ie.sdf,version:ie.version,stretchX:ie.stretchX,stretchY:ie.stretchY,content:ie.content,hasRenderCallback:Boolean(ie.userImage&&ie.userImage.render)}:o.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,y)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],y=this.getImage(n);if(!y)return null;if(l&&l.position.version===y.version)return l.position;if(l)l.position.version=y.version;else{var O={w:y.data.width+2,h:y.data.height+2,x:0,y:0},R=new o.ImagePosition(O,y);this.patterns[n]={bin:O,position:R}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var y=o.potpack(n),O=y.w,R=y.h,k=this.atlasImage;for(var ie in k.resize({width:O||1,height:R||1}),this.patterns){var Ee=this.patterns[ie].bin,We=Ee.x+1,$e=Ee.y+1,qe=this.images[ie].data,Lt=qe.width,Rt=qe.height;o.RGBAImage.copy(qe,k,{x:0,y:0},{x:We,y:$e},{width:Lt,height:Rt}),o.RGBAImage.copy(qe,k,{x:0,y:Rt-1},{x:We,y:$e-1},{width:Lt,height:1}),o.RGBAImage.copy(qe,k,{x:0,y:0},{x:We,y:$e+Rt},{width:Lt,height:1}),o.RGBAImage.copy(qe,k,{x:Lt-1,y:0},{x:We-1,y:$e},{width:1,height:Rt}),o.RGBAImage.copy(qe,k,{x:0,y:0},{x:We+Lt,y:$e},{width:1,height:Rt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,y=n;l<y.length;l+=1){var O=y[l];if(!this.callbackDispatchedThisFrame[O]){this.callbackDispatchedThisFrame[O]=!0;var R=this.images[O];ht(R)&&this.updateImage(O,R)}}},a}(o.Evented),Et=Ye,He=Ye,mt=1e20;function Ye(s,a,n,l,y,O){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=y||"sans-serif",this.fontWeight=O||"normal",this.radius=n||8;var R=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=R,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.d=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Int16Array(R),this.middle=Math.round(R/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function xt(s,a,n,l,y,O,R){for(var k=0;k<a;k++){for(var ie=0;ie<n;ie++)l[ie]=s[ie*a+k];for(_t(l,y,O,R,n),ie=0;ie<n;ie++)s[ie*a+k]=y[ie]}for(ie=0;ie<n;ie++){for(k=0;k<a;k++)l[k]=s[ie*a+k];for(_t(l,y,O,R,a),k=0;k<a;k++)s[ie*a+k]=Math.sqrt(y[k])}}function _t(s,a,n,l,y){n[0]=0,l[0]=-mt,l[1]=+mt;for(var O=1,R=0;O<y;O++){for(var k=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);k<=l[R];)R--,k=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);n[++R]=O,l[R]=k,l[R+1]=+mt}for(O=0,R=0;O<y;O++){for(;l[R+1]<O;)R++;a[O]=(O-n[R])*(O-n[R])+s[n[R]]}}Ye.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var y=a.data[4*l+3]/255;this.gridOuter[l]=y===1?0:y===0?mt:Math.pow(Math.max(0,.5-y),2),this.gridInner[l]=y===1?mt:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(xt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),xt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},Et.default=He;var Ie=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};Ie.prototype.setURL=function(s){this.url=s},Ie.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var y in s)for(var O=0,R=s[y];O<R.length;O+=1)l.push({stack:y,id:R[O]});o.asyncAll(l,function(k,ie){var Ee=k.stack,We=k.id,$e=n.entries[Ee];$e||($e=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var qe=$e.glyphs[We];if(qe===void 0){if(qe=n._tinySDF($e,Ee,We))return $e.glyphs[We]=qe,void ie(null,{stack:Ee,id:We,glyph:qe});var Lt=Math.floor(We/256);if(256*Lt>65535)ie(new Error("glyphs > 65535 not supported"));else if($e.ranges[Lt])ie(null,{stack:Ee,id:We,glyph:qe});else{var Rt=$e.requests[Lt];Rt||(Rt=$e.requests[Lt]=[],Ie.loadGlyphRange(Ee,Lt,n.url,n.requestManager,function(Gt,Dt){if(Dt){for(var jt in Dt)n._doesCharSupportLocalGlyph(+jt)||($e.glyphs[+jt]=Dt[+jt]);$e.ranges[Lt]=!0}for(var ir=0,Qt=Rt;ir<Qt.length;ir+=1)(0,Qt[ir])(Gt,Dt);delete $e.requests[Lt]})),Rt.push(function(Gt,Dt){Gt?ie(Gt):Dt&&ie(null,{stack:Ee,id:We,glyph:Dt[We]||null})})}}else ie(null,{stack:Ee,id:We,glyph:qe})},function(k,ie){if(k)a(k);else if(ie){for(var Ee={},We=0,$e=ie;We<$e.length;We+=1){var qe=$e[We],Lt=qe.stack,Rt=qe.id,Gt=qe.glyph;(Ee[Lt]||(Ee[Lt]={}))[Rt]=Gt&&{id:Gt.id,bitmap:Gt.bitmap.clone(),metrics:Gt.metrics}}a(null,Ee)}})},Ie.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](s)||o.isChar["Hangul Syllables"](s)||o.isChar.Hiragana(s)||o.isChar.Katakana(s))},Ie.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var y=s.tinySDF;if(!y){var O="400";/bold/i.test(a)?O="900":/medium/i.test(a)?O="500":/light/i.test(a)&&(O="200"),y=s.tinySDF=new Ie.TinySDF(24,3,8,.25,l,O)}return{id:n,bitmap:new o.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ie.loadGlyphRange=function(s,a,n,l,y){var O=256*a,R=O+255,k=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",O+"-"+R),o.ResourceType.Glyphs);o.getArrayBuffer(k,function(ie,Ee){if(ie)y(ie);else if(Ee){for(var We={},$e=0,qe=o.parseGlyphPBF(Ee);$e<qe.length;$e+=1){var Lt=qe[$e];We[Lt.id]=Lt}y(null,We)}})},Ie.TinySDF=Et;var De=function(){this.specification=o.styleSpec.light.position};De.prototype.possiblyEvaluate=function(s,a){return o.sphericalToCartesian(s.expression.evaluate(a))},De.prototype.interpolate=function(s,a,n){return{x:o.number(s.x,a.x,n),y:o.number(s.y,a.y,n),z:o.number(s.z,a.z,n)}};var ze=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new De,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),at=function(s){function a(n){s.call(this),this._transitionable=new o.Transitionable(ze),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(o.validateLight,n,l))for(var y in n){var O=n[y];o.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-"-transition".length),O):this._transitionable.setValue(y,O)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,n.call(o.validateStyle,o.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},a}(o.Evented),Pe=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Pe.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Pe.prototype.getDashRanges=function(s,a,n){var l=[],y=s.length%2==1?-s[s.length-1]*n:0,O=s[0]*n,R=!0;l.push({left:y,right:O,isDash:R,zeroLength:s[0]===0});for(var k=s[0],ie=1;ie<s.length;ie++){var Ee=s[ie];l.push({left:y=k*n,right:O=(k+=Ee)*n,isDash:R=!R,zeroLength:Ee===0})}return l},Pe.prototype.addRoundDash=function(s,a,n){for(var l=a/2,y=-n;y<=n;y++)for(var O=this.width*(this.nextRow+n+y),R=0,k=s[R],ie=0;ie<this.width;ie++){ie/k.right>1&&(k=s[++R]);var Ee=Math.abs(ie-k.left),We=Math.abs(ie-k.right),$e=Math.min(Ee,We),qe=void 0,Lt=y/n*(l+1);if(k.isDash){var Rt=l-Math.abs(Lt);qe=Math.sqrt($e*$e+Rt*Rt)}else qe=l-Math.sqrt($e*$e+Lt*Lt);this.data[O+ie]=Math.max(0,Math.min(255,qe+128))}},Pe.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var y=s[0],O=s[s.length-1];y.isDash===O.isDash&&(y.left=O.left-this.width,O.right=y.right+this.width);for(var R=this.width*this.nextRow,k=0,ie=s[k],Ee=0;Ee<this.width;Ee++){Ee/ie.right>1&&(ie=s[++k]);var We=Math.abs(Ee-ie.left),$e=Math.abs(Ee-ie.right),qe=Math.min(We,$e);this.data[R+Ee]=Math.max(0,Math.min(255,(ie.isDash?qe:-qe)+128))}},Pe.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var y=0,O=0;O<s.length;O++)y+=s[O];if(y!==0){var R=this.width/y,k=this.getDashRanges(s,this.width,R);a?this.addRoundDash(k,R,n):this.addRegularDash(k)}var ie={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:y};return this.nextRow+=l,this.dirty=!0,ie},Pe.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ot=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var l=this.workerPool.acquire(this.id),y=0;y<l.length;y++){var O=new s.Actor(l[y],n,this.id);O.name="Worker "+y,this.actors.push(O)}};function Bt(s,a,n){var l=function(O,R){if(O)return n(O);if(R){var k=o.pick(o.extend(R,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(k.vectorLayers=R.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(ie){return ie.id})),k.tiles=a.canonicalizeTileset(k,s.url),n(null,k)}};return s.url?o.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),o.ResourceType.Source),l):o.browser.frame(function(){return l(null,s)})}ot.prototype.broadcast=function(s,a,n){o.asyncAll(this.actors,function(l,y){l.send(s,a,y)},n=n||function(){})},ot.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ot.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ot.Actor=o.Actor;var Wt=function(a,n,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Wt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Wt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*a),y=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*a),O=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<y&&s.y>=l&&s.y<O};var sr=function(s){function a(n,l,y,O){if(s.call(this),this.id=n,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(l,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Bt(this._options,this.map._requestManager,function(l,y){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):y&&(o.extend(n,y),y.bounds&&(n.tileBounds=new Wt(y.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(y.tiles,n.map._requestManager._customAccessToken),o.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.loadTile=function(n,l){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),O={request:this.map._requestManager.transformRequest(y,o.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function R(k,ie){return delete n.request,n.aborted?l(null):k&&k.status!==404?l(k):(ie&&ie.resourceTiming&&(n.resourceTiming=ie.resourceTiming),this.map._refreshExpiredTiles&&ie&&n.setExpiryData(ie),n.loadVectorData(ie,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",O,R.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",O,R.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(o.Evented),ne=function(s){function a(n,l,y,O){s.call(this),this.id=n,this.dispatcher=y,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},l),o.extend(this,o.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Bt(this._options,this.map._requestManager,function(l,y){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):y&&(o.extend(n,y),y.bounds&&(n.tileBounds=new Wt(y.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(y.tiles),o.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var y=this,O=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=o.getImage(this.map._requestManager.transformRequest(O,o.ResourceType.Tile),function(R,k){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(k){y.map._refreshExpiredTiles&&n.setExpiryData(k),delete k.cacheControl,delete k.expires;var ie=y.map.painter.context,Ee=ie.gl;n.texture=y.map.painter.getTileTexture(k.width),n.texture?n.texture.update(k,{useMipmap:!0}):(n.texture=new o.Texture(ie,k,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ie.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax)),n.state="loaded",o.cacheEntryPossiblyAdded(y.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(o.Evented),$=function(s){function a(n,l,y,O){s.call(this,n,l,y,O),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function O(R,k){R&&(n.state="errored",l(R)),k&&(n.dem=k,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=o.getImage(this.map._requestManager.transformRequest(y,o.ResourceType.Tile),function(R,k){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(k){this.map._refreshExpiredTiles&&n.setExpiryData(k),delete k.cacheControl,delete k.expires;var ie=o.window.ImageBitmap&&k instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?k:o.browser.getImageData(k,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ie,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,O.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,y=Math.pow(2,l.z),O=(l.x-1+y)%y,R=l.x===0?n.wrap-1:n.wrap,k=(l.x+1+y)%y,ie=l.x+1===y?n.wrap+1:n.wrap,Ee={};return Ee[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y).key]={backfilled:!1},Ee[new o.OverscaledTileID(n.overscaledZ,ie,l.z,k,l.y).key]={backfilled:!1},l.y>0&&(Ee[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y-1).key]={backfilled:!1},Ee[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Ee[new o.OverscaledTileID(n.overscaledZ,ie,l.z,k,l.y-1).key]={backfilled:!1}),l.y+1<y&&(Ee[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y+1).key]={backfilled:!1},Ee[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Ee[new o.OverscaledTileID(n.overscaledZ,ie,l.z,k,l.y+1).key]={backfilled:!1}),Ee},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(ne),G=function(s){function a(n,l,y,O){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(O),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var R=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*R,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*R,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius||50)*R,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new o.ErrorEvent(l));else{var y={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(y.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new o.Event("data",y))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)l.fire(new o.ErrorEvent(y));else{var O={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(O.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new o.Event("data",O))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,y,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:y},O),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var y=o.extend({},this.workerOptions),O=this._data;typeof O=="string"?(y.request=this.map._requestManager.transformRequest(o.browser.resolveURL(O),o.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(O),this.actor.send(this.type+".loadData",y,function(R,k){l._removed||k&&k.abandoned||(l._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[l.id]&&(l._resourceTiming=k.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:y.source},null),n(R))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var y=this,O=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(O,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(R,k){return delete n.request,n.unloadVectorData(),n.aborted?l(null):R?l(R):(n.loadVectorData(k,y.map.painter,O==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Ae=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),xe=function(s){function a(n,l,y,O){s.call(this),this.id=n,this.dispatcher=y,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var y=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(O,R){y._loaded=!0,O?y.fire(new o.ErrorEvent(O)):R&&(y.image=R,n&&(y.coordinates=n),l&&l(),y._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var y=n.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(R){for(var k=1/0,ie=1/0,Ee=-1/0,We=-1/0,$e=0,qe=R;$e<qe.length;$e+=1){var Lt=qe[$e];k=Math.min(k,Lt.x),ie=Math.min(ie,Lt.y),Ee=Math.max(Ee,Lt.x),We=Math.max(We,Lt.y)}var Rt=Math.max(Ee-k,We-ie),Gt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),Dt=Math.pow(2,Gt);return new o.CanonicalTileID(Gt,Math.floor((k+Ee)/2*Dt),Math.floor((ie+We)/2*Dt))}(y),this.minzoom=this.maxzoom=this.tileID.z;var O=y.map(function(R){return l.tileID.getTilePoint(R)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(O[2].x,O[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[y];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Se=function(s){function a(n,l,y,O){s.call(this,n,l,y,O),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var y=0,O=l.urls;y<O.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(O[y],o.ResourceType.Source).url);o.getVideo(this.urls,function(R,k){n._loaded=!0,R?n.fire(new o.ErrorEvent(R)):k&&(n.video=k,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[y];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(xe),ve=function(s){function a(n,l,y,O){s.call(this,n,l,y,O),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(R){return!Array.isArray(R)||R.length!==2||R.some(function(k){return typeof k!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,y=l.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var R=this.tiles[O];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var y=l[n];if(isNaN(y)||y<=0)return!0}return!1},a}(xe),et={vector:sr,raster:ne,"raster-dem":$,geojson:G,video:Se,image:xe,canvas:ve};function Yt(s,a){var n=o.identity([]);return o.translate(n,n,[1,1,0]),o.scale(n,n,[.5*s.width,.5*s.height,1]),o.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function At(s,a,n,l,y,O){var R=function(Gt,Dt,jt){if(Gt)for(var ir=0,Qt=Gt;ir<Qt.length;ir+=1){var Lr=Dt[Qt[ir]];if(Lr&&Lr.source===jt&&Lr.type==="fill-extrusion")return!0}else for(var gr in Dt){var Ar=Dt[gr];if(Ar.source===jt&&Ar.type==="fill-extrusion")return!0}return!1}(y&&y.layers,a,s.id),k=O.maxPitchScaleFactor(),ie=s.tilesIn(l,k,R);ie.sort(ye);for(var Ee=[],We=0,$e=ie;We<$e.length;We+=1){var qe=$e[We];Ee.push({wrappedTileID:qe.tileID.wrapped().key,queryResults:qe.tile.queryRenderedFeatures(a,n,s._state,qe.queryGeometry,qe.cameraQueryGeometry,qe.scale,y,O,k,Yt(s.transform,qe.tileID))})}var Lt=function(Gt){for(var Dt={},jt={},ir=0,Qt=Gt;ir<Qt.length;ir+=1){var Lr=Qt[ir],gr=Lr.queryResults,Ar=Lr.wrappedTileID,Or=jt[Ar]=jt[Ar]||{};for(var Kr in gr)for(var Qr=gr[Kr],dn=Or[Kr]=Or[Kr]||{},wn=Dt[Kr]=Dt[Kr]||[],ra=0,ya=Qr;ra<ya.length;ra+=1){var Ta=ya[ra];dn[Ta.featureIndex]||(dn[Ta.featureIndex]=!0,wn.push(Ta))}}return Dt}(Ee);for(var Rt in Lt)Lt[Rt].forEach(function(Gt){var Dt=Gt.feature,jt=s.getFeatureState(Dt.layer["source-layer"],Dt.id);Dt.source=Dt.layer.source,Dt.layer["source-layer"]&&(Dt.sourceLayer=Dt.layer["source-layer"]),Dt.state=jt});return Lt}function ye(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var be=function(a,n){this.max=a,this.onRemove=n,this.reset()};be.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},be.prototype.add=function(s,a,n){var l=this,y=s.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var O={value:a,timeout:void 0};if(n!==void 0&&(O.timeout=setTimeout(function(){l.remove(s,O)},n)),this.data[y].push(O),this.order.push(y),this.order.length>this.max){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},be.prototype.has=function(s){return s.wrapped().key in this.data},be.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},be.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},be.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},be.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},be.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),y=this.data[n][l];return this.data[n].splice(l,1),y.timeout&&clearTimeout(y.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(y.value),this.order.splice(this.order.indexOf(n),1),this},be.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},be.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,y=this.data[n];l<y.length;l+=1){var O=y[l];s(O.value)||a.push(O)}for(var R=0,k=a;R<k.length;R+=1){var ie=k[R];this.remove(ie.value.tileID,ie)}};var Ue=function(a,n,l){this.context=a;var y=a.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ue.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ue.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Ue.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var st={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Me=function(a,n,l,y){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=y,this.context=a;var O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Me.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Me.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Me.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Me.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var y=this.attributes[l],O=a.attributes[y.name];O!==void 0&&s.vertexAttribPointer(O,y.components,s[st[y.type]],!1,this.itemSize,y.offset+this.itemSize*(n||0))}},Me.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ft=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ft.prototype.get=function(){return this.current},ft.prototype.set=function(s){},ft.prototype.getDefault=function(){return this.default},ft.prototype.setDefault=function(){this.set(this.default)};var w=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ft),I=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(ft),J=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(ft),ce=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ft),Be=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(ft),Xe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(ft),gt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(ft),tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(ft),It=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(ft),K=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ft),Ze=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(ft),te=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(ft),Je=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(ft),zt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(ft),cr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(ft),lt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(ft),dt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(ft),Ct=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(ft),pt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(ft),we=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(ft),ut=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(ft),Ke=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(ft),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(ft),yr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(ft),Zr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(ft),hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(ft),jn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(ft),yn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(ft),ta=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(ft),ma=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(ft),Zn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(ft),Wn=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(ft),F=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(Wn),H=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(Wn),ue=function(a,n,l,y){this.context=a,this.width=n,this.height=l;var O=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new F(a,O),y&&(this.depthAttachment=new H(a,O))};ue.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var pe=function(a,n,l){this.func=a,this.mask=n,this.range=l};pe.ReadOnly=!1,pe.ReadWrite=!0,pe.disabled=new pe(519,pe.ReadOnly,[0,1]);var rt=function(a,n,l,y,O,R){this.test=a,this.ref=n,this.mask=l,this.fail=y,this.depthFail=O,this.pass=R};rt.disabled=new rt({func:519,mask:0},0,0,7680,7680,7680);var yt=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};yt.disabled=new yt(yt.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),yt.unblended=new yt(yt.Replace,o.Color.transparent,[!0,!0,!0,!0]),yt.alphaBlended=new yt([1,771],o.Color.transparent,[!0,!0,!0,!0]);var Ve=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};Ve.disabled=new Ve(!1,1029,2305),Ve.backCCW=new Ve(!0,1029,2305);var ct=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new w(this),this.clearDepth=new I(this),this.clearStencil=new J(this),this.colorMask=new ce(this),this.depthMask=new Be(this),this.stencilMask=new Xe(this),this.stencilFunc=new gt(this),this.stencilOp=new tt(this),this.stencilTest=new It(this),this.depthRange=new K(this),this.depthTest=new Ze(this),this.depthFunc=new te(this),this.blend=new Je(this),this.blendFunc=new zt(this),this.blendColor=new cr(this),this.blendEquation=new lt(this),this.cullFace=new dt(this),this.cullFaceSide=new Ct(this),this.frontFace=new pt(this),this.program=new we(this),this.activeTexture=new ut(this),this.viewport=new Ke(this),this.bindFramebuffer=new kt(this),this.bindRenderbuffer=new yr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new hr(this),this.bindElementBuffer=new jn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new yn(this),this.pixelStoreUnpack=new ta(this),this.pixelStoreUnpackPremultiplyAlpha=new ma(this),this.pixelStoreUnpackFlipY=new Zn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};ct.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ct.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ct.prototype.createIndexBuffer=function(s,a){return new Ue(this,s,a)},ct.prototype.createVertexBuffer=function(s,a,n){return new Me(this,s,a,n)},ct.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,y=l.createRenderbuffer();return this.bindRenderbuffer.set(y),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),y},ct.prototype.createFramebuffer=function(s,a,n){return new ue(this,s,a,n)},ct.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,y=0;a&&(y|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(y|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(y)},ct.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},ct.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},ct.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},ct.prototype.setColorMode=function(s){o.deepEqual(s.blendFunction,yt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},ct.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var er=function(s){function a(n,l,y){var O=this;s.call(this),this.id=n,this.dispatcher=y,this.on("data",function(R){R.dataType==="source"&&R.sourceDataType==="metadata"&&(O._sourceLoaded=!0),O._sourceLoaded&&!O._paused&&R.dataType==="source"&&R.sourceDataType==="content"&&(O.reload(),O.transform&&O.update(O.transform))}),this.on("error",function(){O._sourceErrored=!0}),this._source=function(R,k,ie,Ee){var We=new et[k.type](R,k,ie,Ee);if(We.id!==R)throw new Error("Expected Source id to be "+R+" instead of "+We.id);return o.bindAll(["load","abort","unload","serialize","prepare"],We),We}(n,l,y,this),this._tiles={},this._cache=new be(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[l];y.upload(n),y.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return o.values(this._tiles).map(function(n){return n.tileID}).sort(rr).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,y=[];for(var O in this._tiles)this._isIdRenderable(O,n)&&y.push(this._tiles[O]);return n?y.sort(function(R,k){var ie=R.tileID,Ee=k.tileID,We=new o.Point(ie.canonical.x,ie.canonical.y)._rotate(l.transform.angle),$e=new o.Point(Ee.canonical.x,Ee.canonical.y)._rotate(l.transform.angle);return ie.overscaledZ-Ee.overscaledZ||$e.y-We.y||$e.x-We.x}).map(function(R){return R.tileID.key}):y.map(function(R){return R.tileID}).sort(rr).map(function(R){return R.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var y=this._tiles[n];y&&(y.state!=="loading"&&(y.state=l),this._loadTile(y,this._tileLoaded.bind(this,y,n,l)))},a.prototype._tileLoaded=function(n,l,y,O){if(O)return n.state="errored",void(O.status!==404?this._source.fire(new o.ErrorEvent(O,{tile:n})):this.update(this.transform));n.timeAdded=o.browser.now(),y==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),y=0;y<l.length;y++){var O=l[y];if(n.neighboringTiles&&n.neighboringTiles[O]){var R=this.getTileByID(O);k(n,R),k(R,n)}}function k(ie,Ee){ie.needsHillshadePrepare=!0;var We=Ee.tileID.canonical.x-ie.tileID.canonical.x,$e=Ee.tileID.canonical.y-ie.tileID.canonical.y,qe=Math.pow(2,ie.tileID.canonical.z),Lt=Ee.tileID.key;We===0&&$e===0||Math.abs($e)>1||(Math.abs(We)>1&&(Math.abs(We+qe)===1?We+=qe:Math.abs(We-qe)===1&&(We-=qe)),Ee.dem&&ie.dem&&(ie.dem.backfillBorder(Ee.dem,We,$e),ie.neighboringTiles&&ie.neighboringTiles[Lt]&&(ie.neighboringTiles[Lt].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,y,O){for(var R in this._tiles){var k=this._tiles[R];if(!(O[R]||!k.hasData()||k.tileID.overscaledZ<=l||k.tileID.overscaledZ>y)){for(var ie=k.tileID;k&&k.tileID.overscaledZ>l+1;){var Ee=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[Ee.key])&&k.hasData()&&(ie=Ee)}for(var We=ie;We.overscaledZ>l;)if(n[(We=We.scaledTo(We.overscaledZ-1)).key]){O[ie.key]=ie;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var y=this._loadedParentTiles[n.key];return y&&y.tileID.overscaledZ>=l?y:null}for(var O=n.overscaledZ-1;O>=l;O--){var R=n.scaledTo(O),k=this._getLoadedTile(R);if(k)return k}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,y=Math.ceil(n.height/this._source.tileSize)+1,O=Math.floor(l*y*5),R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(R)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var y={};for(var O in this._tiles){var R=this._tiles[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+l),y[R.tileID.key]=R}for(var k in this._tiles=y,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var ie in this._tiles)this._setTileReloadTimer(ie,this._tiles[ie])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Or){return new o.OverscaledTileID(Or.canonical.z,Or.wrap,Or.canonical.z,Or.canonical.x,Or.canonical.y)}):(y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(Or){return l._source.hasTile(Or)}))):y=[];var O=n.coveringZoomLevel(this._source),R=Math.max(O-a.maxOverzooming,this._source.minzoom),k=Math.max(O+a.maxUnderzooming,this._source.minzoom),ie=this._updateRetainedTiles(y,O);if(jr(this._source.type)){for(var Ee={},We={},$e=0,qe=Object.keys(ie);$e<qe.length;$e+=1){var Lt=qe[$e],Rt=ie[Lt],Gt=this._tiles[Lt];if(Gt&&!(Gt.fadeEndTime&&Gt.fadeEndTime<=o.browser.now())){var Dt=this.findLoadedParent(Rt,R);Dt&&(this._addTile(Dt.tileID),Ee[Dt.tileID.key]=Dt.tileID),We[Lt]=Rt}}for(var jt in this._retainLoadedChildren(We,O,k,ie),Ee)ie[jt]||(this._coveredTiles[jt]=!0,ie[jt]=Ee[jt])}for(var ir in ie)this._tiles[ir].clearFadeHold();for(var Qt=0,Lr=o.keysDifference(this._tiles,ie);Qt<Lr.length;Qt+=1){var gr=Lr[Qt],Ar=this._tiles[gr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var y={},O={},R=Math.max(l-a.maxOverzooming,this._source.minzoom),k=Math.max(l+a.maxUnderzooming,this._source.minzoom),ie={},Ee=0,We=n;Ee<We.length;Ee+=1){var $e=We[Ee],qe=this._addTile($e);y[$e.key]=$e,qe.hasData()||l<this._source.maxzoom&&(ie[$e.key]=$e)}this._retainLoadedChildren(ie,l,k,y);for(var Lt=0,Rt=n;Lt<Rt.length;Lt+=1){var Gt=Rt[Lt],Dt=this._tiles[Gt.key];if(!Dt.hasData()){if(l+1>this._source.maxzoom){var jt=Gt.children(this._source.maxzoom)[0],ir=this.getTile(jt);if(ir&&ir.hasData()){y[jt.key]=jt;continue}}else{var Qt=Gt.children(this._source.maxzoom);if(y[Qt[0].key]&&y[Qt[1].key]&&y[Qt[2].key]&&y[Qt[3].key])continue}for(var Lr=Dt.wasRequested(),gr=Gt.overscaledZ-1;gr>=R;--gr){var Ar=Gt.scaledTo(gr);if(O[Ar.key])break;if(O[Ar.key]=!0,!(Dt=this.getTile(Ar))&&Lr&&(Dt=this._addTile(Ar)),Dt&&(y[Ar.key]=Ar,Lr=Dt.wasRequested(),Dt.hasData()))break}}}return y},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],y=void 0,O=this._tiles[n].tileID;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){y=this._loadedParentTiles[O.key];break}l.push(O.key);var R=O.scaledTo(O.overscaledZ-1);if(y=this._getLoadedTile(R))break;O=R}for(var k=0,ie=l;k<ie.length;k+=1)this._loadedParentTiles[ie[k]]=y}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var y=Boolean(l);return y||(l=new o.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,y||this._source.fire(new o.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var y=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var O=l.getExpiryTimeout();O&&(this._timers[n]=setTimeout(function(){y._reloadTile(n,"expired"),delete y._timers[n]},O))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,y){var O=this,R=[],k=this.transform;if(!k)return R;for(var ie=y?k.getCameraQueryGeometry(n):n,Ee=n.map(function(gr){return k.pointCoordinate(gr)}),We=ie.map(function(gr){return k.pointCoordinate(gr)}),$e=this.getIds(),qe=1/0,Lt=1/0,Rt=-1/0,Gt=-1/0,Dt=0,jt=We;Dt<jt.length;Dt+=1){var ir=jt[Dt];qe=Math.min(qe,ir.x),Lt=Math.min(Lt,ir.y),Rt=Math.max(Rt,ir.x),Gt=Math.max(Gt,ir.y)}for(var Qt=function(Ar){var Or=O._tiles[$e[Ar]];if(!Or.holdingForFade()){var Kr=Or.tileID,Qr=Math.pow(2,k.zoom-Or.tileID.overscaledZ),dn=l*Or.queryPadding*o.EXTENT/Or.tileSize/Qr,wn=[Kr.getTilePoint(new o.MercatorCoordinate(qe,Lt)),Kr.getTilePoint(new o.MercatorCoordinate(Rt,Gt))];if(wn[0].x-dn<o.EXTENT&&wn[0].y-dn<o.EXTENT&&wn[1].x+dn>=0&&wn[1].y+dn>=0){var ra=Ee.map(function(Ta){return Kr.getTilePoint(Ta)}),ya=We.map(function(Ta){return Kr.getTilePoint(Ta)});R.push({tile:Or,tileID:Kr,queryGeometry:ra,cameraQueryGeometry:ya,scale:Qr})}}},Lr=0;Lr<$e.length;Lr++)Qt(Lr);return R},a.prototype.getVisibleCoordinates=function(n){for(var l=this,y=this.getRenderableIds(n).map(function(ie){return l._tiles[ie].tileID}),O=0,R=y;O<R.length;O+=1){var k=R[O];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return y},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(jr(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,y){this._state.updateState(n=n||"_geojsonTileLayer",l,y)},a.prototype.removeFeatureState=function(n,l,y){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,y)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,y){var O=this._tiles[n];O&&O.setDependencies(l,y)},a.prototype.reloadTilesForDependencies=function(n,l){for(var y in this._tiles)this._tiles[y].hasDependency(n,l)&&this._reloadTile(y,"reloading");this._cache.filter(function(O){return!O.hasDependency(n,l)})},a}(o.Evented);function rr(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function jr(s){return s==="raster"||s==="image"||s==="video"}function nn(){return new o.window.Worker(Qu.workerUrl)}er.maxOverzooming=10,er.maxUnderzooming=3;var ur="mapboxgl_preloaded_worker_pool",Wr=function(){this.active={}};Wr.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Wr.workerCount;)this.workers.push(new nn);return this.active[s]=!0,this.workers.slice()},Wr.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Wr.prototype.isPreloaded=function(){return!!this.active[ur]},Wr.prototype.numActive=function(){return Object.keys(this.active).length};var Tn,mr=Math.floor(o.browser.hardwareConcurrency/2);function Jr(){return Tn||(Tn=new Wr),Tn}function vn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return o.refProperties.forEach(function(y){y in a&&(n[y]=a[y])}),n}function Kn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=vn(s[l],a[s[l].ref]));return s}Wr.workerCount=Math.max(Math.min(mr,6),1);var _n={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Hr(s,a,n){n.push({command:_n.addSource,args:[s,a[s]]})}function oa(s,a,n){a.push({command:_n.removeSource,args:[s]}),n[s]=!0}function Mr(s,a,n,l){oa(s,n,l),Hr(s,a,n)}function va(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;return!0}function ha(s,a,n,l,y,O){var R;for(R in a=a||{},s=s||{})s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],y]}));for(R in a)a.hasOwnProperty(R)&&!s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],y]}))}function da(s){return s.id}function Ki(s,a){return s[a.id]=a,s}var Fi=function(a,n){this.reset(a,n)};Fi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Fi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=o.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var y=a-1,O=this._distances[y],R=n-O,k=R>0?(l-O)/R:0;return this.points[y].mult(1-k).add(this.points[a].mult(k))};var xa=function(a,n,l){var y=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var R=0;R<this.xCellCount*this.yCellCount;R++)y.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function di(s,a,n,l,y){var O=o.create();return a?(o.scale(O,O,[1/y,1/y,1]),n||o.rotateZ(O,O,l.angle)):o.multiply(O,l.labelPlaneMatrix,s),O}function Ga(s,a,n,l,y){if(a){var O=o.clone(s);return o.scale(O,O,[y,y,1]),n||o.rotateZ(O,O,-l.angle),O}return l.glCoordMatrix}function In(s,a){var n=[s.x,s.y,0,1];Pu(n,n,a);var l=n[3];return{point:new o.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function Oi(s,a){return .5+s/a*.5}function $i(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function Ti(s,a,n,l,y,O,R,k){var ie=l?s.textSizeData:s.iconSizeData,Ee=o.evaluateSizeForZoom(ie,n.transform.zoom),We=[256/n.width*2+1,256/n.height*2+1],$e=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;$e.clear();for(var qe=s.lineVertexArray,Lt=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Rt=n.transform.width/n.transform.height,Gt=!1,Dt=0;Dt<Lt.length;Dt++){var jt=Lt.get(Dt);if(jt.hidden||jt.writingMode===o.WritingMode.vertical&&!Gt)Za(jt.numGlyphs,$e);else{Gt=!1;var ir=[jt.anchorX,jt.anchorY,0,1];if(o.transformMat4(ir,ir,a),$i(ir,We)){var Qt=Oi(n.transform.cameraToCenterDistance,ir[3]),Lr=o.evaluateSizeForFeature(ie,Ee,jt),gr=R?Lr/Qt:Lr*Qt,Ar=new o.Point(jt.anchorX,jt.anchorY),Or=In(Ar,y).point,Kr={},Qr=hu(jt,gr,!1,k,a,y,O,s.glyphOffsetArray,qe,$e,Or,Ar,Kr,Rt);Gt=Qr.useVertical,(Qr.notEnoughRoom||Gt||Qr.needsFlipping&&hu(jt,gr,!0,k,a,y,O,s.glyphOffsetArray,qe,$e,Or,Ar,Kr,Rt).notEnoughRoom)&&Za(jt.numGlyphs,$e)}else Za(jt.numGlyphs,$e)}}l?s.text.dynamicLayoutVertexBuffer.updateData($e):s.icon.dynamicLayoutVertexBuffer.updateData($e)}function Io(s,a,n,l,y,O,R,k,ie,Ee,We){var $e=k.glyphStartIndex+k.numGlyphs,qe=k.lineStartIndex,Lt=k.lineStartIndex+k.lineLength,Rt=a.getoffsetX(k.glyphStartIndex),Gt=a.getoffsetX($e-1),Dt=ws(s*Rt,n,l,y,O,R,k.segment,qe,Lt,ie,Ee,We);if(!Dt)return null;var jt=ws(s*Gt,n,l,y,O,R,k.segment,qe,Lt,ie,Ee,We);return jt?{first:Dt,last:jt}:null}function fu(s,a,n,l){return s===o.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===o.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function hu(s,a,n,l,y,O,R,k,ie,Ee,We,$e,qe,Lt){var Rt,Gt=a/24,Dt=s.lineOffsetX*Gt,jt=s.lineOffsetY*Gt;if(s.numGlyphs>1){var ir=s.glyphStartIndex+s.numGlyphs,Qt=s.lineStartIndex,Lr=s.lineStartIndex+s.lineLength,gr=Io(Gt,k,Dt,jt,n,We,$e,s,ie,O,qe);if(!gr)return{notEnoughRoom:!0};var Ar=In(gr.first.point,R).point,Or=In(gr.last.point,R).point;if(l&&!n){var Kr=fu(s.writingMode,Ar,Or,Lt);if(Kr)return Kr}Rt=[gr.first];for(var Qr=s.glyphStartIndex+1;Qr<ir-1;Qr++)Rt.push(ws(Gt*k.getoffsetX(Qr),Dt,jt,n,We,$e,s.segment,Qt,Lr,ie,O,qe));Rt.push(gr.last)}else{if(l&&!n){var dn=In($e,y).point,wn=s.lineStartIndex+s.segment+1,ra=new o.Point(ie.getx(wn),ie.gety(wn)),ya=In(ra,y),Ta=ya.signedDistanceFromCamera>0?ya.point:pa($e,ra,dn,1,y),Ja=fu(s.writingMode,dn,Ta,Lt);if(Ja)return Ja}var Mn=ws(Gt*k.getoffsetX(s.glyphStartIndex),Dt,jt,n,We,$e,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ie,O,qe);if(!Mn)return{notEnoughRoom:!0};Rt=[Mn]}for(var ba=0,ca=Rt;ba<ca.length;ba+=1){var Fn=ca[ba];o.addDynamicAttributes(Ee,Fn.point,Fn.angle)}return{}}function pa(s,a,n,l,y){var O=In(s.add(s.sub(a)._unit()),y).point,R=n.sub(O);return n.add(R._mult(l/R.mag()))}function ws(s,a,n,l,y,O,R,k,ie,Ee,We,$e){var qe=l?s-a:s+a,Lt=qe>0?1:-1,Rt=0;l&&(Lt*=-1,Rt=Math.PI),Lt<0&&(Rt+=Math.PI);for(var Gt=Lt>0?k+R:k+R+1,Dt=y,jt=y,ir=0,Qt=0,Lr=Math.abs(qe),gr=[];ir+Qt<=Lr;){if((Gt+=Lt)<k||Gt>=ie)return null;if(jt=Dt,gr.push(Dt),(Dt=$e[Gt])===void 0){var Ar=new o.Point(Ee.getx(Gt),Ee.gety(Gt)),Or=In(Ar,We);if(Or.signedDistanceFromCamera>0)Dt=$e[Gt]=Or.point;else{var Kr=Gt-Lt;Dt=pa(ir===0?O:new o.Point(Ee.getx(Kr),Ee.gety(Kr)),Ar,jt,Lr-ir+1,We)}}ir+=Qt,Qt=jt.dist(Dt)}var Qr=(Lr-ir)/Qt,dn=Dt.sub(jt),wn=dn.mult(Qr)._add(jt);wn._add(dn._unit()._perp()._mult(n*Lt));var ra=Rt+Math.atan2(Dt.y-jt.y,Dt.x-jt.x);return gr.push(wn),{point:wn,angle:ra,path:gr}}xa.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},xa.prototype.insert=function(s,a,n,l,y){this._forEachCell(a,n,l,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(y)},xa.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},xa.prototype._insertBoxCell=function(s,a,n,l,y,O){this.boxCells[y].push(O)},xa.prototype._insertCircleCell=function(s,a,n,l,y,O){this.circleCells[y].push(O)},xa.prototype._query=function(s,a,n,l,y,O){if(n<0||s>this.width||l<0||a>this.height)return!y&&[];var R=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(y)return!0;for(var k=0;k<this.boxKeys.length;k++)R.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var ie=0;ie<this.circleKeys.length;ie++){var Ee=this.circles[3*ie],We=this.circles[3*ie+1],$e=this.circles[3*ie+2];R.push({key:this.circleKeys[ie],x1:Ee-$e,y1:We-$e,x2:Ee+$e,y2:We+$e})}return O?R.filter(O):R}return this._forEachCell(s,a,n,l,this._queryCell,R,{hitTest:y,seenUids:{box:{},circle:{}}},O),y?R.length>0:R},xa.prototype._queryCircle=function(s,a,n,l,y){var O=s-n,R=s+n,k=a-n,ie=a+n;if(R<0||O>this.width||ie<0||k>this.height)return!l&&[];var Ee=[];return this._forEachCell(O,k,R,ie,this._queryCellCircle,Ee,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},y),l?Ee.length>0:Ee},xa.prototype.query=function(s,a,n,l,y){return this._query(s,a,n,l,!1,y)},xa.prototype.hitTest=function(s,a,n,l,y){return this._query(s,a,n,l,!0,y)},xa.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},xa.prototype._queryCell=function(s,a,n,l,y,O,R,k){var ie=R.seenUids,Ee=this.boxCells[y];if(Ee!==null)for(var We=this.bboxes,$e=0,qe=Ee;$e<qe.length;$e+=1){var Lt=qe[$e];if(!ie.box[Lt]){ie.box[Lt]=!0;var Rt=4*Lt;if(s<=We[Rt+2]&&a<=We[Rt+3]&&n>=We[Rt+0]&&l>=We[Rt+1]&&(!k||k(this.boxKeys[Lt]))){if(R.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[Lt],x1:We[Rt],y1:We[Rt+1],x2:We[Rt+2],y2:We[Rt+3]})}}}var Gt=this.circleCells[y];if(Gt!==null)for(var Dt=this.circles,jt=0,ir=Gt;jt<ir.length;jt+=1){var Qt=ir[jt];if(!ie.circle[Qt]){ie.circle[Qt]=!0;var Lr=3*Qt;if(this._circleAndRectCollide(Dt[Lr],Dt[Lr+1],Dt[Lr+2],s,a,n,l)&&(!k||k(this.circleKeys[Qt]))){if(R.hitTest)return O.push(!0),!0;var gr=Dt[Lr],Ar=Dt[Lr+1],Or=Dt[Lr+2];O.push({key:this.circleKeys[Qt],x1:gr-Or,y1:Ar-Or,x2:gr+Or,y2:Ar+Or})}}}},xa.prototype._queryCellCircle=function(s,a,n,l,y,O,R,k){var ie=R.circle,Ee=R.seenUids,We=this.boxCells[y];if(We!==null)for(var $e=this.bboxes,qe=0,Lt=We;qe<Lt.length;qe+=1){var Rt=Lt[qe];if(!Ee.box[Rt]){Ee.box[Rt]=!0;var Gt=4*Rt;if(this._circleAndRectCollide(ie.x,ie.y,ie.radius,$e[Gt+0],$e[Gt+1],$e[Gt+2],$e[Gt+3])&&(!k||k(this.boxKeys[Rt])))return O.push(!0),!0}}var Dt=this.circleCells[y];if(Dt!==null)for(var jt=this.circles,ir=0,Qt=Dt;ir<Qt.length;ir+=1){var Lr=Qt[ir];if(!Ee.circle[Lr]){Ee.circle[Lr]=!0;var gr=3*Lr;if(this._circlesCollide(jt[gr],jt[gr+1],jt[gr+2],ie.x,ie.y,ie.radius)&&(!k||k(this.circleKeys[Lr])))return O.push(!0),!0}}},xa.prototype._forEachCell=function(s,a,n,l,y,O,R,k){for(var ie=this._convertToXCellCoord(s),Ee=this._convertToYCellCoord(a),We=this._convertToXCellCoord(n),$e=this._convertToYCellCoord(l),qe=ie;qe<=We;qe++)for(var Lt=Ee;Lt<=$e;Lt++)if(y.call(this,s,a,n,l,this.xCellCount*Lt+qe,O,R,k))return},xa.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},xa.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},xa.prototype._circlesCollide=function(s,a,n,l,y,O){var R=l-s,k=y-a,ie=n+O;return ie*ie>R*R+k*k},xa.prototype._circleAndRectCollide=function(s,a,n,l,y,O,R){var k=(O-l)/2,ie=Math.abs(s-(l+k));if(ie>k+n)return!1;var Ee=(R-y)/2,We=Math.abs(a-(y+Ee));if(We>Ee+n)return!1;if(ie<=k||We<=Ee)return!0;var $e=ie-k,qe=We-Ee;return $e*$e+qe*qe<=n*n};var po=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Za(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(po,3*l)}}function Pu(s,a,n){var l=a[0],y=a[1];return s[0]=n[0]*l+n[4]*y+n[12],s[1]=n[1]*l+n[5]*y+n[13],s[3]=n[3]*l+n[7]*y+n[15],s}var Mi=function(a,n,l){n===void 0&&(n=new xa(a.width+200,a.height+200,25)),l===void 0&&(l=new xa(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function _i(s,a,n){return a*(o.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}Mi.prototype.placeCollisionBox=function(s,a,n,l,y){var O=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),R=n*O.perspectiveRatio,k=s.x1*R+O.point.x,ie=s.y1*R+O.point.y,Ee=s.x2*R+O.point.x,We=s.y2*R+O.point.y;return!this.isInsideGrid(k,ie,Ee,We)||!a&&this.grid.hitTest(k,ie,Ee,We,y)?{box:[],offscreen:!1}:{box:[k,ie,Ee,We],offscreen:this.isOffscreen(k,ie,Ee,We)}},Mi.prototype.placeCollisionCircles=function(s,a,n,l,y,O,R,k,ie,Ee,We,$e,qe){var Lt=[],Rt=new o.Point(a.anchorX,a.anchorY),Gt=In(Rt,O),Dt=Oi(this.transform.cameraToCenterDistance,Gt.signedDistanceFromCamera),jt=(Ee?y/Dt:y*Dt)/o.ONE_EM,ir=In(Rt,R).point,Qt=Io(jt,l,a.lineOffsetX*jt,a.lineOffsetY*jt,!1,ir,Rt,a,n,R,{}),Lr=!1,gr=!1,Ar=!0;if(Qt){for(var Or=.5*$e*Dt+qe,Kr=new o.Point(-100,-100),Qr=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),dn=new Fi,wn=Qt.first,ra=Qt.last,ya=[],Ta=wn.path.length-1;Ta>=1;Ta--)ya.push(wn.path[Ta]);for(var Ja=1;Ja<ra.path.length;Ja++)ya.push(ra.path[Ja]);var Mn=2.5*Or;if(k){var ba=ya.map(function(Ws){return In(Ws,k)});ya=ba.some(function(Ws){return Ws.signedDistanceFromCamera<=0})?[]:ba.map(function(Ws){return Ws.point})}var ca=[];if(ya.length>0){for(var Fn=ya[0].clone(),Ma=ya[0].clone(),Qn=1;Qn<ya.length;Qn++)Fn.x=Math.min(Fn.x,ya[Qn].x),Fn.y=Math.min(Fn.y,ya[Qn].y),Ma.x=Math.max(Ma.x,ya[Qn].x),Ma.y=Math.max(Ma.y,ya[Qn].y);ca=Fn.x>=Kr.x&&Ma.x<=Qr.x&&Fn.y>=Kr.y&&Ma.y<=Qr.y?[ya]:Ma.x<Kr.x||Fn.x>Qr.x||Ma.y<Kr.y||Fn.y>Qr.y?[]:o.clipLine([ya],Kr.x,Kr.y,Qr.x,Qr.y)}for(var Da=0,ai=ca;Da<ai.length;Da+=1){var uo;dn.reset(ai[Da],.25*Or),uo=dn.length<=.5*Or?1:Math.ceil(dn.paddedLength/Mn)+1;for(var ro=0;ro<uo;ro++){var Wi=ro/Math.max(uo-1,1),xi=dn.lerp(Wi),no=xi.x+100,Go=xi.y+100;Lt.push(no,Go,Or,0);var Tu=no-Or,_l=Go-Or,Hs=no+Or,fs=Go+Or;if(Ar=Ar&&this.isOffscreen(Tu,_l,Hs,fs),gr=gr||this.isInsideGrid(Tu,_l,Hs,fs),!s&&this.grid.hitTestCircle(no,Go,Or,We)&&(Lr=!0,!ie))return{circles:[],offscreen:!1,collisionDetected:Lr}}}}return{circles:!ie&&Lr||!gr?[]:Lt,offscreen:Ar,collisionDetected:Lr}},Mi.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,y=-1/0,O=-1/0,R=0,k=s;R<k.length;R+=1){var ie=k[R],Ee=new o.Point(ie.x+100,ie.y+100);n=Math.min(n,Ee.x),l=Math.min(l,Ee.y),y=Math.max(y,Ee.x),O=Math.max(O,Ee.y),a.push(Ee)}for(var We={},$e={},qe=0,Lt=this.grid.query(n,l,y,O).concat(this.ignoredGrid.query(n,l,y,O));qe<Lt.length;qe+=1){var Rt=Lt[qe],Gt=Rt.key;if(We[Gt.bucketInstanceId]===void 0&&(We[Gt.bucketInstanceId]={}),!We[Gt.bucketInstanceId][Gt.featureIndex]){var Dt=[new o.Point(Rt.x1,Rt.y1),new o.Point(Rt.x2,Rt.y1),new o.Point(Rt.x2,Rt.y2),new o.Point(Rt.x1,Rt.y2)];o.polygonIntersectsPolygon(a,Dt)&&(We[Gt.bucketInstanceId][Gt.featureIndex]=!0,$e[Gt.bucketInstanceId]===void 0&&($e[Gt.bucketInstanceId]=[]),$e[Gt.bucketInstanceId].push(Gt.featureIndex))}}return $e},Mi.prototype.insertCollisionBox=function(s,a,n,l,y){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:y},s[0],s[1],s[2],s[3])},Mi.prototype.insertCollisionCircles=function(s,a,n,l,y){for(var O=a?this.ignoredGrid:this.grid,R={bucketInstanceId:n,featureIndex:l,collisionGroupID:y},k=0;k<s.length;k+=4)O.insertCircle(R,s[k],s[k+1],s[k+2])},Mi.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Pu(l,l,s),{point:new o.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Mi.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Mi.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Mi.prototype.getViewportMatrix=function(){var s=o.identity([]);return o.translate(s,s,[-100,-100,0]),s};var _o=function(a,n,l,y){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):y&&l?1:0,this.placed=l};_o.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var as=function(a,n,l,y,O){this.text=new _o(a?a.text:null,n,l,O),this.icon=new _o(a?a.icon:null,n,y,O)};as.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var So=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},Ol=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Os=function(a,n,l,y,O){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=y,this.tileID=O},so=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function du(s,a,n,l,y){var O=o.getAnchorAlignment(s),R=-(O.horizontalAlign-.5)*a,k=-(O.verticalAlign-.5)*n,ie=o.evaluateVariableOffset(s,l);return new o.Point(R+ie[0]*y,k+ie[1]*y)}function Ft(s,a,n,l,y,O){var R=s.x1,k=s.x2,ie=s.y1,Ee=s.y2,We=s.anchorPointX,$e=s.anchorPointY,qe=new o.Point(a,n);return l&&qe._rotate(y?O:-O),{x1:R+qe.x,y1:ie+qe.y,x2:k+qe.x,y2:Ee+qe.y,anchorPointX:We,anchorPointY:$e}}so.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Re=function(a,n,l,y){this.transform=a.clone(),this.collisionIndex=new Mi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new so(l),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}};function Mt(s,a,n,l,y){s.emplaceBack(a?1:0,n?1:0,l||0,y||0),s.emplaceBack(a?1:0,n?1:0,l||0,y||0),s.emplaceBack(a?1:0,n?1:0,l||0,y||0),s.emplaceBack(a?1:0,n?1:0,l||0,y||0)}Re.prototype.getBucketParts=function(s,a,n,l){var y=n.getBucket(a),O=n.latestFeatureIndex;if(y&&O&&a.id===y.layerIds[0]){var R=n.collisionBoxArray,k=y.layers[0].layout,ie=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/o.EXTENT,We=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),$e=k.get("text-pitch-alignment")==="map",qe=k.get("text-rotation-alignment")==="map",Lt=_i(n,1,this.transform.zoom),Rt=di(We,$e,qe,this.transform,Lt),Gt=null;if($e){var Dt=Ga(We,$e,qe,this.transform,Lt);Gt=o.multiply([],this.transform.labelPlaneMatrix,Dt)}this.retainedQueryData[y.bucketInstanceId]=new Os(y.bucketInstanceId,O,y.sourceLayerIndex,y.index,n.tileID);var jt={bucket:y,layout:k,posMatrix:We,textLabelPlaneMatrix:Rt,labelToScreenMatrix:Gt,scale:ie,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(l)for(var ir=0,Qt=y.sortKeyRanges;ir<Qt.length;ir+=1){var Lr=Qt[ir];s.push({sortKey:Lr.sortKey,symbolInstanceStart:Lr.symbolInstanceStart,symbolInstanceEnd:Lr.symbolInstanceEnd,parameters:jt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:jt})}},Re.prototype.attemptAnchorPlacement=function(s,a,n,l,y,O,R,k,ie,Ee,We,$e,qe,Lt,Rt){var Gt,Dt=[$e.textOffset0,$e.textOffset1],jt=du(s,n,l,Dt,y),ir=this.collisionIndex.placeCollisionBox(Ft(a,jt.x,jt.y,O,R,this.transform.angle),We,k,ie,Ee.predicate);if(!Rt||this.collisionIndex.placeCollisionBox(Ft(Rt,jt.x,jt.y,O,R,this.transform.angle),We,k,ie,Ee.predicate).box.length!==0)return ir.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[$e.crossTileID]&&this.prevPlacement.placements[$e.crossTileID]&&this.prevPlacement.placements[$e.crossTileID].text&&(Gt=this.prevPlacement.variableOffsets[$e.crossTileID].anchor),this.variableOffsets[$e.crossTileID]={textOffset:Dt,width:n,height:l,anchor:s,textBoxScale:y,prevAnchor:Gt},this.markUsedJustification(qe,s,$e,Lt),qe.allowVerticalPlacement&&(this.markUsedOrientation(qe,Lt,$e),this.placedOrientations[$e.crossTileID]=Lt),{shift:jt,placedGlyphBoxes:ir}):void 0},Re.prototype.placeLayerBucketPart=function(s,a,n){var l=this,y=s.parameters,O=y.bucket,R=y.layout,k=y.posMatrix,ie=y.textLabelPlaneMatrix,Ee=y.labelToScreenMatrix,We=y.textPixelRatio,$e=y.holdingForFade,qe=y.collisionBoxArray,Lt=y.partiallyEvaluatedTextSize,Rt=y.collisionGroup,Gt=R.get("text-optional"),Dt=R.get("icon-optional"),jt=R.get("text-allow-overlap"),ir=R.get("icon-allow-overlap"),Qt=R.get("text-rotation-alignment")==="map",Lr=R.get("text-pitch-alignment")==="map",gr=R.get("icon-text-fit")!=="none",Ar=R.get("symbol-z-order")==="viewport-y",Or=jt&&(ir||!O.hasIconData()||Dt),Kr=ir&&(jt||!O.hasTextData()||Gt);!O.collisionArrays&&qe&&O.deserializeCollisionBoxes(qe);var Qr=function(Mn,ba){if(!a[Mn.crossTileID])if($e)l.placements[Mn.crossTileID]=new So(!1,!1,!1);else{var ca,Fn=!1,Ma=!1,Qn=!0,Da=null,ai={box:null,offscreen:null},uo={box:null,offscreen:null},ro=null,Wi=null,xi=0,no=0,Go=0;ba.textFeatureIndex?xi=ba.textFeatureIndex:Mn.useRuntimeCollisionCircles&&(xi=Mn.featureIndex),ba.verticalTextFeatureIndex&&(no=ba.verticalTextFeatureIndex);var Tu=ba.textBox;if(Tu){var _l=function(Zi){var Zs=o.WritingMode.horizontal;if(O.allowVerticalPlacement&&!Zi&&l.prevPlacement){var ao=l.prevPlacement.placedOrientations[Mn.crossTileID];ao&&(l.placedOrientations[Mn.crossTileID]=ao,l.markUsedOrientation(O,Zs=ao,Mn))}return Zs},Hs=function(Zi,Zs){if(O.allowVerticalPlacement&&Mn.numVerticalGlyphVertices>0&&ba.verticalTextBox)for(var ao=0,Ns=O.writingModes;ao<Ns.length&&(Ns[ao]===o.WritingMode.vertical?(ai=Zs(),uo=ai):ai=Zi(),!(ai&&ai.box&&ai.box.length));ao+=1);else ai=Zi()};if(R.get("text-variable-anchor")){var fs=R.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Mn.crossTileID]){var Ws=l.prevPlacement.variableOffsets[Mn.crossTileID];fs.indexOf(Ws.anchor)>0&&(fs=fs.filter(function(rs){return rs!==Ws.anchor})).unshift(Ws.anchor)}var Zl=function(Zi,Zs,ao){for(var Ns=Zi.x2-Zi.x1,Xs=Zi.y2-Zi.y1,qu=Mn.textBoxScale,gc=gr&&!ir?Zs:null,$l={box:[],offscreen:!1},Jl=jt?2*fs.length:fs.length,Ys=0;Ys<Jl;++Ys){var Ho=l.attemptAnchorPlacement(fs[Ys%fs.length],Zi,Ns,Xs,qu,Qt,Lr,We,k,Rt,Ys>=fs.length,Mn,O,ao,gc);if(Ho&&($l=Ho.placedGlyphBoxes)&&$l.box&&$l.box.length){Fn=!0,Da=Ho.shift;break}}return $l};Hs(function(){return Zl(Tu,ba.iconBox,o.WritingMode.horizontal)},function(){var rs=ba.verticalTextBox;return O.allowVerticalPlacement&&!(ai&&ai.box&&ai.box.length)&&Mn.numVerticalGlyphVertices>0&&rs?Zl(rs,ba.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),ai&&(Fn=ai.box,Qn=ai.offscreen);var _u=_l(ai&&ai.box);if(!Fn&&l.prevPlacement){var Is=l.prevPlacement.variableOffsets[Mn.crossTileID];Is&&(l.variableOffsets[Mn.crossTileID]=Is,l.markUsedJustification(O,Is.anchor,Mn,_u))}}else{var Xl=function(Zi,Zs){var ao=l.collisionIndex.placeCollisionBox(Zi,jt,We,k,Rt.predicate);return ao&&ao.box&&ao.box.length&&(l.markUsedOrientation(O,Zs,Mn),l.placedOrientations[Mn.crossTileID]=Zs),ao};Hs(function(){return Xl(Tu,o.WritingMode.horizontal)},function(){var rs=ba.verticalTextBox;return O.allowVerticalPlacement&&Mn.numVerticalGlyphVertices>0&&rs?Xl(rs,o.WritingMode.vertical):{box:null,offscreen:null}}),_l(ai&&ai.box&&ai.box.length)}}if(Fn=(ca=ai)&&ca.box&&ca.box.length>0,Qn=ca&&ca.offscreen,Mn.useRuntimeCollisionCircles){var Su=O.text.placedSymbolArray.get(Mn.centerJustifiedTextSymbolIndex),Yl=o.evaluateSizeForFeature(O.textSizeData,Lt,Su),Au=R.get("text-padding");ro=l.collisionIndex.placeCollisionCircles(jt,Su,O.lineVertexArray,O.glyphOffsetArray,Yl,k,ie,Ee,n,Lr,Rt.predicate,Mn.collisionCircleDiameter,Au),Fn=jt||ro.circles.length>0&&!ro.collisionDetected,Qn=Qn&&ro.offscreen}if(ba.iconFeatureIndex&&(Go=ba.iconFeatureIndex),ba.iconBox){var wo=function(Zi){var Zs=gr&&Da?Ft(Zi,Da.x,Da.y,Qt,Lr,l.transform.angle):Zi;return l.collisionIndex.placeCollisionBox(Zs,ir,We,k,Rt.predicate)};Ma=uo&&uo.box&&uo.box.length&&ba.verticalIconBox?(Wi=wo(ba.verticalIconBox)).box.length>0:(Wi=wo(ba.iconBox)).box.length>0,Qn=Qn&&Wi.offscreen}var zu=Gt||Mn.numHorizontalGlyphVertices===0&&Mn.numVerticalGlyphVertices===0,Kl=Dt||Mn.numIconVertices===0;if(zu||Kl?Kl?zu||(Ma=Ma&&Fn):Fn=Ma&&Fn:Ma=Fn=Ma&&Fn,Fn&&ca&&ca.box&&l.collisionIndex.insertCollisionBox(ca.box,R.get("text-ignore-placement"),O.bucketInstanceId,uo&&uo.box&&no?no:xi,Rt.ID),Ma&&Wi&&l.collisionIndex.insertCollisionBox(Wi.box,R.get("icon-ignore-placement"),O.bucketInstanceId,Go,Rt.ID),ro&&(Fn&&l.collisionIndex.insertCollisionCircles(ro.circles,R.get("text-ignore-placement"),O.bucketInstanceId,xi,Rt.ID),n)){var qc=O.bucketInstanceId,Oo=l.collisionCircleArrays[qc];Oo===void 0&&(Oo=l.collisionCircleArrays[qc]=new Ol);for(var Ds=0;Ds<ro.circles.length;Ds+=4)Oo.circles.push(ro.circles[Ds+0]),Oo.circles.push(ro.circles[Ds+1]),Oo.circles.push(ro.circles[Ds+2]),Oo.circles.push(ro.collisionDetected?1:0)}l.placements[Mn.crossTileID]=new So(Fn||Or,Ma||Kr,Qn||O.justReloaded),a[Mn.crossTileID]=!0}};if(Ar)for(var dn=O.getSortedSymbolIndexes(this.transform.angle),wn=dn.length-1;wn>=0;--wn){var ra=dn[wn];Qr(O.symbolInstances.get(ra),O.collisionArrays[ra])}else for(var ya=s.symbolInstanceStart;ya<s.symbolInstanceEnd;ya++)Qr(O.symbolInstances.get(ya),O.collisionArrays[ya]);if(n&&O.bucketInstanceId in this.collisionCircleArrays){var Ta=this.collisionCircleArrays[O.bucketInstanceId];o.invert(Ta.invProjMatrix,k),Ta.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Re.prototype.markUsedJustification=function(s,a,n,l){var y;y=l===o.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(a)];for(var O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];O<R.length;O+=1){var k=R[O];k>=0&&(s.text.placedSymbolArray.get(k).crossTileID=y>=0&&k!==y?0:n.crossTileID)}},Re.prototype.markUsedOrientation=function(s,a,n){for(var l=a===o.WritingMode.horizontal||a===o.WritingMode.horizontalOnly?a:0,y=a===o.WritingMode.vertical?a:0,O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];O<R.length;O+=1)s.text.placedSymbolArray.get(R[O]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=y)},Re.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,y=a?a.opacities:{},O=a?a.variableOffsets:{},R=a?a.placedOrientations:{};for(var k in this.placements){var ie=this.placements[k],Ee=y[k];Ee?(this.opacities[k]=new as(Ee,l,ie.text,ie.icon),n=n||ie.text!==Ee.text.placed||ie.icon!==Ee.icon.placed):(this.opacities[k]=new as(null,l,ie.text,ie.icon,ie.skipFade),n=n||ie.text||ie.icon)}for(var We in y){var $e=y[We];if(!this.opacities[We]){var qe=new as($e,l,!1,!1);qe.isHidden()||(this.opacities[We]=qe,n=n||$e.text.placed||$e.icon.placed)}}for(var Lt in O)this.variableOffsets[Lt]||!this.opacities[Lt]||this.opacities[Lt].isHidden()||(this.variableOffsets[Lt]=O[Lt]);for(var Rt in R)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=R[Rt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Re.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,y=a;l<y.length;l+=1){var O=y[l],R=O.getBucket(s);R&&O.latestFeatureIndex&&s.id===R.layerIds[0]&&this.updateBucketOpacities(R,n,O.collisionBoxArray)}},Re.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var y=s.layers[0].layout,O=new as(null,0,!1,!1,!0),R=y.get("text-allow-overlap"),k=y.get("icon-allow-overlap"),ie=y.get("text-variable-anchor"),Ee=y.get("text-rotation-alignment")==="map",We=y.get("text-pitch-alignment")==="map",$e=y.get("icon-text-fit")!=="none",qe=new as(null,0,R&&(k||!s.hasIconData()||y.get("icon-optional")),k&&(R||!s.hasTextData()||y.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Lt=function(ir,Qt,Lr){for(var gr=0;gr<Qt/4;gr++)ir.opacityVertexArray.emplaceBack(Lr)},Rt=function(ir){var Qt=s.symbolInstances.get(ir),Lr=Qt.numHorizontalGlyphVertices,gr=Qt.numVerticalGlyphVertices,Ar=Qt.crossTileID,Or=l.opacities[Ar];a[Ar]?Or=O:Or||(l.opacities[Ar]=Or=qe),a[Ar]=!0;var Kr=Qt.numIconVertices>0,Qr=l.placedOrientations[Qt.crossTileID],dn=Qr===o.WritingMode.vertical,wn=Qr===o.WritingMode.horizontal||Qr===o.WritingMode.horizontalOnly;if(Lr>0||gr>0){var ra=To(Or.text);Lt(s.text,Lr,dn?nl:ra),Lt(s.text,gr,wn?nl:ra);var ya=Or.text.isHidden();[Qt.rightJustifiedTextSymbolIndex,Qt.centerJustifiedTextSymbolIndex,Qt.leftJustifiedTextSymbolIndex].forEach(function(ai){ai>=0&&(s.text.placedSymbolArray.get(ai).hidden=ya||dn?1:0)}),Qt.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Qt.verticalPlacedTextSymbolIndex).hidden=ya||wn?1:0);var Ta=l.variableOffsets[Qt.crossTileID];Ta&&l.markUsedJustification(s,Ta.anchor,Qt,Qr);var Ja=l.placedOrientations[Qt.crossTileID];Ja&&(l.markUsedJustification(s,"left",Qt,Ja),l.markUsedOrientation(s,Ja,Qt))}if(Kr){var Mn=To(Or.icon),ba=!($e&&Qt.verticalPlacedIconSymbolIndex&&dn);Qt.placedIconSymbolIndex>=0&&(Lt(s.icon,Qt.numIconVertices,ba?Mn:nl),s.icon.placedSymbolArray.get(Qt.placedIconSymbolIndex).hidden=Or.icon.isHidden()),Qt.verticalPlacedIconSymbolIndex>=0&&(Lt(s.icon,Qt.numVerticalIconVertices,ba?nl:Mn),s.icon.placedSymbolArray.get(Qt.verticalPlacedIconSymbolIndex).hidden=Or.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var ca=s.collisionArrays[ir];if(ca){var Fn=new o.Point(0,0);if(ca.textBox||ca.verticalTextBox){var Ma=!0;if(ie){var Qn=l.variableOffsets[Ar];Qn?(Fn=du(Qn.anchor,Qn.width,Qn.height,Qn.textOffset,Qn.textBoxScale),Ee&&Fn._rotate(We?l.transform.angle:-l.transform.angle)):Ma=!1}ca.textBox&&Mt(s.textCollisionBox.collisionVertexArray,Or.text.placed,!Ma||dn,Fn.x,Fn.y),ca.verticalTextBox&&Mt(s.textCollisionBox.collisionVertexArray,Or.text.placed,!Ma||wn,Fn.x,Fn.y)}var Da=Boolean(!wn&&ca.verticalIconBox);ca.iconBox&&Mt(s.iconCollisionBox.collisionVertexArray,Or.icon.placed,Da,$e?Fn.x:0,$e?Fn.y:0),ca.verticalIconBox&&Mt(s.iconCollisionBox.collisionVertexArray,Or.icon.placed,!Da,$e?Fn.x:0,$e?Fn.y:0)}}},Gt=0;Gt<s.symbolInstances.length;Gt++)Rt(Gt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var Dt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Dt.invProjMatrix,s.placementViewportMatrix=Dt.viewportMatrix,s.collisionCircleArray=Dt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Re.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Re.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Re.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Re.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Re.prototype.setStale=function(){this.stale=!0};var dr=Math.pow(2,25),en=Math.pow(2,24),xn=Math.pow(2,17),zn=Math.pow(2,16),Gi=Math.pow(2,9),mo=Math.pow(2,8),Do=Math.pow(2,1);function To(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*dr+a*en+n*xn+a*zn+n*Gi+a*mo+n*Do+a}var nl=0,Ml=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ml.prototype.continuePlacement=function(s,a,n,l,y){for(var O=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(O,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(function(R,k){return R.sortKey-k.sortKey}));this._currentPartIndex<O.length;)if(a.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,y())return!0;return!1};var eu=function(a,n,l,y,O,R,k){this.placement=new Re(a,O,R,k),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=y,this._done=!1};eu.prototype.isDone=function(){return this._done},eu.prototype.continuePlacement=function(s,a,n){for(var l=this,y=o.browser.now(),O=function(){var Ee=o.browser.now()-y;return!l._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var R=a[s[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=k)&&(!R.maxzoom||R.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Ml(R)),this._inProgressLayer.continuePlacement(n[R.source],this.placement,this._showCollisionBoxes,R,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},eu.prototype.commit=function(s){return this.placement.commit(s),this.placement};var uf=512/o.EXTENT/2,bs=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var y=0;y<n.length;y++){var O=n.get(y),R=O.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,a)})}};bs.prototype.getScaledCoordinates=function(s,a){var n=uf/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*o.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*o.EXTENT+s.anchorY)*n)}},bs.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),y=0;y<s.length;y++){var O=s.get(y);if(!O.crossTileID){var R=this.indexedSymbolInstances[O.key];if(R)for(var k=this.getScaledCoordinates(O,a),ie=0,Ee=R;ie<Ee.length;ie+=1){var We=Ee[ie];if(Math.abs(We.coord.x-k.x)<=l&&Math.abs(We.coord.y-k.y)<=l&&!n[We.crossTileID]){n[We.crossTileID]=!0,O.crossTileID=We.crossTileID;break}}}}};var Vu=function(){this.maxCrossTileID=0};Vu.prototype.generate=function(){return++this.maxCrossTileID};var tu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};tu.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],y={};for(var O in l){var R=l[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+a),y[R.tileID.key]=R}this.indexes[n]=y}this.lng=s},tu.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var y=this.usedCrossTileIDs[s.overscaledZ];for(var O in this.indexes){var R=this.indexes[O];if(Number(O)>s.overscaledZ)for(var k in R){var ie=R[k];ie.tileID.isChildOf(s)&&ie.findMatches(a.symbolInstances,s,y)}else{var Ee=R[s.scaledTo(Number(O)).key];Ee&&Ee.findMatches(a.symbolInstances,s,y)}}for(var We=0;We<a.symbolInstances.length;We++){var $e=a.symbolInstances.get(We);$e.crossTileID||($e.crossTileID=n.generate(),y[$e.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new bs(s,a.symbolInstances,a.bucketInstanceId),!0},tu.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,y=a.indexedSymbolInstances[n];l<y.length;l+=1)delete this.usedCrossTileIDs[s][y[l].crossTileID]},tu.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var y in l)s[l[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[y]),delete l[y],a=!0)}return a};var Ao=function(){this.layerIndexes={},this.crossTileIDs=new Vu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ao.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new tu);var y=!1,O={};l.handleWrapJump(n);for(var R=0,k=a;R<k.length;R+=1){var ie=k[R],Ee=ie.getBucket(s);Ee&&s.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ie.tileID,Ee,this.crossTileIDs)&&(y=!0),O[Ee.bucketInstanceId]=!0)}return l.removeStaleBuckets(O)&&(y=!0),y},Ao.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var is=function(a,n){return o.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Gu=o.pick(_n,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),al=o.pick(_n,["setCenter","setZoom","setBearing","setPitch"]),Ms=function(){var s={},a=o.styleSpec.$version;for(var n in o.styleSpec.$root){var l,y=o.styleSpec.$root[n];y.required&&((l=n==="version"?a:y.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),$a=function(s){function a(n,l){var y=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ot(Jr(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new Ie(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Pe(256,512),this.crossTileSymbolIndex=new Ao,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var O=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(R){O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:R.pluginStatus,pluginURL:R.pluginURL},function(k,ie){if(o.triggerPluginCompletionEvent(k),ie&&ie.every(function(We){return We}))for(var Ee in O.sourceCaches)O.sourceCaches[Ee].reload()})}),this.on("data",function(R){if(R.dataType==="source"&&R.sourceDataType==="metadata"){var k=y.sourceCaches[R.sourceId];if(k){var ie=k.getSource();if(ie&&ie.vectorLayerIds)for(var Ee in y._layers){var We=y._layers[Ee];We.source===ie.id&&y._validateLayer(We)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var y=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var O=typeof l.validate=="boolean"?l.validate:!o.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var R=this.map._requestManager.transformRequest(n,o.ResourceType.Style);this._request=o.getJSON(R,function(k,ie){y._request=null,k?y.fire(new o.ErrorEvent(k)):ie&&y._load(ie,O)})},a.prototype.loadJSON=function(n,l){var y=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){y._request=null,y._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Ms,!1)},a.prototype._load=function(n,l){if(!l||!is(this,o.validateStyle(n))){for(var y in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(y,n.sources[y],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var O=Kn(this.stylesheet.layers);this._order=O.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var R=0,k=O;R<k.length;R+=1){var ie=k[R];(ie=o.createStyleLayer(ie)).setEventedParent(this,{layer:{id:ie.id}}),this._layers[ie.id]=ie,this._serializedLayers[ie.id]=ie.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new at(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(y,O,R){var k,ie,Ee,We=o.browser.devicePixelRatio>1?"@2x":"",$e=o.getJSON(O.transformRequest(O.normalizeSpriteURL(y,We,".json"),o.ResourceType.SpriteJSON),function(Rt,Gt){$e=null,Ee||(Ee=Rt,k=Gt,Lt())}),qe=o.getImage(O.transformRequest(O.normalizeSpriteURL(y,We,".png"),o.ResourceType.SpriteImage),function(Rt,Gt){qe=null,Ee||(Ee=Rt,ie=Gt,Lt())});function Lt(){if(Ee)R(Ee);else if(k&&ie){var Rt=o.browser.getImageData(ie),Gt={};for(var Dt in k){var jt=k[Dt],ir=jt.width,Qt=jt.height,Lr=jt.x,gr=jt.y,Ar=jt.sdf,Or=jt.pixelRatio,Kr=jt.stretchX,Qr=jt.stretchY,dn=jt.content,wn=new o.RGBAImage({width:ir,height:Qt});o.RGBAImage.copy(Rt,wn,{x:Lr,y:gr},{x:0,y:0},{width:ir,height:Qt}),Gt[Dt]={data:wn,pixelRatio:Or,sdf:Ar,stretchX:Kr,stretchY:Qr,content:dn}}R(null,Gt)}}return{cancel:function(){$e&&($e.cancel(),$e=null),qe&&(qe.cancel(),qe=null)}}}(n,this.map._requestManager,function(y,O){if(l._spriteRequest=null,y)l.fire(new o.ErrorEvent(y));else if(O)for(var R in O)l.imageManager.addImage(R,O[R]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new o.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var y=n.sourceLayer;if(y){var O=l.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+O.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],y=0,O=n;y<O.length;y+=1){var R=this._layers[O[y]];R.type!=="custom"&&l.push(R.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);for(var R in(y.length||O.length)&&this._updateWorkerLayers(y,O),this._updatedSources){var k=this._updatedSources[R];k==="reload"?this._reloadSource(R):k==="clear"&&this._clearSource(R)}for(var ie in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ie].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}for(var Ee in this.sourceCaches)this.sourceCaches[Ee].used=!1;for(var We=0,$e=this._order;We<$e.length;We+=1){var qe=this._layers[$e[We]];qe.recalculate(n,this._availableImages),!qe.isHidden(n.zoom)&&qe.source&&(this.sourceCaches[qe.source].used=!0)}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new o.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),is(this,o.validateStyle(n)))return!1;(n=o.clone$1(n)).layers=Kn(n.layers);var y=function(R,k){if(!R)return[{command:_n.setStyle,args:[k]}];var ie=[];try{if(!o.deepEqual(R.version,k.version))return[{command:_n.setStyle,args:[k]}];o.deepEqual(R.center,k.center)||ie.push({command:_n.setCenter,args:[k.center]}),o.deepEqual(R.zoom,k.zoom)||ie.push({command:_n.setZoom,args:[k.zoom]}),o.deepEqual(R.bearing,k.bearing)||ie.push({command:_n.setBearing,args:[k.bearing]}),o.deepEqual(R.pitch,k.pitch)||ie.push({command:_n.setPitch,args:[k.pitch]}),o.deepEqual(R.sprite,k.sprite)||ie.push({command:_n.setSprite,args:[k.sprite]}),o.deepEqual(R.glyphs,k.glyphs)||ie.push({command:_n.setGlyphs,args:[k.glyphs]}),o.deepEqual(R.transition,k.transition)||ie.push({command:_n.setTransition,args:[k.transition]}),o.deepEqual(R.light,k.light)||ie.push({command:_n.setLight,args:[k.light]});var Ee={},We=[];!function(qe,Lt,Rt,Gt){var Dt;for(Dt in Lt=Lt||{},qe=qe||{})qe.hasOwnProperty(Dt)&&(Lt.hasOwnProperty(Dt)||oa(Dt,Rt,Gt));for(Dt in Lt)Lt.hasOwnProperty(Dt)&&(qe.hasOwnProperty(Dt)?o.deepEqual(qe[Dt],Lt[Dt])||(qe[Dt].type==="geojson"&&Lt[Dt].type==="geojson"&&va(qe,Lt,Dt)?Rt.push({command:_n.setGeoJSONSourceData,args:[Dt,Lt[Dt].data]}):Mr(Dt,Lt,Rt,Gt)):Hr(Dt,Lt,Rt))}(R.sources,k.sources,We,Ee);var $e=[];R.layers&&R.layers.forEach(function(qe){Ee[qe.source]?ie.push({command:_n.removeLayer,args:[qe.id]}):$e.push(qe)}),ie=ie.concat(We),function(qe,Lt,Rt){Lt=Lt||[];var Gt,Dt,jt,ir,Qt,Lr,gr,Ar=(qe=qe||[]).map(da),Or=Lt.map(da),Kr=qe.reduce(Ki,{}),Qr=Lt.reduce(Ki,{}),dn=Ar.slice(),wn=Object.create(null);for(Gt=0,Dt=0;Gt<Ar.length;Gt++)Qr.hasOwnProperty(jt=Ar[Gt])?Dt++:(Rt.push({command:_n.removeLayer,args:[jt]}),dn.splice(dn.indexOf(jt,Dt),1));for(Gt=0,Dt=0;Gt<Or.length;Gt++)dn[dn.length-1-Gt]!==(jt=Or[Or.length-1-Gt])&&(Kr.hasOwnProperty(jt)?(Rt.push({command:_n.removeLayer,args:[jt]}),dn.splice(dn.lastIndexOf(jt,dn.length-Dt),1)):Dt++,Rt.push({command:_n.addLayer,args:[Qr[jt],Lr=dn[dn.length-Gt]]}),dn.splice(dn.length-Gt,0,jt),wn[jt]=!0);for(Gt=0;Gt<Or.length;Gt++)if(ir=Kr[jt=Or[Gt]],Qt=Qr[jt],!wn[jt]&&!o.deepEqual(ir,Qt))if(o.deepEqual(ir.source,Qt.source)&&o.deepEqual(ir["source-layer"],Qt["source-layer"])&&o.deepEqual(ir.type,Qt.type)){for(gr in ha(ir.layout,Qt.layout,Rt,jt,null,_n.setLayoutProperty),ha(ir.paint,Qt.paint,Rt,jt,null,_n.setPaintProperty),o.deepEqual(ir.filter,Qt.filter)||Rt.push({command:_n.setFilter,args:[jt,Qt.filter]}),o.deepEqual(ir.minzoom,Qt.minzoom)&&o.deepEqual(ir.maxzoom,Qt.maxzoom)||Rt.push({command:_n.setLayerZoomRange,args:[jt,Qt.minzoom,Qt.maxzoom]}),ir)ir.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ha(ir[gr],Qt[gr],Rt,jt,gr.slice(6),_n.setPaintProperty):o.deepEqual(ir[gr],Qt[gr])||Rt.push({command:_n.setLayerProperty,args:[jt,gr,Qt[gr]]}));for(gr in Qt)Qt.hasOwnProperty(gr)&&!ir.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ha(ir[gr],Qt[gr],Rt,jt,gr.slice(6),_n.setPaintProperty):o.deepEqual(ir[gr],Qt[gr])||Rt.push({command:_n.setLayerProperty,args:[jt,gr,Qt[gr]]}))}else Rt.push({command:_n.removeLayer,args:[jt]}),Lr=dn[dn.lastIndexOf(jt)+1],Rt.push({command:_n.addLayer,args:[Qt,Lr]})}($e,k.layers,ie)}catch(qe){console.warn("Unable to compute style diff:",qe),ie=[{command:_n.setStyle,args:[k]}]}return ie}(this.serialize(),n).filter(function(R){return!(R.command in al)});if(y.length===0)return!1;var O=y.filter(function(R){return!(R.command in Gu)});if(O.length>0)throw new Error("Unimplemented: "+O.map(function(R){return R.command}).join(", ")+".");return y.forEach(function(R){R.command!=="setTransition"&&l[R.command].apply(l,R.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,y){var O=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(o.validateStyle.source,"sources."+n,l,null,y))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var R=this.sourceCaches[n]=new er(n,l,this.dispatcher);R.style=this,R.setEventedParent(this,function(){return{isSourceLoaded:O.loaded(),source:R.serialize(),sourceId:n}}),R.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new o.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var y=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],y.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,y){y===void 0&&(y={}),this._checkLoaded();var O=n.id;if(this.getLayer(O))this.fire(new o.ErrorEvent(new Error('Layer with id "'+O+'" already exists on this map')));else{var R;if(n.type==="custom"){if(is(this,o.validateCustomStyleLayer(n)))return;R=o.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(O,n.source),n=o.clone$1(n),n=o.extend(n,{source:O})),this._validate(o.validateStyle.layer,"layers."+O,n,{arrayIndex:-1},y))return;R=o.createStyleLayer(n),this._validateLayer(R),R.setEventedParent(this,{layer:{id:O}}),this._serializedLayers[R.id]=R.serialize()}var k=l?this._order.indexOf(l):this._order.length;if(l&&k===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(k,0,O),this._layerOrderChanged=!0,this._layers[O]=R,this._removedLayers[O]&&R.source&&R.type!=="custom"){var ie=this._removedLayers[O];delete this._removedLayers[O],ie.type!==R.type?this._updatedSources[R.source]="clear":(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause())}this._updateLayer(R),R.onAdd&&R.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var y=this._order.indexOf(n);this._order.splice(y,1);var O=l?this._order.indexOf(l):this._order.length;l&&O===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(O,0,n),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var y=this._order.indexOf(n);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,y){this._checkLoaded();var O=this.getLayer(n);O?O.minzoom===l&&O.maxzoom===y||(l!=null&&(O.minzoom=l),y!=null&&(O.maxzoom=y),this._updateLayer(O)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,y){y===void 0&&(y={}),this._checkLoaded();var O=this.getLayer(n);if(O){if(!o.deepEqual(O.filter,l))return l==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(o.validateStyle.filter,"layers."+O.id+".filter",l,null,y)||(O.filter=o.clone$1(l),this._updateLayer(O)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return o.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,y,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getLayoutProperty(l),y)||(R.setLayoutProperty(l,y,O),this._updateLayer(R)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var y=this.getLayer(n);if(y)return y.getLayoutProperty(l);this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,y,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getPaintProperty(l),y)||(R.setPaintProperty(l,y,O)&&this._updateLayer(R),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var y=n.source,O=n.sourceLayer,R=this.sourceCaches[y];if(R!==void 0){var k=R.getSource().type;k==="geojson"&&O?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||O?(n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),R.setFeatureState(O,n.id,l)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var y=n.source,O=this.sourceCaches[y];if(O!==void 0){var R=O.getSource().type,k=R==="vector"?n.sourceLayer:void 0;R!=="vector"||k?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(k,n.id,l):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,y=n.sourceLayer,O=this.sourceCaches[l];if(O!==void 0){if(O.getSource().type!=="vector"||y)return n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),O.getFeatureState(y,n.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,y=function(Qr){return l._layers[Qr].type==="fill-extrusion"},O={},R=[],k=this._order.length-1;k>=0;k--){var ie=this._order[k];if(y(ie)){O[ie]=k;for(var Ee=0,We=n;Ee<We.length;Ee+=1){var $e=We[Ee][ie];if($e)for(var qe=0,Lt=$e;qe<Lt.length;qe+=1)R.push(Lt[qe])}}}R.sort(function(Kr,Qr){return Qr.intersectionZ-Kr.intersectionZ});for(var Rt=[],Gt=this._order.length-1;Gt>=0;Gt--){var Dt=this._order[Gt];if(y(Dt))for(var jt=R.length-1;jt>=0;jt--){var ir=R[jt].feature;if(O[ir.layer.id]<Gt)break;Rt.push(ir),R.pop()}else for(var Qt=0,Lr=n;Qt<Lr.length;Qt+=1){var gr=Lr[Qt][Dt];if(gr)for(var Ar=0,Or=gr;Ar<Or.length;Ar+=1)Rt.push(Or[Ar].feature)}}return Rt},a.prototype.queryRenderedFeatures=function(n,l,y){l&&l.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var O={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var R=0,k=l.layers;R<k.length;R+=1){var ie=k[R],Ee=this._layers[ie];if(!Ee)return this.fire(new o.ErrorEvent(new Error("The layer '"+ie+"' does not exist in the map's style and cannot be queried for features."))),[];O[Ee.source]=!0}}var We=[];for(var $e in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!O[$e]||We.push(At(this.sourceCaches[$e],this._layers,this._serializedLayers,n,l,y));return this.placement&&We.push(function(qe,Lt,Rt,Gt,Dt,jt,ir){for(var Qt={},Lr=jt.queryRenderedSymbols(Gt),gr=[],Ar=0,Or=Object.keys(Lr).map(Number);Ar<Or.length;Ar+=1)gr.push(ir[Or[Ar]]);gr.sort(ye);for(var Kr=function(){var Ta=dn[Qr],Ja=Ta.featureIndex.lookupSymbolFeatures(Lr[Ta.bucketInstanceId],Lt,Ta.bucketIndex,Ta.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,qe);for(var Mn in Ja){var ba=Qt[Mn]=Qt[Mn]||[],ca=Ja[Mn];ca.sort(function(Qn,Da){var ai=Ta.featureSortOrder;if(ai){var uo=ai.indexOf(Qn.featureIndex);return ai.indexOf(Da.featureIndex)-uo}return Da.featureIndex-Qn.featureIndex});for(var Fn=0,Ma=ca;Fn<Ma.length;Fn+=1)ba.push(Ma[Fn])}},Qr=0,dn=gr;Qr<dn.length;Qr+=1)Kr();var wn=function(Ta){Qt[Ta].forEach(function(Ja){var Mn=Ja.feature,ba=Rt[qe[Ta].source].getFeatureState(Mn.layer["source-layer"],Mn.id);Mn.source=Mn.layer.source,Mn.layer["source-layer"]&&(Mn.sourceLayer=Mn.layer["source-layer"]),Mn.state=ba})};for(var ra in Qt)wn(ra);return Qt}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(We)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var y=this.sourceCaches[n];return y?function(O,R){for(var k=O.getRenderableIds().map(function(Lt){return O.getTileByID(Lt)}),ie=[],Ee={},We=0;We<k.length;We++){var $e=k[We],qe=$e.tileID.canonical.key;Ee[qe]||(Ee[qe]=!0,$e.querySourceFeatures(ie,R))}return ie}(y,l):[]},a.prototype.addSourceType=function(n,l,y){return a.getSourceType(n)?y(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},y):y(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var y=this.light.getLight(),O=!1;for(var R in n)if(!o.deepEqual(n[R],y[R])){O=!0;break}if(O){var k={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(k)}},a.prototype._validate=function(n,l,y,O,R){return R===void 0&&(R={}),(!R||R.validate!==!1)&&is(this,n.call(o.validateStyle,o.extend({key:l,style:this.serialize(),value:y,styleSpec:o.styleSpec},O)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,y,O,R){R===void 0&&(R=!1);for(var k=!1,ie=!1,Ee={},We=0,$e=this._order;We<$e.length;We+=1){var qe=this._layers[$e[We]];if(qe.type==="symbol"){if(!Ee[qe.source]){var Lt=this.sourceCaches[qe.source];Ee[qe.source]=Lt.getRenderableIds(!0).map(function(ir){return Lt.getTileByID(ir)}).sort(function(ir,Qt){return Qt.tileID.overscaledZ-ir.tileID.overscaledZ||(ir.tileID.isLessThan(Qt.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(qe,Ee[qe.source],n.center.lng);k=k||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((R=R||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),n.zoom))&&(this.pauseablePlacement=new eu(n,this._order,R,l,y,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),ie=!0),k&&this.pauseablePlacement.placement.setStale()),ie||k)for(var Gt=0,Dt=this._order;Gt<Dt.length;Gt+=1){var jt=this._layers[Dt[Gt]];jt.type==="symbol"&&this.placement.updateLayerOpacities(jt,Ee[jt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,y){this.imageManager.getImages(l.icons,y),this._updateTilesForChangedImages();var O=this.sourceCaches[l.source];O&&O.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,y){this.glyphManager.getGlyphs(l.stacks,y)},a.prototype.getResource=function(n,l,y){return o.makeRequest(l,y)},a}(o.Evented);$a.getSourceType=function(s){return et[s]},$a.setSourceType=function(s,a){et[s]=a},$a.registerForPluginStateChange=o.registerForPluginStateChange;var Hu=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Wu=Hi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),il=Hi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),sc=Hi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),wt=Hi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),qt=Hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wr=Hi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Xn=Hi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Xa=Hi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ni=Hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),to=Hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Sa=Hi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ii=Hi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),qo=Hi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),gi=Hi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),os=Hi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),ru=Hi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),pu=Hi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ss=Hi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Zu=Hi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),mu=Hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ol=Hi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Lu=Hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Xu=Hi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),uc=Hi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),lf=Hi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Ec=Hi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Hi(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),y=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=O?O.concat(y):y,k={};return{fragmentSource:s=s.replace(n,function(ie,Ee,We,$e,qe){return k[qe]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+qe+`
varying `+We+" "+$e+" "+qe+`;
#else
uniform `+We+" "+$e+" u_"+qe+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+qe+`
    `+We+" "+$e+" "+qe+" = u_"+qe+`;
#endif
`}),vertexSource:a=a.replace(n,function(ie,Ee,We,$e,qe){var Lt=$e==="float"?"vec2":"vec4",Rt=qe.match(/color/)?"color":Lt;return k[qe]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+qe+`
uniform lowp float u_`+qe+`_t;
attribute `+We+" "+Lt+" a_"+qe+`;
varying `+We+" "+$e+" "+qe+`;
#else
uniform `+We+" "+$e+" u_"+qe+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+qe+`
    `+qe+" = a_"+qe+`;
#else
    `+We+" "+$e+" "+qe+" = u_"+qe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+qe+`
    `+qe+" = unpack_mix_"+Rt+"(a_"+qe+", u_"+qe+`_t);
#else
    `+We+" "+$e+" "+qe+" = u_"+qe+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+qe+`
uniform lowp float u_`+qe+`_t;
attribute `+We+" "+Lt+" a_"+qe+`;
#else
uniform `+We+" "+$e+" u_"+qe+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+qe+`
    `+We+" "+$e+" "+qe+" = a_"+qe+`;
#else
    `+We+" "+$e+" "+qe+" = u_"+qe+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+qe+`
    `+We+" "+$e+" "+qe+" = unpack_mix_"+Rt+"(a_"+qe+", u_"+qe+`_t);
#else
    `+We+" "+$e+" "+qe+" = u_"+qe+`;
#endif
`}),staticAttributes:l,staticUniforms:R}}var Vc=Object.freeze({__proto__:null,prelude:Wu,background:il,backgroundPattern:sc,circle:wt,clippingMask:qt,heatmap:wr,heatmapTexture:Xn,collisionBox:Xa,collisionCircle:ni,debug:to,fill:Sa,fillOutline:Ii,fillOutlinePattern:qo,fillPattern:gi,fillExtrusion:os,fillExtrusionPattern:ru,hillshadePrepare:pu,hillshade:ss,line:Zu,lineGradient:mu,linePattern:ol,lineSDF:Lu,raster:Xu,symbolIcon:uc,symbolSDF:lf,symbolTextAndIcon:Ec}),Gc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Tf(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}Gc.prototype.bind=function(s,a,n,l,y,O,R,k){this.context=s;for(var ie=this.boundPaintVertexBuffers.length!==l.length,Ee=0;!ie&&Ee<l.length;Ee++)this.boundPaintVertexBuffers[Ee]!==l[Ee]&&(ie=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ie&&this.boundIndexBuffer===y&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===R&&this.boundDynamicVertexBuffer2===k?(s.bindVertexArrayOES.set(this.vao),R&&R.bind(),y&&y.dynamicDraw&&y.bind(),k&&k.bind()):this.freshBind(a,n,l,y,O,R,k)},Gc.prototype.freshBind=function(s,a,n,l,y,O,R){var k,ie=s.numAttributes,Ee=this.context,We=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=R;else{k=Ee.currentNumAttributes||0;for(var $e=ie;$e<k;$e++)We.disableVertexAttribArray($e)}a.enableAttributes(We,s);for(var qe=0,Lt=n;qe<Lt.length;qe+=1)Lt[qe].enableAttributes(We,s);O&&O.enableAttributes(We,s),R&&R.enableAttributes(We,s),a.bind(),a.setVertexAttribPointers(We,s,y);for(var Rt=0,Gt=n;Rt<Gt.length;Rt+=1){var Dt=Gt[Rt];Dt.bind(),Dt.setVertexAttribPointers(We,s,y)}O&&(O.bind(),O.setVertexAttribPointers(We,s,y)),l&&l.bind(),R&&(R.bind(),R.setVertexAttribPointers(We,s,y)),Ee.currentNumAttributes=ie},Gc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Hc=function(a,n,l,y,O,R){var k=a.gl;this.program=k.createProgram();for(var ie=Tf(l.staticAttributes),Ee=y?y.getBinderAttributes():[],We=ie.concat(Ee),$e=l.staticUniforms?Tf(l.staticUniforms):[],qe=y?y.getBinderUniforms():[],Lt=[],Rt=0,Gt=$e.concat(qe);Rt<Gt.length;Rt+=1){var Dt=Gt[Rt];Lt.indexOf(Dt)<0&&Lt.push(Dt)}var jt=y?y.defines():[];R&&jt.push("#define OVERDRAW_INSPECTOR;");var ir=jt.concat(Wu.fragmentSource,l.fragmentSource).join(`
`),Qt=jt.concat(Wu.vertexSource,l.vertexSource).join(`
`),Lr=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(Lr,ir),k.compileShader(Lr),k.attachShader(this.program,Lr);var gr=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(gr,Qt),k.compileShader(gr),k.attachShader(this.program,gr),this.attributes={};var Ar={};this.numAttributes=We.length;for(var Or=0;Or<this.numAttributes;Or++)We[Or]&&(k.bindAttribLocation(this.program,Or,We[Or]),this.attributes[We[Or]]=Or);k.linkProgram(this.program),k.deleteShader(gr),k.deleteShader(Lr);for(var Kr=0;Kr<Lt.length;Kr++){var Qr=Lt[Kr];if(Qr&&!Ar[Qr]){var dn=k.getUniformLocation(this.program,Qr);dn&&(Ar[Qr]=dn)}}this.fixedUniforms=O(a,Ar),this.binderUniforms=y?y.getUniforms(a,Ar):[]}}};function _f(s,a,n){var l=1/_i(n,1,a.transform.tileZoom),y=Math.pow(2,n.tileID.overscaledZ),O=n.tileSize*Math.pow(2,a.transform.tileZoom)/y,R=O*(n.tileID.canonical.x+n.tileID.wrap*y),k=O*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[R>>16,k>>16],u_pixel_coord_lower:[65535&R,65535&k]}}Hc.prototype.draw=function(s,a,n,l,y,O,R,k,ie,Ee,We,$e,qe,Lt,Rt,Gt){var Dt,jt=s.gl;if(!this.failedToCreate){for(var ir in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(y),s.setCullFace(O),this.fixedUniforms)this.fixedUniforms[ir].set(R[ir]);Lt&&Lt.setUniforms(s,this.binderUniforms,$e,{zoom:qe});for(var Qt=(Dt={},Dt[jt.LINES]=2,Dt[jt.TRIANGLES]=3,Dt[jt.LINE_STRIP]=1,Dt)[a],Lr=0,gr=We.get();Lr<gr.length;Lr+=1){var Ar=gr[Lr],Or=Ar.vaos||(Ar.vaos={});(Or[k]||(Or[k]=new Gc)).bind(s,this,ie,Lt?Lt.getPaintVertexBuffers():[],Ee,Ar.vertexOffset,Rt,Gt),jt.drawElements(a,Ar.primitiveLength*Qt,jt.UNSIGNED_SHORT,Ar.primitiveOffset*Qt*2)}}};var Pi=function(a,n,l,y){var O=n.style.light,R=O.properties.get("position"),k=[R.x,R.y,R.z],ie=o.create$1();O.properties.get("anchor")==="viewport"&&o.fromRotation(ie,-n.transform.angle),o.transformMat3(k,k,ie);var Ee=O.properties.get("color");return{u_matrix:a,u_lightpos:k,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+l,u_opacity:y}},Ru=function(a,n,l,y,O,R,k){return o.extend(Pi(a,n,l,y),_f(R,n,k),{u_height_factor:-Math.pow(2,O.overscaledZ)/k.tileSize/8})},Pl=function(a){return{u_matrix:a}},nu=function(a,n,l,y){return o.extend(Pl(a),_f(l,n,y))},Wc=function(a,n){return{u_matrix:a,u_world:n}},lc=function(a,n,l,y,O){return o.extend(nu(a,n,l,y),{u_world:O})},vu=function(a,n,l,y){var O,R,k=a.transform;if(y.paint.get("circle-pitch-alignment")==="map"){var ie=_i(l,1,k.zoom);O=!0,R=[ie,ie]}else O=!1,R=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:R}},Zc=function(a,n,l){var y=_i(l,1,n.zoom),O=Math.pow(2,n.zoom-l.tileID.overscaledZ),R=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[n.pixelsToGLUnits[0]/(y*O),n.pixelsToGLUnits[1]/(y*O)],u_overscale_factor:R}},Fs=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},au=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},Ll=function(a){return{u_matrix:a}},Tc=function(a,n,l,y){return{u_matrix:a,u_extrude_scale:_i(n,1,l),u_intensity:y}},yi=function(a,n,l){var y=a.transform;return{u_matrix:_c(a,n,l),u_ratio:1/_i(n,1,y.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},cc=function(a,n,l,y){return o.extend(yi(a,n,l),{u_image:0,u_image_height:y})},Uf=function(a,n,l,y){var O=a.transform,R=Bf(n,O);return{u_matrix:_c(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/_i(n,1,O.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[R,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},fc=function(a,n,l,y,O){var R=a.lineAtlas,k=Bf(n,a.transform),ie=l.layout.get("line-cap")==="round",Ee=R.getDash(y.from,ie),We=R.getDash(y.to,ie),$e=Ee.width*O.fromScale,qe=We.width*O.toScale;return o.extend(yi(a,n,l),{u_patternscale_a:[k/$e,-Ee.height/2],u_patternscale_b:[k/qe,-We.height/2],u_sdfgamma:R.width/(256*Math.min($e,qe)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:We.y,u_mix:O.t})};function Bf(s,a){return 1/_i(s,1,a.tileZoom)}function _c(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Rl=function(a,n,l,y,O){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(k=O.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(R=O.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:pl(O.paint.get("raster-hue-rotate"))};var R,k};function pl(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Ps,hc=function(a,n,l,y,O,R,k,ie,Ee,We){var $e=O.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_pitch:$e.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:$e.width/$e.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:R,u_label_plane_matrix:k,u_coord_matrix:ie,u_is_text:+Ee,u_pitch_with_map:+y,u_texsize:We,u_texture:0}},Fo=function(a,n,l,y,O,R,k,ie,Ee,We,$e){var qe=O.transform;return o.extend(hc(a,n,l,y,O,R,k,ie,Ee,We),{u_gamma_scale:y?Math.cos(qe._pitch)*qe.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+$e})},Il=function(a,n,l,y,O,R,k,ie,Ee,We){return o.extend(Fo(a,n,l,y,O,R,k,ie,!0,Ee,!0),{u_texsize_icon:We,u_texture_icon:1})},ml=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Xc=function(a,n,l,y,O,R){return o.extend(function(k,ie,Ee,We){var $e=Ee.imageManager.getPattern(k.from.toString()),qe=Ee.imageManager.getPattern(k.to.toString()),Lt=Ee.imageManager.getPixelSize(),Rt=Lt.width,Gt=Lt.height,Dt=Math.pow(2,We.tileID.overscaledZ),jt=We.tileSize*Math.pow(2,Ee.transform.tileZoom)/Dt,ir=jt*(We.tileID.canonical.x+We.tileID.wrap*Dt),Qt=jt*We.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:$e.tl,u_pattern_br_a:$e.br,u_pattern_tl_b:qe.tl,u_pattern_br_b:qe.br,u_texsize:[Rt,Gt],u_mix:ie.t,u_pattern_size_a:$e.displaySize,u_pattern_size_b:qe.displaySize,u_scale_a:ie.fromScale,u_scale_b:ie.toScale,u_tile_units_to_pixels:1/_i(We,1,Ee.transform.tileZoom),u_pixel_coord_upper:[ir>>16,Qt>>16],u_pixel_coord_lower:[65535&ir,65535&Qt]}}(y,R,l,O),{u_matrix:a,u_opacity:n})},vl={fillExtrusion:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new o.Uniform1f(a,n.u_height_factor),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new o.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new o.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new o.UniformColor(a,n.u_color),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_overlay:new o.Uniform1i(a,n.u_overlay),u_overlay_scale:new o.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new o.Uniform1f(a,n.u_extrude_scale),u_intensity:new o.Uniform1f(a,n.u_intensity),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_color_ramp:new o.Uniform1i(a,n.u_color_ramp),u_opacity:new o.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_latrange:new o.Uniform2f(a,n.u_latrange),u_light:new o.Uniform2f(a,n.u_light),u_shadow:new o.UniformColor(a,n.u_shadow),u_highlight:new o.UniformColor(a,n.u_highlight),u_accent:new o.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_dimension:new o.Uniform2f(a,n.u_dimension),u_zoom:new o.Uniform1f(a,n.u_zoom),u_unpack:new o.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_image:new o.Uniform1i(a,n.u_image),u_image_height:new o.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_texsize:new o.Uniform2f(a,n.u_texsize),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_image:new o.Uniform1i(a,n.u_image),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new o.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new o.Uniform1f(a,n.u_sdfgamma),u_image:new o.Uniform1i(a,n.u_image),u_tex_y_a:new o.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new o.Uniform1f(a,n.u_tex_y_b),u_mix:new o.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new o.Uniform2f(a,n.u_tl_parent),u_scale_parent:new o.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new o.Uniform1f(a,n.u_buffer_scale),u_fade_t:new o.Uniform1f(a,n.u_fade_t),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image0:new o.Uniform1i(a,n.u_image0),u_image1:new o.Uniform1i(a,n.u_image1),u_brightness_low:new o.Uniform1f(a,n.u_brightness_low),u_brightness_high:new o.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new o.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new o.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new o.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texsize_icon:new o.Uniform2f(a,n.u_texsize_icon),u_texture:new o.Uniform1i(a,n.u_texture),u_texture_icon:new o.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_color:new o.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image:new o.Uniform1i(a,n.u_image),u_pattern_tl_a:new o.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(a,n.u_pattern_br_b),u_texsize:new o.Uniform2f(a,n.u_texsize),u_mix:new o.Uniform1f(a,n.u_mix),u_pattern_size_a:new o.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new o.Uniform1f(a,n.u_scale_a),u_scale_b:new o.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(a,n.u_tile_units_to_pixels)}}};function iu(s,a,n,l,y,O,R){for(var k=s.context,ie=k.gl,Ee=s.useProgram("collisionBox"),We=[],$e=0,qe=0,Lt=0;Lt<l.length;Lt++){var Rt=l[Lt],Gt=a.getTile(Rt),Dt=Gt.getBucket(n);if(Dt){var jt=Rt.posMatrix;y[0]===0&&y[1]===0||(jt=s.translatePosMatrix(Rt.posMatrix,Gt,y,O));var ir=R?Dt.textCollisionBox:Dt.iconCollisionBox,Qt=Dt.collisionCircleArray;if(Qt.length>0){var Lr=o.create(),gr=jt;o.mul(Lr,Dt.placementInvProjMatrix,s.transform.glCoordMatrix),o.mul(Lr,Lr,Dt.placementViewportMatrix),We.push({circleArray:Qt,circleOffset:qe,transform:gr,invTransform:Lr}),qe=$e+=Qt.length/4}ir&&Ee.draw(k,ie.LINES,pe.disabled,rt.disabled,s.colorModeForRenderPass(),Ve.disabled,Zc(jt,s.transform,Gt),n.id,ir.layoutVertexBuffer,ir.indexBuffer,ir.segments,null,s.transform.zoom,null,null,ir.collisionVertexBuffer)}}if(R&&We.length){var Ar=s.useProgram("collisionCircle"),Or=new o.StructArrayLayout2f1f2i16;Or.resize(4*$e),Or._trim();for(var Kr=0,Qr=0,dn=We;Qr<dn.length;Qr+=1)for(var wn=dn[Qr],ra=0;ra<wn.circleArray.length/4;ra++){var ya=4*ra,Ta=wn.circleArray[ya+0],Ja=wn.circleArray[ya+1],Mn=wn.circleArray[ya+2],ba=wn.circleArray[ya+3];Or.emplace(Kr++,Ta,Ja,Mn,ba,0),Or.emplace(Kr++,Ta,Ja,Mn,ba,1),Or.emplace(Kr++,Ta,Ja,Mn,ba,2),Or.emplace(Kr++,Ta,Ja,Mn,ba,3)}(!Ps||Ps.length<2*$e)&&(Ps=function(uo){var ro=2*uo,Wi=new o.StructArrayLayout3ui6;Wi.resize(ro),Wi._trim();for(var xi=0;xi<ro;xi++){var no=6*xi;Wi.uint16[no+0]=4*xi+0,Wi.uint16[no+1]=4*xi+1,Wi.uint16[no+2]=4*xi+2,Wi.uint16[no+3]=4*xi+2,Wi.uint16[no+4]=4*xi+3,Wi.uint16[no+5]=4*xi+0}return Wi}($e));for(var ca=k.createIndexBuffer(Ps,!0),Fn=k.createVertexBuffer(Or,o.collisionCircleLayout.members,!0),Ma=0,Qn=We;Ma<Qn.length;Ma+=1){var Da=Qn[Ma],ai=Fs(Da.transform,Da.invTransform,s.transform);Ar.draw(k,ie.TRIANGLES,pe.disabled,rt.disabled,s.colorModeForRenderPass(),Ve.disabled,ai,n.id,Fn,ca,o.SegmentVector.simpleSegment(0,2*Da.circleOffset,Da.circleArray.length,Da.circleArray.length/2),null,s.transform.zoom,null,null,null)}Fn.destroy(),ca.destroy()}}var Yc=o.identity(new Float32Array(16));function Sf(s,a,n,l,y,O){var R=o.getAnchorAlignment(s),k=-(R.horizontalAlign-.5)*a,ie=-(R.verticalAlign-.5)*n,Ee=o.evaluateVariableOffset(s,l);return new o.Point((k/y+Ee[0])*O,(ie/y+Ee[1])*O)}function Af(s,a,n,l,y,O,R,k,ie,Ee,We){var $e=s.text.placedSymbolArray,qe=s.text.dynamicLayoutVertexArray,Lt=s.icon.dynamicLayoutVertexArray,Rt={};qe.clear();for(var Gt=0;Gt<$e.length;Gt++){var Dt=$e.get(Gt),jt=Dt.hidden||!Dt.crossTileID||s.allowVerticalPlacement&&!Dt.placedOrientation?null:l[Dt.crossTileID];if(jt){var ir=new o.Point(Dt.anchorX,Dt.anchorY),Qt=In(ir,n?k:R),Lr=Oi(O.cameraToCenterDistance,Qt.signedDistanceFromCamera),gr=y.evaluateSizeForFeature(s.textSizeData,Ee,Dt)*Lr/o.ONE_EM;n&&(gr*=s.tilePixelRatio/ie);for(var Ar=Sf(jt.anchor,jt.width,jt.height,jt.textOffset,jt.textBoxScale,gr),Or=n?In(ir.add(Ar),R).point:Qt.point.add(a?Ar.rotate(-O.angle):Ar),Kr=s.allowVerticalPlacement&&Dt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Qr=0;Qr<Dt.numGlyphs;Qr++)o.addDynamicAttributes(qe,Or,Kr);We&&Dt.associatedIconIndex>=0&&(Rt[Dt.associatedIconIndex]={shiftedAnchor:Or,angle:Kr})}else Za(Dt.numGlyphs,qe)}if(We){Lt.clear();for(var dn=s.icon.placedSymbolArray,wn=0;wn<dn.length;wn++){var ra=dn.get(wn);if(ra.hidden)Za(ra.numGlyphs,Lt);else{var ya=Rt[wn];if(ya)for(var Ta=0;Ta<ra.numGlyphs;Ta++)o.addDynamicAttributes(Lt,ya.shiftedAnchor,ya.angle);else Za(ra.numGlyphs,Lt)}}s.icon.dynamicLayoutVertexBuffer.updateData(Lt)}s.text.dynamicLayoutVertexBuffer.updateData(qe)}function Dl(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function dc(s,a,n,l,y,O,R,k,ie,Ee,We,$e){for(var qe=s.context,Lt=qe.gl,Rt=s.transform,Gt=k==="map",Dt=ie==="map",jt=Gt&&n.layout.get("symbol-placement")!=="point",ir=Gt&&!Dt&&!jt,Qt=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Lr=s.depthModeForSublayer(0,pe.ReadOnly),gr=n.layout.get("text-variable-anchor"),Ar=[],Or=0,Kr=l;Or<Kr.length;Or+=1){var Qr=Kr[Or],dn=a.getTile(Qr),wn=dn.getBucket(n);if(wn){var ra=y?wn.text:wn.icon;if(ra&&ra.segments.get().length){var ya=ra.programConfigurations.get(n.id),Ta=y||wn.sdfIcons,Ja=y?wn.textSizeData:wn.iconSizeData,Mn=Dt||Rt.pitch!==0,ba=s.useProgram(Dl(Ta,y,wn),ya),ca=o.evaluateSizeForZoom(Ja,Rt.zoom),Fn=void 0,Ma=[0,0],Qn=void 0,Da=void 0,ai=null,uo=void 0;if(y)Qn=dn.glyphAtlasTexture,Da=Lt.LINEAR,Fn=dn.glyphAtlasTexture.size,wn.iconsInText&&(Ma=dn.imageAtlasTexture.size,ai=dn.imageAtlasTexture,uo=Mn||s.options.rotating||s.options.zooming||Ja.kind==="composite"||Ja.kind==="camera"?Lt.LINEAR:Lt.NEAREST);else{var ro=n.layout.get("icon-size").constantOr(0)!==1||wn.iconsNeedLinear;Qn=dn.imageAtlasTexture,Da=Ta||s.options.rotating||s.options.zooming||ro||Mn?Lt.LINEAR:Lt.NEAREST,Fn=dn.imageAtlasTexture.size}var Wi=_i(dn,1,s.transform.zoom),xi=di(Qr.posMatrix,Dt,Gt,s.transform,Wi),no=Ga(Qr.posMatrix,Dt,Gt,s.transform,Wi),Go=gr&&wn.hasTextData(),Tu=n.layout.get("icon-text-fit")!=="none"&&Go&&wn.hasIconData();jt&&Ti(wn,Qr.posMatrix,s,y,xi,no,Dt,Ee);var _l=s.translatePosMatrix(Qr.posMatrix,dn,O,R),Hs=jt||y&&gr||Tu?Yc:xi,fs=s.translatePosMatrix(no,dn,O,R,!0),Ws=Ta&&n.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Zl={program:ba,buffers:ra,uniformValues:Ta?wn.iconsInText?Il(Ja.kind,ca,ir,Dt,s,_l,Hs,fs,Fn,Ma):Fo(Ja.kind,ca,ir,Dt,s,_l,Hs,fs,y,Fn,!0):hc(Ja.kind,ca,ir,Dt,s,_l,Hs,fs,y,Fn),atlasTexture:Qn,atlasTextureIcon:ai,atlasInterpolation:Da,atlasInterpolationIcon:uo,isSDF:Ta,hasHalo:Ws};if(Qt)for(var _u=0,Is=ra.segments.get();_u<Is.length;_u+=1){var Xl=Is[_u];Ar.push({segments:new o.SegmentVector([Xl]),sortKey:Xl.sortKey,state:Zl})}else Ar.push({segments:ra.segments,sortKey:0,state:Zl})}}}Qt&&Ar.sort(function(Kl,qc){return Kl.sortKey-qc.sortKey});for(var Su=0,Yl=Ar;Su<Yl.length;Su+=1){var Au=Yl[Su],wo=Au.state;if(qe.activeTexture.set(Lt.TEXTURE0),wo.atlasTexture.bind(wo.atlasInterpolation,Lt.CLAMP_TO_EDGE),wo.atlasTextureIcon&&(qe.activeTexture.set(Lt.TEXTURE1),wo.atlasTextureIcon&&wo.atlasTextureIcon.bind(wo.atlasInterpolationIcon,Lt.CLAMP_TO_EDGE)),wo.isSDF){var zu=wo.uniformValues;wo.hasHalo&&(zu.u_is_halo=1,Sc(wo.buffers,Au.segments,n,s,wo.program,Lr,We,$e,zu)),zu.u_is_halo=0}Sc(wo.buffers,Au.segments,n,s,wo.program,Lr,We,$e,wo.uniformValues)}}function Sc(s,a,n,l,y,O,R,k,ie){var Ee=l.context;y.draw(Ee,Ee.gl.TRIANGLES,O,R,k,Ve.disabled,ie,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function Nl(s,a,n,l,y,O,R){var k,ie,Ee,We,$e,qe=s.context.gl,Lt=n.paint.get("fill-pattern"),Rt=Lt&&Lt.constantOr(1),Gt=n.getCrossfadeParameters();R?(ie=Rt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=qe.LINES):(ie=Rt?"fillPattern":"fill",k=qe.TRIANGLES);for(var Dt=0,jt=l;Dt<jt.length;Dt+=1){var ir=jt[Dt],Qt=a.getTile(ir);if(!Rt||Qt.patternsLoaded()){var Lr=Qt.getBucket(n);if(Lr){var gr=Lr.programConfigurations.get(n.id),Ar=s.useProgram(ie,gr);Rt&&(s.context.activeTexture.set(qe.TEXTURE0),Qt.imageAtlasTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),gr.updatePaintBuffers(Gt));var Or=Lt.constantOr(null);if(Or&&Qt.imageAtlas){var Kr=Qt.imageAtlas,Qr=Kr.patternPositions[Or.to.toString()],dn=Kr.patternPositions[Or.from.toString()];Qr&&dn&&gr.setConstantPatternPositions(Qr,dn)}var wn=s.translatePosMatrix(ir.posMatrix,Qt,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(R){We=Lr.indexBuffer2,$e=Lr.segments2;var ra=[qe.drawingBufferWidth,qe.drawingBufferHeight];Ee=ie==="fillOutlinePattern"&&Rt?lc(wn,s,Gt,Qt,ra):Wc(wn,ra)}else We=Lr.indexBuffer,$e=Lr.segments,Ee=Rt?nu(wn,s,Gt,Qt):Pl(wn);Ar.draw(s.context,k,y,s.stencilModeForClipping(ir),O,Ve.disabled,Ee,n.id,Lr.layoutVertexBuffer,We,$e,n.paint,s.transform.zoom,gr)}}}}function Yu(s,a,n,l,y,O,R){for(var k=s.context,ie=k.gl,Ee=n.paint.get("fill-extrusion-pattern"),We=Ee.constantOr(1),$e=n.getCrossfadeParameters(),qe=n.paint.get("fill-extrusion-opacity"),Lt=0,Rt=l;Lt<Rt.length;Lt+=1){var Gt=Rt[Lt],Dt=a.getTile(Gt),jt=Dt.getBucket(n);if(jt){var ir=jt.programConfigurations.get(n.id),Qt=s.useProgram(We?"fillExtrusionPattern":"fillExtrusion",ir);We&&(s.context.activeTexture.set(ie.TEXTURE0),Dt.imageAtlasTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),ir.updatePaintBuffers($e));var Lr=Ee.constantOr(null);if(Lr&&Dt.imageAtlas){var gr=Dt.imageAtlas,Ar=gr.patternPositions[Lr.to.toString()],Or=gr.patternPositions[Lr.from.toString()];Ar&&Or&&ir.setConstantPatternPositions(Ar,Or)}var Kr=s.translatePosMatrix(Gt.posMatrix,Dt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Qr=n.paint.get("fill-extrusion-vertical-gradient"),dn=We?Ru(Kr,s,Qr,qe,Gt,$e,Dt):Pi(Kr,s,Qr,qe);Qt.draw(k,k.gl.TRIANGLES,y,O,R,Ve.backCCW,dn,n.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,n.paint,s.transform.zoom,ir)}}}function Cf(s,a,n,l,y,O){var R=s.context,k=R.gl,ie=a.fbo;if(ie){var Ee=s.useProgram("hillshade");R.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,ie.colorAttachment.get());var We=function($e,qe,Lt){var Rt=Lt.paint.get("hillshade-shadow-color"),Gt=Lt.paint.get("hillshade-highlight-color"),Dt=Lt.paint.get("hillshade-accent-color"),jt=Lt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Lt.paint.get("hillshade-illumination-anchor")==="viewport"&&(jt-=$e.transform.angle);var ir,Qt,Lr,gr=!$e.options.moving;return{u_matrix:$e.transform.calculatePosMatrix(qe.tileID.toUnwrapped(),gr),u_image:0,u_latrange:(ir=qe.tileID,Qt=Math.pow(2,ir.canonical.z),Lr=ir.canonical.y,[new o.MercatorCoordinate(0,Lr/Qt).toLngLat().lat,new o.MercatorCoordinate(0,(Lr+1)/Qt).toLngLat().lat]),u_light:[Lt.paint.get("hillshade-exaggeration"),jt],u_shadow:Rt,u_highlight:Gt,u_accent:Dt}}(s,a,n);Ee.draw(R,k.TRIANGLES,l,y,O,Ve.disabled,We,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function gl(s,a,n,l,y,O){var R=s.context,k=R.gl,ie=a.dem;if(ie&&ie.data){var Ee=ie.dim,We=ie.stride,$e=ie.getPixels();if(R.activeTexture.set(k.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture(We),a.demTexture){var qe=a.demTexture;qe.update($e,{premultiply:!1}),qe.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else a.demTexture=new o.Texture(R,$e,k.RGBA,{premultiply:!1}),a.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);R.activeTexture.set(k.TEXTURE0);var Lt=a.fbo;if(!Lt){var Rt=new o.Texture(R,{width:Ee,height:Ee,data:null},k.RGBA);Rt.bind(k.LINEAR,k.CLAMP_TO_EDGE),(Lt=a.fbo=R.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Rt.texture)}R.bindFramebuffer.set(Lt.framebuffer),R.viewport.set([0,0,Ee,Ee]),s.useProgram("hillshadePrepare").draw(R,k.TRIANGLES,l,y,O,Ve.disabled,function(Gt,Dt){var jt=Dt.stride,ir=o.create();return o.ortho(ir,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ir,ir,[0,-o.EXTENT,0]),{u_matrix:ir,u_image:1,u_dimension:[jt,jt],u_zoom:Gt.overscaledZ,u_unpack:Dt.getUnpackVector()}}(a.tileID,ie),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function pc(s,a,n,l,y){var O=l.paint.get("raster-fade-duration");if(O>0){var R=o.browser.now(),k=(R-s.timeAdded)/O,ie=a?(R-a.timeAdded)/O:-1,Ee=n.getSource(),We=y.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),$e=!a||Math.abs(a.tileID.overscaledZ-We)>Math.abs(s.tileID.overscaledZ-We),qe=$e&&s.refreshedUponExpiration?1:o.clamp($e?k:1-ie,0,1);return s.refreshedUponExpiration&&k>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-qe}:{opacity:qe,mix:0}}return{opacity:1,mix:0}}var Co=new o.Color(1,0,0,1),Vf=new o.Color(0,1,0,1),Kc=new o.Color(0,0,1,1),Ac=new o.Color(1,0,1,1),cf=new o.Color(0,1,1,1);function ff(s,a,n,l){kl(s,0,a+n/2,s.transform.width,n,l)}function hf(s,a,n,l){kl(s,a-n/2,0,n,s.transform.height,l)}function kl(s,a,n,l,y,O){var R=s.context,k=R.gl;k.enable(k.SCISSOR_TEST),k.scissor(a*o.browser.devicePixelRatio,n*o.browser.devicePixelRatio,l*o.browser.devicePixelRatio,y*o.browser.devicePixelRatio),R.clear({color:O}),k.disable(k.SCISSOR_TEST)}function jl(s,a,n){var l=s.context,y=l.gl,O=n.posMatrix,R=s.useProgram("debug"),k=pe.disabled,ie=rt.disabled,Ee=s.colorModeForRenderPass();l.activeTexture.set(y.TEXTURE0),s.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),R.draw(l,y.LINE_STRIP,k,ie,Ee,Ve.disabled,au(O,o.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var We=a.getTileByID(n.key).latestRawTileData,$e=Math.floor((We&&We.byteLength||0)/1024),qe=a.getTile(n).tileSize,Lt=512/Math.min(qe,512)*(n.overscaledZ/s.transform.zoom)*.5,Rt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Rt+=" => "+n.overscaledZ),function(Gt,Dt){Gt.initDebugOverlayCanvas();var jt=Gt.debugOverlayCanvas,ir=Gt.context.gl,Qt=Gt.debugOverlayCanvas.getContext("2d");Qt.clearRect(0,0,jt.width,jt.height),Qt.shadowColor="white",Qt.shadowBlur=2,Qt.lineWidth=1.5,Qt.strokeStyle="white",Qt.textBaseline="top",Qt.font="bold 36px Open Sans, sans-serif",Qt.fillText(Dt,5,5),Qt.strokeText(Dt,5,5),Gt.debugOverlayTexture.update(jt),Gt.debugOverlayTexture.bind(ir.LINEAR,ir.CLAMP_TO_EDGE)}(s,Rt+" "+$e+"kb"),R.draw(l,y.TRIANGLES,k,ie,yt.alphaBlended,Ve.disabled,au(O,o.Color.transparent,Lt),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var zl={symbol:function(a,n,l,y,O){if(a.renderPass==="translucent"){var R=rt.disabled,k=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ie,Ee,We,$e,qe,Lt,Rt){for(var Gt=Ee.transform,Dt=qe==="map",jt=Lt==="map",ir=0,Qt=ie;ir<Qt.length;ir+=1){var Lr=Qt[ir],gr=$e.getTile(Lr),Ar=gr.getBucket(We);if(Ar&&Ar.text&&Ar.text.segments.get().length){var Or=o.evaluateSizeForZoom(Ar.textSizeData,Gt.zoom),Kr=_i(gr,1,Ee.transform.zoom),Qr=di(Lr.posMatrix,jt,Dt,Ee.transform,Kr),dn=We.layout.get("icon-text-fit")!=="none"&&Ar.hasIconData();if(Or){var wn=Math.pow(2,Gt.zoom-gr.tileID.overscaledZ);Af(Ar,Dt,jt,Rt,o.symbolSize,Gt,Qr,Lr.posMatrix,wn,Or,dn)}}}}(y,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),O),l.paint.get("icon-opacity").constantOr(1)!==0&&dc(a,n,l,y,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),R,k),l.paint.get("text-opacity").constantOr(1)!==0&&dc(a,n,l,y,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),R,k),n.map.showCollisionBoxes&&(iu(a,n,l,y,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),iu(a,n,l,y,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,y){if(a.renderPass==="translucent"){var O=l.paint.get("circle-opacity"),R=l.paint.get("circle-stroke-width"),k=l.paint.get("circle-stroke-opacity"),ie=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||R.constantOr(1)!==0&&k.constantOr(1)!==0){for(var Ee=a.context,We=Ee.gl,$e=a.depthModeForSublayer(0,pe.ReadOnly),qe=rt.disabled,Lt=a.colorModeForRenderPass(),Rt=[],Gt=0;Gt<y.length;Gt++){var Dt=y[Gt],jt=n.getTile(Dt),ir=jt.getBucket(l);if(ir){var Qt=ir.programConfigurations.get(l.id),Lr={programConfiguration:Qt,program:a.useProgram("circle",Qt),layoutVertexBuffer:ir.layoutVertexBuffer,indexBuffer:ir.indexBuffer,uniformValues:vu(a,Dt,jt,l)};if(ie)for(var gr=0,Ar=ir.segments.get();gr<Ar.length;gr+=1){var Or=Ar[gr];Rt.push({segments:new o.SegmentVector([Or]),sortKey:Or.sortKey,state:Lr})}else Rt.push({segments:ir.segments,sortKey:0,state:Lr})}}ie&&Rt.sort(function(ra,ya){return ra.sortKey-ya.sortKey});for(var Kr=0,Qr=Rt;Kr<Qr.length;Kr+=1){var dn=Qr[Kr],wn=dn.state;wn.program.draw(Ee,We.TRIANGLES,$e,qe,Lt,Ve.disabled,wn.uniformValues,l.id,wn.layoutVertexBuffer,wn.indexBuffer,dn.segments,l.paint,a.transform.zoom,wn.programConfiguration)}}}},heatmap:function(a,n,l,y){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var O=a.context,R=O.gl,k=rt.disabled,ie=new yt([R.ONE,R.ONE],o.Color.transparent,[!0,!0,!0,!0]);!function(Rt,Gt,Dt){var jt=Rt.gl;Rt.activeTexture.set(jt.TEXTURE1),Rt.viewport.set([0,0,Gt.width/4,Gt.height/4]);var ir=Dt.heatmapFbo;if(ir)jt.bindTexture(jt.TEXTURE_2D,ir.colorAttachment.get()),Rt.bindFramebuffer.set(ir.framebuffer);else{var Qt=jt.createTexture();jt.bindTexture(jt.TEXTURE_2D,Qt),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_S,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_T,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MIN_FILTER,jt.LINEAR),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MAG_FILTER,jt.LINEAR),ir=Dt.heatmapFbo=Rt.createFramebuffer(Gt.width/4,Gt.height/4,!1),function(Lr,gr,Ar,Or){var Kr=Lr.gl;Kr.texImage2D(Kr.TEXTURE_2D,0,Kr.RGBA,gr.width/4,gr.height/4,0,Kr.RGBA,Lr.extRenderToTextureHalfFloat?Lr.extTextureHalfFloat.HALF_FLOAT_OES:Kr.UNSIGNED_BYTE,null),Or.colorAttachment.set(Ar)}(Rt,Gt,Qt,ir)}}(O,a,l),O.clear({color:o.Color.transparent});for(var Ee=0;Ee<y.length;Ee++){var We=y[Ee];if(!n.hasRenderableParent(We)){var $e=n.getTile(We),qe=$e.getBucket(l);if(qe){var Lt=qe.programConfigurations.get(l.id);a.useProgram("heatmap",Lt).draw(O,R.TRIANGLES,pe.disabled,k,ie,Ve.disabled,Tc(We.posMatrix,$e,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,l.paint,a.transform.zoom,Lt)}}}O.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Rt,Gt){var Dt=Rt.context,jt=Dt.gl,ir=Gt.heatmapFbo;if(ir){Dt.activeTexture.set(jt.TEXTURE0),jt.bindTexture(jt.TEXTURE_2D,ir.colorAttachment.get()),Dt.activeTexture.set(jt.TEXTURE1);var Qt=Gt.colorRampTexture;Qt||(Qt=Gt.colorRampTexture=new o.Texture(Dt,Gt.colorRamp,jt.RGBA)),Qt.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Rt.useProgram("heatmapTexture").draw(Dt,jt.TRIANGLES,pe.disabled,rt.disabled,Rt.colorModeForRenderPass(),Ve.disabled,function(Lr,gr,Ar,Or){var Kr=o.create();o.ortho(Kr,0,Lr.width,Lr.height,0,0,1);var Qr=Lr.context.gl;return{u_matrix:Kr,u_world:[Qr.drawingBufferWidth,Qr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:gr.paint.get("heatmap-opacity")}}(Rt,Gt),Gt.id,Rt.viewportBuffer,Rt.quadTriangleIndexBuffer,Rt.viewportSegments,Gt.paint,Rt.transform.zoom)}}(a,l))},line:function(a,n,l,y){if(a.renderPass==="translucent"){var O=l.paint.get("line-opacity"),R=l.paint.get("line-width");if(O.constantOr(1)!==0&&R.constantOr(1)!==0)for(var k=a.depthModeForSublayer(0,pe.ReadOnly),ie=a.colorModeForRenderPass(),Ee=l.paint.get("line-dasharray"),We=l.paint.get("line-pattern"),$e=We.constantOr(1),qe=l.paint.get("line-gradient"),Lt=l.getCrossfadeParameters(),Rt=$e?"linePattern":Ee?"lineSDF":qe?"lineGradient":"line",Gt=a.context,Dt=Gt.gl,jt=!0,ir=0,Qt=y;ir<Qt.length;ir+=1){var Lr=Qt[ir],gr=n.getTile(Lr);if(!$e||gr.patternsLoaded()){var Ar=gr.getBucket(l);if(Ar){var Or=Ar.programConfigurations.get(l.id),Kr=a.context.program.get(),Qr=a.useProgram(Rt,Or),dn=jt||Qr.program!==Kr,wn=We.constantOr(null);if(wn&&gr.imageAtlas){var ra=gr.imageAtlas,ya=ra.patternPositions[wn.to.toString()],Ta=ra.patternPositions[wn.from.toString()];ya&&Ta&&Or.setConstantPatternPositions(ya,Ta)}var Ja=$e?Uf(a,gr,l,Lt):Ee?fc(a,gr,l,Ee,Lt):qe?cc(a,gr,l,Ar.lineClipsArray.length):yi(a,gr,l);if($e)Gt.activeTexture.set(Dt.TEXTURE0),gr.imageAtlasTexture.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE),Or.updatePaintBuffers(Lt);else if(Ee&&(dn||a.lineAtlas.dirty))Gt.activeTexture.set(Dt.TEXTURE0),a.lineAtlas.bind(Gt);else if(qe){var Mn=Ar.gradients[l.id],ba=Mn.texture;if(l.gradientVersion!==Mn.version){var ca=256;if(l.stepInterpolant){var Fn=n.getSource().maxzoom,Ma=Lr.canonical.z===Fn?Math.ceil(1<<a.transform.maxZoom-Lr.canonical.z):1;ca=o.clamp(o.nextPowerOfTwo(Ar.maxLineLength/o.EXTENT*1024*Ma),256,Gt.maxTextureSize)}Mn.gradient=o.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:ca,image:Mn.gradient||void 0,clips:Ar.lineClipsArray}),Mn.texture?Mn.texture.update(Mn.gradient):Mn.texture=new o.Texture(Gt,Mn.gradient,Dt.RGBA),Mn.version=l.gradientVersion,ba=Mn.texture}Gt.activeTexture.set(Dt.TEXTURE0),ba.bind(l.stepInterpolant?Dt.NEAREST:Dt.LINEAR,Dt.CLAMP_TO_EDGE)}Qr.draw(Gt,Dt.TRIANGLES,k,a.stencilModeForClipping(Lr),ie,Ve.disabled,Ja,l.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,l.paint,a.transform.zoom,Or,Ar.layoutVertexBuffer2),jt=!1}}}}},fill:function(a,n,l,y){var O=l.paint.get("fill-color"),R=l.paint.get("fill-opacity");if(R.constantOr(1)!==0){var k=a.colorModeForRenderPass(),ie=l.paint.get("fill-pattern"),Ee=a.opaquePassEnabledForLayer()&&!ie.constantOr(1)&&O.constantOr(o.Color.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Ee){var We=a.depthModeForSublayer(1,a.renderPass==="opaque"?pe.ReadWrite:pe.ReadOnly);Nl(a,n,l,y,We,k,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var $e=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,pe.ReadOnly);Nl(a,n,l,y,$e,k,!0)}}},"fill-extrusion":function(a,n,l,y){var O=l.paint.get("fill-extrusion-opacity");if(O!==0&&a.renderPass==="translucent"){var R=new pe(a.context.gl.LEQUAL,pe.ReadWrite,a.depthRangeFor3D);if(O!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Yu(a,n,l,y,R,rt.disabled,yt.disabled),Yu(a,n,l,y,R,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var k=a.colorModeForRenderPass();Yu(a,n,l,y,R,rt.disabled,k)}}},hillshade:function(a,n,l,y){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var O=a.context,R=a.depthModeForSublayer(0,pe.ReadOnly),k=a.colorModeForRenderPass(),ie=a.renderPass==="translucent"?a.stencilConfigForOverlap(y):[{},y],Ee=ie[0],We=0,$e=ie[1];We<$e.length;We+=1){var qe=$e[We],Lt=n.getTile(qe);Lt.needsHillshadePrepare&&a.renderPass==="offscreen"?gl(a,Lt,l,R,rt.disabled,k):a.renderPass==="translucent"&&Cf(a,Lt,l,R,Ee[qe.overscaledZ],k)}O.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,y){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&y.length)for(var O=a.context,R=O.gl,k=n.getSource(),ie=a.useProgram("raster"),Ee=a.colorModeForRenderPass(),We=k instanceof xe?[{},y]:a.stencilConfigForOverlap(y),$e=We[0],qe=We[1],Lt=qe[qe.length-1].overscaledZ,Rt=!a.options.moving,Gt=0,Dt=qe;Gt<Dt.length;Gt+=1){var jt=Dt[Gt],ir=a.depthModeForSublayer(jt.overscaledZ-Lt,l.paint.get("raster-opacity")===1?pe.ReadWrite:pe.ReadOnly,R.LESS),Qt=n.getTile(jt),Lr=a.transform.calculatePosMatrix(jt.toUnwrapped(),Rt);Qt.registerFadeDuration(l.paint.get("raster-fade-duration"));var gr=n.findLoadedParent(jt,0),Ar=pc(Qt,gr,n,l,a.transform),Or=void 0,Kr=void 0,Qr=l.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;O.activeTexture.set(R.TEXTURE0),Qt.texture.bind(Qr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(R.TEXTURE1),gr?(gr.texture.bind(Qr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Or=Math.pow(2,gr.tileID.overscaledZ-Qt.tileID.overscaledZ),Kr=[Qt.tileID.canonical.x*Or%1,Qt.tileID.canonical.y*Or%1]):Qt.texture.bind(Qr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);var dn=Rl(Lr,Kr||[0,0],Or||1,Ar,l);k instanceof xe?ie.draw(O,R.TRIANGLES,ir,rt.disabled,Ee,Ve.disabled,dn,l.id,k.boundsBuffer,a.quadTriangleIndexBuffer,k.boundsSegments):ie.draw(O,R.TRIANGLES,ir,$e[jt.overscaledZ],Ee,Ve.disabled,dn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var y=l.paint.get("background-color"),O=l.paint.get("background-opacity");if(O!==0){var R=a.context,k=R.gl,ie=a.transform,Ee=ie.tileSize,We=l.paint.get("background-pattern");if(!a.isPatternMissing(We)){var $e=!We&&y.a===1&&O===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===$e){var qe=rt.disabled,Lt=a.depthModeForSublayer(0,$e==="opaque"?pe.ReadWrite:pe.ReadOnly),Rt=a.colorModeForRenderPass(),Gt=a.useProgram(We?"backgroundPattern":"background"),Dt=ie.coveringTiles({tileSize:Ee});We&&(R.activeTexture.set(k.TEXTURE0),a.imageManager.bind(a.context));for(var jt=l.getCrossfadeParameters(),ir=0,Qt=Dt;ir<Qt.length;ir+=1){var Lr=Qt[ir],gr=a.transform.calculatePosMatrix(Lr.toUnwrapped()),Ar=We?Xc(gr,O,a,We,{tileID:Lr,tileSize:Ee},jt):ml(gr,O,y);Gt.draw(R,k.TRIANGLES,Lt,qe,Rt,Ve.disabled,Ar,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var y=0;y<l.length;y++)jl(a,n,l[y])},custom:function(a,n,l){var y=a.context,O=l.implementation;if(a.renderPass==="offscreen"){var R=O.prerender;R&&(a.setCustomLayerDefaults(),y.setColorMode(a.colorModeForRenderPass()),R.call(O,y.gl,a.transform.customLayerMatrix()),y.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),y.setColorMode(a.colorModeForRenderPass()),y.setStencilMode(rt.disabled);var k=O.renderingMode==="3d"?new pe(a.context.gl.LEQUAL,pe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,pe.ReadOnly);y.setDepthMode(k),O.render(y.gl,a.transform.customLayerMatrix()),y.setDirty(),a.setBaseState(),y.bindFramebuffer.set(null)}}},Di=function(a,n){this.context=new ct(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=er.maxUnderzooming+er.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ao,this.gpuTimers={}};Di.prototype.resize=function(s,a){if(this.width=s*o.browser.devicePixelRatio,this.height=a*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},Di.prototype.setup=function(){var s=this.context,a=new o.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(o.EXTENT,0),a.emplaceBack(0,o.EXTENT),a.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Hu.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var n=new o.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(o.EXTENT,0),n.emplaceBack(0,o.EXTENT),n.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Hu.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var l=new o.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(o.EXTENT,0,o.EXTENT,0),l.emplaceBack(0,o.EXTENT,0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Ae.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var y=new o.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(y,Hu.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var O=new o.StructArrayLayout1ui2;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(O);var R=new o.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(R),this.emptyTexture=new o.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new rt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Di.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=o.create();o.ortho(n,0,this.width,this.height,0,0,1),o.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,pe.disabled,this.stencilClearMode,yt.disabled,Ve.disabled,Ll(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Di.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(yt.disabled),n.setDepthMode(pe.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var O=0,R=a;O<R.length;O+=1){var k=R[O],ie=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;y.draw(n,l.TRIANGLES,pe.disabled,new rt({func:l.ALWAYS,mask:0},ie,255,l.KEEP,l.KEEP,l.REPLACE),yt.disabled,Ve.disabled,Ll(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Di.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new rt({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},Di.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new rt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},Di.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ie,Ee){return Ee.overscaledZ-ie.overscaledZ}),y=l[l.length-1].overscaledZ,O=l[0].overscaledZ-y+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();for(var R={},k=0;k<O;k++)R[k+y]=new rt({func:n.GEQUAL,mask:255},k+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=O,[R,l]}return[(a={},a[y]=rt.disabled,a),l]},Di.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new yt([s.CONSTANT_COLOR,s.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?yt.unblended:yt.alphaBlended},Di.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return pe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new pe(n||this.context.gl.LEQUAL,a,[l,l])},Di.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Di.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var l=this.style._order,y=this.style.sourceCaches;for(var O in y){var R=y[O];R.used&&R.prepare(this.context)}var k,ie,Ee={},We={},$e={};for(var qe in y){var Lt=y[qe];Ee[qe]=Lt.getVisibleCoordinates(),We[qe]=Ee[qe].slice().reverse(),$e[qe]=Lt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<l.length;Rt++)if(this.style._layers[l[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var Gt=0,Dt=l;Gt<Dt.length;Gt+=1){var jt=this.style._layers[Dt[Gt]];if(jt.hasOffscreenPass()&&!jt.isHidden(this.transform.zoom)){var ir=We[jt.source];(jt.type==="custom"||ir.length)&&this.renderLayer(this,y[jt.source],jt,ir)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var Qt=this.style._layers[l[this.currentLayer]],Lr=y[Qt.source],gr=Ee[Qt.source];this._renderTileClippingMasks(Qt,gr),this.renderLayer(this,Lr,Qt,gr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Ar=this.style._layers[l[this.currentLayer]],Or=y[Ar.source],Kr=(Ar.type==="symbol"?$e:We)[Ar.source];this._renderTileClippingMasks(Ar,Ee[Ar.source]),this.renderLayer(this,Or,Ar,Kr)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Qr){Qr.source&&!Qr.isHidden(n.transform.zoom)&&(Qr.source!==(ie&&ie.id)&&(ie=n.style.sourceCaches[Qr.source]),(!k||k.getSource().maxzoom<ie.getSource().maxzoom)&&(k=ie))}),k&&zl.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(Qr){var dn=Qr.transform.padding;ff(Qr,Qr.transform.height-(dn.top||0),3,Co),ff(Qr,dn.bottom||0,3,Vf),hf(Qr,dn.left||0,3,Kc),hf(Qr,Qr.transform.width-(dn.right||0),3,Ac);var wn=Qr.transform.centerPoint;!function(ra,ya,Ta,Ja){kl(ra,ya-1,Ta-10,2,20,Ja),kl(ra,ya-10,Ta-1,20,2,Ja)}(Qr,wn.x,Qr.transform.height-wn.y,cf)}(this),this.context.setDefault()},Di.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),zl[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Di.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},Di.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Di.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Di.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],y=this.context.extTimerQuery,O=y.getQueryObjectEXT(l.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(l.query),a[n]=O}return a},Di.prototype.translatePosMatrix=function(s,a,n,l,y){if(!n[0]&&!n[1])return s;var O=y?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(O){var R=Math.sin(O),k=Math.cos(O);n=[n[0]*k-n[1]*R,n[0]*R+n[1]*k]}var ie=[y?n[0]:_i(a,n[0],this.transform.zoom),y?n[1]:_i(a,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return o.translate(Ee,s,ie),Ee},Di.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},Di.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},Di.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},Di.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new Hc(this.context,s,Vc[s],a,vl[s],this._showOverdrawInspector)),this.cache[n]},Di.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Di.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Di.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Di.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ou=function(a,n){this.points=a,this.planes=n};ou.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(R){return o.transformMat4([],R,s)}).map(function(R){return o.scale$1([],R,1/R[3]/a*l)}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(R){var k=o.sub([],y[R[0]],y[R[1]]),ie=o.sub([],y[R[2]],y[R[1]]),Ee=o.normalize([],o.cross([],k,ie)),We=-o.dot(Ee,y[R[1]]);return Ee.concat(We)});return new ou(y,O)};var Uo=function(a,n){this.min=a,this.max=n,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};Uo.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=o.clone$2(this.min),l=o.clone$2(this.max),y=0;y<a.length;y++)n[y]=a[y]?this.min[y]:this.center[y],l[y]=a[y]?this.center[y]:this.max[y];return l[2]=this.max[2],new Uo(n,l)},Uo.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Uo.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Uo.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var y=s.planes[l],O=0,R=0;R<a.length;R++)O+=o.dot$1(y,a[R])>=0;if(O===0)return 0;O!==a.length&&(n=!1)}if(n)return 2;for(var k=0;k<3;k++){for(var ie=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,We=0;We<s.points.length;We++){var $e=s.points[We][k]-this.min[k];ie=Math.min(ie,$e),Ee=Math.max(Ee,$e)}if(Ee<0||ie>this.max[k]-this.min[k])return 0}return 1};var Bo=function(a,n,l,y){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),y===void 0&&(y=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=y};Bo.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=o.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=o.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=o.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=o.number(s.right,a.right,n)),this},Bo.prototype.getCenter=function(s,a){var n=o.clamp((this.left+s-this.right)/2,0,s),l=o.clamp((this.top+a-this.bottom)/2,0,a);return new o.Point(n,l)},Bo.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},Bo.prototype.clone=function(){return new Bo(this.top,this.bottom,this.left,this.right)},Bo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ui=function(a,n,l,y,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Bo,this._posMatrixCache={},this._alignedPosMatrixCache={}},li={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ui.prototype.clone=function(){var s=new ui(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},li.minZoom.get=function(){return this._minZoom},li.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},li.maxZoom.get=function(){return this._maxZoom},li.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},li.minPitch.get=function(){return this._minPitch},li.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},li.maxPitch.get=function(){return this._maxPitch},li.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},li.renderWorldCopies.get=function(){return this._renderWorldCopies},li.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},li.worldSize.get=function(){return this.tileSize*this.scale},li.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},li.size.get=function(){return new o.Point(this.width,this.height)},li.bearing.get=function(){return-this.angle/Math.PI*180},li.bearing.set=function(s){var a=-o.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},li.pitch.get=function(){return this._pitch/Math.PI*180},li.pitch.set=function(s){var a=o.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},li.fov.get=function(){return this._fov/Math.PI*180},li.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},li.zoom.get=function(){return this._zoom},li.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},li.center.get=function(){return this._center},li.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},li.padding.get=function(){return this._edgeInsets.toJSON()},li.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},li.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ui.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},ui.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},ui.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},ui.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new o.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new o.Point(0,0)),l=this.pointCoordinate(new o.Point(this.width,0)),y=this.pointCoordinate(new o.Point(this.width,this.height)),O=this.pointCoordinate(new o.Point(0,this.height)),R=Math.floor(Math.min(n.x,l.x,y.x,O.x)),k=Math.floor(Math.max(n.x,l.x,y.x,O.x)),ie=R-1;ie<=k+1;ie++)ie!==0&&a.push(new o.UnwrappedTileID(ie,s));return a},ui.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=o.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,a),O=[y*l.x,y*l.y,0],R=ou.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),k=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=a);var ie=function(dn){return{aabb:new Uo([dn*y,0,0],[(dn+1)*y,y,0]),zoom:0,x:0,y:0,wrap:dn,fullyVisible:!1}},Ee=[],We=[],$e=a,qe=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Lt=1;Lt<=3;Lt++)Ee.push(ie(-Lt)),Ee.push(ie(Lt));for(Ee.push(ie(0));Ee.length>0;){var Rt=Ee.pop(),Gt=Rt.x,Dt=Rt.y,jt=Rt.fullyVisible;if(!jt){var ir=Rt.aabb.intersects(R);if(ir===0)continue;jt=ir===2}var Qt=Rt.aabb.distanceX(O),Lr=Rt.aabb.distanceY(O),gr=Math.max(Math.abs(Qt),Math.abs(Lr));if(Rt.zoom===$e||gr>3+(1<<$e-Rt.zoom)-2&&Rt.zoom>=k)We.push({tileID:new o.OverscaledTileID(Rt.zoom===$e?qe:Rt.zoom,Rt.wrap,Rt.zoom,Gt,Dt),distanceSq:o.sqrLen([O[0]-.5-Gt,O[1]-.5-Dt])});else for(var Ar=0;Ar<4;Ar++){var Or=(Gt<<1)+Ar%2,Kr=(Dt<<1)+(Ar>>1);Ee.push({aabb:Rt.aabb.quadrant(Ar),zoom:Rt.zoom+1,x:Or,y:Kr,wrap:Rt.wrap,fullyVisible:jt})}}return We.sort(function(Qr,dn){return Qr.distanceSq-dn.distanceSq}).map(function(Qr){return Qr.tileID})},ui.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},li.unmodified.get=function(){return this._unmodified},ui.prototype.zoomScale=function(s){return Math.pow(2,s)},ui.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},ui.prototype.project=function(s){var a=o.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(s.lng)*this.worldSize,o.mercatorYfromLat(a)*this.worldSize)},ui.prototype.unproject=function(s){return new o.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},li.point.get=function(){return this.project(this.center)},ui.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(s),O=new o.MercatorCoordinate(y.x-(n.x-l.x),y.y-(n.y-l.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())},ui.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},ui.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},ui.prototype.locationCoordinate=function(s){return o.MercatorCoordinate.fromLngLat(s)},ui.prototype.coordinateLocation=function(s){return s.toLngLat()},ui.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];o.transformMat4(a,a,this.pixelMatrixInverse),o.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],y=n[3],O=a[1]/l,R=n[1]/y,k=a[2]/l,ie=n[2]/y,Ee=k===ie?0:(0-k)/(ie-k);return new o.MercatorCoordinate(o.number(a[0]/l,n[0]/y,Ee)/this.worldSize,o.number(O,R,Ee)/this.worldSize)},ui.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix),new o.Point(a[0]/a[3],a[1]/a[3])},ui.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},ui.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ui.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ui.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var y=s.canonical,O=this.worldSize/this.zoomScale(y.z),R=y.x+Math.pow(2,y.z)*s.wrap,k=o.identity(new Float64Array(16));return o.translate(k,k,[R*O,y.y*O,0]),o.scale(k,k,[O/o.EXTENT,O/o.EXTENT,1]),o.multiply(k,a?this.alignedProjMatrix:this.projMatrix,k),l[n]=new Float32Array(k),l[n]},ui.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ui.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,y=-90,O=90,R=-180,k=180,ie=this.size,Ee=this._unmodified;if(this.latRange){var We=this.latRange;y=o.mercatorYfromLat(We[1])*this.worldSize,s=(O=o.mercatorYfromLat(We[0])*this.worldSize)-y<ie.y?ie.y/(O-y):0}if(this.lngRange){var $e=this.lngRange;R=o.mercatorXfromLng($e[0])*this.worldSize,a=(k=o.mercatorXfromLng($e[1])*this.worldSize)-R<ie.x?ie.x/(k-R):0}var qe=this.point,Lt=Math.max(a||0,s||0);if(Lt)return this.center=this.unproject(new o.Point(a?(k+R)/2:qe.x,s?(O+y)/2:qe.y)),this.zoom+=this.scaleZoom(Lt),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Rt=qe.y,Gt=ie.y/2;Rt-Gt<y&&(l=y+Gt),Rt+Gt>O&&(l=O-Gt)}if(this.lngRange){var Dt=qe.x,jt=ie.x/2;Dt-jt<R&&(n=R+jt),Dt+jt>k&&(n=k-jt)}n===void 0&&l===void 0||(this.center=this.unproject(new o.Point(n!==void 0?n:qe.x,l!==void 0?l:qe.y))),this._unmodified=Ee,this._constraining=!1}},ui.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-a-n,.01,Math.PI-.01)),y=this.point,O=y.x,R=y.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ie=this.height/50,Ee=new Float64Array(16);o.perspective(Ee,this._fov,this.width/this.height,ie,k),Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,o.scale(Ee,Ee,[1,-1,1]),o.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),o.rotateX(Ee,Ee,this._pitch),o.rotateZ(Ee,Ee,this.angle),o.translate(Ee,Ee,[-O,-R,0]),this.mercatorMatrix=o.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),o.scale(Ee,Ee,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=o.invert([],this.projMatrix);var We=this.width%2/2,$e=this.height%2/2,qe=Math.cos(this.angle),Lt=Math.sin(this.angle),Rt=O-Math.round(O)+qe*We+Lt*$e,Gt=R-Math.round(R)+qe*$e+Lt*We,Dt=new Float64Array(Ee);if(o.translate(Dt,Dt,[Rt>.5?Rt-1:Rt,Gt>.5?Gt-1:Gt,0]),this.alignedProjMatrix=Dt,Ee=o.create(),o.scale(Ee,Ee,[this.width/2,-this.height/2,1]),o.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=o.create(),o.scale(Ee,Ee,[1,-1,1]),o.translate(Ee,Ee,[-1,-1,0]),o.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ui.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new o.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},ui.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,s))},ui.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,y=a.x,O=a.y,R=0,k=s;R<k.length;R+=1){var ie=k[R];n=Math.min(n,ie.x),l=Math.min(l,ie.y),y=Math.max(y,ie.x),O=Math.max(O,ie.y)}return[new o.Point(n,l),new o.Point(y,l),new o.Point(y,O),new o.Point(n,O),new o.Point(n,l)]},Object.defineProperties(ui.prototype,li);var sl=function(a){var n,l,y,O;this._hashName=a&&encodeURIComponent(a),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,y=null,O=function(){y=null,l&&(n(),y=setTimeout(O,300),l=!1)},function(){return l=!0,y||O(),y})};sl.prototype.addTo=function(s){return this._map=s,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},sl.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},sl.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,l),O=Math.round(a.lng*y)/y,R=Math.round(a.lat*y)/y,k=this._map.getBearing(),ie=this._map.getPitch(),Ee="";if(Ee+=s?"/"+O+"/"+R+"/"+n:n+"/"+R+"/"+O,(k||ie)&&(Ee+="/"+Math.round(10*k)/10),ie&&(Ee+="/"+Math.round(ie)),this._hashName){var We=this._hashName,$e=!1,qe=o.window.location.hash.slice(1).split("&").map(function(Lt){var Rt=Lt.split("=")[0];return Rt===We?($e=!0,Rt+"="+Ee):Lt}).filter(function(Lt){return Lt});return $e||qe.push(We+"="+Ee),"#"+qe.join("&")}return"#"+Ee},sl.prototype._getCurrentHash=function(){var s,a=this,n=o.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},sl.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},sl.prototype._updateHashUnthrottled=function(){var s=this.getHashString();try{o.window.history.replaceState(o.window.history.state,"",s)}catch(a){}};var us={linearity:.3,easing:o.bezier(0,0,.3,1)},mc=o.extend({deceleration:2500,maxSpeed:1400},us),wf=o.extend({deceleration:20,maxSpeed:1400},us),Of=o.extend({deceleration:1e3,maxSpeed:360},us),No=o.extend({deceleration:1e3,maxSpeed:90},us),yl=function(a){this._map=a,this.clear()};function oi(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function Ia(s,a,n){var l=n.maxSpeed,y=n.linearity,O=n.deceleration,R=o.clamp(s*y/(a/1e3),-l,l),k=Math.abs(R)/(O*y);return{easing:n.easing,duration:1e3*k,amount:R*(k/2)}}yl.prototype.clear=function(){this._inertiaBuffer=[]},yl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:s})},yl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=o.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},yl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var y=l[n].settings;a.zoom+=y.zoomDelta||0,a.bearing+=y.bearingDelta||0,a.pitch+=y.pitchDelta||0,y.panDelta&&a.pan._add(y.panDelta),y.around&&(a.around=y.around),y.pinchAround&&(a.pinchAround=y.pinchAround)}var O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,R={};if(a.pan.mag()){var k=Ia(a.pan.mag(),O,o.extend({},mc,s||{}));R.offset=a.pan.mult(k.amount/a.pan.mag()),R.center=this._map.transform.center,oi(R,k)}if(a.zoom){var ie=Ia(a.zoom,O,wf);R.zoom=this._map.transform.zoom+ie.amount,oi(R,ie)}if(a.bearing){var Ee=Ia(a.bearing,O,Of);R.bearing=this._map.transform.bearing+o.clamp(Ee.amount,-179,179),oi(R,Ee)}if(a.pitch){var We=Ia(a.pitch,O,No);R.pitch=this._map.transform.pitch+We.amount,oi(R,We)}if(R.zoom||R.bearing){var $e=a.pinchAround===void 0?a.around:a.pinchAround;R.around=$e?this._map.unproject($e):this._map.getCenter()}return this.clear(),o.extend(R,{noMoveStart:!0})}};var xs=function(s){function a(l,y,O,R){R===void 0&&(R={});var k=D.mousePos(y.getCanvasContainer(),O),ie=y.unproject(k);s.call(this,l,o.extend({point:k,lngLat:ie,originalEvent:O},R)),this._defaultPrevented=!1,this.target=y}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),ls=function(s){function a(l,y,O){var R=l==="touchend"?O.changedTouches:O.touches,k=D.touchPos(y.getCanvasContainer(),R),ie=k.map(function($e){return y.unproject($e)}),Ee=k.reduce(function($e,qe,Lt,Rt){return $e.add(qe.div(Rt.length))},new o.Point(0,0)),We=y.unproject(Ee);s.call(this,l,{points:k,point:Ee,lngLats:ie,lngLat:We,originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),Iu=function(s){function a(l,y,O){s.call(this,l,{originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),bn=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};bn.prototype.reset=function(){delete this._mousedownPos},bn.prototype.wheel=function(s){return this._firePreventable(new Iu(s.type,this._map,s))},bn.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new xs(s.type,this._map,s))},bn.prototype.mouseup=function(s){this._map.fire(new xs(s.type,this._map,s))},bn.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new xs(s.type,this._map,s))},bn.prototype.dblclick=function(s){return this._firePreventable(new xs(s.type,this._map,s))},bn.prototype.mouseover=function(s){this._map.fire(new xs(s.type,this._map,s))},bn.prototype.mouseout=function(s){this._map.fire(new xs(s.type,this._map,s))},bn.prototype.touchstart=function(s){return this._firePreventable(new ls(s.type,this._map,s))},bn.prototype.touchmove=function(s){this._map.fire(new ls(s.type,this._map,s))},bn.prototype.touchend=function(s){this._map.fire(new ls(s.type,this._map,s))},bn.prototype.touchcancel=function(s){this._map.fire(new ls(s.type,this._map,s))},bn.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},bn.prototype.isEnabled=function(){return!0},bn.prototype.isActive=function(){return!1},bn.prototype.enable=function(){},bn.prototype.disable=function(){};var Es=function(a){this._map=a};Es.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Es.prototype.mousemove=function(s){this._map.fire(new xs(s.type,this._map,s))},Es.prototype.mousedown=function(){this._delayContextMenu=!0},Es.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Es.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new xs(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},Es.prototype.isEnabled=function(){return!0},Es.prototype.isActive=function(){return!1},Es.prototype.enable=function(){},Es.prototype.disable=function(){};var Us=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function Cc(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}Us.prototype.isEnabled=function(){return!!this._enabled},Us.prototype.isActive=function(){return!!this._active},Us.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Us.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Us.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Us.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var y=Math.min(l.x,n.x),O=Math.max(l.x,n.x),R=Math.min(l.y,n.y),k=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+y+"px,"+R+"px)"),this._box.style.width=O-y+"px",this._box.style.height=k-R+"px"}}},Us.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,y=a;if(this.reset(),D.suppressClick(),l.x!==y.x||l.y!==y.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(R){return R.fitScreenCoordinates(l,y,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},Us.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},Us.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},Us.prototype._fireEvent=function(s,a){return this._map.fire(new o.Event(s,{originalEvent:a}))};var gu=function(a){this.reset(),this.numTouches=a.numTouches};gu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},gu.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var y=new o.Point(0,0),O=0,R=l;O<R.length;O+=1)y._add(R[O]);return y.div(l.length)}(a),this.touches=Cc(n,a)))},gu.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=Cc(n,a);for(var y in this.touches){var O=l[y];(!O||O.dist(this.touches[y])>30)&&(this.aborted=!0)}}},gu.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var yu=function(a){this.singleTap=new gu(a),this.numTaps=a.numTaps,this.reset()};yu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},yu.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},yu.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},yu.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var y=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(l)<30;if(y&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var bu=function(){this._zoomIn=new yu({numTouches:1,numTaps:2}),this._zoomOut=new yu({numTouches:2,numTaps:1}),this.reset()};bu.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},bu.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},bu.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},bu.prototype.touchend=function(s,a,n){var l=this,y=this._zoomIn.touchend(s,a,n),O=this._zoomOut.touchend(s,a,n);return y?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(y)},{originalEvent:s})}}):O?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(O)},{originalEvent:s})}}):void 0},bu.prototype.touchcancel=function(){this.reset()},bu.prototype.enable=function(){this._enabled=!0},bu.prototype.disable=function(){this._enabled=!1,this.reset()},bu.prototype.isEnabled=function(){return this._enabled},bu.prototype.isActive=function(){return this._active};var Sn={0:1,2:2},Si=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};Si.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Si.prototype._correctButton=function(s,a){return!1},Si.prototype._move=function(s,a){return{}},Si.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},Si.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,y){var O=Sn[y];return l.buttons===void 0||(l.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},Si.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},Si.prototype.enable=function(){this._enabled=!0},Si.prototype.disable=function(){this._enabled=!1,this.reset()},Si.prototype.isEnabled=function(){return this._enabled},Si.prototype.isActive=function(){return this._active};var $c=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(Si),wc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var y=.8*(l.x-n.x);if(y)return this._active=!0,{bearingDelta:y}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(Si),Fl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var y=-.5*(l.y-n.y);if(y)return this._active=!0,{pitchDelta:y}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(Si),Du=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Du.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},Du.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},Du.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},Du.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},Du.prototype.touchcancel=function(){this.reset()},Du.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=Cc(n,a),y=new o.Point(0,0),O=new o.Point(0,0),R=0;for(var k in l){var ie=l[k],Ee=this._touches[k];Ee&&(y._add(ie),O._add(ie.sub(Ee)),R++,l[k]=ie)}if(this._touches=l,!(R<this._minTouches)&&O.mag()){var We=O.div(R);if(this._sum._add(We),!(this._sum.mag()<this._clickTolerance))return{around:y.div(R),panDelta:We}}},Du.prototype.enable=function(){this._enabled=!0},Du.prototype.disable=function(){this._enabled=!1,this.reset()},Du.prototype.isEnabled=function(){return this._enabled},Du.prototype.isActive=function(){return this._active};var Ua=function(){this.reset()};function Oc(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function Bs(s,a){return Math.log(s/a)/Math.LN2}Ua.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ua.prototype._start=function(s){},Ua.prototype._move=function(s,a,n){return{}},Ua.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Ua.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,y=l[1],O=Oc(n,a,l[0]),R=Oc(n,a,y);if(O&&R){var k=this._aroundCenter?null:O.add(R).div(2);return this._move([O,R],k,s)}}},Ua.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,y=l[1],O=Oc(n,a,l[0]),R=Oc(n,a,y);O&&R||(this._active&&D.suppressClick(),this.reset())}},Ua.prototype.touchcancel=function(){this.reset()},Ua.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Ua.prototype.disable=function(){this._enabled=!1,this.reset()},Ua.prototype.isEnabled=function(){return this._enabled},Ua.prototype.isActive=function(){return this._active};var bl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var y=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Bs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bs(this._distance,y),pinchAround:l}},a}(Ua);function df(s,a){return 180*s.angleWith(a)/Math.PI}var Mc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var y=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:df(this._vector,y),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,y=df(n,this._startVector);return Math.abs(y)<l},a}(Ua);function Ul(s){return Math.abs(s.y)>Math.abs(s.x)}var Ls=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,Ul(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,y){var O=n[0].sub(this._lastPoints[0]),R=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(O,R,y.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(O.y+R.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,y){if(this._valid!==void 0)return this._valid;var O=n.mag()>=2,R=l.mag()>=2;if(O||R){if(!O||!R)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var k=n.y>0==l.y>0;return Ul(n)&&Ul(l)&&k}},a}(Ua),Yo={panStep:100,bearingStep:15,pitchStep:10},Ji=function(){var a=Yo;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep};function bi(s){return s*(2-s)}Ji.prototype.reset=function(){this._active=!1},Ji.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,y=0,O=0,R=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),O=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),O=1);break;case 38:s.shiftKey?y=1:(s.preventDefault(),R=-1);break;case 40:s.shiftKey?y=-1:(s.preventDefault(),R=1);break;default:return}return{cameraAnimation:function(ie){var Ee=ie.getZoom();ie.easeTo({duration:300,easeId:"keyboardHandler",easing:bi,zoom:n?Math.round(Ee)+n*(s.shiftKey?2:1):Ee,bearing:ie.getBearing()+l*a._bearingStep,pitch:ie.getPitch()+y*a._pitchStep,offset:[-O*a._panStep,-R*a._panStep],center:ie.getCenter()},{originalEvent:s})}}}},Ji.prototype.enable=function(){this._enabled=!0},Ji.prototype.disable=function(){this._enabled=!1,this.reset()},Ji.prototype.isEnabled=function(){return this._enabled},Ji.prototype.isActive=function(){return this._active};var Qi=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};Qi.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Qi.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Qi.prototype.isEnabled=function(){return!!this._enabled},Qi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Qi.prototype.isZooming=function(){return!!this._zooming},Qi.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Qi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Qi.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=o.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Qi.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Qi.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Qi.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var y=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(y*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var O,R=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,k=this._startZoom,ie=this._easing,Ee=!1;if(this._type==="wheel"&&k&&ie){var We=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),$e=ie(We);O=o.number(k,R,$e),We<1?this._frameId||(this._frameId=!0):Ee=!0}else O=R,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:O-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Qi.prototype._smoothOutEasing=function(s){var a=o.ease;if(this._prevEase){var n=this._prevEase,l=(o.browser.now()-n.start)/n.duration,y=n.easing(l+.01)-n.easing(l),O=.27/Math.sqrt(y*y+1e-4)*.01,R=Math.sqrt(.0729-O*O);a=o.bezier(O,R,.25,1)}return this._prevEase={start:o.browser.now(),duration:s,easing:a},a},Qi.prototype.reset=function(){this._active=!1};var Ku=function(a,n){this._clickZoom=a,this._tapZoom=n};Ku.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ku.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ku.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ku.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var vo=function(){this.reset()};vo.prototype.reset=function(){this._active=!1},vo.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},vo.prototype.enable=function(){this._enabled=!0},vo.prototype.disable=function(){this._enabled=!1,this.reset()},vo.prototype.isEnabled=function(){return this._enabled},vo.prototype.isActive=function(){return this._active};var es=function(){this._tap=new yu({numTouches:1,numTaps:1}),this.reset()};es.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},es.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},es.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],y=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(s,a,n)},es.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},es.prototype.touchcancel=function(){this.reset()},es.prototype.enable=function(){this._enabled=!0},es.prototype.disable=function(){this._enabled=!1,this.reset()},es.prototype.isEnabled=function(){return this._enabled},es.prototype.isActive=function(){return this._active};var xu=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};xu.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},xu.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},xu.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},xu.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Nu=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};Nu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Nu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Nu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Nu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Vo=function(a,n,l,y){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0};Vo.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Vo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Vo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Vo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Vo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Vo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var xl=function(a){return a.zoom||a.drag||a.pitch||a.rotate},Vn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(o.Event);function la(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var go=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yl(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),o.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[o.window,"blur",void 0]];for(var y=0,O=this._listeners;y<O.length;y+=1){var R=O[y],k=R[0];D.addEventListener(k,R[1],k===o.window.document?this.handleWindowEvent:this.handleEvent,R[2])}};go.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===o.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},go.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new bn(a,s));var l=a.boxZoom=new Us(a,s);this._add("boxZoom",l);var y=new bu,O=new vo;a.doubleClickZoom=new Ku(O,y),this._add("tapZoom",y),this._add("clickZoom",O);var R=new es;this._add("tapDragZoom",R);var k=a.touchPitch=new Ls;this._add("touchPitch",k);var ie=new wc(s),Ee=new Fl(s);a.dragRotate=new Nu(s,ie,Ee),this._add("mouseRotate",ie,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var We=new $c(s),$e=new Du(s);a.dragPan=new xu(n,We,$e),this._add("mousePan",We),this._add("touchPan",$e,["touchZoom","touchRotate"]);var qe=new Mc,Lt=new bl;a.touchZoomRotate=new Vo(n,Lt,qe,R),this._add("touchRotate",qe,["touchPan","touchZoom"]),this._add("touchZoom",Lt,["touchPan","touchRotate"]);var Rt=a.scrollZoom=new Qi(a,this);this._add("scrollZoom",Rt,["mousePan"]);var Gt=a.keyboard=new Ji;this._add("keyboard",Gt),this._add("blockableMapEvent",new Es(a));for(var Dt=0,jt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Dt<jt.length;Dt+=1){var ir=jt[Dt];s.interactive&&s[ir]&&a[ir].enable(s[ir])}},go.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},go.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},go.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},go.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},go.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},go.prototype.isMoving=function(){return Boolean(xl(this._eventsInProgress))||this.isZooming()},go.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},go.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},go.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var y=l[n];this._el.contains(y.target)&&a.push(y)}return a},go.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},y={},O={},R=s.touches?this._getMapTouches(s.touches):void 0,k=R?D.touchPos(this._el,R):D.mousePos(this._el,s),ie=0,Ee=this._handlers;ie<Ee.length;ie+=1){var We=Ee[ie],$e=We.handlerName,qe=We.handler,Lt=We.allowed;if(qe.isEnabled()){var Rt=void 0;this._blockedByActive(O,Lt,$e)?qe.reset():qe[a||s.type]&&(Rt=qe[a||s.type](s,k,R),this.mergeHandlerResult(l,y,Rt,$e,n),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||qe.isActive())&&(O[$e]=qe)}}var Gt={};for(var Dt in this._previousActiveHandlers)O[Dt]||(Gt[Dt]=n);this._previousActiveHandlers=O,(Object.keys(Gt).length||la(l))&&(this._changes.push([l,y,Gt]),this._triggerRenderFrame()),(Object.keys(O).length||la(l))&&this._map._stop(!0),this._updatingCamera=!1;var jt=l.cameraAnimation;jt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],jt(this._map))}else this.stop(!0)},go.prototype.mergeHandlerResult=function(s,a,n,l,y){if(n){o.extend(s,n);var O={handlerName:l,originalEvent:n.originalEvent||y};n.zoomDelta!==void 0&&(a.zoom=O),n.panDelta!==void 0&&(a.drag=O),n.pitchDelta!==void 0&&(a.pitch=O),n.bearingDelta!==void 0&&(a.rotate=O)}},go.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,y=this._changes;l<y.length;l+=1){var O=y[l],R=O[0],k=O[1],ie=O[2];R.panDelta&&(s.panDelta=(s.panDelta||new o.Point(0,0))._add(R.panDelta)),R.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+R.zoomDelta),R.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+R.bearingDelta),R.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+R.pitchDelta),R.around!==void 0&&(s.around=R.around),R.pinchAround!==void 0&&(s.pinchAround=R.pinchAround),R.noInertia&&(s.noInertia=R.noInertia),o.extend(a,k),o.extend(n,ie)}this._updateMapTransform(s,a,n),this._changes=[]},go.prototype._updateMapTransform=function(s,a,n){var l=this._map,y=l.transform;if(!la(s))return this._fireEvents(a,n,!0);var O=s.panDelta,R=s.zoomDelta,k=s.bearingDelta,ie=s.pitchDelta,Ee=s.around,We=s.pinchAround;We!==void 0&&(Ee=We),l._stop(!0),Ee=Ee||l.transform.centerPoint;var $e=y.pointLocation(O?Ee.sub(O):Ee);k&&(y.bearing+=k),ie&&(y.pitch+=ie),R&&(y.zoom+=R),y.setLocationAtPoint($e,Ee),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},go.prototype._fireEvents=function(s,a,n){var l=this,y=xl(this._eventsInProgress),O=xl(s),R={};for(var k in s)this._eventsInProgress[k]||(R[k+"start"]=s[k].originalEvent),this._eventsInProgress[k]=s[k];for(var ie in!y&&O&&this._fireEvent("movestart",O.originalEvent),R)this._fireEvent(ie,R[ie]);for(var Ee in O&&this._fireEvent("move",O.originalEvent),s)this._fireEvent(Ee,s[Ee].originalEvent);var We,$e={};for(var qe in this._eventsInProgress){var Lt=this._eventsInProgress[qe],Rt=Lt.handlerName,Gt=Lt.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[qe],$e[qe+"end"]=We=a[Rt]||Gt)}for(var Dt in $e)this._fireEvent(Dt,$e[Dt]);var jt=xl(this._eventsInProgress);if(n&&(y||O)&&!jt){this._updatingCamera=!0;var ir=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Qt=function(gr){return gr!==0&&-l._bearingSnap<gr&&gr<l._bearingSnap};ir?(Qt(ir.bearing||this._map.getBearing())&&(ir.bearing=0),this._map.easeTo(ir,{originalEvent:We})):(this._map.fire(new o.Event("moveend",{originalEvent:We})),Qt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},go.prototype._fireEvent=function(s,a){this._map.fire(new o.Event(s,a?{originalEvent:a}:{}))},go.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new Vn("renderFrame",{timeStamp:a})),s._applyChanges()})},go.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var $u=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,y){return n=o.Point.convert(n).mult(-1),this.panTo(this.transform.center,o.extend({offset:n},l),y)},a.prototype.panTo=function(n,l,y){return this.easeTo(o.extend({center:n},l),y)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,y){return this.easeTo(o.extend({zoom:n},l),y)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,y){return this.easeTo(o.extend({bearing:n},l),y)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,o.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){return n=o.LngLatBounds.convert(n),this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),0,l)},a.prototype._cameraForBoxAndBearing=function(n,l,y,O){var R={top:0,bottom:0,right:0,left:0};if(typeof(O=o.extend({padding:R,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){var k=O.padding;O.padding={top:k,bottom:k,right:k,left:k}}O.padding=o.extend(R,O.padding);var ie=this.transform,Ee=ie.padding,We=ie.project(o.LngLat.convert(n)),$e=ie.project(o.LngLat.convert(l)),qe=We.rotate(-y*Math.PI/180),Lt=$e.rotate(-y*Math.PI/180),Rt=new o.Point(Math.max(qe.x,Lt.x),Math.max(qe.y,Lt.y)),Gt=new o.Point(Math.min(qe.x,Lt.x),Math.min(qe.y,Lt.y)),Dt=Rt.sub(Gt),jt=(ie.width-(Ee.left+Ee.right+O.padding.left+O.padding.right))/Dt.x,ir=(ie.height-(Ee.top+Ee.bottom+O.padding.top+O.padding.bottom))/Dt.y;if(!(ir<0||jt<0)){var Qt=Math.min(ie.scaleZoom(ie.scale*Math.min(jt,ir)),O.maxZoom),Lr=o.Point.convert(O.offset),gr=new o.Point(Lr.x+(O.padding.left-O.padding.right)/2,Lr.y+(O.padding.top-O.padding.bottom)/2).mult(ie.scale/ie.zoomScale(Qt));return{center:ie.unproject(We.add($e).div(2).sub(gr)),zoom:Qt,bearing:y}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,y){return this._fitInternal(this.cameraForBounds(n,l),l,y)},a.prototype.fitScreenCoordinates=function(n,l,y,O,R){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(n)),this.transform.pointLocation(o.Point.convert(l)),y,O),O,R)},a.prototype._fitInternal=function(n,l,y){return n?(delete(l=o.extend(n,l)).padding,l.linear?this.easeTo(l,y):this.flyTo(l,y)):this},a.prototype.jumpTo=function(n,l){this.stop();var y=this.transform,O=!1,R=!1,k=!1;return"zoom"in n&&y.zoom!==+n.zoom&&(O=!0,y.zoom=+n.zoom),n.center!==void 0&&(y.center=o.LngLat.convert(n.center)),"bearing"in n&&y.bearing!==+n.bearing&&(R=!0,y.bearing=+n.bearing),"pitch"in n&&y.pitch!==+n.pitch&&(k=!0,y.pitch=+n.pitch),n.padding==null||y.isPaddingEqual(n.padding)||(y.padding=n.padding),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),O&&this.fire(new o.Event("zoomstart",l)).fire(new o.Event("zoom",l)).fire(new o.Event("zoomend",l)),R&&this.fire(new o.Event("rotatestart",l)).fire(new o.Event("rotate",l)).fire(new o.Event("rotateend",l)),k&&this.fire(new o.Event("pitchstart",l)).fire(new o.Event("pitch",l)).fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))},a.prototype.easeTo=function(n,l){var y=this;this._stop(!1,n.easeId),((n=o.extend({offset:[0,0],duration:500,easing:o.ease},n)).animate===!1||!n.essential&&o.browser.prefersReducedMotion)&&(n.duration=0);var O=this.transform,R=this.getZoom(),k=this.getBearing(),ie=this.getPitch(),Ee=this.getPadding(),We="zoom"in n?+n.zoom:R,$e="bearing"in n?this._normalizeBearing(n.bearing,k):k,qe="pitch"in n?+n.pitch:ie,Lt="padding"in n?n.padding:O.padding,Rt=o.Point.convert(n.offset),Gt=O.centerPoint.add(Rt),Dt=O.pointLocation(Gt),jt=o.LngLat.convert(n.center||Dt);this._normalizeCenter(jt);var ir,Qt,Lr=O.project(Dt),gr=O.project(jt).sub(Lr),Ar=O.zoomScale(We-R);n.around&&(ir=o.LngLat.convert(n.around),Qt=O.locationPoint(ir));var Or={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||We!==R,this._rotating=this._rotating||k!==$e,this._pitching=this._pitching||qe!==ie,this._padding=!O.isPaddingEqual(Lt),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Or),this._ease(function(Kr){if(y._zooming&&(O.zoom=o.number(R,We,Kr)),y._rotating&&(O.bearing=o.number(k,$e,Kr)),y._pitching&&(O.pitch=o.number(ie,qe,Kr)),y._padding&&(O.interpolatePadding(Ee,Lt,Kr),Gt=O.centerPoint.add(Rt)),ir)O.setLocationAtPoint(ir,Qt);else{var Qr=O.zoomScale(O.zoom-R),dn=We>R?Math.min(2,Ar):Math.max(.5,Ar),wn=Math.pow(dn,1-Kr),ra=O.unproject(Lr.add(gr.mult(Kr*wn)).mult(Qr));O.setLocationAtPoint(O.renderWorldCopies?ra.wrap():ra,Gt)}y._fireMoveEvents(l)},function(Kr){y._afterEase(l,Kr)},n),this},a.prototype._prepareEase=function(n,l,y){y===void 0&&(y={}),this._moving=!0,l||y.moving||this.fire(new o.Event("movestart",n)),this._zooming&&!y.zooming&&this.fire(new o.Event("zoomstart",n)),this._rotating&&!y.rotating&&this.fire(new o.Event("rotatestart",n)),this._pitching&&!y.pitching&&this.fire(new o.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new o.Event("move",n)),this._zooming&&this.fire(new o.Event("zoom",n)),this._rotating&&this.fire(new o.Event("rotate",n)),this._pitching&&this.fire(new o.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var y=this._zooming,O=this._rotating,R=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.Event("zoomend",n)),O&&this.fire(new o.Event("rotateend",n)),R&&this.fire(new o.Event("pitchend",n)),this.fire(new o.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var y=this;if(!n.essential&&o.browser.prefersReducedMotion){var O=o.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(O,l)}this.stop(),n=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},n);var R=this.transform,k=this.getZoom(),ie=this.getBearing(),Ee=this.getPitch(),We=this.getPadding(),$e="zoom"in n?o.clamp(+n.zoom,R.minZoom,R.maxZoom):k,qe="bearing"in n?this._normalizeBearing(n.bearing,ie):ie,Lt="pitch"in n?+n.pitch:Ee,Rt="padding"in n?n.padding:R.padding,Gt=R.zoomScale($e-k),Dt=o.Point.convert(n.offset),jt=R.centerPoint.add(Dt),ir=R.pointLocation(jt),Qt=o.LngLat.convert(n.center||ir);this._normalizeCenter(Qt);var Lr=R.project(ir),gr=R.project(Qt).sub(Lr),Ar=n.curve,Or=Math.max(R.width,R.height),Kr=Or/Gt,Qr=gr.mag();if("minZoom"in n){var dn=o.clamp(Math.min(n.minZoom,k,$e),R.minZoom,R.maxZoom),wn=Or/R.zoomScale(dn-k);Ar=Math.sqrt(wn/Qr*2)}var ra=Ar*Ar;function ya(Qn){var Da=(Kr*Kr-Or*Or+(Qn?-1:1)*ra*ra*Qr*Qr)/(2*(Qn?Kr:Or)*ra*Qr);return Math.log(Math.sqrt(Da*Da+1)-Da)}function Ta(Qn){return(Math.exp(Qn)-Math.exp(-Qn))/2}function Ja(Qn){return(Math.exp(Qn)+Math.exp(-Qn))/2}var Mn=ya(0),ba=function(Da){return Ja(Mn)/Ja(Mn+Ar*Da)},ca=function(Da){return Or*((Ja(Mn)*(Ta(ai=Mn+Ar*Da)/Ja(ai))-Ta(Mn))/ra)/Qr;var ai},Fn=(ya(1)-Mn)/Ar;if(Math.abs(Qr)<1e-6||!isFinite(Fn)){if(Math.abs(Or-Kr)<1e-6)return this.easeTo(n,l);var Ma=Kr<Or?-1:1;Fn=Math.abs(Math.log(Kr/Or))/Ar,ca=function(){return 0},ba=function(Da){return Math.exp(Ma*Ar*Da)}}return n.duration="duration"in n?+n.duration:1e3*Fn/("screenSpeed"in n?+n.screenSpeed/Ar:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ie!==qe,this._pitching=Lt!==Ee,this._padding=!R.isPaddingEqual(Rt),this._prepareEase(l,!1),this._ease(function(Qn){var Da=Qn*Fn,ai=1/ba(Da);R.zoom=Qn===1?$e:k+R.scaleZoom(ai),y._rotating&&(R.bearing=o.number(ie,qe,Qn)),y._pitching&&(R.pitch=o.number(Ee,Lt,Qn)),y._padding&&(R.interpolatePadding(We,Rt,Qn),jt=R.centerPoint.add(Dt));var uo=Qn===1?Qt:R.unproject(Lr.add(gr.mult(ca(Da))).mult(ai));R.setLocationAtPoint(R.renderWorldCopies?uo.wrap():uo,jt),y._fireMoveEvents(l)},function(){return y._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,l)}if(!n){var O=this.handlers;O&&O.stop(!1)}return this},a.prototype._ease=function(n,l,y){y.animate===!1||y.duration===0?(n(1),l()):(this._easeStart=o.browser.now(),this._easeOptions=y,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=o.wrap(n,-180,180);var y=Math.abs(n-l);return Math.abs(n-360-l)<y&&(n-=360),Math.abs(n+360-l)<y&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var y=n.lng-l.center.lng;n.lng+=y>180?-360:y<-180?360:0}},a}(o.Evented),Vs=function(a){a===void 0&&(a={}),this.options=a,o.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Vs.prototype.getDefaultPosition=function(){return"bottom-right"},Vs.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Vs.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Vs.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,y,O){return y.value&&(l+=y.key+"="+y.value+(O<a.length-1?"&":"")),l},"?");s.href=o.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow"}},Vs.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Vs.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(k){return typeof k!="string"?"":k})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var y=n[l];if(y.used){var O=y.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort(function(k,ie){return k.length-ie.length});var R=(s=s.filter(function(k,ie){for(var Ee=ie+1;Ee<s.length;Ee++)if(s[Ee].indexOf(k)>=0)return!1;return!0})).join(" | ");R!==this._attribHTML&&(this._attribHTML=R,s.length?(this._innerContainer.innerHTML=R,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Vs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Ui=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Ui.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ui.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ui.prototype.getDefaultPosition=function(){return"bottom-left"},Ui.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ui.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Ui.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var cs=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};cs.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},cs.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var y=l[n];if(y.id===s)return void(y.cancelled=!0)}},cs.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var y=l[n];if(!y.cancelled&&(y.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},cs.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Jc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Gs=o.window.HTMLImageElement,Li=o.window.HTMLElement,Ni=o.window.ImageBitmap,Bl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Eu=function(s){function a(l){var y=this;if((l=o.extend({},Bl,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var O=new ui(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,O,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new cs,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Jc,l.locale),this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof Li))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new go(this,l),this._hash=l.hash&&new sl(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Vs({customAttribution:l.customAttribution})),this.addControl(new Ui,l.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(R){y._update(R.dataType==="style"),y.fire(new o.Event(R.dataType+"data",R))}),this.on("dataloading",function(R){y.fire(new o.Event(R.dataType+"dataloading",R))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,y){if(y===void 0&&l.getDefaultPosition&&(y=l.getDefaultPosition()),y===void 0&&(y="top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var O=l.onAdd(this);this._controls.push(l);var R=this._controlPositions[y];return y.indexOf("bottom")!==-1?R.insertBefore(O,R.firstChild):R.appendChild(O),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(l);return y>-1&&this._controls.splice(y,1),l.onRemove(this),this},a.prototype.resize=function(l){var y=this._containerDimensions(),O=y[0],R=y[1];this._resizeCanvas(O,R),this.transform.resize(O,R),this.painter.resize(O,R);var k=!this._moving;return k&&(this.stop(),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l))),this.fire(new o.Event("resize",l)),k&&this.fire(new o.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(o.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(o.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,y,O){var R,k=this;if(l==="mouseenter"||l==="mouseover"){var ie=!1;return{layer:y,listener:O,delegates:{mousemove:function($e){var qe=k.getLayer(y)?k.queryRenderedFeatures($e.point,{layers:[y]}):[];qe.length?ie||(ie=!0,O.call(k,new xs(l,k,$e.originalEvent,{features:qe}))):ie=!1},mouseout:function(){ie=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Ee=!1;return{layer:y,listener:O,delegates:{mousemove:function($e){(k.getLayer(y)?k.queryRenderedFeatures($e.point,{layers:[y]}):[]).length?Ee=!0:Ee&&(Ee=!1,O.call(k,new xs(l,k,$e.originalEvent)))},mouseout:function($e){Ee&&(Ee=!1,O.call(k,new xs(l,k,$e.originalEvent)))}}}}return{layer:y,listener:O,delegates:(R={},R[l]=function(We){var $e=k.getLayer(y)?k.queryRenderedFeatures(We.point,{layers:[y]}):[];$e.length&&(We.features=$e,O.call(k,We),delete We.features)},R)}},a.prototype.on=function(l,y,O){if(O===void 0)return s.prototype.on.call(this,l,y);var R=this._createDelegatedListener(l,y,O);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(R),R.delegates)this.on(k,R.delegates[k]);return this},a.prototype.once=function(l,y,O){if(O===void 0)return s.prototype.once.call(this,l,y);var R=this._createDelegatedListener(l,y,O);for(var k in R.delegates)this.once(k,R.delegates[k]);return this},a.prototype.off=function(l,y,O){var R=this;return O===void 0?s.prototype.off.call(this,l,y):(this._delegatedListeners&&this._delegatedListeners[l]&&function(k){for(var ie=k[l],Ee=0;Ee<ie.length;Ee++){var We=ie[Ee];if(We.layer===y&&We.listener===O){for(var $e in We.delegates)R.off($e,We.delegates[$e]);return ie.splice(Ee,1),R}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,y){if(!this.style)return[];var O;if(y!==void 0||l===void 0||l instanceof o.Point||Array.isArray(l)||(y=l,l=void 0),y=y||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof l[0]=="number")O=[o.Point.convert(l)];else{var R=o.Point.convert(l[0]),k=o.Point.convert(l[1]);O=[R,new o.Point(k.x,R.y),k,new o.Point(R.x,k.y),R]}return this.style.queryRenderedFeatures(O,y,this.transform)},a.prototype.querySourceFeatures=function(l,y){return this.style.querySourceFeatures(l,y)},a.prototype.setStyle=function(l,y){return(y=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(l,y))},a.prototype._getUIString=function(l){var y=this._locale[l];if(y==null)throw new Error("Missing UI string '"+l+"'");return y},a.prototype._updateStyle=function(l,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new $a(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new $a(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,y){var O=this;if(typeof l=="string"){var R=this._requestManager.normalizeStyleURL(l),k=this._requestManager.transformRequest(R,o.ResourceType.Style);o.getJSON(k,function(ie,Ee){ie?O.fire(new o.ErrorEvent(ie)):Ee&&O._updateDiff(Ee,y)})}else typeof l=="object"&&this._updateDiff(l,y)},a.prototype._updateDiff=function(l,y){try{this.style.setState(l)&&this._update(!0)}catch(O){o.warnOnce("Unable to perform style diff: "+(O.message||O.error||O)+".  Rebuilding the style from scratch."),this._updateStyle(l,y)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,y){return this._lazyInitEmptyStyle(),this.style.addSource(l,y),this._update(!0)},a.prototype.isSourceLoaded=function(l){var y=this.style&&this.style.sourceCaches[l];if(y!==void 0)return y.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var y in l){var O=l[y]._tiles;for(var R in O){var k=O[R];if(k.state!=="loaded"&&k.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,y,O){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,y,O)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,y,O){O===void 0&&(O={});var R=O.pixelRatio;R===void 0&&(R=1);var k=O.sdf;k===void 0&&(k=!1);var ie=O.stretchX,Ee=O.stretchY,We=O.content;if(this._lazyInitEmptyStyle(),y instanceof Gs||Ni&&y instanceof Ni){var $e=o.browser.getImageData(y);this.style.addImage(l,{data:new o.RGBAImage({width:$e.width,height:$e.height},$e.data),pixelRatio:R,stretchX:ie,stretchY:Ee,content:We,sdf:k,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var qe=y;this.style.addImage(l,{data:new o.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:R,stretchX:ie,stretchY:Ee,content:We,sdf:k,version:0,userImage:qe}),qe.onAdd&&qe.onAdd(this,l)}},a.prototype.updateImage=function(l,y){var O=this.style.getImage(l);if(!O)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var R=y instanceof Gs||Ni&&y instanceof Ni?o.browser.getImageData(y):y,k=R.width,ie=R.height,Ee=R.data;return k===void 0||ie===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==O.data.width||ie!==O.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(O.data.replace(Ee,!(y instanceof Gs||Ni&&y instanceof Ni)),void this.style.updateImage(l,O))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,y){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),y)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,y){return this._lazyInitEmptyStyle(),this.style.addLayer(l,y),this._update(!0)},a.prototype.moveLayer=function(l,y){return this.style.moveLayer(l,y),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,y,O){return this.style.setLayerZoomRange(l,y,O),this._update(!0)},a.prototype.setFilter=function(l,y,O){return O===void 0&&(O={}),this.style.setFilter(l,y,O),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,y,O,R){return R===void 0&&(R={}),this.style.setPaintProperty(l,y,O,R),this._update(!0)},a.prototype.getPaintProperty=function(l,y){return this.style.getPaintProperty(l,y)},a.prototype.setLayoutProperty=function(l,y,O,R){return R===void 0&&(R={}),this.style.setLayoutProperty(l,y,O,R),this._update(!0)},a.prototype.getLayoutProperty=function(l,y){return this.style.getLayoutProperty(l,y)},a.prototype.setLight=function(l,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(l,y),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,y){return this.style.setFeatureState(l,y),this._update()},a.prototype.removeFeatureState=function(l,y){return this.style.removeFeatureState(l,y),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,y=0;return this._container&&(l=this._container.clientWidth||400,y=this._container.clientHeight||300),[l,y]},a.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var O=this._containerDimensions();this._resizeCanvas(O[0],O[1]);var R=this._controlContainer=D.create("div","mapboxgl-control-container",l),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ie){k[ie]=D.create("div","mapboxgl-ctrl-"+ie,R)})},a.prototype._resizeCanvas=function(l,y){var O=o.browser.devicePixelRatio||1;this._canvas.width=O*l,this._canvas.height=O*y,this._canvas.style.width=l+"px",this._canvas.style.height=y+"px"},a.prototype._setupPainter=function(){var l=o.extend({},W.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);y?(this.painter=new Di(y,this.transform),o.webpSupported.testSupport(y)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var y,O=this,R=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,y),R=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ie=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,We=o.browser.now();this.style.zoomHistory.update(Ee,We);var $e=new o.EvaluationParameters(Ee,{now:We,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),qe=$e.crossFadingFactor();qe===1&&qe===this._crossFadingFactor||(ie=!0,this._crossFadingFactor=qe),this.style.update($e)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||ie)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Lt=o.browser.now()-R;k.endQueryEXT(k.TIME_ELAPSED_EXT,y),setTimeout(function(){var Dt=k.getQueryObjectEXT(y,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(y),O.fire(new o.Event("gpu-timing-frame",{cpuTime:Lt,gpuTime:Dt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var Dt=O.painter.queryGpuTimers(Rt);O.fire(new o.Event("gpu-timing-layer",{layerTimes:Dt}))},50)}var Gt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Gt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Gt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,y=this._controls;l<y.length;l+=1)y[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var O=this.painter.context.gl.getExtension("WEBGL_lose_context");O&&O.loseContext(),Vl(this._canvasContainer),Vl(this._controlContainer),Vl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(y){l._frame=null,l._render(y)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,y){o.setCacheLimits(l,y)},n.version.get=function(){return o.version},Object.defineProperties(a.prototype,n),a}($u);function Vl(s){s.parentNode&&s.parentNode.removeChild(s)}var vc={showCompass:!0,showZoom:!0,visualizePitch:!1},ku=function(a){var n=this;this.options=o.extend({},vc,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ku.prototype._updateZoomButtons=function(){var s=this._map.getZoom();this._zoomInButton.disabled=s===this._map.getMaxZoom(),this._zoomOutButton.disabled=s===this._map.getMinZoom()},ku.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},ku.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ts(this._map,this._compass,this.options.visualizePitch)),this._container},ku.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ku.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},ku.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var ts=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new wc({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new Fl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Ju(s,a,n){if(s=new o.LngLat(s.lng,s.lat),a){var l=new o.LngLat(s.lng-360,s.lat),y=new o.LngLat(s.lng+360,s.lat),O=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<O?s=l:n.locationPoint(y).distSqr(a)<O&&(s=y)}for(;Math.abs(s.lng-n.center.lng)>180;){var R=n.locationPoint(s);if(R.x>=0&&R.y>=0&&R.x<=n.width&&R.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}ts.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},ts.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(s,a);y&&y.pitchDelta&&n.setPitch(n.getPitch()+y.pitchDelta)}},ts.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},ts.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(o.window,"mousemove",this.mousemove),D.removeEventListener(o.window,"mouseup",this.mouseup)},ts.prototype.mousedown=function(s){this.down(o.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(o.window,"mousemove",this.mousemove),D.addEventListener(o.window,"mouseup",this.mouseup)},ts.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},ts.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},ts.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},ts.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},ts.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ts.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ul={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mf(s,a,n){var l=s.classList;for(var y in ul)l.remove("mapboxgl-"+n+"-anchor-"+y);l.add("mapboxgl-"+n+"-anchor-"+a)}var Gl,Qc=function(s){function a(n,l){var y=this;if(s.call(this),(n instanceof o.window.HTMLElement||l)&&(n=o.extend({element:n},l)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=o.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var O=D.createNS("http://www.w3.org/2000/svg","svg");O.setAttributeNS(null,"display","block"),O.setAttributeNS(null,"height","41px"),O.setAttributeNS(null,"width","27px"),O.setAttributeNS(null,"viewBox","0 0 27 41");var R=D.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"stroke","none"),R.setAttributeNS(null,"stroke-width","1"),R.setAttributeNS(null,"fill","none"),R.setAttributeNS(null,"fill-rule","evenodd");var k=D.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");var ie=D.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ie.setAttributeNS(null,"fill","#000000");for(var Ee=0,We=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ee<We.length;Ee+=1){var $e=We[Ee],qe=D.createNS("http://www.w3.org/2000/svg","ellipse");qe.setAttributeNS(null,"opacity","0.04"),qe.setAttributeNS(null,"cx","10.5"),qe.setAttributeNS(null,"cy","5.80029008"),qe.setAttributeNS(null,"rx",$e.rx),qe.setAttributeNS(null,"ry",$e.ry),ie.appendChild(qe)}var Lt=D.createNS("http://www.w3.org/2000/svg","g");Lt.setAttributeNS(null,"fill",this._color);var Rt=D.createNS("http://www.w3.org/2000/svg","path");Rt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Lt.appendChild(Rt);var Gt=D.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"opacity","0.25"),Gt.setAttributeNS(null,"fill","#000000");var Dt=D.createNS("http://www.w3.org/2000/svg","path");Dt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Gt.appendChild(Dt);var jt=D.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var ir=D.createNS("http://www.w3.org/2000/svg","g");ir.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Qt=D.createNS("http://www.w3.org/2000/svg","circle");Qt.setAttributeNS(null,"fill","#000000"),Qt.setAttributeNS(null,"opacity","0.25"),Qt.setAttributeNS(null,"cx","5.5"),Qt.setAttributeNS(null,"cy","5.5"),Qt.setAttributeNS(null,"r","5.4999962");var Lr=D.createNS("http://www.w3.org/2000/svg","circle");Lr.setAttributeNS(null,"fill","#FFFFFF"),Lr.setAttributeNS(null,"cx","5.5"),Lr.setAttributeNS(null,"cy","5.5"),Lr.setAttributeNS(null,"r","5.4999962"),ir.appendChild(Qt),ir.appendChild(Lr),k.appendChild(ie),k.appendChild(Lt),k.appendChild(Gt),k.appendChild(jt),k.appendChild(ir),O.appendChild(k),O.setAttributeNS(null,"height",41*this._scale+"px"),O.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(O),this._offset=o.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(gr){gr.preventDefault()}),this._element.addEventListener("mousedown",function(gr){gr.preventDefault()}),this._element.addEventListener("focus",function(){var gr=y._map.getContainer();gr.scrollTop=0,gr.scrollLeft=0}),Mf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,y=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&y!==32&&y!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,y=this._element;this._popup&&(l===y||y.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ju(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,ul[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=o.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(o.Evented),pf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ts=0,ju=!1,ll=function(s){function a(n){s.call(this),this.options=o.extend({},pf,n),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Gl!==void 0?l(Gl):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(y){l(Gl=y.state!=="denied")}):l(Gl=!!o.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ts=0,ju=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),y=n.coords;return l&&(y.longitude<l.getWest()||y.longitude>l.getEast()||y.latitude<l.getSouth()||y.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude),y=n.coords.accuracy,O=this._map.getBearing(),R=o.extend({bearing:O},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(y),R,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),y=this._map.unproject([1,n]),O=l.distanceTo(y),R=Math.ceil(2*this._accuracy/O);this._circleElement.style.width=R+"px",this._circleElement.style.height=R+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&ju)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var O=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Qc(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(R){R.geolocateSource||l._watchState!=="ACTIVE_LOCK"||R.originalEvent&&R.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new o.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ts--,ju=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ts>1?(n={maximumAge:6e5,timeout:0},ju=!0):(n=this.options.positionOptions,ju=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(o.Evented),mf={maxWidth:100,unit:"metric"},El=function(a){this.options=o.extend({},mf,a),o.bindAll(["_onMove","setUnit"],this)};function Hl(s,a,n){var l=n&&n.maxWidth||100,y=s._container.clientHeight/2,O=s.unproject([0,y]),R=s.unproject([l,y]),k=O.distanceTo(R);if(n&&n.unit==="imperial"){var ie=3.2808*k;ie>5280?cl(a,l,ie/5280,s._getUIString("ScaleControl.Miles")):cl(a,l,ie,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?cl(a,l,k/1852,s._getUIString("ScaleControl.NauticalMiles")):k>=1e3?cl(a,l,k/1e3,s._getUIString("ScaleControl.Kilometers")):cl(a,l,k,s._getUIString("ScaleControl.Meters"))}function cl(s,a,n,l){var y,O,R,k=(y=n,(O=Math.pow(10,(""+Math.floor(y)).length-1))*(R=(R=y/O)>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(ie){var Ee=Math.pow(10,Math.ceil(-Math.log(ie)/Math.LN10));return Math.round(ie*Ee)/Ee}(R)));s.style.width=a*(k/n)+"px",s.innerHTML=k+"&nbsp;"+l}El.prototype.getDefaultPosition=function(){return"bottom-left"},El.prototype._onMove=function(){Hl(this._map,this._container,this.options)},El.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},El.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},El.prototype.setUnit=function(s){this.options.unit=s,Hl(this._map,this._container,this.options)};var Rs=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof o.window.HTMLElement?this._container=a.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Rs.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Rs.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Rs.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Rs.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Rs.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Rs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Rs.prototype._isFullscreen=function(){return this._fullscreen},Rs.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Rs.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Tl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Wl=function(s){function a(n){s.call(this),this.options=o.extend(Object.create(Tl),n),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(o.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,y=o.window.document.createDocumentFragment(),O=o.window.document.createElement("body");for(O.innerHTML=n;l=O.firstChild;)y.appendChild(l);return this.setDOMContent(y)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){return this._createContent(),this._content.appendChild(n),this._update(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createContent=function(){this._content&&D.remove(this._content),this._content=D.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function($e){return l._container.classList.add($e)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ju(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var y=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),O=this.options.anchor,R=function $e(qe){if(qe){if(typeof qe=="number"){var Lt=Math.round(Math.sqrt(.5*Math.pow(qe,2)));return{center:new o.Point(0,0),top:new o.Point(0,qe),"top-left":new o.Point(Lt,Lt),"top-right":new o.Point(-Lt,Lt),bottom:new o.Point(0,-qe),"bottom-left":new o.Point(Lt,-Lt),"bottom-right":new o.Point(-Lt,-Lt),left:new o.Point(qe,0),right:new o.Point(-qe,0)}}if(qe instanceof o.Point||Array.isArray(qe)){var Rt=o.Point.convert(qe);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:o.Point.convert(qe.center||[0,0]),top:o.Point.convert(qe.top||[0,0]),"top-left":o.Point.convert(qe["top-left"]||[0,0]),"top-right":o.Point.convert(qe["top-right"]||[0,0]),bottom:o.Point.convert(qe.bottom||[0,0]),"bottom-left":o.Point.convert(qe["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(qe["bottom-right"]||[0,0]),left:o.Point.convert(qe.left||[0,0]),right:o.Point.convert(qe.right||[0,0])}}return $e(new o.Point(0,0))}(this.options.offset);if(!O){var k,ie=this._container.offsetWidth,Ee=this._container.offsetHeight;k=y.y+R.bottom.y<Ee?["top"]:y.y>this._map.transform.height-Ee?["bottom"]:[],y.x<ie/2?k.push("left"):y.x>this._map.transform.width-ie/2&&k.push("right"),O=k.length===0?"bottom":k.join("-")}var We=y.add(R[O]).round();D.setTransform(this._container,ul[O]+" translate("+We.x+"px,"+We.y+"px)"),Mf(this._container,O,"popup")}},a.prototype._onClose=function(){this.remove()},a}(o.Evented),Qu={version:o.version,supported:W,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:Eu,NavigationControl:ku,GeolocateControl:ll,AttributionControl:Vs,ScaleControl:El,FullscreenControl:Rs,Popup:Wl,Marker:Qc,Style:$a,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Jr().acquire(ur)},clearPrewarmedResources:function(){var a=Tn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(ur),Tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(s){o.config.ACCESS_TOKEN=s},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(s){o.config.API_URL=s},get workerCount(){return Wr.workerCount},set workerCount(s){Wr.workerCount=s},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){o.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){o.clearTileCache(a)},workerUrl:""};return Qu}),Z})},"4cb6":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm");E.METADATA_KEY=T;var m=i("9Fde");E.Container=m.Container;var Z=i("FV85");E.BindingScopeEnum=Z.BindingScopeEnum,E.BindingTypeEnum=Z.BindingTypeEnum,E.TargetTypeEnum=Z.TargetTypeEnum;var z=i("dxzI");E.AsyncContainerModule=z.AsyncContainerModule,E.ContainerModule=z.ContainerModule;var o=i("cZ5Q");E.injectable=o.injectable;var W=i("0gSV");E.tagged=W.tagged;var D=i("ZzCi");E.named=D.named;var Y=i("Yk9n");E.inject=Y.inject,E.LazyServiceIdentifer=Y.LazyServiceIdentifer;var q=i("jYx5");E.optional=q.optional;var he=i("n2J3");E.unmanaged=he.unmanaged;var X=i("jIg/");E.multiInject=X.multiInject;var je=i("oaX6");E.targetName=je.targetName;var Ge=i("Sk89");E.postConstruct=Ge.postConstruct;var ge=i("wnjb");E.MetadataReader=ge.MetadataReader;var Ce=i("d9O0");E.id=Ce.id;var ht=i("Ztfv");E.decorate=ht.decorate;var Ne=i("RR/i");E.traverseAncerstors=Ne.traverseAncerstors,E.taggedConstraint=Ne.taggedConstraint,E.namedConstraint=Ne.namedConstraint,E.typeConstraint=Ne.typeConstraint;var Et=i("ujMp");E.getServiceIdentifierAsString=Et.getServiceIdentifierAsString;var He=i("78VC");E.multiBindToService=He.multiBindToService},"4qC0":function(Le,E,i){var T=i("NykK"),m=i("Z0cm"),Z=i("ExA7"),z="[object String]";function o(W){return typeof W=="string"||!m(W)&&Z(W)&&T(W)==z}Le.exports=o},"5Tg0":function(Le,E,i){(function(T){var m=i("Kz5y"),Z=E&&!E.nodeType&&E,z=Z&&typeof T=="object"&&T&&!T.nodeType&&T,o=z&&z.exports===Z,W=o?m.Buffer:void 0,D=W?W.allocUnsafe:void 0;function Y(q,he){if(he)return q.slice();var X=q.length,je=D?D(X):new q.constructor(X);return q.copy(je),je}T.exports=Y}).call(this,i("YuTi")(Le))},"5gLl":function(Le,E,i){"use strict";i.d(E,"a",function(){return X});var T=i("lSNA"),m=i.n(T),Z=i("LvWW"),z=i.n(Z),o=i("AKIq"),W=i.n(o),D=i("cWyK"),Y=i.n(D);function q(je,Ge){var ge=Object.keys(je);if(Object.getOwnPropertySymbols){var Ce=Object.getOwnPropertySymbols(je);Ge&&(Ce=Ce.filter(function(ht){return Object.getOwnPropertyDescriptor(je,ht).enumerable})),ge.push.apply(ge,Ce)}return ge}function he(je){for(var Ge=1;Ge<arguments.length;Ge++){var ge=arguments[Ge]!=null?arguments[Ge]:{};Ge%2?q(Object(ge),!0).forEach(function(Ce){m()(je,Ce,ge[Ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(je,Object.getOwnPropertyDescriptors(ge)):q(Object(ge)).forEach(function(Ce){Object.defineProperty(je,Ce,Object.getOwnPropertyDescriptor(ge,Ce))})}return je}function X(je,Ge){var ge=[],Ce={};if(je.features=je.features.filter(function(Ne){var Et=Ne.geometry;return Ne!=null&&Et&&Et.type&&Et.coordinates&&Et.coordinates.length>0}),z()(je,!0),je.features.length===0)return{dataArray:[],featureKeys:Ce};var ht=0;return D.flattenEach(je,function(Ne,Et){var He=Object(o.getCoords)(Ne),mt=Et,Ye=he(he({},Ne.properties),{},{coordinates:He,_id:mt});ge.push(Ye)}),{dataArray:ge,featureKeys:Ce}}},"5ku3":function(Le,E,i){"use strict";(function(T){i.d(E,"a",function(){return z});var m=i("U8pU"),Z=i("I0ug");function z(){var W=(typeof T=="undefined"?"undefined":Object(m.a)(T))==="object"&&String(T)==="[object process]"&&!T.browser;return!W||Object(Z.a)()}function o(){return z()&&typeof document!="undefined"}}).call(this,i("Q2Ig"))},"5zYK":function(Le,E,i){"use strict";i.d(E,"a",function(){return q});var T=i("lSNA"),m=i.n(T),Z=i("RIqP"),z=i.n(Z),o=i("LvWW"),W=i.n(o);function D(he,X){var je=Object.keys(he);if(Object.getOwnPropertySymbols){var Ge=Object.getOwnPropertySymbols(he);X&&(Ge=Ge.filter(function(ge){return Object.getOwnPropertyDescriptor(he,ge).enumerable})),je.push.apply(je,Ge)}return je}function Y(he){for(var X=1;X<arguments.length;X++){var je=arguments[X]!=null?arguments[X]:{};X%2?D(Object(je),!0).forEach(function(Ge){m()(he,Ge,je[Ge])}):Object.getOwnPropertyDescriptors?Object.defineProperties(he,Object.getOwnPropertyDescriptors(je)):D(Object(je)).forEach(function(Ge){Object.defineProperty(he,Ge,Object.getOwnPropertyDescriptor(je,Ge))})}return he}function q(he,X){var je=X.x,Ge=X.y,ge=X.x1,Ce=X.y1,ht=X.coordinates,Ne=[];return he.forEach(function(Et,He){var mt=[];if(je&&Ge&&(mt=[parseFloat(Et[je]),parseFloat(Et[Ge])]),je&&Ge&&ge&&Ce){var Ye=[parseFloat(Et[je]),parseFloat(Et[Ge])],xt=[parseFloat(Et[ge]),parseFloat(Et[Ce])];mt=[Ye,xt]}if(ht){var _t="Polygon";Array.isArray(ht[0])||(_t="Point"),Array.isArray(ht[0])&&!Array.isArray(ht[0][0])&&(_t="LineString");var Ie={type:_t,coordinates:z()(Et[ht])};W()(Ie,!0),mt=Ie.coordinates}var De=Y(Y({},Et),{},{_id:He,coordinates:mt});Ne.push(De)}),{dataArray:Ne}}},"6AGu":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("LKzl"),Z=function(){function z(o){this._binding=o}return z.prototype.inRequestScope=function(){return this._binding.scope=T.BindingScopeEnum.Request,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inSingletonScope=function(){return this._binding.scope=T.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inTransientScope=function(){return this._binding.scope=T.BindingScopeEnum.Transient,new m.BindingWhenOnSyntax(this._binding)},z}();E.BindingInSyntax=Z},"6D9b":function(Le,E,i){Le.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(Le,E){},"6acW":function(Le,E,i){var T=i("dt0z"),m=i("gQMU");function Z(z){return m(T(z).toLowerCase())}Le.exports=Z},"6nK8":function(Le,E,i){var T=i("dVn5"),m=i("fo6e"),Z=i("dt0z"),z=i("9NmV");function o(W,D,Y){return W=Z(W),D=Y?void 0:D,D===void 0?m(W)?z(W):T(W):W.match(D)||[]}Le.exports=o},"711d":function(Le,E){function i(T){return function(m){return m==null?void 0:m[T]}}Le.exports=i},"78VC":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiBindToService=function(T){return function(m){return function(){for(var Z=[],z=0;z<arguments.length;z++)Z[z]=arguments[z];return Z.forEach(function(o){return T.bind(o).toService(m)})}}}},"7Ix3":function(Le,E){function i(T){var m=[];if(T!=null)for(var Z in Object(T))m.push(Z);return m}Le.exports=i},"7tbW":function(Le,E,i){var T=i("LGYb");function m(Z){return Z&&Z.length?T(Z):[]}Le.exports=m},"8/Fi":function(Le,E,i){"use strict";var T=i("J4zp"),m=i.n(T),Z=i("9nhX"),z=i.n(Z),o=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function W(ot){return o.indexOf(ot)}var D=2,Y=4,q=64,he=128,X=256,je=512,Ge=8192,ge=16384,Ce=32768,ht=32768*2,Ne=131072,Et=262144,He=524288,mt=1048576,Ye=2097152,xt=4194304,_t=8388608,Ie=16777216,De=16777216*2;function ze(ot,Bt){return ot=z()(Math.floor(ot),0,255),Bt=z()(Math.floor(Bt),0,255),256*ot+Bt}function at(ot){var Bt=ot.color,Wt=ot.radius,sr=ot.tileX,ne=ot.tileY,$=ot.shape,G=ot.opacity,Ae=ot.stroke,xe=ot.strokeWidth,Se=ot.strokeOpacity,ve=[],et=[],Yt=[],At=[ze(Bt[0],Bt[1]),ze(Bt[2],Bt[3])],ye=[ze(Ae[0],Ae[1]),ze(Ae[2],Ae[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(be){var Ue=m()(be,2),st=Ue[0],Me=Ue[1];ve.push([].concat(At,[(st+1)*_t+(Me+1)*Ye+W($)*Ne+Wt,(sr+512)*He+(ne+512)*q])),et.push([].concat(ye,[xe,Se])),Yt.push([G,0,0,0])}),{packedBuffer:ve,packedBuffer2:et,packedBuffer3:Yt}}function Pe(ot,Bt){if(ot===0&&!Bt)return 0;if(ot===1&&Bt)return 4294967295;var Wt=Bt?1:0,sr=Math.floor(ot*127);return sr*De+Wt*Ie+sr*Ne+Wt*ht+sr*je+Wt*X+sr*D+Wt}},"88Gu":function(Le,E){var i=800,T=16,m=Date.now;function Z(z){var o=0,W=0;return function(){var D=m(),Y=T-(D-W);if(W=D,Y>0){if(++o>=i)return arguments[0]}else o=0;return z.apply(void 0,arguments)}}Le.exports=Z},"8ml+":function(Le,E,i){"use strict";var T=i("h1nZ");i.o(T,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return T.CityBuildingLayer}),i.o(T,"Control")&&i.d(E,"Control",function(){return T.Control}),i.o(T,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return T.HeatmapLayer}),i.o(T,"ImageLayer")&&i.d(E,"ImageLayer",function(){return T.ImageLayer}),i.o(T,"LineLayer")&&i.d(E,"LineLayer",function(){return T.LineLayer}),i.o(T,"Logo")&&i.d(E,"Logo",function(){return T.Logo}),i.o(T,"Marker")&&i.d(E,"Marker",function(){return T.Marker}),i.o(T,"PointLayer")&&i.d(E,"PointLayer",function(){return T.PointLayer}),i.o(T,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return T.PolygonLayer}),i.o(T,"Popup")&&i.d(E,"Popup",function(){return T.Popup}),i.o(T,"RasterLayer")&&i.d(E,"RasterLayer",function(){return T.RasterLayer}),i.o(T,"Scale")&&i.d(E,"Scale",function(){return T.Scale}),i.o(T,"Scene")&&i.d(E,"Scene",function(){return T.Scene}),i.o(T,"Zoom")&&i.d(E,"Zoom",function(){return T.Zoom});var m=i("kQ+U");i.d(E,"Scene",function(){return m.a});var Z=i("sxDa");i.d(E,"CityBuildingLayer",function(){return Z.a}),i.d(E,"HeatmapLayer",function(){return Z.b}),i.d(E,"ImageLayer",function(){return Z.c}),i.d(E,"LineLayer",function(){return Z.d}),i.d(E,"PointLayer",function(){return Z.e}),i.d(E,"PolygonLayer",function(){return Z.f}),i.d(E,"RasterLayer",function(){return Z.g});var z=i("k5/I");i.d(E,"Control",function(){return z.a}),i.d(E,"Logo",function(){return z.b}),i.d(E,"Marker",function(){return z.c}),i.d(E,"Popup",function(){return z.d}),i.d(E,"Scale",function(){return z.e}),i.d(E,"Zoom",function(){return z.f});var o=i("Hel2"),W=i("RL2/")},"8uyu":function(Le,E){},"9Fde":function(Le,E,i){"use strict";var T=this&&this.__awaiter||function(ht,Ne,Et,He){return new(Et||(Et=Promise))(function(mt,Ye){function xt(De){try{Ie(He.next(De))}catch(ze){Ye(ze)}}function _t(De){try{Ie(He.throw(De))}catch(ze){Ye(ze)}}function Ie(De){De.done?mt(De.value):new Et(function(ze){ze(De.value)}).then(xt,_t)}Ie((He=He.apply(ht,Ne||[])).next())})},m=this&&this.__generator||function(ht,Ne){var Et={label:0,sent:function(){if(Ye[0]&1)throw Ye[1];return Ye[1]},trys:[],ops:[]},He,mt,Ye,xt;return xt={next:_t(0),throw:_t(1),return:_t(2)},typeof Symbol=="function"&&(xt[Symbol.iterator]=function(){return this}),xt;function _t(De){return function(ze){return Ie([De,ze])}}function Ie(De){if(He)throw new TypeError("Generator is already executing.");for(;Et;)try{if(He=1,mt&&(Ye=mt[De[0]&2?"return":De[0]?"throw":"next"])&&!(Ye=Ye.call(mt,De[1])).done)return Ye;(mt=0,Ye)&&(De=[0,Ye.value]);switch(De[0]){case 0:case 1:Ye=De;break;case 4:return Et.label++,{value:De[1],done:!1};case 5:Et.label++,mt=De[1],De=[0];continue;case 7:De=Et.ops.pop(),Et.trys.pop();continue;default:if(!(Ye=Et.trys,Ye=Ye.length>0&&Ye[Ye.length-1])&&(De[0]===6||De[0]===2)){Et=0;continue}if(De[0]===3&&(!Ye||De[1]>Ye[0]&&De[1]<Ye[3])){Et.label=De[1];break}if(De[0]===6&&Et.label<Ye[1]){Et.label=Ye[1],Ye=De;break}if(Ye&&Et.label<Ye[2]){Et.label=Ye[2],Et.ops.push(De);break}Ye[2]&&Et.ops.pop(),Et.trys.pop();continue}De=Ne.call(ht,Et)}catch(ze){De=[6,ze],mt=0}finally{He=Ye=0}if(De[0]&5)throw De[1];return{value:De[0]?De[1]:void 0,done:!0}}};Object.defineProperty(E,"__esModule",{value:!0});var Z=i("LgvC"),z=i("MON2"),o=i("FV85"),W=i("xfSm"),D=i("wnjb"),Y=i("h7MG"),q=i("aPG5"),he=i("gzZq"),X=i("d9O0"),je=i("ujMp"),Ge=i("HpQ9"),ge=i("AwBQ"),Ce=function(){function ht(Ne){var Et=Ne||{};if(typeof Et!="object")throw new Error(""+z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Et.defaultScope===void 0)Et.defaultScope=o.BindingScopeEnum.Transient;else if(Et.defaultScope!==o.BindingScopeEnum.Singleton&&Et.defaultScope!==o.BindingScopeEnum.Transient&&Et.defaultScope!==o.BindingScopeEnum.Request)throw new Error(""+z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Et.autoBindInjectable===void 0)Et.autoBindInjectable=!1;else if(typeof Et.autoBindInjectable!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Et.skipBaseClassChecks===void 0)Et.skipBaseClassChecks=!1;else if(typeof Et.skipBaseClassChecks!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Et.autoBindInjectable,defaultScope:Et.defaultScope,skipBaseClassChecks:Et.skipBaseClassChecks},this.id=X.id(),this._bindingDictionary=new ge.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return ht.merge=function(Ne,Et){var He=new ht,mt=Y.getBindingDictionary(He),Ye=Y.getBindingDictionary(Ne),xt=Y.getBindingDictionary(Et);function _t(Ie,De){Ie.traverse(function(ze,at){at.forEach(function(Pe){De.add(Pe.serviceIdentifier,Pe.clone())})})}return _t(Ye,mt),_t(xt,mt),He},ht.prototype.load=function(){for(var Ne=[],Et=0;Et<arguments.length;Et++)Ne[Et]=arguments[Et];for(var He=this._getContainerModuleHelpersFactory(),mt=0,Ye=Ne;mt<Ye.length;mt++){var xt=Ye[mt],_t=He(xt.id);xt.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)}},ht.prototype.loadAsync=function(){for(var Ne=[],Et=0;Et<arguments.length;Et++)Ne[Et]=arguments[Et];return T(this,void 0,void 0,function(){var He,mt,Ye,xt,_t;return m(this,function(Ie){switch(Ie.label){case 0:He=this._getContainerModuleHelpersFactory(),mt=0,Ye=Ne,Ie.label=1;case 1:return mt<Ye.length?(xt=Ye[mt],_t=He(xt.id),[4,xt.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)]):[3,4];case 2:Ie.sent(),Ie.label=3;case 3:return mt++,[3,1];case 4:return[2]}})})},ht.prototype.unload=function(){for(var Ne=this,Et=[],He=0;He<arguments.length;He++)Et[He]=arguments[He];var mt=function(xt){return function(_t){return _t.moduleId===xt}};Et.forEach(function(Ye){var xt=mt(Ye.id);Ne._bindingDictionary.removeByCondition(xt)})},ht.prototype.bind=function(Ne){var Et=this.options.defaultScope||o.BindingScopeEnum.Transient,He=new Z.Binding(Ne,Et);return this._bindingDictionary.add(Ne,He),new he.BindingToSyntax(He)},ht.prototype.rebind=function(Ne){return this.unbind(Ne),this.bind(Ne)},ht.prototype.unbind=function(Ne){try{this._bindingDictionary.remove(Ne)}catch(Et){throw new Error(z.CANNOT_UNBIND+" "+je.getServiceIdentifierAsString(Ne))}},ht.prototype.unbindAll=function(){this._bindingDictionary=new ge.Lookup},ht.prototype.isBound=function(Ne){var Et=this._bindingDictionary.hasKey(Ne);return!Et&&this.parent&&(Et=this.parent.isBound(Ne)),Et},ht.prototype.isBoundNamed=function(Ne,Et){return this.isBoundTagged(Ne,W.NAMED_TAG,Et)},ht.prototype.isBoundTagged=function(Ne,Et,He){var mt=!1;if(this._bindingDictionary.hasKey(Ne)){var Ye=this._bindingDictionary.get(Ne),xt=Y.createMockRequest(this,Ne,Et,He);mt=Ye.some(function(_t){return _t.constraint(xt)})}return!mt&&this.parent&&(mt=this.parent.isBoundTagged(Ne,Et,He)),mt},ht.prototype.snapshot=function(){this._snapshots.push(Ge.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ht.prototype.restore=function(){var Ne=this._snapshots.pop();if(Ne===void 0)throw new Error(z.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ne.bindings,this._middleware=Ne.middleware},ht.prototype.createChild=function(Ne){var Et=new ht(Ne||this.options);return Et.parent=this,Et},ht.prototype.applyMiddleware=function(){for(var Ne=[],Et=0;Et<arguments.length;Et++)Ne[Et]=arguments[Et];var He=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ne.reduce(function(mt,Ye){return Ye(mt)},He)},ht.prototype.applyCustomMetadataReader=function(Ne){this._metadataReader=Ne},ht.prototype.get=function(Ne){return this._get(!1,!1,o.TargetTypeEnum.Variable,Ne)},ht.prototype.getTagged=function(Ne,Et,He){return this._get(!1,!1,o.TargetTypeEnum.Variable,Ne,Et,He)},ht.prototype.getNamed=function(Ne,Et){return this.getTagged(Ne,W.NAMED_TAG,Et)},ht.prototype.getAll=function(Ne){return this._get(!0,!0,o.TargetTypeEnum.Variable,Ne)},ht.prototype.getAllTagged=function(Ne,Et,He){return this._get(!1,!0,o.TargetTypeEnum.Variable,Ne,Et,He)},ht.prototype.getAllNamed=function(Ne,Et){return this.getAllTagged(Ne,W.NAMED_TAG,Et)},ht.prototype.resolve=function(Ne){var Et=this.createChild();return Et.bind(Ne).toSelf(),Et.get(Ne)},ht.prototype._getContainerModuleHelpersFactory=function(){var Ne=this,Et=function(Ie,De){Ie._binding.moduleId=De},He=function(Ie){return function(De){var ze=Ne.bind.bind(Ne),at=ze(De);return Et(at,Ie),at}},mt=function(Ie){return function(De){var ze=Ne.unbind.bind(Ne);ze(De)}},Ye=function(Ie){return function(De){var ze=Ne.isBound.bind(Ne);return ze(De)}},xt=function(Ie){return function(De){var ze=Ne.rebind.bind(Ne),at=ze(De);return Et(at,Ie),at}};return function(_t){return{bindFunction:He(_t),isboundFunction:Ye(_t),rebindFunction:xt(_t),unbindFunction:mt(_t)}}},ht.prototype._get=function(Ne,Et,He,mt,Ye,xt){var _t=null,Ie={avoidConstraints:Ne,contextInterceptor:function(ze){return ze},isMultiInject:Et,key:Ye,serviceIdentifier:mt,targetType:He,value:xt};if(this._middleware){if(_t=this._middleware(Ie),_t==null)throw new Error(z.INVALID_MIDDLEWARE_RETURN)}else _t=this._planAndResolve()(Ie);return _t},ht.prototype._planAndResolve=function(){var Ne=this;return function(Et){var He=Y.plan(Ne._metadataReader,Ne,Et.isMultiInject,Et.targetType,Et.serviceIdentifier,Et.key,Et.value,Et.avoidConstraints);He=Et.contextInterceptor(He);var mt=q.resolve(He);return mt}},ht}();E.Container=Ce},"9NmV":function(Le,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",z=T+m+Z,o="\\u2700-\\u27bf",W="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",Y="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",q="\\u2000-\\u206f",he=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",X="A-Z\\xc0-\\xd6\\xd8-\\xde",je="\\ufe0e\\ufe0f",Ge=D+Y+q+he,ge="['\u2019]",Ce="["+Ge+"]",ht="["+z+"]",Ne="\\d+",Et="["+o+"]",He="["+W+"]",mt="[^"+i+Ge+Ne+o+W+X+"]",Ye="\\ud83c[\\udffb-\\udfff]",xt="(?:"+ht+"|"+Ye+")",_t="[^"+i+"]",Ie="(?:\\ud83c[\\udde6-\\uddff]){2}",De="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+X+"]",at="\\u200d",Pe="(?:"+He+"|"+mt+")",ot="(?:"+ze+"|"+mt+")",Bt="(?:"+ge+"(?:d|ll|m|re|s|t|ve))?",Wt="(?:"+ge+"(?:D|LL|M|RE|S|T|VE))?",sr=xt+"?",ne="["+je+"]?",$="(?:"+at+"(?:"+[_t,Ie,De].join("|")+")"+ne+sr+")*",G="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ae="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xe=ne+sr+$,Se="(?:"+[Et,Ie,De].join("|")+")"+xe,ve=RegExp([ze+"?"+He+"+"+Bt+"(?="+[Ce,ze,"$"].join("|")+")",ot+"+"+Wt+"(?="+[Ce,ze+Pe,"$"].join("|")+")",ze+"?"+Pe+"+"+Bt,ze+"+"+Wt,Ae,G,Ne,Se].join("|"),"g");function et(Yt){return Yt.match(ve)||[]}Le.exports=et},"9lTW":function(Le,E,i){"use strict";(function(T){var m=i("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Z(Pe,ot){if(Pe===ot)return 0;for(var Bt=Pe.length,Wt=ot.length,sr=0,ne=Math.min(Bt,Wt);sr<ne;++sr)if(Pe[sr]!==ot[sr]){Bt=Pe[sr],Wt=ot[sr];break}return Bt<Wt?-1:Wt<Bt?1:0}function z(Pe){return T.Buffer&&typeof T.Buffer.isBuffer=="function"?T.Buffer.isBuffer(Pe):!!(Pe!=null&&Pe._isBuffer)}var o=i("MCLT"),W=Object.prototype.hasOwnProperty,D=Array.prototype.slice,Y=function(){return function(){}.name==="foo"}();function q(Pe){return Object.prototype.toString.call(Pe)}function he(Pe){return z(Pe)||typeof T.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Pe):Pe?Pe instanceof DataView?!0:!!(Pe.buffer&&Pe.buffer instanceof ArrayBuffer):!1}var X=Le.exports=Et,je=/\s*function\s+([^\(\s]*)\s*/;function Ge(Pe){if(!o.isFunction(Pe))return;if(Y)return Pe.name;var ot=Pe.toString(),Bt=ot.match(je);return Bt&&Bt[1]}X.AssertionError=function(ot){this.name="AssertionError",this.actual=ot.actual,this.expected=ot.expected,this.operator=ot.operator,ot.message?(this.message=ot.message,this.generatedMessage=!1):(this.message=ht(this),this.generatedMessage=!0);var Bt=ot.stackStartFunction||Ne;if(Error.captureStackTrace)Error.captureStackTrace(this,Bt);else{var Wt=new Error;if(Wt.stack){var sr=Wt.stack,ne=Ge(Bt),$=sr.indexOf(`
`+ne);if($>=0){var G=sr.indexOf(`
`,$+1);sr=sr.substring(G+1)}this.stack=sr}}},o.inherits(X.AssertionError,Error);function ge(Pe,ot){return typeof Pe=="string"?Pe.length<ot?Pe:Pe.slice(0,ot):Pe}function Ce(Pe){if(Y||!o.isFunction(Pe))return o.inspect(Pe);var ot=Ge(Pe),Bt=ot?": "+ot:"";return"[Function"+Bt+"]"}function ht(Pe){return ge(Ce(Pe.actual),128)+" "+Pe.operator+" "+ge(Ce(Pe.expected),128)}function Ne(Pe,ot,Bt,Wt,sr){throw new X.AssertionError({message:Bt,actual:Pe,expected:ot,operator:Wt,stackStartFunction:sr})}X.fail=Ne;function Et(Pe,ot){Pe||Ne(Pe,!0,ot,"==",X.ok)}X.ok=Et,X.equal=function(ot,Bt,Wt){ot!=Bt&&Ne(ot,Bt,Wt,"==",X.equal)},X.notEqual=function(ot,Bt,Wt){ot==Bt&&Ne(ot,Bt,Wt,"!=",X.notEqual)},X.deepEqual=function(ot,Bt,Wt){He(ot,Bt,!1)||Ne(ot,Bt,Wt,"deepEqual",X.deepEqual)},X.deepStrictEqual=function(ot,Bt,Wt){He(ot,Bt,!0)||Ne(ot,Bt,Wt,"deepStrictEqual",X.deepStrictEqual)};function He(Pe,ot,Bt,Wt){if(Pe===ot)return!0;if(z(Pe)&&z(ot))return Z(Pe,ot)===0;if(o.isDate(Pe)&&o.isDate(ot))return Pe.getTime()===ot.getTime();if(o.isRegExp(Pe)&&o.isRegExp(ot))return Pe.source===ot.source&&Pe.global===ot.global&&Pe.multiline===ot.multiline&&Pe.lastIndex===ot.lastIndex&&Pe.ignoreCase===ot.ignoreCase;if((Pe===null||typeof Pe!="object")&&(ot===null||typeof ot!="object"))return Bt?Pe===ot:Pe==ot;if(he(Pe)&&he(ot)&&q(Pe)===q(ot)&&!(Pe instanceof Float32Array||Pe instanceof Float64Array))return Z(new Uint8Array(Pe.buffer),new Uint8Array(ot.buffer))===0;if(z(Pe)!==z(ot))return!1;Wt=Wt||{actual:[],expected:[]};var sr=Wt.actual.indexOf(Pe);return sr!==-1&&sr===Wt.expected.indexOf(ot)?!0:(Wt.actual.push(Pe),Wt.expected.push(ot),Ye(Pe,ot,Bt,Wt))}function mt(Pe){return Object.prototype.toString.call(Pe)=="[object Arguments]"}function Ye(Pe,ot,Bt,Wt){if(Pe==null||ot===null||ot===void 0)return!1;if(o.isPrimitive(Pe)||o.isPrimitive(ot))return Pe===ot;if(Bt&&Object.getPrototypeOf(Pe)!==Object.getPrototypeOf(ot))return!1;var sr=mt(Pe),ne=mt(ot);if(sr&&!ne||!sr&&ne)return!1;if(sr)return Pe=D.call(Pe),ot=D.call(ot),He(Pe,ot,Bt);var $=at(Pe),G=at(ot),Ae,xe;if($.length!==G.length)return!1;for($.sort(),G.sort(),xe=$.length-1;xe>=0;xe--)if($[xe]!==G[xe])return!1;for(xe=$.length-1;xe>=0;xe--)if(Ae=$[xe],!He(Pe[Ae],ot[Ae],Bt,Wt))return!1;return!0}X.notDeepEqual=function(ot,Bt,Wt){He(ot,Bt,!1)&&Ne(ot,Bt,Wt,"notDeepEqual",X.notDeepEqual)},X.notDeepStrictEqual=xt;function xt(Pe,ot,Bt){He(Pe,ot,!0)&&Ne(Pe,ot,Bt,"notDeepStrictEqual",xt)}X.strictEqual=function(ot,Bt,Wt){ot!==Bt&&Ne(ot,Bt,Wt,"===",X.strictEqual)},X.notStrictEqual=function(ot,Bt,Wt){ot===Bt&&Ne(ot,Bt,Wt,"!==",X.notStrictEqual)};function _t(Pe,ot){if(!Pe||!ot)return!1;if(Object.prototype.toString.call(ot)=="[object RegExp]")return ot.test(Pe);try{if(Pe instanceof ot)return!0}catch(Bt){}return Error.isPrototypeOf(ot)?!1:ot.call({},Pe)===!0}function Ie(Pe){var ot;try{Pe()}catch(Bt){ot=Bt}return ot}function De(Pe,ot,Bt,Wt){var sr;if(typeof ot!="function")throw new TypeError('"block" argument must be a function');typeof Bt=="string"&&(Wt=Bt,Bt=null),sr=Ie(ot),Wt=(Bt&&Bt.name?" ("+Bt.name+").":".")+(Wt?" "+Wt:"."),Pe&&!sr&&Ne(sr,Bt,"Missing expected exception"+Wt);var ne=typeof Wt=="string",$=!Pe&&o.isError(sr),G=!Pe&&sr&&!Bt;if(($&&ne&&_t(sr,Bt)||G)&&Ne(sr,Bt,"Got unwanted exception"+Wt),Pe&&sr&&Bt&&!_t(sr,Bt)||!Pe&&sr)throw sr}X.throws=function(Pe,ot,Bt){De(!0,Pe,ot,Bt)},X.doesNotThrow=function(Pe,ot,Bt){De(!1,Pe,ot,Bt)},X.ifError=function(Pe){if(Pe)throw Pe};function ze(Pe,ot){Pe||Ne(Pe,!0,ot,"==",ze)}X.strict=m(ze,X,{equal:X.strictEqual,deepEqual:X.deepStrictEqual,notEqual:X.notStrictEqual,notDeepEqual:X.notDeepStrictEqual}),X.strict.strict=X.strict;var at=Object.keys||function(Pe){var ot=[];for(var Bt in Pe)W.call(Pe,Bt)&&ot.push(Bt);return ot}}).call(this,i("yLpj"))},"9nhX":function(Le,E,i){var T=i("g4R6"),m=i("tLB3");function Z(z,o,W){return W===void 0&&(W=o,o=void 0),W!==void 0&&(W=m(W),W=W===W?W:0),o!==void 0&&(o=m(o),o=o===o?o:0),T(m(z),o,W)}Le.exports=Z},AFH1:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.TOPRIGHT="topright",m.TOPLEFT="topleft",m.BOTTOMRIGHT="bottomright",m.BOTTOMLEFT="bottomleft"})(T||(T={}))},AKIq:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(he){if(!he)throw new Error("coord is required");if(!Array.isArray(he)){if(he.type==="Feature"&&he.geometry!==null&&he.geometry.type==="Point")return he.geometry.coordinates;if(he.type==="Point")return he.coordinates}if(Array.isArray(he)&&he.length>=2&&!Array.isArray(he[0])&&!Array.isArray(he[1]))return he;throw new Error("coord must be GeoJSON Point or an Array of numbers")}E.getCoord=m;function Z(he){if(Array.isArray(he))return he;if(he.type==="Feature"){if(he.geometry!==null)return he.geometry.coordinates}else if(he.coordinates)return he.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}E.getCoords=Z;function z(he){if(he.length>1&&T.isNumber(he[0])&&T.isNumber(he[1]))return!0;if(Array.isArray(he[0])&&he[0].length)return z(he[0]);throw new Error("coordinates must only contain numbers")}E.containsNumber=z;function o(he,X,je){if(!X||!je)throw new Error("type and name required");if(!he||he.type!==X)throw new Error("Invalid input to "+je+": must be a "+X+", given "+he.type)}E.geojsonType=o;function W(he,X,je){if(!he)throw new Error("No feature passed");if(!je)throw new Error(".featureOf() requires a name");if(!he||he.type!=="Feature"||!he.geometry)throw new Error("Invalid input to "+je+", Feature with geometry required");if(!he.geometry||he.geometry.type!==X)throw new Error("Invalid input to "+je+": must be a "+X+", given "+he.geometry.type)}E.featureOf=W;function D(he,X,je){if(!he)throw new Error("No featureCollection passed");if(!je)throw new Error(".collectionOf() requires a name");if(!he||he.type!=="FeatureCollection")throw new Error("Invalid input to "+je+", FeatureCollection required");for(var Ge=0,ge=he.features;Ge<ge.length;Ge++){var Ce=ge[Ge];if(!Ce||Ce.type!=="Feature"||!Ce.geometry)throw new Error("Invalid input to "+je+", Feature with geometry required");if(!Ce.geometry||Ce.geometry.type!==X)throw new Error("Invalid input to "+je+": must be a "+X+", given "+Ce.geometry.type)}}E.collectionOf=D;function Y(he){return he.type==="Feature"?he.geometry:he}E.getGeom=Y;function q(he,X){return he.type==="FeatureCollection"?"FeatureCollection":he.type==="GeometryCollection"?"GeometryCollection":he.type==="Feature"&&he.geometry!==null?he.geometry.type:he.type}E.getType=q},APxj:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Ucsi");function m(Z,z){z===void 0&&(z=!0);var o=T.makePropertyInjectDecorator(Z,z),W=T.makePropertyInjectNamedDecorator(Z,z),D=T.makePropertyInjectTaggedDecorator(Z,z),Y=T.makePropertyMultiInjectDecorator(Z,z);return{lazyInject:o,lazyInjectNamed:W,lazyInjectTagged:D,lazyMultiInject:Y}}E.default=m},AwBQ:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=function(){function Z(){this._map=new Map}return Z.prototype.getMap=function(){return this._map},Z.prototype.add=function(z,o){if(z==null)throw new Error(T.NULL_ARGUMENT);if(o==null)throw new Error(T.NULL_ARGUMENT);var W=this._map.get(z);W!==void 0?(W.push(o),this._map.set(z,W)):this._map.set(z,[o])},Z.prototype.get=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);var o=this._map.get(z);if(o!==void 0)return o;throw new Error(T.KEY_NOT_FOUND)},Z.prototype.remove=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);if(!this._map.delete(z))throw new Error(T.KEY_NOT_FOUND)},Z.prototype.removeByCondition=function(z){var o=this;this._map.forEach(function(W,D){var Y=W.filter(function(q){return!z(q)});Y.length>0?o._map.set(D,Y):o._map.delete(D)})},Z.prototype.hasKey=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);return this._map.has(z)},Z.prototype.clone=function(){var z=new Z;return this._map.forEach(function(o,W){o.forEach(function(D){return z.add(W,D.clone())})}),z},Z.prototype.traverse=function(z){this._map.forEach(function(o,W){z(W,o)})},Z}();E.Lookup=m},"B6l+":function(Le,E,i){var T=i("Sq3C"),m=i("Z1HP"),Z=i("Sxd8"),z=i("dt0z");function o(W,D,Y){W=z(W),D=Z(D);var q=D?m(W):0;return D&&q<D?W+T(D-q,Y):W}Le.exports=o},BGjm:function(Le,E){Le.exports=i;function i(T,m){m||(m=document);var Z=m.head||m.getElementsByTagName("head")[0];if(!Z){Z=m.createElement("head");var z=m.body||m.getElementsByTagName("body")[0];z?z.parentNode.insertBefore(Z,z):m.documentElement.appendChild(Z)}var o=m.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=T:o.appendChild(m.createTextNode(T)),Z.appendChild(o),o}},BMrR:function(Le,E,i){"use strict";var T=i("qrJ5");E.a=T.a},BkRI:function(Le,E,i){var T=i("OBhP"),m=1,Z=4;function z(o){return T(o,m|Z)}Le.exports=z},BpBL:function(Le,E,i){"use strict";i.d(E,"a",function(){return m});var T=i("Hel2");function m(z,o){var W=o.extent,D=new Promise(function(q){Z(z,function(he){q(he)})}),Y={images:D,_id:1,dataArray:[{_id:0,coordinates:[[W[0],W[1]],[W[2],W[3]]]}]};return Y}function Z(z,o){var W=z,D=[];if(typeof W=="string")Object(T.o)({url:W},function(he,X){D.push(X),o(D)});else{var Y=W.length,q=0;W.forEach(function(he){Object(T.o)({url:he},function(X,je){q++,D.push(je),q===Y&&o(D)})})}return m}},CIdX:function(Le,E,i){Le.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(Le,E){function i(T,m,Z){for(var z=Z-1,o=T.length;++z<o;)if(T[z]===m)return z;return-1}Le.exports=i},"D+ow":function(Le,E){},D9lx:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("6AGu"),m=i("406g"),Z=i("z4Hk"),z=function(){function o(W){this._binding=W,this._bindingWhenSyntax=new Z.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new m.BindingOnSyntax(this._binding),this._bindingInSyntax=new T.BindingInSyntax(W)}return o.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},o.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},o.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},o.prototype.when=function(W){return this._bindingWhenSyntax.when(W)},o.prototype.whenTargetNamed=function(W){return this._bindingWhenSyntax.whenTargetNamed(W)},o.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},o.prototype.whenTargetTagged=function(W,D){return this._bindingWhenSyntax.whenTargetTagged(W,D)},o.prototype.whenInjectedInto=function(W){return this._bindingWhenSyntax.whenInjectedInto(W)},o.prototype.whenParentNamed=function(W){return this._bindingWhenSyntax.whenParentNamed(W)},o.prototype.whenParentTagged=function(W,D){return this._bindingWhenSyntax.whenParentTagged(W,D)},o.prototype.whenAnyAncestorIs=function(W){return this._bindingWhenSyntax.whenAnyAncestorIs(W)},o.prototype.whenNoAncestorIs=function(W){return this._bindingWhenSyntax.whenNoAncestorIs(W)},o.prototype.whenAnyAncestorNamed=function(W){return this._bindingWhenSyntax.whenAnyAncestorNamed(W)},o.prototype.whenAnyAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(W,D)},o.prototype.whenNoAncestorNamed=function(W){return this._bindingWhenSyntax.whenNoAncestorNamed(W)},o.prototype.whenNoAncestorTagged=function(W,D){return this._bindingWhenSyntax.whenNoAncestorTagged(W,D)},o.prototype.whenAnyAncestorMatches=function(W){return this._bindingWhenSyntax.whenAnyAncestorMatches(W)},o.prototype.whenNoAncestorMatches=function(W){return this._bindingWhenSyntax.whenNoAncestorMatches(W)},o.prototype.onActivation=function(W){return this._bindingOnSyntax.onActivation(W)},o}();E.BindingInWhenOnSyntax=z},"Dw+G":function(Le,E,i){var T=i("juv8"),m=i("mTTR");function Z(z,o){return z&&T(o,m(o),z)}Le.exports=Z},DzJC:function(Le,E,i){var T=i("sEfC"),m=i("GoyQ"),Z="Expected a function";function z(o,W,D){var Y=!0,q=!0;if(typeof o!="function")throw new TypeError(Z);return m(D)&&(Y="leading"in D?!!D.leading:Y,q="trailing"in D?!!D.trailing:q),T(o,W,{leading:Y,maxWait:W,trailing:q})}Le.exports=z},EA7m:function(Le,E,i){var T=i("zZ0H"),m=i("Ioao"),Z=i("wclG");function z(o,W){return Z(m(o,W,T),o+"")}Le.exports=z},EEGq:function(Le,E,i){var T=i("juv8"),m=i("oCl/");function Z(z,o){return T(z,m(z),o)}Le.exports=Z},EfZ0:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Le,E,i){var T=i("bahg"),m=i("quyA"),Z=i("0JQy");function z(o){return m(o)?Z(o):T(o)}Le.exports=z},FI6e:function(Le,E){},FV85:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={Request:"Request",Singleton:"Singleton",Transient:"Transient"};E.BindingScopeEnum=T;var m={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};E.BindingTypeEnum=m;var Z={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};E.TargetTypeEnum=Z},FmoU:function(Le,E,i){"use strict";i.d(E,"a",function(){return mt}),i.d(E,"b",function(){return Ie});var T=function($,G,Ae){$.prototype=G.prototype=Ae,Ae.constructor=$};function m($,G){var Ae=Object.create($.prototype);for(var xe in G)Ae[xe]=G[xe];return Ae}function Z(){}var z=.7,o=1/z,W="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Y="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q=/^#([0-9a-f]{3,8})$/,he=new RegExp("^rgb\\("+[W,W,W]+"\\)$"),X=new RegExp("^rgb\\("+[Y,Y,Y]+"\\)$"),je=new RegExp("^rgba\\("+[W,W,W,D]+"\\)$"),Ge=new RegExp("^rgba\\("+[Y,Y,Y,D]+"\\)$"),ge=new RegExp("^hsl\\("+[D,Y,Y]+"\\)$"),Ce=new RegExp("^hsla\\("+[D,Y,Y,D]+"\\)$"),ht={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};T(Z,mt,{copy:function(G){return Object.assign(new this.constructor,this,G)},displayable:function(){return this.rgb().displayable()},hex:Ne,formatHex:Ne,formatHsl:Et,formatRgb:He,toString:He});function Ne(){return this.rgb().formatHex()}function Et(){return Bt(this).formatHsl()}function He(){return this.rgb().formatRgb()}function mt($){var G,Ae;return $=($+"").trim().toLowerCase(),(G=q.exec($))?(Ae=G[1].length,G=parseInt(G[1],16),Ae===6?Ye(G):Ae===3?new De(G>>8&15|G>>4&240,G>>4&15|G&240,(G&15)<<4|G&15,1):Ae===8?xt(G>>24&255,G>>16&255,G>>8&255,(G&255)/255):Ae===4?xt(G>>12&15|G>>8&240,G>>8&15|G>>4&240,G>>4&15|G&240,((G&15)<<4|G&15)/255):null):(G=he.exec($))?new De(G[1],G[2],G[3],1):(G=X.exec($))?new De(G[1]*255/100,G[2]*255/100,G[3]*255/100,1):(G=je.exec($))?xt(G[1],G[2],G[3],G[4]):(G=Ge.exec($))?xt(G[1]*255/100,G[2]*255/100,G[3]*255/100,G[4]):(G=ge.exec($))?ot(G[1],G[2]/100,G[3]/100,1):(G=Ce.exec($))?ot(G[1],G[2]/100,G[3]/100,G[4]):ht.hasOwnProperty($)?Ye(ht[$]):$==="transparent"?new De(NaN,NaN,NaN,0):null}function Ye($){return new De($>>16&255,$>>8&255,$&255,1)}function xt($,G,Ae,xe){return xe<=0&&($=G=Ae=NaN),new De($,G,Ae,xe)}function _t($){return $ instanceof Z||($=mt($)),$?($=$.rgb(),new De($.r,$.g,$.b,$.opacity)):new De}function Ie($,G,Ae,xe){return arguments.length===1?_t($):new De($,G,Ae,xe==null?1:xe)}function De($,G,Ae,xe){this.r=+$,this.g=+G,this.b=+Ae,this.opacity=+xe}T(De,Ie,m(Z,{brighter:function(G){return G=G==null?o:Math.pow(o,G),new De(this.r*G,this.g*G,this.b*G,this.opacity)},darker:function(G){return G=G==null?z:Math.pow(z,G),new De(this.r*G,this.g*G,this.b*G,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ze,formatHex:ze,formatRgb:at,toString:at}));function ze(){return"#"+Pe(this.r)+Pe(this.g)+Pe(this.b)}function at(){var $=this.opacity;return $=isNaN($)?1:Math.max(0,Math.min(1,$)),($===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+($===1?")":", "+$+")")}function Pe($){return $=Math.max(0,Math.min(255,Math.round($)||0)),($<16?"0":"")+$.toString(16)}function ot($,G,Ae,xe){return xe<=0?$=G=Ae=NaN:Ae<=0||Ae>=1?$=G=NaN:G<=0&&($=NaN),new sr($,G,Ae,xe)}function Bt($){if($ instanceof sr)return new sr($.h,$.s,$.l,$.opacity);if($ instanceof Z||($=mt($)),!$)return new sr;if($ instanceof sr)return $;$=$.rgb();var G=$.r/255,Ae=$.g/255,xe=$.b/255,Se=Math.min(G,Ae,xe),ve=Math.max(G,Ae,xe),et=NaN,Yt=ve-Se,At=(ve+Se)/2;return Yt?(G===ve?et=(Ae-xe)/Yt+(Ae<xe)*6:Ae===ve?et=(xe-G)/Yt+2:et=(G-Ae)/Yt+4,Yt/=At<.5?ve+Se:2-ve-Se,et*=60):Yt=At>0&&At<1?0:et,new sr(et,Yt,At,$.opacity)}function Wt($,G,Ae,xe){return arguments.length===1?Bt($):new sr($,G,Ae,xe==null?1:xe)}function sr($,G,Ae,xe){this.h=+$,this.s=+G,this.l=+Ae,this.opacity=+xe}T(sr,Wt,m(Z,{brighter:function(G){return G=G==null?o:Math.pow(o,G),new sr(this.h,this.s,this.l*G,this.opacity)},darker:function(G){return G=G==null?z:Math.pow(z,G),new sr(this.h,this.s,this.l*G,this.opacity)},rgb:function(){var G=this.h%360+(this.h<0)*360,Ae=isNaN(G)||isNaN(this.s)?0:this.s,xe=this.l,Se=xe+(xe<.5?xe:1-xe)*Ae,ve=2*xe-Se;return new De(ne(G>=240?G-240:G+120,ve,Se),ne(G,ve,Se),ne(G<120?G+240:G-120,ve,Se),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var G=this.opacity;return G=isNaN(G)?1:Math.max(0,Math.min(1,G)),(G===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(G===1?")":", "+G+")")}}));function ne($,G,Ae){return($<60?G+(Ae-G)*$/60:$<180?Ae:$<240?G+(Ae-G)*(240-$)/60:G)*255}},G6z8:function(Le,E,i){var T=i("fR/l"),m=i("oCl/"),Z=i("mTTR");function z(o){return T(o,Z,m)}Le.exports=z},GXnB:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function Z(z,o){this.key=z,this.value=o}return Z.prototype.toString=function(){return this.key===T.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Z}();E.Metadata=m},Gi0A:function(Le,E,i){var T=i("QqLw"),m=i("ExA7"),Z="[object Map]";function z(o){return m(o)&&T(o)==Z}Le.exports=z},"H+7v":function(Le,E,i){Le.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},HTcj:function(Le,E,i){"use strict";var T=i("GNNt"),m=i("wEI+"),Z=i("kZZr"),z=i.n(Z),o=i("q1tI"),W=i.n(o),D=i("TSYQ"),Y=i.n(D),q=i("jYQm"),he=function(je){var Ge=Object(o.useContext)(q.a),ge=je.children,Ce=je.contentWidth,ht=je.className,Ne=je.style,Et=Object(o.useContext)(m.b.ConfigContext),He=Et.getPrefixCls,mt=je.prefixCls||He("pro"),Ye=Ce||Ge.contentWidth,xt="".concat(mt,"-grid-content");return W.a.createElement("div",{className:Y()(xt,ht,{wide:Ye==="Fixed"}),style:Ne},W.a.createElement("div",{className:"".concat(mt,"-grid-content-children")},ge))};E.a=he},Hel2:function(Le,E,i){"use strict";i.d(E,"o",function(){return At}),i.d(E,"m",function(){return Me}),i.d(E,"p",function(){return J}),i.d(E,"d",function(){return tt}),i.d(E,"q",function(){return K}),i.d(E,"r",function(){return te}),i.d(E,"j",function(){return Je}),i.d(E,"h",function(){return zt}),i.d(E,"b",function(){return cr}),i.d(E,"i",function(){return lt}),i.d(E,"s",function(){return Ct}),i.d(E,"k",function(){return pt}),i.d(E,"l",function(){return we}),i.d(E,"n",function(){return ut}),i.d(E,"f",function(){return Ke}),i.d(E,"e",function(){return kt}),i.d(E,"g",function(){return yr}),i.d(E,"a",function(){return T}),i.d(E,"c",function(){return m});var T={};i.r(T),i.d(T,"getContainer",function(){return W}),i.d(T,"trim",function(){return D}),i.d(T,"splitWords",function(){return Y}),i.d(T,"create",function(){return he}),i.d(T,"remove",function(){return X}),i.d(T,"addClass",function(){return je}),i.d(T,"removeClass",function(){return Ge}),i.d(T,"hasClass",function(){return ge}),i.d(T,"setClass",function(){return Ce}),i.d(T,"getClass",function(){return ht}),i.d(T,"empty",function(){return Ne}),i.d(T,"setTransform",function(){return He}),i.d(T,"triggerResize",function(){return mt}),i.d(T,"printCanvas",function(){return Ye});var m={};i.r(m),i.d(m,"sum",function(){return jn}),i.d(m,"max",function(){return Zr}),i.d(m,"min",function(){return hr}),i.d(m,"mean",function(){return yn}),i.d(m,"mode",function(){return ta}),i.d(m,"statMap",function(){return ma}),i.d(m,"getColumn",function(){return Zn}),i.d(m,"getSatByColumn",function(){return Wn});function Z(F){var H=131,ue=137,pe=0;F+="x";for(var rt=Math.floor(9007199254740991/ue),yt=0;yt<F.length;yt++)pe>rt&&(pe=Math.floor(pe/ue)),pe=pe*H+F.charCodeAt(yt);return pe}function z(F){F=F.toString();for(var H=5381,ue=F.length;ue;)H=H*33^F.charCodeAt(--ue);return H>>>0}var o=window.document.documentElement.style;function W(F){var H=F;return typeof F=="string"&&(H=document.getElementById(F)),H}function D(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function Y(F){return D(F).split(/\s+/)}function q(F){if(!o)return F[0];for(var H in F)if(F[H]&&F[H]in o)return F[H];return F[0]}function he(F,H,ue){var pe=document.createElement(F);return pe.className=H||"",ue&&ue.appendChild(pe),pe}function X(F){var H=F.parentNode;H&&H.removeChild(F)}function je(F,H){if(F.classList!==void 0)for(var ue=Y(H),pe=0,rt=ue.length;pe<rt;pe++)F.classList.add(ue[pe]);else if(!ge(F,H)){var yt=ht(F);Ce(F,(yt?yt+" ":"")+H)}}function Ge(F,H){F.classList!==void 0?F.classList.remove(H):Ce(F,D((" "+ht(F)+" ").replace(" "+H+" "," ")))}function ge(F,H){if(F.classList!==void 0)return F.classList.contains(H);var ue=ht(F);return ue.length>0&&new RegExp("(^|\\s)"+H+"(\\s|$)").test(ue)}function Ce(F,H){F instanceof HTMLElement?F.className=H:F.className.baseVal=H}function ht(F){return F instanceof SVGElement&&(F=F.correspondingElement),F.className.baseVal===void 0?F.className:F.className.baseVal}function Ne(F){for(;F&&F.firstChild;)F.removeChild(F.firstChild)}var Et=q(["transform","WebkitTransform"]);function He(F,H){F.style[Et]=H}function mt(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var F=window.document.createEvent("UIEvents");F.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(F)}}function Ye(F){var H=["padding: "+(F.height/2-8)+"px "+F.width/2+"px;","line-height: "+F.height+"px;","background-image: url("+F.toDataURL()+");"];console.log(`%c
`,H.join(""))}var xt=i("lwsE"),_t=i.n(xt),Ie=i("W8MJ"),De=i.n(Ie),ze=i("7W2i"),at=i.n(ze),Pe=i("a1gu"),ot=i.n(Pe),Bt=i("Nsbk"),Wt=i.n(Bt),sr=i("oShl"),ne=i.n(sr);function $(F){var H=G();return function(){var pe=Wt()(F),rt;if(H){var yt=Wt()(this).constructor;rt=Reflect.construct(pe,arguments,yt)}else rt=pe.apply(this,arguments);return ot()(this,rt)}}function G(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(F){return!1}}var Ae=function(F){at()(ue,F);var H=$(ue);function ue(pe,rt,yt){var Ve;return _t()(this,ue),Ve=H.call(this,pe),Ve.status=void 0,Ve.url=void 0,Ve.status=rt,Ve.url=yt,Ve.name=Ve.constructor.name,Ve.message=pe,Ve}return De()(ue,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),ue}(ne()(Error));function xe(F){var H=new XMLHttpRequest;H.open("GET",F.url,!0);for(var ue in F.headers)F.headers.hasOwnProperty(ue)&&H.setRequestHeader(ue,F.headers[ue]);return H.withCredentials=F.credentials==="include",H}var Se=function(H,ue){var pe=xe(H);return pe.setRequestHeader("Accept","application/json"),pe.onerror=function(){ue(new Error(pe.statusText))},pe.onload=function(){if(pe.status>=200&&pe.status<300&&pe.response){var rt;try{rt=JSON.parse(pe.response)}catch(yt){return ue(yt)}ue(null,rt)}else pe.status===401?ue(new Ae("".concat(pe.statusText),pe.status,H.url)):ue(new Ae(pe.statusText,pe.status,H.url))},pe.send(),pe},ve=function(H,ue){var pe=xe(H);return pe.responseType="arraybuffer",pe.onerror=function(){ue(new Error(pe.statusText))},pe.onload=function(){var rt=pe.response;if(rt.byteLength===0&&pe.status===200)return ue(new Error("http status 200 returned without content."));pe.status>=200&&pe.status<300&&pe.response?ue(null,{data:rt,cacheControl:pe.getResponseHeader("Cache-Control"),expires:pe.getResponseHeader("Expires")}):ue(new Ae(pe.statusText,pe.status,H.url))},pe.send(),pe};function et(F){var H=window.document.createElement("a");return H.href=F,H.protocol===window.document.location.protocol&&H.host===window.document.location.host}var Yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",At=function(H,ue){return ve(H,function(pe,rt){if(pe)ue(pe);else if(rt){var yt=new window.Image;yt.crossOrigin="anonymous";var Ve=window.URL||window.webkitURL;yt.onload=function(){ue(null,yt),Ve.revokeObjectURL(yt.src)};var ct=new window.Blob([new Uint8Array(rt.data)],{type:"image/png"});yt.src=rt.data.byteLength?Ve.createObjectURL(ct):Yt}})},ye=i("J4zp"),be=i.n(ye),Ue=i("/rf6"),st=2*Math.PI*6378137/2;function Me(F){var H=[Infinity,Infinity,-Infinity,-Infinity];return F.forEach(function(ue){var pe=ue.coordinates;ft(H,pe)}),H}function ft(F,H){return Array.isArray(H[0])?H.forEach(function(ue){ft(F,ue)}):(F[0]>H[0]&&(F[0]=H[0]),F[1]>H[1]&&(F[1]=H[1]),F[2]<H[0]&&(F[2]=H[0]),F[3]<H[1]&&(F[3]=H[1])),F}function w(F,H){return I(F,H)}function I(F,H){return Array.isArray(F[0])?F.map(function(ue){return I(ue,H)}):H(F)}function J(F){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};F=gt(F,H);var pe=F[0],rt=F[1],yt=pe*st/180,Ve=Math.log(Math.tan((90+rt)*Math.PI/360))/(Math.PI/180);return Ve=Ve*st/180,ue.enable&&(yt=Number(yt.toFixed(ue.decimal)),Ve=Number(Ve.toFixed(ue.decimal))),F.length===3?[yt,Ve,F[2]]:[yt,Ve]}function ce(F){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,ue=F[0],pe=F[1],rt=ue/st*180,yt=pe/st*180;return yt=180/Math.PI*(2*Math.atan(Math.exp(yt*Math.PI/180))-Math.PI/2),H!=null&&(rt=Number(rt.toFixed(H)),yt=Number(yt.toFixed(H))),F.length===3?[rt,yt,F[2]]:[rt,yt]}function Be(F){if(F==null)throw new Error("lng is required");return(F>180||F<-180)&&(F=F%360,F>180&&(F=-360+F),F<-180&&(F=360+F),F===0&&(F=0)),F}function Xe(F){if(F==null)throw new Error("lat is required");return(F>90||F<-90)&&(F=F%180,F>90&&(F=-180+F),F<-90&&(F=180+F),F===0&&(F=0)),F}function gt(F,H){if(H===!1)return F;var ue=Be(F[0]),pe=Xe(F[1]);return pe>85&&(pe=85),pe<-85&&(pe=-85),F.length===3?[ue,pe,F[2]]:[ue,pe]}function tt(F){var H=85.0511287798,ue=Math.max(Math.min(H,F[1]),-H),pe=256<<20,rt=Math.PI/180,yt=F[0]*rt,Ve=ue*rt;Ve=Math.log(Math.tan(Math.PI/4+Ve/2));var ct=.5/Math.PI,er=.5,rr=-.5/Math.PI;return rt=.5,yt=pe*(ct*yt+er),Ve=pe*(rr*Ve+rt),[Math.floor(yt),Math.floor(Ve)]}function It(F){var H=.5/Math.PI,ue=.5,pe=-.5/Math.PI,rt=.5,yt=256<<20,Ve=be()(F,2),ct=Ve[0],er=Ve[1];ct=(ct/yt-ue)/H,er=(er/yt-rt)/pe,er=(Math.atan(Math.pow(Math.E,er))-Math.PI/4)*2,rt=Math.PI/180;var rr=er/rt,jr=ct/rt;return[jr,rr]}function K(F,H,ue){var pe=Object(Ue.degreesToRadians)(H[1]-F[1]),rt=Object(Ue.degreesToRadians)(H[0]-F[0]),yt=Object(Ue.degreesToRadians)(F[1]),Ve=Object(Ue.degreesToRadians)(H[1]),ct=Math.pow(Math.sin(pe/2),2)+Math.pow(Math.sin(rt/2),2)*Math.cos(yt)*Math.cos(Ve);return Object(Ue.radiansToLength)(2*Math.atan2(Math.sqrt(ct),Math.sqrt(1-ct)),ue="meters")}function Ze(F){var H=Math.PI/180,ue=85.0511287798,pe=6378137,rt=Math.max(Math.min(ue,F[1]),-ue),yt=Math.sin(rt*H),Ve=pe*F[0]*H,ct=pe*Math.log((1+yt)/(1-yt))/2;return[Ve,ct]}function te(F,H){var ue=Math.abs(F[1][1]-F[0][1])*H,pe=Math.abs(F[1][0]-F[0][0])*H;return[[F[0][0]-pe,F[0][1]-ue],[F[1][0]+pe,F[1][1]+ue]]}function Je(F,H){return F[0][0]<=H[0][0]&&F[0][1]<=H[0][1]&&F[1][0]>=H[1][0]&&F[1][1]>=H[1][1]}function zt(F){return[[F[0],F[1]],[F[2],F[3]]]}var cr=function(){function F(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,ue=arguments.length>1?arguments[1]:void 0;_t()(this,F),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=H,this.destroy=ue||this.defaultDestroy,this.order=[],this.clear()}return De()(F,[{key:"clear",value:function(){var ue=this;this.order.forEach(function(pe){ue.delete(pe)}),this.cache={},this.order=[]}},{key:"get",value:function(ue){var pe=this.cache[ue];return pe&&(this.deleteOrder(ue),this.appendOrder(ue)),pe}},{key:"set",value:function(ue,pe){this.cache[ue]?(this.delete(ue),this.cache[ue]=pe,this.appendOrder(ue)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[ue]=pe,this.appendOrder(ue))}},{key:"delete",value:function(ue){var pe=this.cache[ue];pe&&(this.deleteCache(ue),this.deleteOrder(ue),this.destroy(pe,ue))}},{key:"deleteCache",value:function(ue){delete this.cache[ue]}},{key:"deleteOrder",value:function(ue){var pe=this.order.findIndex(function(rt){return rt===ue});pe>=0&&this.order.splice(pe,1)}},{key:"appendOrder",value:function(ue){this.order.push(ue)}},{key:"defaultDestroy",value:function(ue,pe){return null}}]),F}();function lt(F,H){F.forEach(function(ue){if(!H[ue])return;H[ue]=H[ue].bind(H)})}var dt=i("FmoU");function Ct(F){var H=dt.a(F),ue=[0,0,0,0];return H!=null&&(ue[0]=H.r/255,ue[1]=H.g/255,ue[2]=H.b/255,ue[3]=H.opacity),ue}function pt(F){var H=F&&F[0],ue=F&&F[1],pe=F&&F[2],rt=H+ue*256+pe*65536-1;return rt}function we(F){return[F+1&255,F+1>>8&255,F+1>>8>>8&255]}function ut(F){var H=document.createElement("canvas"),ue=H.getContext("2d");H.width=256,H.height=1;for(var pe=ue.createLinearGradient(0,0,256,1),rt=null,yt=F.positions[0],Ve=F.positions[F.positions.length-1],ct=0;ct<F.colors.length;++ct){var er=(F.positions[ct]-yt)/(Ve-yt);pe.addColorStop(er,F.colors[ct])}return ue.fillStyle=pe,ue.fillRect(0,0,256,1),rt=new Uint8ClampedArray(ue.getImageData(0,0,256,1).data),new ImageData(rt,256,1)}var Ke;(function(F){F.CENTER="center",F.TOP="top",F["TOP-LEFT"]="top-left",F["TOP-RIGHT"]="top-right",F.BOTTOM="bottom",F["BOTTOM-LEFT"]="bottom-left",F.LEFT="left",F.RIGHT="right"})(Ke||(Ke={}));var kt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yr(F,H,ue){var pe=F.classList;for(var rt in kt)kt.hasOwnProperty(rt)&&pe.remove("l7-".concat(ue,"-anchor-").concat(rt));pe.add("l7-".concat(ue,"-anchor-").concat(H))}function Zr(F){if(F.length===0)throw new Error("max requires at least one data point");for(var H=F[0],ue=1;ue<F.length;ue++)F[ue]>H&&(H=F[ue]);return H*1}function hr(F){if(F.length===0)throw new Error("min requires at least one data point");for(var H=F[0],ue=1;ue<F.length;ue++)F[ue]<H&&(H=F[ue]);return H*1}function jn(F){if(F.length===0)return 0;for(var H=F[0]*1,ue=1;ue<F.length;ue++)H+=F[ue]*1;return H}function yn(F){if(F.length===0)throw new Error("mean requires at least one data point");return jn(F)/F.length}function ta(F){if(F.length===0)throw new Error("mean requires at least one data point");if(F.length<3)return F[0];F.sort();for(var H=F[0],ue=NaN,pe=0,rt=1,yt=1;yt<F.length+1;yt++)F[yt]!==H?(rt>pe&&(pe=rt,ue=H),rt=1,H=F[yt]):rt++;return ue*1}var ma={min:hr,max:Zr,mean:yn,sum:jn,mode:ta};function Zn(F,H){return F.map(function(ue){return ue[H]})}function Wn(F,H){return ma[F](H)}},HpQ9:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(){}return m.of=function(Z,z){var o=new m;return o.bindings=Z,o.middleware=z,o},m}();E.ContainerSnapshot=T},HthE:function(Le,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return m});var T;(function(Z){Z[Z.LNGLAT=1]="LNGLAT",Z[Z.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Z[Z.VECTOR_TILE=3]="VECTOR_TILE",Z[Z.IDENTITY=4]="IDENTITY",Z[Z.P20=5]="P20",Z[Z.P20_OFFSET=6]="P20_OFFSET",Z[Z.METER_OFFSET=7]="METER_OFFSET"})(T||(T={}));var m={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Le,E,i){"use strict";(function(T){i.d(E,"a",function(){return Z});var m=i("U8pU");function Z(z){if(typeof window!="undefined"&&Object(m.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof T!="undefined"&&Object(m.a)(T.versions)==="object"&&Boolean(T.versions.electron))return!0;var o=(typeof navigator=="undefined"?"undefined":Object(m.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,W=z||o;return!!(W&&W.indexOf("Electron")>=0)}}).call(this,i("Q2Ig"))},IOcx:function(Le,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return ot}),i.d(E,"c",function(){return Bt}),i.d(E,"d",function(){return Wt}),i.d(E,"e",function(){return sr});var T={};i.r(T),i.d(T,"create",function(){return Z}),i.d(T,"clone",function(){return z}),i.d(T,"copy",function(){return o}),i.d(T,"identity",function(){return W}),i.d(T,"fromValues",function(){return D}),i.d(T,"set",function(){return Y}),i.d(T,"transpose",function(){return q}),i.d(T,"invert",function(){return he}),i.d(T,"adjoint",function(){return X}),i.d(T,"determinant",function(){return je}),i.d(T,"multiply",function(){return Ge}),i.d(T,"rotate",function(){return ge}),i.d(T,"scale",function(){return Ce}),i.d(T,"fromRotation",function(){return ht}),i.d(T,"fromScaling",function(){return Ne}),i.d(T,"str",function(){return Et}),i.d(T,"frob",function(){return He}),i.d(T,"LDU",function(){return mt}),i.d(T,"add",function(){return Ye}),i.d(T,"subtract",function(){return xt}),i.d(T,"exactEquals",function(){return _t}),i.d(T,"equals",function(){return Ie}),i.d(T,"multiplyScalar",function(){return De}),i.d(T,"multiplyScalarAndAdd",function(){return ze}),i.d(T,"mul",function(){return at}),i.d(T,"sub",function(){return Pe});var m=i("yU0y");function Z(){var ne=new m.a(4);return m.a!=Float32Array&&(ne[1]=0,ne[2]=0),ne[0]=1,ne[3]=1,ne}function z(ne){var $=new m.a(4);return $[0]=ne[0],$[1]=ne[1],$[2]=ne[2],$[3]=ne[3],$}function o(ne,$){return ne[0]=$[0],ne[1]=$[1],ne[2]=$[2],ne[3]=$[3],ne}function W(ne){return ne[0]=1,ne[1]=0,ne[2]=0,ne[3]=1,ne}function D(ne,$,G,Ae){var xe=new m.a(4);return xe[0]=ne,xe[1]=$,xe[2]=G,xe[3]=Ae,xe}function Y(ne,$,G,Ae,xe){return ne[0]=$,ne[1]=G,ne[2]=Ae,ne[3]=xe,ne}function q(ne,$){if(ne===$){var G=$[1];ne[1]=$[2],ne[2]=G}else ne[0]=$[0],ne[1]=$[2],ne[2]=$[1],ne[3]=$[3];return ne}function he(ne,$){var G=$[0],Ae=$[1],xe=$[2],Se=$[3],ve=G*Se-xe*Ae;return ve?(ve=1/ve,ne[0]=Se*ve,ne[1]=-Ae*ve,ne[2]=-xe*ve,ne[3]=G*ve,ne):null}function X(ne,$){var G=$[0];return ne[0]=$[3],ne[1]=-$[1],ne[2]=-$[2],ne[3]=G,ne}function je(ne){return ne[0]*ne[3]-ne[2]*ne[1]}function Ge(ne,$,G){var Ae=$[0],xe=$[1],Se=$[2],ve=$[3],et=G[0],Yt=G[1],At=G[2],ye=G[3];return ne[0]=Ae*et+Se*Yt,ne[1]=xe*et+ve*Yt,ne[2]=Ae*At+Se*ye,ne[3]=xe*At+ve*ye,ne}function ge(ne,$,G){var Ae=$[0],xe=$[1],Se=$[2],ve=$[3],et=Math.sin(G),Yt=Math.cos(G);return ne[0]=Ae*Yt+Se*et,ne[1]=xe*Yt+ve*et,ne[2]=Ae*-et+Se*Yt,ne[3]=xe*-et+ve*Yt,ne}function Ce(ne,$,G){var Ae=$[0],xe=$[1],Se=$[2],ve=$[3],et=G[0],Yt=G[1];return ne[0]=Ae*et,ne[1]=xe*et,ne[2]=Se*Yt,ne[3]=ve*Yt,ne}function ht(ne,$){var G=Math.sin($),Ae=Math.cos($);return ne[0]=Ae,ne[1]=G,ne[2]=-G,ne[3]=Ae,ne}function Ne(ne,$){return ne[0]=$[0],ne[1]=0,ne[2]=0,ne[3]=$[1],ne}function Et(ne){return"mat2("+ne[0]+", "+ne[1]+", "+ne[2]+", "+ne[3]+")"}function He(ne){return Math.hypot(ne[0],ne[1],ne[2],ne[3])}function mt(ne,$,G,Ae){return ne[2]=Ae[2]/Ae[0],G[0]=Ae[0],G[1]=Ae[1],G[3]=Ae[3]-ne[2]*G[1],[ne,$,G]}function Ye(ne,$,G){return ne[0]=$[0]+G[0],ne[1]=$[1]+G[1],ne[2]=$[2]+G[2],ne[3]=$[3]+G[3],ne}function xt(ne,$,G){return ne[0]=$[0]-G[0],ne[1]=$[1]-G[1],ne[2]=$[2]-G[2],ne[3]=$[3]-G[3],ne}function _t(ne,$){return ne[0]===$[0]&&ne[1]===$[1]&&ne[2]===$[2]&&ne[3]===$[3]}function Ie(ne,$){var G=ne[0],Ae=ne[1],xe=ne[2],Se=ne[3],ve=$[0],et=$[1],Yt=$[2],At=$[3];return Math.abs(G-ve)<=m.b*Math.max(1,Math.abs(G),Math.abs(ve))&&Math.abs(Ae-et)<=m.b*Math.max(1,Math.abs(Ae),Math.abs(et))&&Math.abs(xe-Yt)<=m.b*Math.max(1,Math.abs(xe),Math.abs(Yt))&&Math.abs(Se-At)<=m.b*Math.max(1,Math.abs(Se),Math.abs(At))}function De(ne,$,G){return ne[0]=$[0]*G,ne[1]=$[1]*G,ne[2]=$[2]*G,ne[3]=$[3]*G,ne}function ze(ne,$,G,Ae){return ne[0]=$[0]+G[0]*Ae,ne[1]=$[1]+G[1]*Ae,ne[2]=$[2]+G[2]*Ae,ne[3]=$[3]+G[3]*Ae,ne}var at=Ge,Pe=xt,ot=i("ZaHm"),Bt=i("ZxFD"),Wt=i("n+fv"),sr=i("bl9R")},ISu3:function(Le,E,i){"use strict";i.d(E,"a",function(){return Z}),i.d(E,"c",function(){return z}),i.d(E,"b",function(){return o}),i.d(E,"d",function(){return W});var T={},m={},Z=function(Y){return m[Y]},z=function(Y,q){m[Y]=q},o=function(Y){return T[Y]},W=function(Y,q){T[Y]=q}},Ioao:function(Le,E,i){var T=i("heNW"),m=Math.max;function Z(z,o,W){return o=m(o===void 0?z.length-1:o,0),function(){for(var D=arguments,Y=-1,q=m(D.length-o,0),he=Array(q);++Y<q;)he[Y]=D[o+Y];Y=-1;for(var X=Array(o+1);++Y<o;)X[Y]=D[Y];return X[o]=W(he),T(z,this,X)}}Le.exports=Z},J2iB:function(Le,E){function i(T){return T==null}Le.exports=i},J7lC:function(Le,E){},K9nA:function(Le,E,i){"use strict";(function(T,m){i.d(E,"b",function(){return W}),i.d(E,"a",function(){return q});var Z=i("U8pU"),z={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof T!="undefined"&&T,document:typeof document!="undefined"&&document,process:(typeof m=="undefined"?"undefined":Object(Z.a)(m))==="object"&&m},o=z.self||z.window||z.global,W=z.window||z.self||z.global,D=z.global||z.self||z.window,Y=z.document||{},q=z.process||{},he=console}).call(this,i("yLpj"),i("Q2Ig"))},KKCa:function(Le,E){typeof Object.create=="function"?Le.exports=function(T,m){T.super_=m,T.prototype=Object.create(m.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}})}:Le.exports=function(T,m){T.super_=m;var Z=function(){};Z.prototype=m.prototype,T.prototype=new Z,T.prototype.constructor=T}},KwMD:function(Le,E){function i(T,m,Z,z){for(var o=T.length,W=Z+(z?1:-1);z?W--:++W<o;)if(m(T[W],W,T))return W;return-1}Le.exports=i},KxBF:function(Le,E){function i(T,m,Z){var z=-1,o=T.length;m<0&&(m=-m>o?0:o+m),Z=Z>o?o:Z,Z<0&&(Z+=o),o=m>Z?0:Z-m>>>0,m>>>=0;for(var W=Array(o);++z<o;)W[z]=T[z+m];return W}Le.exports=i},L56e:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T=["mapload"]},LGYb:function(Le,E,i){var T=i("1hJj"),m=i("jbM+"),Z=i("Xt/L"),z=i("xYSL"),o=i("dQpi"),W=i("rEGp"),D=200;function Y(q,he,X){var je=-1,Ge=m,ge=q.length,Ce=!0,ht=[],Ne=ht;if(X)Ce=!1,Ge=Z;else if(ge>=D){var Et=he?null:o(q);if(Et)return W(Et);Ce=!1,Ge=z,Ne=new T}else Ne=he?[]:ht;e:for(;++je<ge;){var He=q[je],mt=he?he(He):He;if(He=X||He!==0?He:0,Ce&&mt===mt){for(var Ye=Ne.length;Ye--;)if(Ne[Ye]===mt)continue e;he&&Ne.push(mt),ht.push(He)}else Ge(Ne,mt,X)||(Ne!==ht&&Ne.push(mt),ht.push(He))}return ht}Le.exports=Y},LKzl:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("z4Hk"),Z=function(){function z(o){this._binding=o,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new T.BindingOnSyntax(this._binding)}return z.prototype.when=function(o){return this._bindingWhenSyntax.when(o)},z.prototype.whenTargetNamed=function(o){return this._bindingWhenSyntax.whenTargetNamed(o)},z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},z.prototype.whenTargetTagged=function(o,W){return this._bindingWhenSyntax.whenTargetTagged(o,W)},z.prototype.whenInjectedInto=function(o){return this._bindingWhenSyntax.whenInjectedInto(o)},z.prototype.whenParentNamed=function(o){return this._bindingWhenSyntax.whenParentNamed(o)},z.prototype.whenParentTagged=function(o,W){return this._bindingWhenSyntax.whenParentTagged(o,W)},z.prototype.whenAnyAncestorIs=function(o){return this._bindingWhenSyntax.whenAnyAncestorIs(o)},z.prototype.whenNoAncestorIs=function(o){return this._bindingWhenSyntax.whenNoAncestorIs(o)},z.prototype.whenAnyAncestorNamed=function(o){return this._bindingWhenSyntax.whenAnyAncestorNamed(o)},z.prototype.whenAnyAncestorTagged=function(o,W){return this._bindingWhenSyntax.whenAnyAncestorTagged(o,W)},z.prototype.whenNoAncestorNamed=function(o){return this._bindingWhenSyntax.whenNoAncestorNamed(o)},z.prototype.whenNoAncestorTagged=function(o,W){return this._bindingWhenSyntax.whenNoAncestorTagged(o,W)},z.prototype.whenAnyAncestorMatches=function(o){return this._bindingWhenSyntax.whenAnyAncestorMatches(o)},z.prototype.whenNoAncestorMatches=function(o){return this._bindingWhenSyntax.whenNoAncestorMatches(o)},z.prototype.onActivation=function(o){return this._bindingOnSyntax.onActivation(o)},z}();E.BindingWhenOnSyntax=Z},LcsW:function(Le,E,i){var T=i("kekF"),m=T(Object.getPrototypeOf,Object);Le.exports=m},LgvC:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("d9O0"),Z=function(){function z(o,W){this.id=m.id(),this.activated=!1,this.serviceIdentifier=o,this.scope=W,this.type=T.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return z.prototype.clone=function(){var o=new z(this.serviceIdentifier,this.scope);return o.activated=!1,o.implementationType=this.implementationType,o.dynamicValue=this.dynamicValue,o.scope=this.scope,o.type=this.type,o.factory=this.factory,o.provider=this.provider,o.constraint=this.constraint,o.onActivation=this.onActivation,o.cache=this.cache,o},z}();E.Binding=Z},LsHQ:function(Le,E,i){var T=i("EA7m"),m=i("mv/X");function Z(z){return T(function(o,W){var D=-1,Y=W.length,q=Y>1?W[Y-1]:void 0,he=Y>2?W[2]:void 0;for(q=z.length>3&&typeof q=="function"?(Y--,q):void 0,he&&m(W[0],W[1],he)&&(q=Y<3?void 0:q,Y=1),o=Object(o);++D<Y;){var X=W[D];X&&z(o,X,D,q)}return o})}Le.exports=Z},LvWW:function(Le,E,i){var T=i("mhV4");Le.exports=m;function m(Y,q){switch(Y&&Y.type||null){case"FeatureCollection":return Y.features=Y.features.map(Z(m,q)),Y;case"GeometryCollection":return Y.geometries=Y.geometries.map(Z(m,q)),Y;case"Feature":return Y.geometry=m(Y.geometry,q),Y;case"Polygon":case"MultiPolygon":return z(Y,q);default:return Y}}function Z(Y,q){return function(he){return Y(he,q)}}function z(Y,q){return Y.type==="Polygon"?Y.coordinates=o(Y.coordinates,q):Y.type==="MultiPolygon"&&(Y.coordinates=Y.coordinates.map(Z(o,q))),Y}function o(Y,q){q=!!q,Y[0]=W(Y[0],q);for(var he=1;he<Y.length;he++)Y[he]=W(Y[he],!q);return Y}function W(Y,q){return D(Y)===q?Y:Y.reverse()}function D(Y){return T.ring(Y)>=0}},MCLT:function(Le,E,i){(function(T){var m=Object.getOwnPropertyDescriptors||function(ve){for(var et=Object.keys(ve),Yt={},At=0;At<et.length;At++)Yt[et[At]]=Object.getOwnPropertyDescriptor(ve,et[At]);return Yt},Z=/%[sdj%]/g;E.format=function(Se){if(!Ye(Se)){for(var ve=[],et=0;et<arguments.length;et++)ve.push(W(arguments[et]));return ve.join(" ")}for(var et=1,Yt=arguments,At=Yt.length,ye=String(Se).replace(Z,function(Ue){if(Ue==="%%")return"%";if(et>=At)return Ue;switch(Ue){case"%s":return String(Yt[et++]);case"%d":return Number(Yt[et++]);case"%j":try{return JSON.stringify(Yt[et++])}catch(st){return"[Circular]"}default:return Ue}}),be=Yt[et];et<At;be=Yt[++et])Et(be)||!De(be)?ye+=" "+be:ye+=" "+W(be);return ye},E.deprecate=function(Se,ve){if(typeof T!="undefined"&&T.noDeprecation===!0)return Se;if(typeof T=="undefined")return function(){return E.deprecate(Se,ve).apply(this,arguments)};var et=!1;function Yt(){if(!et){if(T.throwDeprecation)throw new Error(ve);T.traceDeprecation?console.trace(ve):console.error(ve),et=!0}return Se.apply(this,arguments)}return Yt};var z={},o;E.debuglog=function(Se){if(_t(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Se=Se.toUpperCase(),!z[Se])if(new RegExp("\\b"+Se+"\\b","i").test(o)){var ve=T.pid;z[Se]=function(){var et=E.format.apply(E,arguments);console.error("%s %d: %s",Se,ve,et)}}else z[Se]=function(){};return z[Se]};function W(Se,ve){var et={seen:[],stylize:Y};return arguments.length>=3&&(et.depth=arguments[2]),arguments.length>=4&&(et.colors=arguments[3]),Ne(ve)?et.showHidden=ve:ve&&E._extend(et,ve),_t(et.showHidden)&&(et.showHidden=!1),_t(et.depth)&&(et.depth=2),_t(et.colors)&&(et.colors=!1),_t(et.customInspect)&&(et.customInspect=!0),et.colors&&(et.stylize=D),he(et,Se,et.depth)}E.inspect=W,W.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},W.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Se,ve){var et=W.styles[ve];return et?"["+W.colors[et][0]+"m"+Se+"["+W.colors[et][1]+"m":Se}function Y(Se,ve){return Se}function q(Se){var ve={};return Se.forEach(function(et,Yt){ve[et]=!0}),ve}function he(Se,ve,et){if(Se.customInspect&&ve&&Pe(ve.inspect)&&ve.inspect!==E.inspect&&!(ve.constructor&&ve.constructor.prototype===ve)){var Yt=ve.inspect(et,Se);return Ye(Yt)||(Yt=he(Se,Yt,et)),Yt}var At=X(Se,ve);if(At)return At;var ye=Object.keys(ve),be=q(ye);if(Se.showHidden&&(ye=Object.getOwnPropertyNames(ve)),at(ve)&&(ye.indexOf("message")>=0||ye.indexOf("description")>=0))return je(ve);if(ye.length===0){if(Pe(ve)){var Ue=ve.name?": "+ve.name:"";return Se.stylize("[Function"+Ue+"]","special")}if(Ie(ve))return Se.stylize(RegExp.prototype.toString.call(ve),"regexp");if(ze(ve))return Se.stylize(Date.prototype.toString.call(ve),"date");if(at(ve))return je(ve)}var st="",Me=!1,ft=["{","}"];if(ht(ve)&&(Me=!0,ft=["[","]"]),Pe(ve)){var w=ve.name?": "+ve.name:"";st=" [Function"+w+"]"}if(Ie(ve)&&(st=" "+RegExp.prototype.toString.call(ve)),ze(ve)&&(st=" "+Date.prototype.toUTCString.call(ve)),at(ve)&&(st=" "+je(ve)),ye.length===0&&(!Me||ve.length==0))return ft[0]+st+ft[1];if(et<0)return Ie(ve)?Se.stylize(RegExp.prototype.toString.call(ve),"regexp"):Se.stylize("[Object]","special");Se.seen.push(ve);var I;return Me?I=Ge(Se,ve,et,be,ye):I=ye.map(function(J){return ge(Se,ve,et,be,J,Me)}),Se.seen.pop(),Ce(I,st,ft)}function X(Se,ve){if(_t(ve))return Se.stylize("undefined","undefined");if(Ye(ve)){var et="'"+JSON.stringify(ve).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Se.stylize(et,"string")}if(mt(ve))return Se.stylize(""+ve,"number");if(Ne(ve))return Se.stylize(""+ve,"boolean");if(Et(ve))return Se.stylize("null","null")}function je(Se){return"["+Error.prototype.toString.call(Se)+"]"}function Ge(Se,ve,et,Yt,At){for(var ye=[],be=0,Ue=ve.length;be<Ue;++be)$(ve,String(be))?ye.push(ge(Se,ve,et,Yt,String(be),!0)):ye.push("");return At.forEach(function(st){st.match(/^\d+$/)||ye.push(ge(Se,ve,et,Yt,st,!0))}),ye}function ge(Se,ve,et,Yt,At,ye){var be,Ue,st;if(st=Object.getOwnPropertyDescriptor(ve,At)||{value:ve[At]},st.get?st.set?Ue=Se.stylize("[Getter/Setter]","special"):Ue=Se.stylize("[Getter]","special"):st.set&&(Ue=Se.stylize("[Setter]","special")),$(Yt,At)||(be="["+At+"]"),Ue||(Se.seen.indexOf(st.value)<0?(Et(et)?Ue=he(Se,st.value,null):Ue=he(Se,st.value,et-1),Ue.indexOf(`
`)>-1&&(ye?Ue=Ue.split(`
`).map(function(Me){return"  "+Me}).join(`
`).substr(2):Ue=`
`+Ue.split(`
`).map(function(Me){return"   "+Me}).join(`
`))):Ue=Se.stylize("[Circular]","special")),_t(be)){if(ye&&At.match(/^\d+$/))return Ue;be=JSON.stringify(""+At),be.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(be=be.substr(1,be.length-2),be=Se.stylize(be,"name")):(be=be.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),be=Se.stylize(be,"string"))}return be+": "+Ue}function Ce(Se,ve,et){var Yt=0,At=Se.reduce(function(ye,be){return Yt++,be.indexOf(`
`)>=0&&Yt++,ye+be.replace(/\u001b\[\d\d?m/g,"").length+1},0);return At>60?et[0]+(ve===""?"":ve+`
 `)+" "+Se.join(`,
  `)+" "+et[1]:et[0]+ve+" "+Se.join(", ")+" "+et[1]}function ht(Se){return Array.isArray(Se)}E.isArray=ht;function Ne(Se){return typeof Se=="boolean"}E.isBoolean=Ne;function Et(Se){return Se===null}E.isNull=Et;function He(Se){return Se==null}E.isNullOrUndefined=He;function mt(Se){return typeof Se=="number"}E.isNumber=mt;function Ye(Se){return typeof Se=="string"}E.isString=Ye;function xt(Se){return typeof Se=="symbol"}E.isSymbol=xt;function _t(Se){return Se===void 0}E.isUndefined=_t;function Ie(Se){return De(Se)&&Bt(Se)==="[object RegExp]"}E.isRegExp=Ie;function De(Se){return typeof Se=="object"&&Se!==null}E.isObject=De;function ze(Se){return De(Se)&&Bt(Se)==="[object Date]"}E.isDate=ze;function at(Se){return De(Se)&&(Bt(Se)==="[object Error]"||Se instanceof Error)}E.isError=at;function Pe(Se){return typeof Se=="function"}E.isFunction=Pe;function ot(Se){return Se===null||typeof Se=="boolean"||typeof Se=="number"||typeof Se=="string"||typeof Se=="symbol"||typeof Se=="undefined"}E.isPrimitive=ot,E.isBuffer=i("1gqn");function Bt(Se){return Object.prototype.toString.call(Se)}function Wt(Se){return Se<10?"0"+Se.toString(10):Se.toString(10)}var sr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ne(){var Se=new Date,ve=[Wt(Se.getHours()),Wt(Se.getMinutes()),Wt(Se.getSeconds())].join(":");return[Se.getDate(),sr[Se.getMonth()],ve].join(" ")}E.log=function(){console.log("%s - %s",ne(),E.format.apply(E,arguments))},E.inherits=i("KKCa"),E._extend=function(Se,ve){if(!ve||!De(ve))return Se;for(var et=Object.keys(ve),Yt=et.length;Yt--;)Se[et[Yt]]=ve[et[Yt]];return Se};function $(Se,ve){return Object.prototype.hasOwnProperty.call(Se,ve)}var G=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;E.promisify=function(ve){if(typeof ve!="function")throw new TypeError('The "original" argument must be of type Function');if(G&&ve[G]){var et=ve[G];if(typeof et!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(et,G,{value:et,enumerable:!1,writable:!1,configurable:!0}),et}function et(){for(var Yt,At,ye=new Promise(function(st,Me){Yt=st,At=Me}),be=[],Ue=0;Ue<arguments.length;Ue++)be.push(arguments[Ue]);be.push(function(st,Me){st?At(st):Yt(Me)});try{ve.apply(this,be)}catch(st){At(st)}return ye}return Object.setPrototypeOf(et,Object.getPrototypeOf(ve)),G&&Object.defineProperty(et,G,{value:et,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(et,m(ve))},E.promisify.custom=G;function Ae(Se,ve){if(!Se){var et=new Error("Promise was rejected with a falsy value");et.reason=Se,Se=et}return ve(Se)}function xe(Se){if(typeof Se!="function")throw new TypeError('The "original" argument must be of type Function');function ve(){for(var et=[],Yt=0;Yt<arguments.length;Yt++)et.push(arguments[Yt]);var At=et.pop();if(typeof At!="function")throw new TypeError("The last argument must be of type Function");var ye=this,be=function(){return At.apply(ye,arguments)};Se.apply(this,et).then(function(Ue){T.nextTick(be,null,Ue)},function(Ue){T.nextTick(Ae,Ue,be)})}return Object.setPrototypeOf(ve,Object.getPrototypeOf(Se)),Object.defineProperties(ve,m(Se)),ve}E.callbackify=xe}).call(this,i("Q2Ig"))},MON2:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",E.UNDEFINED_INJECT_ANNOTATION=function(T){return"@inject called with undefined this could mean that the class "+T+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",E.ARGUMENTS_LENGTH_MISMATCH=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"The number of constructor arguments in the derived class "+(T[0]+" must be >= than the number of constructor arguments of its base class.")},E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",E.POST_CONSTRUCT_ERROR=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"@postConstruct error in class "+T[0]+": "+T[1]},E.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"It looks like there is a circular dependency "+("in one of the '"+T[0]+"' bindings. Please investigate bindings with")+("service identifier '"+T[1]+"'.")},E.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Le,E,i){var T=i("hypo"),m=i("ljhN"),Z=Object.prototype,z=Z.hasOwnProperty;function o(W,D,Y){var q=W[D];(!(z.call(W,D)&&m(q,Y))||Y===void 0&&!(D in W))&&T(W,D,Y)}Le.exports=o},O0oS:function(Le,E,i){var T=i("Cwc5"),m=function(){try{var Z=T(Object,"defineProperty");return Z({},"",{}),Z}catch(z){}}();Le.exports=m},O1je:function(Le,E){},OBhP:function(Le,E,i){var T=i("fmRc"),m=i("gFfm"),Z=i("MrPd"),z=i("WwFo"),o=i("Dw+G"),W=i("5Tg0"),D=i("Q1l4"),Y=i("VOtZ"),q=i("EEGq"),he=i("qZTm"),X=i("G6z8"),je=i("QqLw"),Ge=i("yHx3"),ge=i("wrZu"),Ce=i("+iFO"),ht=i("Z0cm"),Ne=i("DSRE"),Et=i("zEVN"),He=i("GoyQ"),mt=i("1+5i"),Ye=i("7GkX"),xt=i("mTTR"),_t=1,Ie=2,De=4,ze="[object Arguments]",at="[object Array]",Pe="[object Boolean]",ot="[object Date]",Bt="[object Error]",Wt="[object Function]",sr="[object GeneratorFunction]",ne="[object Map]",$="[object Number]",G="[object Object]",Ae="[object RegExp]",xe="[object Set]",Se="[object String]",ve="[object Symbol]",et="[object WeakMap]",Yt="[object ArrayBuffer]",At="[object DataView]",ye="[object Float32Array]",be="[object Float64Array]",Ue="[object Int8Array]",st="[object Int16Array]",Me="[object Int32Array]",ft="[object Uint8Array]",w="[object Uint8ClampedArray]",I="[object Uint16Array]",J="[object Uint32Array]",ce={};ce[ze]=ce[at]=ce[Yt]=ce[At]=ce[Pe]=ce[ot]=ce[ye]=ce[be]=ce[Ue]=ce[st]=ce[Me]=ce[ne]=ce[$]=ce[G]=ce[Ae]=ce[xe]=ce[Se]=ce[ve]=ce[ft]=ce[w]=ce[I]=ce[J]=!0,ce[Bt]=ce[Wt]=ce[et]=!1;function Be(Xe,gt,tt,It,K,Ze){var te,Je=gt&_t,zt=gt&Ie,cr=gt&De;if(tt&&(te=K?tt(Xe,It,K,Ze):tt(Xe)),te!==void 0)return te;if(!He(Xe))return Xe;var lt=ht(Xe);if(lt){if(te=Ge(Xe),!Je)return D(Xe,te)}else{var dt=je(Xe),Ct=dt==Wt||dt==sr;if(Ne(Xe))return W(Xe,Je);if(dt==G||dt==ze||Ct&&!K){if(te=zt||Ct?{}:Ce(Xe),!Je)return zt?q(Xe,o(te,Xe)):Y(Xe,z(te,Xe))}else{if(!ce[dt])return K?Xe:{};te=ge(Xe,dt,Je)}}Ze||(Ze=new T);var pt=Ze.get(Xe);if(pt)return pt;Ze.set(Xe,te),mt(Xe)?Xe.forEach(function(Ke){te.add(Be(Ke,gt,tt,Ke,Xe,Ze))}):Et(Xe)&&Xe.forEach(function(Ke,kt){te.set(kt,Be(Ke,gt,tt,kt,Xe,Ze))});var we=cr?zt?X:he:zt?xt:Ye,ut=lt?void 0:we(Xe);return m(ut||Xe,function(Ke,kt){ut&&(kt=Ke,Ke=Xe[kt]),Z(te,kt,Be(Ke,gt,tt,kt,Xe,Ze))}),te}Le.exports=Be},PSsN:function(Le,E){},PUg6:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.normal="normal",m.additive="additive",m.subtractive="subtractive",m.min="min",m.max="max"})(T||(T={}))},Q1l4:function(Le,E){function i(T,m){var Z=-1,z=T.length;for(m||(m=Array(z));++Z<z;)m[Z]=T[Z];return m}Le.exports=i},QGbF:function(Le,E){},"QQZ/":function(Le,E,i){var T=i("Sq3C"),m=i("Z1HP"),Z=i("Sxd8"),z=i("dt0z");function o(W,D,Y){W=z(W),D=Z(D);var q=D?m(W):0;return D&&q<D?T(D-q,Y)+W:W}Le.exports=o},QcOe:function(Le,E,i){var T=i("GoyQ"),m=i("6sVZ"),Z=i("7Ix3"),z=Object.prototype,o=z.hasOwnProperty;function W(D){if(!T(D))return Z(D);var Y=m(D),q=[];for(var he in D)he=="constructor"&&(Y||!o.call(D,he))||q.push(he);return q}Le.exports=W},QkVN:function(Le,E,i){var T=i("+Qka"),m=i("LsHQ"),Z=m(function(z,o,W){T(z,o,W)});Le.exports=Z},"R/W3":function(Le,E,i){var T=i("KwMD"),m=i("2ajD"),Z=i("CZoQ");function z(o,W,D){return W===W?Z(o,W,D):T(o,m,D)}Le.exports=z},"RL2/":function(Le,E,i){"use strict";var T="2.2.41"},RMtq:function(Le,E){},"RR/i":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=function D(Y,q){var he=Y.parentRequest;return he!==null?q(he)?!0:D(he,q):!1};E.traverseAncerstors=Z;var z=function(Y){return function(q){var he=function(je){return je!==null&&je.target!==null&&je.target.matchesTag(Y)(q)};return he.metaData=new m.Metadata(Y,q),he}};E.taggedConstraint=z;var o=z(T.NAMED_TAG);E.namedConstraint=o;var W=function(Y){return function(q){var he=null;if(q!==null)if(he=q.bindings[0],typeof Y=="string"){var X=he.serviceIdentifier;return X===Y}else{var je=q.bindings[0].implementationType;return Y===je}return!1}};E.typeConstraint=W},Sk89:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),Z=i("GXnB");function z(){return function(o,W,D){var Y=new Z.Metadata(m.POST_CONSTRUCT,W);if(Reflect.hasOwnMetadata(m.POST_CONSTRUCT,o.constructor))throw new Error(T.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(m.POST_CONSTRUCT,Y,o.constructor)}}E.postConstruct=z},Sq3C:function(Le,E,i){var T=i("sKgW"),m=i("zoYe"),Z=i("wy8a"),z=i("quyA"),o=i("Z1HP"),W=i("Em2t"),D=Math.ceil;function Y(q,he){he=he===void 0?" ":m(he);var X=he.length;if(X<2)return X?T(he,q):he;var je=T(he,D(q/o(he)));return z(he)?Z(W(je),0,q).join(""):je.slice(0,q)}Le.exports=Y},Sxd8:function(Le,E,i){var T=i("ZCgT");function m(Z){var z=T(Z),o=z%1;return z===z?o?z-o:z:0}Le.exports=m},T1AV:function(Le,E,i){var T=i("t2Dn"),m=i("5Tg0"),Z=i("yP5f"),z=i("Q1l4"),o=i("+iFO"),W=i("03A+"),D=i("Z0cm"),Y=i("3L66"),q=i("DSRE"),he=i("lSCD"),X=i("GoyQ"),je=i("YO3V"),Ge=i("c6wG"),ge=i("itsj"),Ce=i("jeLo");function ht(Ne,Et,He,mt,Ye,xt,_t){var Ie=ge(Ne,He),De=ge(Et,He),ze=_t.get(De);if(ze){T(Ne,He,ze);return}var at=xt?xt(Ie,De,He+"",Ne,Et,_t):void 0,Pe=at===void 0;if(Pe){var ot=D(De),Bt=!ot&&q(De),Wt=!ot&&!Bt&&Ge(De);at=De,ot||Bt||Wt?D(Ie)?at=Ie:Y(Ie)?at=z(Ie):Bt?(Pe=!1,at=m(De,!0)):Wt?(Pe=!1,at=Z(De,!0)):at=[]:je(De)||W(De)?(at=Ie,W(Ie)?at=Ce(Ie):(!X(Ie)||he(Ie))&&(at=o(De))):Pe=!1}Pe&&(_t.set(De,at),Ye(at,De,mt,xt,_t),_t.delete(De)),T(Ne,He,at)}Le.exports=ht},TKrE:function(Le,E,i){var T=i("qRkn"),m=i("dt0z"),Z=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,z="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",W="\\u20d0-\\u20ff",D=z+o+W,Y="["+D+"]",q=RegExp(Y,"g");function he(X){return X=m(X),X&&X.replace(Z,T).replace(q,"")}Le.exports=he},"U+yc":function(Le,E){function i(T,m,Z,z,o){var W={};return Object.keys(z).forEach(function(D){W[D]=z[D]}),W.enumerable=!!W.enumerable,W.configurable=!!W.configurable,("value"in W||W.initializer)&&(W.writable=!0),W=Z.slice().reverse().reduce(function(D,Y){return Y(T,m,D)||D},W),o&&W.initializer!==void 0&&(W.value=W.initializer?W.initializer.call(o):void 0,W.initializer=void 0),W.initializer===void 0&&(Object.defineProperty(T,m,W),W=null),W}Le.exports=i},U1ZX:function(Le,E){},UB5X:function(Le,E,i){var T=i("NykK"),m=i("ExA7"),Z="[object Number]";function z(o){return typeof o=="number"||m(o)&&T(o)==Z}Le.exports=z},Ucsi:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=Symbol.for("INJECTION");function m(D,Y,q,he){function X(){return he&&!Reflect.hasMetadata(T,this,Y)&&Reflect.defineMetadata(T,q(),this,Y),Reflect.hasMetadata(T,this,Y)?Reflect.getMetadata(T,this,Y):q()}function je(Ge){Reflect.defineMetadata(T,Ge,this,Y)}Object.defineProperty(D,Y,{configurable:!0,enumerable:!0,get:X,set:je})}function Z(D,Y){return function(q){return function(he,X){var je=function(){return D.get(q)};m(he,X,je,Y)}}}E.makePropertyInjectDecorator=Z;function z(D,Y){return function(q,he){return function(X,je){var Ge=function(){return D.getNamed(q,he)};m(X,je,Ge,Y)}}}E.makePropertyInjectNamedDecorator=z;function o(D,Y){return function(q,he,X){return function(je,Ge){var ge=function(){return D.getTagged(q,he,X)};m(je,Ge,ge,Y)}}}E.makePropertyInjectTaggedDecorator=o;function W(D,Y){return function(q){return function(he,X){var je=function(){return D.getAll(q)};m(he,X,je,Y)}}}E.makePropertyMultiInjectDecorator=W},V1cb:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Hover="hover",m.Click="click",m.Select="select",m.Active="active",m.Drag="drag"})(T||(T={}))},VIsB:function(Le,E,i){"use strict";i.d(E,"a",function(){return W});var T=i("Hel2");function m(je,Ge){var ge;if(typeof Symbol=="undefined"||je[Symbol.iterator]==null){if(Array.isArray(je)||(ge=Z(je))||Ge&&je&&typeof je.length=="number"){ge&&(je=ge);var Ce=0,ht=function(){};return{s:ht,n:function(){return Ce>=je.length?{done:!0}:{done:!1,value:je[Ce++]}},e:function(Ye){throw Ye},f:ht}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ne=!0,Et=!1,He;return{s:function(){ge=je[Symbol.iterator]()},n:function(){var Ye=ge.next();return Ne=Ye.done,Ye},e:function(Ye){Et=!0,He=Ye},f:function(){try{!Ne&&ge.return!=null&&ge.return()}finally{if(Et)throw He}}}}function Z(je,Ge){if(!je)return;if(typeof je=="string")return z(je,Ge);var ge=Object.prototype.toString.call(je).slice(8,-1);if(ge==="Object"&&je.constructor&&(ge=je.constructor.name),ge==="Map"||ge==="Set")return Array.from(je);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return z(je,Ge)}function z(je,Ge){(Ge==null||Ge>je.length)&&(Ge=je.length);for(var ge=0,Ce=new Array(Ge);ge<Ge;ge++)Ce[ge]=je[ge];return Ce}var o=6378e3;function W(je,Ge){var ge=je.dataArray,Ce=Ge.size,ht=Ce===void 0?10:Ce,Ne=ht/(2*Math.PI*o)*(256<<20)/2,Et=D(ge,ht),He=Et.gridHash,mt=Et.gridOffset,Ye=X(He,mt,Ge);return{yOffset:Ne,xOffset:Ne,radius:Ne,type:"grid",dataArray:Ye}}function D(je,Ge){var ge=Infinity,Ce=-Infinity,ht,Ne=m(je),Et;try{for(Ne.s();!(Et=Ne.n()).done;){var He=Et.value;ht=He.coordinates[1],Number.isFinite(ht)&&(ge=ht<ge?ht:ge,Ce=ht>Ce?ht:Ce)}}catch(Wt){Ne.e(Wt)}finally{Ne.f()}var mt=(ge+Ce)/2,Ye=Y(Ge,mt);if(Ye.xOffset<=0||Ye.yOffset<=0)return{gridHash:{},gridOffset:Ye};var xt={},_t=m(je),Ie;try{for(_t.s();!(Ie=_t.n()).done;){var De=Ie.value,ze=De.coordinates[1],at=De.coordinates[0];if(Number.isFinite(ze)&&Number.isFinite(at)){var Pe=Math.floor((ze+90)/Ye.yOffset),ot=Math.floor((at+180)/Ye.xOffset),Bt="".concat(Pe,"-").concat(ot);xt[Bt]=xt[Bt]||{count:0,points:[]},xt[Bt].count+=1,xt[Bt].points.push(De)}}}catch(Wt){_t.e(Wt)}finally{_t.f()}return{gridHash:xt,gridOffset:Ye}}function Y(je,Ge){var ge=q(je),Ce=he(Ge,je);return{yOffset:ge,xOffset:Ce}}function q(je){return je/o*(180/Math.PI)}function he(je,Ge){return Ge/o*(180/Math.PI)/Math.cos(je*Math.PI/180)}function X(je,Ge,ge){return Object.keys(je).reduce(function(Ce,ht,Ne){var Et=ht.split("-"),He=parseInt(Et[0],10),mt=parseInt(Et[1],10),Ye={};if(ge.field&&ge.method){var xt=T.c.getColumn(je[ht].points,ge.field);Ye[ge.method]=T.c.statMap[ge.method](xt)}return Object.assign(Ye,{_id:Ne,coordinates:Object(T.d)([-180+Ge.xOffset*(mt+.5),-90+Ge.yOffset*(He+.5)]),rawData:je[ht].points,count:je[ht].count}),Ce.push(Ye),Ce},[])}},VOtZ:function(Le,E,i){var T=i("juv8"),m=i("MvSz");function Z(z,o){return T(z,m(z),o)}Le.exports=Z},VmRL:function(Le,E,i){"use strict";Le.exports=T,Le.exports.default=T;function T(ne,$,G){G=G||2;var Ae=$&&$.length,xe=Ae?$[0]*G:ne.length,Se=m(ne,0,xe,G,!0),ve=[];if(!Se||Se.next===Se.prev)return ve;var et,Yt,At,ye,be,Ue,st;if(Ae&&(Se=q(ne,$,Se,G)),ne.length>80*G){et=At=ne[0],Yt=ye=ne[1];for(var Me=G;Me<xe;Me+=G)be=ne[Me],Ue=ne[Me+1],be<et&&(et=be),Ue<Yt&&(Yt=Ue),be>At&&(At=be),Ue>ye&&(ye=Ue);st=Math.max(At-et,ye-Yt),st=st!==0?1/st:0}return z(Se,ve,G,et,Yt,st),ve}function m(ne,$,G,Ae,xe){var Se,ve;if(xe===sr(ne,$,G,Ae)>0)for(Se=$;Se<G;Se+=Ae)ve=ot(Se,ne[Se],ne[Se+1],ve);else for(Se=G-Ae;Se>=$;Se-=Ae)ve=ot(Se,ne[Se],ne[Se+1],ve);return ve&&Ye(ve,ve.next)&&(Bt(ve),ve=ve.next),ve}function Z(ne,$){if(!ne)return ne;$||($=ne);var G=ne,Ae;do if(Ae=!1,!G.steiner&&(Ye(G,G.next)||mt(G.prev,G,G.next)===0)){if(Bt(G),G=$=G.prev,G===G.next)break;Ae=!0}else G=G.next;while(Ae||G!==$);return $}function z(ne,$,G,Ae,xe,Se,ve){if(!ne)return;!ve&&Se&&ge(ne,Ae,xe,Se);for(var et=ne,Yt,At;ne.prev!==ne.next;){if(Yt=ne.prev,At=ne.next,Se?W(ne,Ae,xe,Se):o(ne)){$.push(Yt.i/G),$.push(ne.i/G),$.push(At.i/G),Bt(ne),ne=At.next,et=At.next;continue}if(ne=At,ne===et){ve?ve===1?(ne=D(Z(ne),$,G),z(ne,$,G,Ae,xe,Se,2)):ve===2&&Y(ne,$,G,Ae,xe,Se):z(Z(ne),$,G,Ae,xe,Se,1);break}}}function o(ne){var $=ne.prev,G=ne,Ae=ne.next;if(mt($,G,Ae)>=0)return!1;for(var xe=ne.next.next;xe!==ne.prev;){if(Et($.x,$.y,G.x,G.y,Ae.x,Ae.y,xe.x,xe.y)&&mt(xe.prev,xe,xe.next)>=0)return!1;xe=xe.next}return!0}function W(ne,$,G,Ae){var xe=ne.prev,Se=ne,ve=ne.next;if(mt(xe,Se,ve)>=0)return!1;for(var et=xe.x<Se.x?xe.x<ve.x?xe.x:ve.x:Se.x<ve.x?Se.x:ve.x,Yt=xe.y<Se.y?xe.y<ve.y?xe.y:ve.y:Se.y<ve.y?Se.y:ve.y,At=xe.x>Se.x?xe.x>ve.x?xe.x:ve.x:Se.x>ve.x?Se.x:ve.x,ye=xe.y>Se.y?xe.y>ve.y?xe.y:ve.y:Se.y>ve.y?Se.y:ve.y,be=ht(et,Yt,$,G,Ae),Ue=ht(At,ye,$,G,Ae),st=ne.prevZ,Me=ne.nextZ;st&&st.z>=be&&Me&&Me.z<=Ue;){if(st!==ne.prev&&st!==ne.next&&Et(xe.x,xe.y,Se.x,Se.y,ve.x,ve.y,st.x,st.y)&&mt(st.prev,st,st.next)>=0)return!1;if(st=st.prevZ,Me!==ne.prev&&Me!==ne.next&&Et(xe.x,xe.y,Se.x,Se.y,ve.x,ve.y,Me.x,Me.y)&&mt(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}for(;st&&st.z>=be;){if(st!==ne.prev&&st!==ne.next&&Et(xe.x,xe.y,Se.x,Se.y,ve.x,ve.y,st.x,st.y)&&mt(st.prev,st,st.next)>=0)return!1;st=st.prevZ}for(;Me&&Me.z<=Ue;){if(Me!==ne.prev&&Me!==ne.next&&Et(xe.x,xe.y,Se.x,Se.y,ve.x,ve.y,Me.x,Me.y)&&mt(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function D(ne,$,G){var Ae=ne;do{var xe=Ae.prev,Se=Ae.next.next;!Ye(xe,Se)&&xt(xe,Ae,Ae.next,Se)&&ze(xe,Se)&&ze(Se,xe)&&($.push(xe.i/G),$.push(Ae.i/G),$.push(Se.i/G),Bt(Ae),Bt(Ae.next),Ae=ne=Se),Ae=Ae.next}while(Ae!==ne);return Z(Ae)}function Y(ne,$,G,Ae,xe,Se){var ve=ne;do{for(var et=ve.next.next;et!==ve.prev;){if(ve.i!==et.i&&He(ve,et)){var Yt=Pe(ve,et);ve=Z(ve,ve.next),Yt=Z(Yt,Yt.next),z(ve,$,G,Ae,xe,Se),z(Yt,$,G,Ae,xe,Se);return}et=et.next}ve=ve.next}while(ve!==ne)}function q(ne,$,G,Ae){var xe=[],Se,ve,et,Yt,At;for(Se=0,ve=$.length;Se<ve;Se++)et=$[Se]*Ae,Yt=Se<ve-1?$[Se+1]*Ae:ne.length,At=m(ne,et,Yt,Ae,!1),At===At.next&&(At.steiner=!0),xe.push(Ne(At));for(xe.sort(he),Se=0;Se<xe.length;Se++)X(xe[Se],G),G=Z(G,G.next);return G}function he(ne,$){return ne.x-$.x}function X(ne,$){if($=je(ne,$),$){var G=Pe($,ne);Z($,$.next),Z(G,G.next)}}function je(ne,$){var G=$,Ae=ne.x,xe=ne.y,Se=-Infinity,ve;do{if(xe<=G.y&&xe>=G.next.y&&G.next.y!==G.y){var et=G.x+(xe-G.y)*(G.next.x-G.x)/(G.next.y-G.y);if(et<=Ae&&et>Se){if(Se=et,et===Ae){if(xe===G.y)return G;if(xe===G.next.y)return G.next}ve=G.x<G.next.x?G:G.next}}G=G.next}while(G!==$);if(!ve)return null;if(Ae===Se)return ve;var Yt=ve,At=ve.x,ye=ve.y,be=Infinity,Ue;G=ve;do Ae>=G.x&&G.x>=At&&Ae!==G.x&&Et(xe<ye?Ae:Se,xe,At,ye,xe<ye?Se:Ae,xe,G.x,G.y)&&(Ue=Math.abs(xe-G.y)/(Ae-G.x),ze(G,ne)&&(Ue<be||Ue===be&&(G.x>ve.x||G.x===ve.x&&Ge(ve,G)))&&(ve=G,be=Ue)),G=G.next;while(G!==Yt);return ve}function Ge(ne,$){return mt(ne.prev,ne,$.prev)<0&&mt($.next,ne,ne.next)<0}function ge(ne,$,G,Ae){var xe=ne;do xe.z===null&&(xe.z=ht(xe.x,xe.y,$,G,Ae)),xe.prevZ=xe.prev,xe.nextZ=xe.next,xe=xe.next;while(xe!==ne);xe.prevZ.nextZ=null,xe.prevZ=null,Ce(xe)}function Ce(ne){var $,G,Ae,xe,Se,ve,et,Yt,At=1;do{for(G=ne,ne=null,Se=null,ve=0;G;){for(ve++,Ae=G,et=0,$=0;$<At&&!(et++,Ae=Ae.nextZ,!Ae);$++);for(Yt=At;et>0||Yt>0&&Ae;)et!==0&&(Yt===0||!Ae||G.z<=Ae.z)?(xe=G,G=G.nextZ,et--):(xe=Ae,Ae=Ae.nextZ,Yt--),Se?Se.nextZ=xe:ne=xe,xe.prevZ=Se,Se=xe;G=Ae}Se.nextZ=null,At*=2}while(ve>1);return ne}function ht(ne,$,G,Ae,xe){return ne=32767*(ne-G)*xe,$=32767*($-Ae)*xe,ne=(ne|ne<<8)&16711935,ne=(ne|ne<<4)&252645135,ne=(ne|ne<<2)&858993459,ne=(ne|ne<<1)&1431655765,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,ne|$<<1}function Ne(ne){var $=ne,G=ne;do($.x<G.x||$.x===G.x&&$.y<G.y)&&(G=$),$=$.next;while($!==ne);return G}function Et(ne,$,G,Ae,xe,Se,ve,et){return(xe-ve)*($-et)-(ne-ve)*(Se-et)>=0&&(ne-ve)*(Ae-et)-(G-ve)*($-et)>=0&&(G-ve)*(Se-et)-(xe-ve)*(Ae-et)>=0}function He(ne,$){return ne.next.i!==$.i&&ne.prev.i!==$.i&&!De(ne,$)&&(ze(ne,$)&&ze($,ne)&&at(ne,$)&&(mt(ne.prev,ne,$.prev)||mt(ne,$.prev,$))||Ye(ne,$)&&mt(ne.prev,ne,ne.next)>0&&mt($.prev,$,$.next)>0)}function mt(ne,$,G){return($.y-ne.y)*(G.x-$.x)-($.x-ne.x)*(G.y-$.y)}function Ye(ne,$){return ne.x===$.x&&ne.y===$.y}function xt(ne,$,G,Ae){var xe=Ie(mt(ne,$,G)),Se=Ie(mt(ne,$,Ae)),ve=Ie(mt(G,Ae,ne)),et=Ie(mt(G,Ae,$));return xe!==Se&&ve!==et||(xe===0&&_t(ne,G,$)||(Se===0&&_t(ne,Ae,$)||ve===0&&_t(G,ne,Ae)))?!0:!!(et===0&&_t(G,$,Ae))}function _t(ne,$,G){return $.x<=Math.max(ne.x,G.x)&&$.x>=Math.min(ne.x,G.x)&&$.y<=Math.max(ne.y,G.y)&&$.y>=Math.min(ne.y,G.y)}function Ie(ne){return ne>0?1:ne<0?-1:0}function De(ne,$){var G=ne;do{if(G.i!==ne.i&&G.next.i!==ne.i&&G.i!==$.i&&G.next.i!==$.i&&xt(G,G.next,ne,$))return!0;G=G.next}while(G!==ne);return!1}function ze(ne,$){return mt(ne.prev,ne,ne.next)<0?mt(ne,$,ne.next)>=0&&mt(ne,ne.prev,$)>=0:mt(ne,$,ne.prev)<0||mt(ne,ne.next,$)<0}function at(ne,$){var G=ne,Ae=!1,xe=(ne.x+$.x)/2,Se=(ne.y+$.y)/2;do G.y>Se!==G.next.y>Se&&G.next.y!==G.y&&xe<(G.next.x-G.x)*(Se-G.y)/(G.next.y-G.y)+G.x&&(Ae=!Ae),G=G.next;while(G!==ne);return Ae}function Pe(ne,$){var G=new Wt(ne.i,ne.x,ne.y),Ae=new Wt($.i,$.x,$.y),xe=ne.next,Se=$.prev;return ne.next=$,$.prev=ne,G.next=xe,xe.prev=G,Ae.next=G,G.prev=Ae,Se.next=Ae,Ae.prev=Se,Ae}function ot(ne,$,G,Ae){var xe=new Wt(ne,$,G);return Ae?(xe.next=Ae.next,xe.prev=Ae,Ae.next.prev=xe,Ae.next=xe):(xe.prev=xe,xe.next=xe),xe}function Bt(ne){ne.next.prev=ne.prev,ne.prev.next=ne.next,ne.prevZ&&(ne.prevZ.nextZ=ne.nextZ),ne.nextZ&&(ne.nextZ.prevZ=ne.prevZ)}function Wt(ne,$,G){this.i=ne,this.x=$,this.y=G,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}T.deviation=function(ne,$,G,Ae){var xe=$&&$.length,Se=xe?$[0]*G:ne.length,ve=Math.abs(sr(ne,0,Se,G));if(xe)for(var et=0,Yt=$.length;et<Yt;et++){var At=$[et]*G,ye=et<Yt-1?$[et+1]*G:ne.length;ve-=Math.abs(sr(ne,At,ye,G))}var be=0;for(et=0;et<Ae.length;et+=3){var Ue=Ae[et]*G,st=Ae[et+1]*G,Me=Ae[et+2]*G;be+=Math.abs((ne[Ue]-ne[Me])*(ne[st+1]-ne[Ue+1])-(ne[Ue]-ne[st])*(ne[Me+1]-ne[Ue+1]))}return ve===0&&be===0?0:Math.abs((be-ve)/ve)};function sr(ne,$,G,Ae){for(var xe=0,Se=$,ve=G-Ae;Se<G;Se+=Ae)xe+=(ne[ve]-ne[Se])*(ne[Se+1]+ne[ve+1]),ve=Se;return xe}T.flatten=function(ne){for(var $=ne[0][0].length,G={vertices:[],holes:[],dimensions:$},Ae=0,xe=0;xe<ne.length;xe++){for(var Se=0;Se<ne[xe].length;Se++)for(var ve=0;ve<$;ve++)G.vertices.push(ne[xe][Se][ve]);xe>0&&(Ae+=ne[xe-1].length,G.holes.push(Ae))}return G}},WFAs:function(Le,E){var i=Array.isArray;Le.exports=i},Wnft:function(Le,E,i){Le.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(Le,E,i){var T=i("juv8"),m=i("7GkX");function Z(z,o){return z&&T(o,m(o),z)}Le.exports=Z},XYm9:function(Le,E,i){var T=i("+K+b");function m(Z,z){var o=z?T(Z.buffer):Z.buffer;return new Z.constructor(o,Z.byteOffset,Z.byteLength)}Le.exports=m},"Xt/L":function(Le,E){function i(T,m,Z){for(var z=-1,o=T==null?0:T.length;++z<o;)if(Z(m,T[z]))return!0;return!1}Le.exports=i},Y8BV:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,Z){var z=Z.callback;return z&&(m.dataArray=m.dataArray.filter(z)),m}},YO3V:function(Le,E,i){var T=i("NykK"),m=i("LcsW"),Z=i("ExA7"),z="[object Object]",o=Function.prototype,W=Object.prototype,D=o.toString,Y=W.hasOwnProperty,q=D.call(Object);function he(X){if(!Z(X)||T(X)!=z)return!1;var je=m(X);if(je===null)return!0;var Ge=Y.call(je,"constructor")&&je.constructor;return typeof Ge=="function"&&Ge instanceof Ge&&D.call(Ge)==q}Le.exports=he},Yk9n:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),Z=i("GXnB"),z=i("Ztfv"),o=function(){function D(Y){this._cb=Y}return D.prototype.unwrap=function(){return this._cb()},D}();E.LazyServiceIdentifer=o;function W(D){return function(Y,q,he){if(D===void 0)throw new Error(T.UNDEFINED_INJECT_ANNOTATION(Y.name));var X=new Z.Metadata(m.INJECT_TAG,D);typeof he=="number"?z.tagParameter(Y,q,he,X):z.tagProperty(Y,q,X)}}E.inject=W},Z1HP:function(Le,E,i){var T=i("ycre"),m=i("quyA"),Z=i("q4HE");function z(o){return m(o)?Z(o):T(o)}Le.exports=z},ZCgT:function(Le,E,i){var T=i("tLB3"),m=1/0,Z=17976931348623157e292;function z(o){if(!o)return o===0?o:0;if(o=T(o),o===m||o===-m){var W=o<0?-1:1;return W*Z}return o===o?o:0}Le.exports=z},ZK94:function(Le,E){Le.exports.RADIUS=6378137,Le.exports.FLATTENING=1/298.257223563,Le.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Le,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return Z}),i.d(E,"copy",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"set",function(){return W}),i.d(E,"identity",function(){return D}),i.d(E,"transpose",function(){return Y}),i.d(E,"invert",function(){return q}),i.d(E,"adjoint",function(){return he}),i.d(E,"determinant",function(){return X}),i.d(E,"multiply",function(){return je}),i.d(E,"translate",function(){return Ge}),i.d(E,"scale",function(){return ge}),i.d(E,"rotate",function(){return Ce}),i.d(E,"rotateX",function(){return ht}),i.d(E,"rotateY",function(){return Ne}),i.d(E,"rotateZ",function(){return Et}),i.d(E,"fromTranslation",function(){return He}),i.d(E,"fromScaling",function(){return mt}),i.d(E,"fromRotation",function(){return Ye}),i.d(E,"fromXRotation",function(){return xt}),i.d(E,"fromYRotation",function(){return _t}),i.d(E,"fromZRotation",function(){return Ie}),i.d(E,"fromRotationTranslation",function(){return De}),i.d(E,"fromQuat2",function(){return ze}),i.d(E,"getTranslation",function(){return at}),i.d(E,"getScaling",function(){return Pe}),i.d(E,"getRotation",function(){return ot}),i.d(E,"fromRotationTranslationScale",function(){return Bt}),i.d(E,"fromRotationTranslationScaleOrigin",function(){return Wt}),i.d(E,"fromQuat",function(){return sr}),i.d(E,"frustum",function(){return ne}),i.d(E,"perspective",function(){return $}),i.d(E,"perspectiveFromFieldOfView",function(){return G}),i.d(E,"ortho",function(){return Ae}),i.d(E,"lookAt",function(){return xe}),i.d(E,"targetTo",function(){return Se}),i.d(E,"str",function(){return ve}),i.d(E,"frob",function(){return et}),i.d(E,"add",function(){return Yt}),i.d(E,"subtract",function(){return At}),i.d(E,"multiplyScalar",function(){return ye}),i.d(E,"multiplyScalarAndAdd",function(){return be}),i.d(E,"exactEquals",function(){return Ue}),i.d(E,"equals",function(){return st}),i.d(E,"mul",function(){return Me}),i.d(E,"sub",function(){return ft});var T=i("yU0y");function m(){var w=new T.a(16);return T.a!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w}function Z(w){var I=new T.a(16);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I[8]=w[8],I[9]=w[9],I[10]=w[10],I[11]=w[11],I[12]=w[12],I[13]=w[13],I[14]=w[14],I[15]=w[15],I}function z(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function o(w,I,J,ce,Be,Xe,gt,tt,It,K,Ze,te,Je,zt,cr,lt){var dt=new T.a(16);return dt[0]=w,dt[1]=I,dt[2]=J,dt[3]=ce,dt[4]=Be,dt[5]=Xe,dt[6]=gt,dt[7]=tt,dt[8]=It,dt[9]=K,dt[10]=Ze,dt[11]=te,dt[12]=Je,dt[13]=zt,dt[14]=cr,dt[15]=lt,dt}function W(w,I,J,ce,Be,Xe,gt,tt,It,K,Ze,te,Je,zt,cr,lt,dt){return w[0]=I,w[1]=J,w[2]=ce,w[3]=Be,w[4]=Xe,w[5]=gt,w[6]=tt,w[7]=It,w[8]=K,w[9]=Ze,w[10]=te,w[11]=Je,w[12]=zt,w[13]=cr,w[14]=lt,w[15]=dt,w}function D(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Y(w,I){if(w===I){var J=I[1],ce=I[2],Be=I[3],Xe=I[6],gt=I[7],tt=I[11];w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=J,w[6]=I[9],w[7]=I[13],w[8]=ce,w[9]=Xe,w[11]=I[14],w[12]=Be,w[13]=gt,w[14]=tt}else w[0]=I[0],w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=I[1],w[5]=I[5],w[6]=I[9],w[7]=I[13],w[8]=I[2],w[9]=I[6],w[10]=I[10],w[11]=I[14],w[12]=I[3],w[13]=I[7],w[14]=I[11],w[15]=I[15];return w}function q(w,I){var J=I[0],ce=I[1],Be=I[2],Xe=I[3],gt=I[4],tt=I[5],It=I[6],K=I[7],Ze=I[8],te=I[9],Je=I[10],zt=I[11],cr=I[12],lt=I[13],dt=I[14],Ct=I[15],pt=J*tt-ce*gt,we=J*It-Be*gt,ut=J*K-Xe*gt,Ke=ce*It-Be*tt,kt=ce*K-Xe*tt,yr=Be*K-Xe*It,Zr=Ze*lt-te*cr,hr=Ze*dt-Je*cr,jn=Ze*Ct-zt*cr,yn=te*dt-Je*lt,ta=te*Ct-zt*lt,ma=Je*Ct-zt*dt,Zn=pt*ma-we*ta+ut*yn+Ke*jn-kt*hr+yr*Zr;return Zn?(Zn=1/Zn,w[0]=(tt*ma-It*ta+K*yn)*Zn,w[1]=(Be*ta-ce*ma-Xe*yn)*Zn,w[2]=(lt*yr-dt*kt+Ct*Ke)*Zn,w[3]=(Je*kt-te*yr-zt*Ke)*Zn,w[4]=(It*jn-gt*ma-K*hr)*Zn,w[5]=(J*ma-Be*jn+Xe*hr)*Zn,w[6]=(dt*ut-cr*yr-Ct*we)*Zn,w[7]=(Ze*yr-Je*ut+zt*we)*Zn,w[8]=(gt*ta-tt*jn+K*Zr)*Zn,w[9]=(ce*jn-J*ta-Xe*Zr)*Zn,w[10]=(cr*kt-lt*ut+Ct*pt)*Zn,w[11]=(te*ut-Ze*kt-zt*pt)*Zn,w[12]=(tt*hr-gt*yn-It*Zr)*Zn,w[13]=(J*yn-ce*hr+Be*Zr)*Zn,w[14]=(lt*we-cr*Ke-dt*pt)*Zn,w[15]=(Ze*Ke-te*we+Je*pt)*Zn,w):null}function he(w,I){var J=I[0],ce=I[1],Be=I[2],Xe=I[3],gt=I[4],tt=I[5],It=I[6],K=I[7],Ze=I[8],te=I[9],Je=I[10],zt=I[11],cr=I[12],lt=I[13],dt=I[14],Ct=I[15];return w[0]=tt*(Je*Ct-zt*dt)-te*(It*Ct-K*dt)+lt*(It*zt-K*Je),w[1]=-(ce*(Je*Ct-zt*dt)-te*(Be*Ct-Xe*dt)+lt*(Be*zt-Xe*Je)),w[2]=ce*(It*Ct-K*dt)-tt*(Be*Ct-Xe*dt)+lt*(Be*K-Xe*It),w[3]=-(ce*(It*zt-K*Je)-tt*(Be*zt-Xe*Je)+te*(Be*K-Xe*It)),w[4]=-(gt*(Je*Ct-zt*dt)-Ze*(It*Ct-K*dt)+cr*(It*zt-K*Je)),w[5]=J*(Je*Ct-zt*dt)-Ze*(Be*Ct-Xe*dt)+cr*(Be*zt-Xe*Je),w[6]=-(J*(It*Ct-K*dt)-gt*(Be*Ct-Xe*dt)+cr*(Be*K-Xe*It)),w[7]=J*(It*zt-K*Je)-gt*(Be*zt-Xe*Je)+Ze*(Be*K-Xe*It),w[8]=gt*(te*Ct-zt*lt)-Ze*(tt*Ct-K*lt)+cr*(tt*zt-K*te),w[9]=-(J*(te*Ct-zt*lt)-Ze*(ce*Ct-Xe*lt)+cr*(ce*zt-Xe*te)),w[10]=J*(tt*Ct-K*lt)-gt*(ce*Ct-Xe*lt)+cr*(ce*K-Xe*tt),w[11]=-(J*(tt*zt-K*te)-gt*(ce*zt-Xe*te)+Ze*(ce*K-Xe*tt)),w[12]=-(gt*(te*dt-Je*lt)-Ze*(tt*dt-It*lt)+cr*(tt*Je-It*te)),w[13]=J*(te*dt-Je*lt)-Ze*(ce*dt-Be*lt)+cr*(ce*Je-Be*te),w[14]=-(J*(tt*dt-It*lt)-gt*(ce*dt-Be*lt)+cr*(ce*It-Be*tt)),w[15]=J*(tt*Je-It*te)-gt*(ce*Je-Be*te)+Ze*(ce*It-Be*tt),w}function X(w){var I=w[0],J=w[1],ce=w[2],Be=w[3],Xe=w[4],gt=w[5],tt=w[6],It=w[7],K=w[8],Ze=w[9],te=w[10],Je=w[11],zt=w[12],cr=w[13],lt=w[14],dt=w[15],Ct=I*gt-J*Xe,pt=I*tt-ce*Xe,we=I*It-Be*Xe,ut=J*tt-ce*gt,Ke=J*It-Be*gt,kt=ce*It-Be*tt,yr=K*cr-Ze*zt,Zr=K*lt-te*zt,hr=K*dt-Je*zt,jn=Ze*lt-te*cr,yn=Ze*dt-Je*cr,ta=te*dt-Je*lt;return Ct*ta-pt*yn+we*jn+ut*hr-Ke*Zr+kt*yr}function je(w,I,J){var ce=I[0],Be=I[1],Xe=I[2],gt=I[3],tt=I[4],It=I[5],K=I[6],Ze=I[7],te=I[8],Je=I[9],zt=I[10],cr=I[11],lt=I[12],dt=I[13],Ct=I[14],pt=I[15],we=J[0],ut=J[1],Ke=J[2],kt=J[3];return w[0]=we*ce+ut*tt+Ke*te+kt*lt,w[1]=we*Be+ut*It+Ke*Je+kt*dt,w[2]=we*Xe+ut*K+Ke*zt+kt*Ct,w[3]=we*gt+ut*Ze+Ke*cr+kt*pt,we=J[4],ut=J[5],Ke=J[6],kt=J[7],w[4]=we*ce+ut*tt+Ke*te+kt*lt,w[5]=we*Be+ut*It+Ke*Je+kt*dt,w[6]=we*Xe+ut*K+Ke*zt+kt*Ct,w[7]=we*gt+ut*Ze+Ke*cr+kt*pt,we=J[8],ut=J[9],Ke=J[10],kt=J[11],w[8]=we*ce+ut*tt+Ke*te+kt*lt,w[9]=we*Be+ut*It+Ke*Je+kt*dt,w[10]=we*Xe+ut*K+Ke*zt+kt*Ct,w[11]=we*gt+ut*Ze+Ke*cr+kt*pt,we=J[12],ut=J[13],Ke=J[14],kt=J[15],w[12]=we*ce+ut*tt+Ke*te+kt*lt,w[13]=we*Be+ut*It+Ke*Je+kt*dt,w[14]=we*Xe+ut*K+Ke*zt+kt*Ct,w[15]=we*gt+ut*Ze+Ke*cr+kt*pt,w}function Ge(w,I,J){var ce=J[0],Be=J[1],Xe=J[2],gt,tt,It,K,Ze,te,Je,zt,cr,lt,dt,Ct;return I===w?(w[12]=I[0]*ce+I[4]*Be+I[8]*Xe+I[12],w[13]=I[1]*ce+I[5]*Be+I[9]*Xe+I[13],w[14]=I[2]*ce+I[6]*Be+I[10]*Xe+I[14],w[15]=I[3]*ce+I[7]*Be+I[11]*Xe+I[15]):(gt=I[0],tt=I[1],It=I[2],K=I[3],Ze=I[4],te=I[5],Je=I[6],zt=I[7],cr=I[8],lt=I[9],dt=I[10],Ct=I[11],w[0]=gt,w[1]=tt,w[2]=It,w[3]=K,w[4]=Ze,w[5]=te,w[6]=Je,w[7]=zt,w[8]=cr,w[9]=lt,w[10]=dt,w[11]=Ct,w[12]=gt*ce+Ze*Be+cr*Xe+I[12],w[13]=tt*ce+te*Be+lt*Xe+I[13],w[14]=It*ce+Je*Be+dt*Xe+I[14],w[15]=K*ce+zt*Be+Ct*Xe+I[15]),w}function ge(w,I,J){var ce=J[0],Be=J[1],Xe=J[2];return w[0]=I[0]*ce,w[1]=I[1]*ce,w[2]=I[2]*ce,w[3]=I[3]*ce,w[4]=I[4]*Be,w[5]=I[5]*Be,w[6]=I[6]*Be,w[7]=I[7]*Be,w[8]=I[8]*Xe,w[9]=I[9]*Xe,w[10]=I[10]*Xe,w[11]=I[11]*Xe,w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function Ce(w,I,J,ce){var Be=ce[0],Xe=ce[1],gt=ce[2],tt=Math.hypot(Be,Xe,gt),It,K,Ze,te,Je,zt,cr,lt,dt,Ct,pt,we,ut,Ke,kt,yr,Zr,hr,jn,yn,ta,ma,Zn,Wn;return tt<T.b?null:(tt=1/tt,Be*=tt,Xe*=tt,gt*=tt,It=Math.sin(J),K=Math.cos(J),Ze=1-K,te=I[0],Je=I[1],zt=I[2],cr=I[3],lt=I[4],dt=I[5],Ct=I[6],pt=I[7],we=I[8],ut=I[9],Ke=I[10],kt=I[11],yr=Be*Be*Ze+K,Zr=Xe*Be*Ze+gt*It,hr=gt*Be*Ze-Xe*It,jn=Be*Xe*Ze-gt*It,yn=Xe*Xe*Ze+K,ta=gt*Xe*Ze+Be*It,ma=Be*gt*Ze+Xe*It,Zn=Xe*gt*Ze-Be*It,Wn=gt*gt*Ze+K,w[0]=te*yr+lt*Zr+we*hr,w[1]=Je*yr+dt*Zr+ut*hr,w[2]=zt*yr+Ct*Zr+Ke*hr,w[3]=cr*yr+pt*Zr+kt*hr,w[4]=te*jn+lt*yn+we*ta,w[5]=Je*jn+dt*yn+ut*ta,w[6]=zt*jn+Ct*yn+Ke*ta,w[7]=cr*jn+pt*yn+kt*ta,w[8]=te*ma+lt*Zn+we*Wn,w[9]=Je*ma+dt*Zn+ut*Wn,w[10]=zt*ma+Ct*Zn+Ke*Wn,w[11]=cr*ma+pt*Zn+kt*Wn,I!==w&&(w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w)}function ht(w,I,J){var ce=Math.sin(J),Be=Math.cos(J),Xe=I[4],gt=I[5],tt=I[6],It=I[7],K=I[8],Ze=I[9],te=I[10],Je=I[11];return I!==w&&(w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[4]=Xe*Be+K*ce,w[5]=gt*Be+Ze*ce,w[6]=tt*Be+te*ce,w[7]=It*Be+Je*ce,w[8]=K*Be-Xe*ce,w[9]=Ze*Be-gt*ce,w[10]=te*Be-tt*ce,w[11]=Je*Be-It*ce,w}function Ne(w,I,J){var ce=Math.sin(J),Be=Math.cos(J),Xe=I[0],gt=I[1],tt=I[2],It=I[3],K=I[8],Ze=I[9],te=I[10],Je=I[11];return I!==w&&(w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=Xe*Be-K*ce,w[1]=gt*Be-Ze*ce,w[2]=tt*Be-te*ce,w[3]=It*Be-Je*ce,w[8]=Xe*ce+K*Be,w[9]=gt*ce+Ze*Be,w[10]=tt*ce+te*Be,w[11]=It*ce+Je*Be,w}function Et(w,I,J){var ce=Math.sin(J),Be=Math.cos(J),Xe=I[0],gt=I[1],tt=I[2],It=I[3],K=I[4],Ze=I[5],te=I[6],Je=I[7];return I!==w&&(w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=Xe*Be+K*ce,w[1]=gt*Be+Ze*ce,w[2]=tt*Be+te*ce,w[3]=It*Be+Je*ce,w[4]=K*Be-Xe*ce,w[5]=Ze*Be-gt*ce,w[6]=te*Be-tt*ce,w[7]=Je*Be-It*ce,w}function He(w,I){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=I[0],w[13]=I[1],w[14]=I[2],w[15]=1,w}function mt(w,I){return w[0]=I[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=I[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Ye(w,I,J){var ce=J[0],Be=J[1],Xe=J[2],gt=Math.hypot(ce,Be,Xe),tt,It,K;return gt<T.b?null:(gt=1/gt,ce*=gt,Be*=gt,Xe*=gt,tt=Math.sin(I),It=Math.cos(I),K=1-It,w[0]=ce*ce*K+It,w[1]=Be*ce*K+Xe*tt,w[2]=Xe*ce*K-Be*tt,w[3]=0,w[4]=ce*Be*K-Xe*tt,w[5]=Be*Be*K+It,w[6]=Xe*Be*K+ce*tt,w[7]=0,w[8]=ce*Xe*K+Be*tt,w[9]=Be*Xe*K-ce*tt,w[10]=Xe*Xe*K+It,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)}function xt(w,I){var J=Math.sin(I),ce=Math.cos(I);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ce,w[6]=J,w[7]=0,w[8]=0,w[9]=-J,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function _t(w,I){var J=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=0,w[2]=-J,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=J,w[9]=0,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Ie(w,I){var J=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=J,w[2]=0,w[3]=0,w[4]=-J,w[5]=ce,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function De(w,I,J){var ce=I[0],Be=I[1],Xe=I[2],gt=I[3],tt=ce+ce,It=Be+Be,K=Xe+Xe,Ze=ce*tt,te=ce*It,Je=ce*K,zt=Be*It,cr=Be*K,lt=Xe*K,dt=gt*tt,Ct=gt*It,pt=gt*K;return w[0]=1-(zt+lt),w[1]=te+pt,w[2]=Je-Ct,w[3]=0,w[4]=te-pt,w[5]=1-(Ze+lt),w[6]=cr+dt,w[7]=0,w[8]=Je+Ct,w[9]=cr-dt,w[10]=1-(Ze+zt),w[11]=0,w[12]=J[0],w[13]=J[1],w[14]=J[2],w[15]=1,w}function ze(w,I){var J=new T.a(3),ce=-I[0],Be=-I[1],Xe=-I[2],gt=I[3],tt=I[4],It=I[5],K=I[6],Ze=I[7],te=ce*ce+Be*Be+Xe*Xe+gt*gt;return te>0?(J[0]=(tt*gt+Ze*ce+It*Xe-K*Be)*2/te,J[1]=(It*gt+Ze*Be+K*ce-tt*Xe)*2/te,J[2]=(K*gt+Ze*Xe+tt*Be-It*ce)*2/te):(J[0]=(tt*gt+Ze*ce+It*Xe-K*Be)*2,J[1]=(It*gt+Ze*Be+K*ce-tt*Xe)*2,J[2]=(K*gt+Ze*Xe+tt*Be-It*ce)*2),De(w,I,J),w}function at(w,I){return w[0]=I[12],w[1]=I[13],w[2]=I[14],w}function Pe(w,I){var J=I[0],ce=I[1],Be=I[2],Xe=I[4],gt=I[5],tt=I[6],It=I[8],K=I[9],Ze=I[10];return w[0]=Math.hypot(J,ce,Be),w[1]=Math.hypot(Xe,gt,tt),w[2]=Math.hypot(It,K,Ze),w}function ot(w,I){var J=new T.a(3);Pe(J,I);var ce=1/J[0],Be=1/J[1],Xe=1/J[2],gt=I[0]*ce,tt=I[1]*Be,It=I[2]*Xe,K=I[4]*ce,Ze=I[5]*Be,te=I[6]*Xe,Je=I[8]*ce,zt=I[9]*Be,cr=I[10]*Xe,lt=gt+Ze+cr,dt=0;return lt>0?(dt=Math.sqrt(lt+1)*2,w[3]=.25*dt,w[0]=(te-zt)/dt,w[1]=(Je-It)/dt,w[2]=(tt-K)/dt):gt>Ze&&gt>cr?(dt=Math.sqrt(1+gt-Ze-cr)*2,w[3]=(te-zt)/dt,w[0]=.25*dt,w[1]=(tt+K)/dt,w[2]=(Je+It)/dt):Ze>cr?(dt=Math.sqrt(1+Ze-gt-cr)*2,w[3]=(Je-It)/dt,w[0]=(tt+K)/dt,w[1]=.25*dt,w[2]=(te+zt)/dt):(dt=Math.sqrt(1+cr-gt-Ze)*2,w[3]=(tt-K)/dt,w[0]=(Je+It)/dt,w[1]=(te+zt)/dt,w[2]=.25*dt),w}function Bt(w,I,J,ce){var Be=I[0],Xe=I[1],gt=I[2],tt=I[3],It=Be+Be,K=Xe+Xe,Ze=gt+gt,te=Be*It,Je=Be*K,zt=Be*Ze,cr=Xe*K,lt=Xe*Ze,dt=gt*Ze,Ct=tt*It,pt=tt*K,we=tt*Ze,ut=ce[0],Ke=ce[1],kt=ce[2];return w[0]=(1-(cr+dt))*ut,w[1]=(Je+we)*ut,w[2]=(zt-pt)*ut,w[3]=0,w[4]=(Je-we)*Ke,w[5]=(1-(te+dt))*Ke,w[6]=(lt+Ct)*Ke,w[7]=0,w[8]=(zt+pt)*kt,w[9]=(lt-Ct)*kt,w[10]=(1-(te+cr))*kt,w[11]=0,w[12]=J[0],w[13]=J[1],w[14]=J[2],w[15]=1,w}function Wt(w,I,J,ce,Be){var Xe=I[0],gt=I[1],tt=I[2],It=I[3],K=Xe+Xe,Ze=gt+gt,te=tt+tt,Je=Xe*K,zt=Xe*Ze,cr=Xe*te,lt=gt*Ze,dt=gt*te,Ct=tt*te,pt=It*K,we=It*Ze,ut=It*te,Ke=ce[0],kt=ce[1],yr=ce[2],Zr=Be[0],hr=Be[1],jn=Be[2],yn=(1-(lt+Ct))*Ke,ta=(zt+ut)*Ke,ma=(cr-we)*Ke,Zn=(zt-ut)*kt,Wn=(1-(Je+Ct))*kt,F=(dt+pt)*kt,H=(cr+we)*yr,ue=(dt-pt)*yr,pe=(1-(Je+lt))*yr;return w[0]=yn,w[1]=ta,w[2]=ma,w[3]=0,w[4]=Zn,w[5]=Wn,w[6]=F,w[7]=0,w[8]=H,w[9]=ue,w[10]=pe,w[11]=0,w[12]=J[0]+Zr-(yn*Zr+Zn*hr+H*jn),w[13]=J[1]+hr-(ta*Zr+Wn*hr+ue*jn),w[14]=J[2]+jn-(ma*Zr+F*hr+pe*jn),w[15]=1,w}function sr(w,I){var J=I[0],ce=I[1],Be=I[2],Xe=I[3],gt=J+J,tt=ce+ce,It=Be+Be,K=J*gt,Ze=ce*gt,te=ce*tt,Je=Be*gt,zt=Be*tt,cr=Be*It,lt=Xe*gt,dt=Xe*tt,Ct=Xe*It;return w[0]=1-te-cr,w[1]=Ze+Ct,w[2]=Je-dt,w[3]=0,w[4]=Ze-Ct,w[5]=1-K-cr,w[6]=zt+lt,w[7]=0,w[8]=Je+dt,w[9]=zt-lt,w[10]=1-K-te,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function ne(w,I,J,ce,Be,Xe,gt){var tt=1/(J-I),It=1/(Be-ce),K=1/(Xe-gt);return w[0]=Xe*2*tt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Xe*2*It,w[6]=0,w[7]=0,w[8]=(J+I)*tt,w[9]=(Be+ce)*It,w[10]=(gt+Xe)*K,w[11]=-1,w[12]=0,w[13]=0,w[14]=gt*Xe*2*K,w[15]=0,w}function $(w,I,J,ce,Be){var Xe=1/Math.tan(I/2),gt;return w[0]=Xe/J,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Xe,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,Be!=null&&Be!==Infinity?(gt=1/(ce-Be),w[10]=(Be+ce)*gt,w[14]=2*Be*ce*gt):(w[10]=-1,w[14]=-2*ce),w}function G(w,I,J,ce){var Be=Math.tan(I.upDegrees*Math.PI/180),Xe=Math.tan(I.downDegrees*Math.PI/180),gt=Math.tan(I.leftDegrees*Math.PI/180),tt=Math.tan(I.rightDegrees*Math.PI/180),It=2/(gt+tt),K=2/(Be+Xe);return w[0]=It,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=K,w[6]=0,w[7]=0,w[8]=-((gt-tt)*It*.5),w[9]=(Be-Xe)*K*.5,w[10]=ce/(J-ce),w[11]=-1,w[12]=0,w[13]=0,w[14]=ce*J/(J-ce),w[15]=0,w}function Ae(w,I,J,ce,Be,Xe,gt){var tt=1/(I-J),It=1/(ce-Be),K=1/(Xe-gt);return w[0]=-2*tt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*It,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*K,w[11]=0,w[12]=(I+J)*tt,w[13]=(Be+ce)*It,w[14]=(gt+Xe)*K,w[15]=1,w}function xe(w,I,J,ce){var Be,Xe,gt,tt,It,K,Ze,te,Je,zt,cr=I[0],lt=I[1],dt=I[2],Ct=ce[0],pt=ce[1],we=ce[2],ut=J[0],Ke=J[1],kt=J[2];return Math.abs(cr-ut)<T.b&&Math.abs(lt-Ke)<T.b&&Math.abs(dt-kt)<T.b?D(w):(Ze=cr-ut,te=lt-Ke,Je=dt-kt,zt=1/Math.hypot(Ze,te,Je),Ze*=zt,te*=zt,Je*=zt,Be=pt*Je-we*te,Xe=we*Ze-Ct*Je,gt=Ct*te-pt*Ze,zt=Math.hypot(Be,Xe,gt),zt?(zt=1/zt,Be*=zt,Xe*=zt,gt*=zt):(Be=0,Xe=0,gt=0),tt=te*gt-Je*Xe,It=Je*Be-Ze*gt,K=Ze*Xe-te*Be,zt=Math.hypot(tt,It,K),zt?(zt=1/zt,tt*=zt,It*=zt,K*=zt):(tt=0,It=0,K=0),w[0]=Be,w[1]=tt,w[2]=Ze,w[3]=0,w[4]=Xe,w[5]=It,w[6]=te,w[7]=0,w[8]=gt,w[9]=K,w[10]=Je,w[11]=0,w[12]=-(Be*cr+Xe*lt+gt*dt),w[13]=-(tt*cr+It*lt+K*dt),w[14]=-(Ze*cr+te*lt+Je*dt),w[15]=1,w)}function Se(w,I,J,ce){var Be=I[0],Xe=I[1],gt=I[2],tt=ce[0],It=ce[1],K=ce[2],Ze=Be-J[0],te=Xe-J[1],Je=gt-J[2],zt=Ze*Ze+te*te+Je*Je;zt>0&&(zt=1/Math.sqrt(zt),Ze*=zt,te*=zt,Je*=zt);var cr=It*Je-K*te,lt=K*Ze-tt*Je,dt=tt*te-It*Ze;return zt=cr*cr+lt*lt+dt*dt,zt>0&&(zt=1/Math.sqrt(zt),cr*=zt,lt*=zt,dt*=zt),w[0]=cr,w[1]=lt,w[2]=dt,w[3]=0,w[4]=te*dt-Je*lt,w[5]=Je*cr-Ze*dt,w[6]=Ze*lt-te*cr,w[7]=0,w[8]=Ze,w[9]=te,w[10]=Je,w[11]=0,w[12]=Be,w[13]=Xe,w[14]=gt,w[15]=1,w}function ve(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"}function et(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])}function Yt(w,I,J){return w[0]=I[0]+J[0],w[1]=I[1]+J[1],w[2]=I[2]+J[2],w[3]=I[3]+J[3],w[4]=I[4]+J[4],w[5]=I[5]+J[5],w[6]=I[6]+J[6],w[7]=I[7]+J[7],w[8]=I[8]+J[8],w[9]=I[9]+J[9],w[10]=I[10]+J[10],w[11]=I[11]+J[11],w[12]=I[12]+J[12],w[13]=I[13]+J[13],w[14]=I[14]+J[14],w[15]=I[15]+J[15],w}function At(w,I,J){return w[0]=I[0]-J[0],w[1]=I[1]-J[1],w[2]=I[2]-J[2],w[3]=I[3]-J[3],w[4]=I[4]-J[4],w[5]=I[5]-J[5],w[6]=I[6]-J[6],w[7]=I[7]-J[7],w[8]=I[8]-J[8],w[9]=I[9]-J[9],w[10]=I[10]-J[10],w[11]=I[11]-J[11],w[12]=I[12]-J[12],w[13]=I[13]-J[13],w[14]=I[14]-J[14],w[15]=I[15]-J[15],w}function ye(w,I,J){return w[0]=I[0]*J,w[1]=I[1]*J,w[2]=I[2]*J,w[3]=I[3]*J,w[4]=I[4]*J,w[5]=I[5]*J,w[6]=I[6]*J,w[7]=I[7]*J,w[8]=I[8]*J,w[9]=I[9]*J,w[10]=I[10]*J,w[11]=I[11]*J,w[12]=I[12]*J,w[13]=I[13]*J,w[14]=I[14]*J,w[15]=I[15]*J,w}function be(w,I,J,ce){return w[0]=I[0]+J[0]*ce,w[1]=I[1]+J[1]*ce,w[2]=I[2]+J[2]*ce,w[3]=I[3]+J[3]*ce,w[4]=I[4]+J[4]*ce,w[5]=I[5]+J[5]*ce,w[6]=I[6]+J[6]*ce,w[7]=I[7]+J[7]*ce,w[8]=I[8]+J[8]*ce,w[9]=I[9]+J[9]*ce,w[10]=I[10]+J[10]*ce,w[11]=I[11]+J[11]*ce,w[12]=I[12]+J[12]*ce,w[13]=I[13]+J[13]*ce,w[14]=I[14]+J[14]*ce,w[15]=I[15]+J[15]*ce,w}function Ue(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]&&w[8]===I[8]&&w[9]===I[9]&&w[10]===I[10]&&w[11]===I[11]&&w[12]===I[12]&&w[13]===I[13]&&w[14]===I[14]&&w[15]===I[15]}function st(w,I){var J=w[0],ce=w[1],Be=w[2],Xe=w[3],gt=w[4],tt=w[5],It=w[6],K=w[7],Ze=w[8],te=w[9],Je=w[10],zt=w[11],cr=w[12],lt=w[13],dt=w[14],Ct=w[15],pt=I[0],we=I[1],ut=I[2],Ke=I[3],kt=I[4],yr=I[5],Zr=I[6],hr=I[7],jn=I[8],yn=I[9],ta=I[10],ma=I[11],Zn=I[12],Wn=I[13],F=I[14],H=I[15];return Math.abs(J-pt)<=T.b*Math.max(1,Math.abs(J),Math.abs(pt))&&Math.abs(ce-we)<=T.b*Math.max(1,Math.abs(ce),Math.abs(we))&&Math.abs(Be-ut)<=T.b*Math.max(1,Math.abs(Be),Math.abs(ut))&&Math.abs(Xe-Ke)<=T.b*Math.max(1,Math.abs(Xe),Math.abs(Ke))&&Math.abs(gt-kt)<=T.b*Math.max(1,Math.abs(gt),Math.abs(kt))&&Math.abs(tt-yr)<=T.b*Math.max(1,Math.abs(tt),Math.abs(yr))&&Math.abs(It-Zr)<=T.b*Math.max(1,Math.abs(It),Math.abs(Zr))&&Math.abs(K-hr)<=T.b*Math.max(1,Math.abs(K),Math.abs(hr))&&Math.abs(Ze-jn)<=T.b*Math.max(1,Math.abs(Ze),Math.abs(jn))&&Math.abs(te-yn)<=T.b*Math.max(1,Math.abs(te),Math.abs(yn))&&Math.abs(Je-ta)<=T.b*Math.max(1,Math.abs(Je),Math.abs(ta))&&Math.abs(zt-ma)<=T.b*Math.max(1,Math.abs(zt),Math.abs(ma))&&Math.abs(cr-Zn)<=T.b*Math.max(1,Math.abs(cr),Math.abs(Zn))&&Math.abs(lt-Wn)<=T.b*Math.max(1,Math.abs(lt),Math.abs(Wn))&&Math.abs(dt-F)<=T.b*Math.max(1,Math.abs(dt),Math.abs(F))&&Math.abs(Ct-H)<=T.b*Math.max(1,Math.abs(Ct),Math.abs(H))}var Me=je,ft=At},Ztfv:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function Z(q,he,X,je){var Ge=m.TAGGED;o(Ge,q,he,je,X)}E.tagParameter=Z;function z(q,he,X){var je=m.TAGGED_PROP;o(je,q.constructor,he,X)}E.tagProperty=z;function o(q,he,X,je,Ge){var ge={},Ce=typeof Ge=="number",ht=Ge!==void 0&&Ce?Ge.toString():X;if(Ce&&X!==void 0)throw new Error(T.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(q,he)&&(ge=Reflect.getMetadata(q,he));var Ne=ge[ht];if(!Array.isArray(Ne))Ne=[];else for(var Et=0,He=Ne;Et<He.length;Et++){var mt=He[Et];if(mt.key===je.key)throw new Error(T.DUPLICATED_METADATA+" "+mt.key.toString())}Ne.push(je),ge[ht]=Ne,Reflect.defineMetadata(q,ge,he)}function W(q,he){Reflect.decorate(q,he)}function D(q,he){return function(X,je){he(X,je,q)}}function Y(q,he,X){typeof X=="number"?W([D(X,q)],he):typeof X=="string"?Reflect.decorate([q],he,X):W([q],he)}E.decorate=Y},ZxFD:function(Le,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return Z}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return W}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return Y}),i.d(E,"multiply",function(){return q}),i.d(E,"divide",function(){return he}),i.d(E,"ceil",function(){return X}),i.d(E,"floor",function(){return je}),i.d(E,"min",function(){return Ge}),i.d(E,"max",function(){return ge}),i.d(E,"round",function(){return Ce}),i.d(E,"scale",function(){return ht}),i.d(E,"scaleAndAdd",function(){return Ne}),i.d(E,"distance",function(){return Et}),i.d(E,"squaredDistance",function(){return He}),i.d(E,"length",function(){return mt}),i.d(E,"squaredLength",function(){return Ye}),i.d(E,"negate",function(){return xt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ie}),i.d(E,"dot",function(){return De}),i.d(E,"cross",function(){return ze}),i.d(E,"lerp",function(){return at}),i.d(E,"random",function(){return Pe}),i.d(E,"transformMat2",function(){return ot}),i.d(E,"transformMat2d",function(){return Bt}),i.d(E,"transformMat3",function(){return Wt}),i.d(E,"transformMat4",function(){return sr}),i.d(E,"rotate",function(){return ne}),i.d(E,"angle",function(){return $}),i.d(E,"zero",function(){return G}),i.d(E,"str",function(){return Ae}),i.d(E,"exactEquals",function(){return xe}),i.d(E,"equals",function(){return Se}),i.d(E,"len",function(){return ve}),i.d(E,"sub",function(){return et}),i.d(E,"mul",function(){return Yt}),i.d(E,"div",function(){return At}),i.d(E,"dist",function(){return ye}),i.d(E,"sqrDist",function(){return be}),i.d(E,"sqrLen",function(){return Ue}),i.d(E,"forEach",function(){return st});var T=i("yU0y");function m(){var Me=new T.a(2);return T.a!=Float32Array&&(Me[0]=0,Me[1]=0),Me}function Z(Me){var ft=new T.a(2);return ft[0]=Me[0],ft[1]=Me[1],ft}function z(Me,ft){var w=new T.a(2);return w[0]=Me,w[1]=ft,w}function o(Me,ft){return Me[0]=ft[0],Me[1]=ft[1],Me}function W(Me,ft,w){return Me[0]=ft,Me[1]=w,Me}function D(Me,ft,w){return Me[0]=ft[0]+w[0],Me[1]=ft[1]+w[1],Me}function Y(Me,ft,w){return Me[0]=ft[0]-w[0],Me[1]=ft[1]-w[1],Me}function q(Me,ft,w){return Me[0]=ft[0]*w[0],Me[1]=ft[1]*w[1],Me}function he(Me,ft,w){return Me[0]=ft[0]/w[0],Me[1]=ft[1]/w[1],Me}function X(Me,ft){return Me[0]=Math.ceil(ft[0]),Me[1]=Math.ceil(ft[1]),Me}function je(Me,ft){return Me[0]=Math.floor(ft[0]),Me[1]=Math.floor(ft[1]),Me}function Ge(Me,ft,w){return Me[0]=Math.min(ft[0],w[0]),Me[1]=Math.min(ft[1],w[1]),Me}function ge(Me,ft,w){return Me[0]=Math.max(ft[0],w[0]),Me[1]=Math.max(ft[1],w[1]),Me}function Ce(Me,ft){return Me[0]=Math.round(ft[0]),Me[1]=Math.round(ft[1]),Me}function ht(Me,ft,w){return Me[0]=ft[0]*w,Me[1]=ft[1]*w,Me}function Ne(Me,ft,w,I){return Me[0]=ft[0]+w[0]*I,Me[1]=ft[1]+w[1]*I,Me}function Et(Me,ft){var w=ft[0]-Me[0],I=ft[1]-Me[1];return Math.hypot(w,I)}function He(Me,ft){var w=ft[0]-Me[0],I=ft[1]-Me[1];return w*w+I*I}function mt(Me){var ft=Me[0],w=Me[1];return Math.hypot(ft,w)}function Ye(Me){var ft=Me[0],w=Me[1];return ft*ft+w*w}function xt(Me,ft){return Me[0]=-ft[0],Me[1]=-ft[1],Me}function _t(Me,ft){return Me[0]=1/ft[0],Me[1]=1/ft[1],Me}function Ie(Me,ft){var w=ft[0],I=ft[1],J=w*w+I*I;return J>0&&(J=1/Math.sqrt(J)),Me[0]=ft[0]*J,Me[1]=ft[1]*J,Me}function De(Me,ft){return Me[0]*ft[0]+Me[1]*ft[1]}function ze(Me,ft,w){var I=ft[0]*w[1]-ft[1]*w[0];return Me[0]=Me[1]=0,Me[2]=I,Me}function at(Me,ft,w,I){var J=ft[0],ce=ft[1];return Me[0]=J+I*(w[0]-J),Me[1]=ce+I*(w[1]-ce),Me}function Pe(Me,ft){ft=ft||1;var w=T.c()*2*Math.PI;return Me[0]=Math.cos(w)*ft,Me[1]=Math.sin(w)*ft,Me}function ot(Me,ft,w){var I=ft[0],J=ft[1];return Me[0]=w[0]*I+w[2]*J,Me[1]=w[1]*I+w[3]*J,Me}function Bt(Me,ft,w){var I=ft[0],J=ft[1];return Me[0]=w[0]*I+w[2]*J+w[4],Me[1]=w[1]*I+w[3]*J+w[5],Me}function Wt(Me,ft,w){var I=ft[0],J=ft[1];return Me[0]=w[0]*I+w[3]*J+w[6],Me[1]=w[1]*I+w[4]*J+w[7],Me}function sr(Me,ft,w){var I=ft[0],J=ft[1];return Me[0]=w[0]*I+w[4]*J+w[12],Me[1]=w[1]*I+w[5]*J+w[13],Me}function ne(Me,ft,w,I){var J=ft[0]-w[0],ce=ft[1]-w[1],Be=Math.sin(I),Xe=Math.cos(I);return Me[0]=J*Xe-ce*Be+w[0],Me[1]=J*Be+ce*Xe+w[1],Me}function $(Me,ft){var w=Me[0],I=Me[1],J=ft[0],ce=ft[1],Be=Math.sqrt(w*w+I*I)*Math.sqrt(J*J+ce*ce),Xe=Be&&(w*J+I*ce)/Be;return Math.acos(Math.min(Math.max(Xe,-1),1))}function G(Me){return Me[0]=0,Me[1]=0,Me}function Ae(Me){return"vec2("+Me[0]+", "+Me[1]+")"}function xe(Me,ft){return Me[0]===ft[0]&&Me[1]===ft[1]}function Se(Me,ft){var w=Me[0],I=Me[1],J=ft[0],ce=ft[1];return Math.abs(w-J)<=T.b*Math.max(1,Math.abs(w),Math.abs(J))&&Math.abs(I-ce)<=T.b*Math.max(1,Math.abs(I),Math.abs(ce))}var ve=mt,et=Y,Yt=q,At=he,ye=Et,be=He,Ue=Ye,st=function(){var Me=m();return function(ft,w,I,J,ce,Be){var Xe,gt;for(w||(w=2),I||(I=0),J?gt=Math.min(J*w+I,ft.length):gt=ft.length,Xe=I;Xe<gt;Xe+=w)Me[0]=ft[Xe],Me[1]=ft[Xe+1],ce(Me,Me,Be),ft[Xe]=Me[0],ft[Xe+1]=Me[1];return ft}}()},ZzCi:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=i("Ztfv");function z(o){return function(W,D,Y){var q=new m.Metadata(T.NAMED_TAG,o);typeof Y=="number"?Z.tagParameter(W,D,Y,q):Z.tagProperty(W,D,q)}}E.named=z},a5Wf:function(Le,E,i){"use strict";i.r(E);var T=i("IzEo"),m=i("bx4M"),Z=i("14J3"),z=i("BMrR"),o=i("jCWc"),W=i("kPKH"),D=i("fWQN"),Y=i("mtLc"),q=i("yKVA"),he=i("879j"),X=i("aHsQ"),je=i("sGsY"),Ge=i("9kvl"),ge=i("q1tI"),Ce=i.n(ge),ht=i("HTcj"),Ne=i("ZhIB"),Et=i.n(Ne),He=i("yP6+"),mt=i("0Owb");function Ye(b){var p=b.style;p.height="100%";var c=parseInt("".concat(getComputedStyle(b).height),10),d=parseInt("".concat(getComputedStyle(b).paddingTop),10)+parseInt("".concat(getComputedStyle(b).paddingBottom),10);return c-d}function xt(b){if(!b)return 0;var p=b,c=Ye(p),d=p.parentNode;return d&&(c=Ye(d)),c}function _t(){return function(b){var p=function(c){Object(q.a)(v,c);var d=Object(he.a)(v);function v(){var L;Object(D.a)(this,v);for(var j=arguments.length,se=new Array(j),oe=0;oe<j;oe++)se[oe]=arguments[oe];return L=d.call.apply(d,[this].concat(se)),L.state={computedHeight:0},L.root=null,L.handleRoot=function(le){L.root=le},L}return Object(Y.a)(v,[{key:"componentDidMount",value:function(){var j=this.props.height;if(!j&&this.root){var se=xt(this.root);this.setState({computedHeight:se}),se<1&&(se=xt(this.root),this.setState({computedHeight:se}))}}},{key:"render",value:function(){var j=this.props.height,se=this.state.computedHeight,oe=j||se;return Ce.a.createElement("div",{ref:this.handleRoot},oe>0&&Ce.a.createElement(b,Object(mt.a)({},this.props,{height:oe})))}}]),v}(Ce.a.Component);return p}}var Ie=_t,De=He.Guide.Arc,ze=He.Guide.Html,at=He.Guide.Line,Pe=function(p){switch(p){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};He.Shape.registerShape&&He.Shape.registerShape("point","pointer",{drawShape:function(p,c){var d=p.points[0];d=this.parsePoint(d);var v=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:v.x,y1:v.y,x2:d.x,y2:d.y,stroke:p.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:v.x,y:v.y,r:6,stroke:p.color,lineWidth:3,fill:"#fff"}})}});var ot=function(p){var c=p.title,d=p.height,v=d===void 0?1:d,L=p.percent,j=p.forceFit,se=j===void 0?!0:j,oe=p.formatter,le=oe===void 0?Pe:oe,Tt=p.color,Xt=Tt===void 0?"#2F9CFF":Tt,Kt=p.bgColor,tr=Kt===void 0?"#F0F2F5":Kt,Cr={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},Fr=[{value:L/10}],ln=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((Fr[0].value*10).toFixed(2),`%
    </div>
  </div>`)},hn={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Ce.a.createElement(He.Chart,{height:v,data:Fr,scale:Cr,padding:[-16,0,16,0],forceFit:se},Ce.a.createElement(He.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Ce.a.createElement(He.Axis,{name:"1",line:void 0}),Ce.a.createElement(He.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:le,textStyle:hn}}),Ce.a.createElement(He.Guide,null,Ce.a.createElement(at,{start:[3,.905],end:[3,.85],lineStyle:{stroke:Xt,lineDash:void 0,lineWidth:2}}),Ce.a.createElement(at,{start:[5,.905],end:[5,.85],lineStyle:{stroke:Xt,lineDash:void 0,lineWidth:3}}),Ce.a.createElement(at,{start:[7,.905],end:[7,.85],lineStyle:{stroke:Xt,lineDash:void 0,lineWidth:3}}),Ce.a.createElement(De,{start:[0,.965],end:[10,.965],style:{stroke:tr,lineWidth:10}}),Ce.a.createElement(De,{start:[0,.965],end:[Fr[0].value,.965],style:{stroke:Xt,lineWidth:10}}),Ce.a.createElement(ze,{position:["50%","95%"],html:ln()})),Ce.a.createElement(He.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:Xt,active:!1}))},Bt=Ie()(ot),Wt=i("k1fw"),sr=i("iz+Y"),ne=i.n(sr),$=function(p){var c=p.height,d=c===void 0?1:c,v=p.data,L=v===void 0?[]:v,j=p.forceFit,se=j===void 0?!0:j,oe=p.color,le=oe===void 0?"rgba(24, 144, 255, 0.2)":oe,Tt=p.borderColor,Xt=Tt===void 0?"#1089ff":Tt,Kt=p.scale,tr=Kt===void 0?{x:{},y:{}}:Kt,Cr=p.borderWidth,Fr=Cr===void 0?2:Cr,ln=p.line,hn=p.xAxis,$n=p.yAxis,sa=p.animate,fa=sa===void 0?!0:sa,ja=[36,5,30,5],_a={x:Object(Wt.a)({type:"cat",range:[0,1]},tr.x),y:Object(Wt.a)({min:0},tr.y)},ii=["x*y",function(io,Ca){return{name:io,value:Ca}}],Ka=d+54;return Ce.a.createElement("div",{className:ne.a.miniChart,style:{height:d}},Ce.a.createElement("div",{className:ne.a.chartContent},d>0&&Ce.a.createElement(He.Chart,{animate:fa,scale:_a,height:Ka,forceFit:se,data:L,padding:ja},Ce.a.createElement(He.Axis,Object(mt.a)({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},hn)),Ce.a.createElement(He.Axis,Object(mt.a)({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},$n)),Ce.a.createElement(He.Tooltip,{showTitle:!1,crosshairs:!1}),Ce.a.createElement(He.Geom,{type:"area",position:"x*y",color:le,tooltip:ii,shape:"smooth",style:{fillOpacity:1}}),ln?Ce.a.createElement(He.Geom,{type:"line",position:"x*y",shape:"smooth",color:Xt,size:Fr,tooltip:!1}):Ce.a.createElement("span",{style:{display:"none"}}))))},G=Ie()($),Ae=i("/zsF"),xe=i("PArb"),Se=i("jrin"),ve=i("cQSq"),et=i.n(ve),Yt=i("9/5/"),At=i.n(Yt),ye=i("Jssm"),be=i.n(ye),Ue=i("TSYQ"),st=i.n(Ue),Me=i("d9mD"),ft=i.n(Me),w=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){var d;Object(D.a)(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.state={legendData:[],legendBlock:!1},d.chart=void 0,d.root=void 0,d.requestRef=0,d.resize=At()(function(){var se=d.props.hasLegend,oe=d.state.legendBlock;if(!se||!d.root){window.removeEventListener("resize",d.resize);return}d.root&&d.root.parentNode&&d.root.parentNode.clientWidth<=380?oe||d.setState({legendBlock:!0}):oe&&d.setState({legendBlock:!1})},300),d.getG2Instance=function(se){d.chart=se,requestAnimationFrame(function(){d.getLegendData(),d.resize()})},d.getLegendData=function(){if(!d.chart)return;var se=d.chart.getAllGeoms()[0];if(!se)return;var oe=se.get("dataArray")||[],le=oe.map(function(Tt){var Xt=Tt[0]._origin;return Xt.color=Tt[0].color,Xt.checked=!0,Xt});d.setState({legendData:le})},d.handleRoot=function(se){d.root=se},d.handleLegendClick=function(se,oe){var le=se;le.checked=!le.checked;var Tt=d.state.legendData;Tt[oe]=le;var Xt=Tt.filter(function(Kt){return Kt.checked}).map(function(Kt){return Kt.x});d.chart&&d.chart.filter("x",function(Kt){return Xt.indexOf("".concat(Kt))>-1}),d.setState({legendData:Tt})},d}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){var v=this;window.addEventListener("resize",function(){v.requestRef=requestAnimationFrame(function(){return v.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(v){var L=this.props.data;L!==v.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var v,L=this,j=this.props,se=j.valueFormat,oe=j.subTitle,le=j.total,Tt=j.hasLegend,Xt=Tt===void 0?!1:Tt,Kt=j.className,tr=j.style,Cr=j.height,Fr=Cr===void 0?0:Cr,ln=j.forceFit,hn=ln===void 0?!0:ln,$n=j.percent,sa=j.color,fa=j.inner,ja=fa===void 0?.75:fa,_a=j.animate,ii=_a===void 0?!0:_a,Ka=j.colors,io=j.lineWidth,Ca=io===void 0?1:io,Ba=this.state,ac=Ba.legendData,ic=Ba.legendBlock,lu=st()(ft.a.pie,Kt,(v={},Object(Se.a)(v,ft.a.hasLegend,!!Xt),Object(Se.a)(v,ft.a.legendBlock,ic),v)),Cl=this.props,nh=Cl.data,jc=Cl.selected,wl=jc===void 0?!0:jc,js=Cl.tooltip,kf=js===void 0?!0:js,oo=nh||[],wu=wl,Uu=kf,jf=Ka;oo=oo||[],wu=wu||!0,Uu=Uu||!0;var lo,fl={x:{type:"cat",range:[0,1]},y:{min:0}};($n||$n===0)&&(wu=!1,Uu=!1,lo=function(ch){return ch==="\u5360\u6BD4"?sa||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},oo=[{x:"\u5360\u6BD4",y:parseFloat("".concat($n))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat($n))}]);var zf=["x*percent",function(xc,ch){return{name:xc,value:"".concat((ch*100).toFixed(2),"%")}}],zc=[12,0,12,0],Gh=new ve.DataView;return Gh.source(oo).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Ce.a.createElement("div",{ref:this.handleRoot,className:lu,style:tr},Ce.a.createElement(be.a,{maxFontSize:25},Ce.a.createElement("div",{className:ft.a.chart},Ce.a.createElement(He.Chart,{scale:fl,height:Fr,forceFit:hn,data:Gh,padding:zc,animate:ii,onGetG2Instance:this.getG2Instance},!!Uu&&Ce.a.createElement(He.Tooltip,{showTitle:!1}),Ce.a.createElement(He.Coord,{type:"theta",innerRadius:ja}),Ce.a.createElement(He.Geom,{style:{lineWidth:Ca,stroke:"#fff"},tooltip:Uu?zf:void 0,type:"intervalStack",position:"percent",color:["x",$n||$n===0?lo:jf],selected:wu})),(oe||le)&&Ce.a.createElement("div",{className:ft.a.total},oe&&Ce.a.createElement("h4",{className:"pie-sub-title"},oe),le&&Ce.a.createElement("div",{className:"pie-stat"},typeof le=="function"?le():le)))),Xt&&Ce.a.createElement("ul",{className:ft.a.legend},ac.map(function(xc,ch){return Ce.a.createElement("li",{key:xc.x,onClick:function(){return L.handleLegendClick(xc,ch)}},Ce.a.createElement("span",{className:ft.a.dot,style:{backgroundColor:xc.checked?xc.color:"#aaa"}}),Ce.a.createElement("span",{className:ft.a.legendTitle},xc.x),Ce.a.createElement(xe.a,{type:"vertical"}),Ce.a.createElement("span",{className:ft.a.percent},"".concat((Number.isNaN(xc.percent)?0:xc.percent*100).toFixed(2),"%")),Ce.a.createElement("span",{className:ft.a.value},se?se(xc.y):xc.y))})))}}]),c}(ge.Component),I=Ie()(w),J=i("tJVT"),ce=i("1XEM"),Be=i.n(ce),Xe="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",gt=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){var d;Object(D.a)(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.state={dv:null,height:0,width:0},d.requestRef=0,d.isUnmount=!1,d.root=void 0,d.imageMask=void 0,d.resize=function(){d.requestRef=requestAnimationFrame(function(){d.renderChart(d.props)})},d.saveRootRef=function(se){d.root=se},d.initTagCloud=function(){function se(oe){return Object(Wt.a)(Object(Wt.a)({},oe.style),{},{fillOpacity:oe.opacity,fontSize:oe.origin._origin.size,rotate:oe.origin._origin.rotate,text:oe.origin._origin.text,textAlign:"center",fontFamily:oe.origin._origin.font,fill:oe.color,textBaseline:"Alphabetic"})}He.Shape.registerShape("point","cloud",{drawShape:function(le,Tt){var Xt=se(le);return Tt.addShape("text",{attrs:Object(Wt.a)(Object(Wt.a)({},Xt),{},{x:le.x,y:le.y})})}})},d.renderChart=At()(function(se){var oe=se||d.props,le=oe.data,Tt=oe.height;if(le.length<1||!d.root)return;var Xt=Tt,Kt=d.root.offsetWidth,tr=function(){var Fr=new et.a.View().source(le),ln=Fr.range("value"),hn=Object(J.a)(ln,2),$n=hn[0],sa=hn[1];if(Fr.transform({type:"tag-cloud",fields:["name","value"],imageMask:d.imageMask,font:"Verdana",size:[Kt,Xt],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(ja){var _a=Math.pow((ja.value-$n)/(sa-$n),2);return _a*(17.5-5)+5}}),d.isUnmount)return;d.setState({dv:Fr,width:Kt,height:Xt})};d.imageMask?tr():(d.imageMask=new Image,d.imageMask.crossOrigin="",d.imageMask.src=Xe,d.imageMask.onload=tr)},200),d}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){var v=this;requestAnimationFrame(function(){v.initTagCloud(),v.renderChart(v.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(v){var L=this.props.data;v&&JSON.stringify(v.data)!==JSON.stringify(L)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var v=this.props,L=v.className,j=v.height,se=this.state,oe=se.dv,le=se.width,Tt=se.height;return Ce.a.createElement("div",{className:st()(Be.a.tagCloud,L),style:{width:"100%",height:j},ref:this.saveRootRef},oe&&Ce.a.createElement(He.Chart,{width:le,height:Tt,data:oe,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},Ce.a.createElement(He.Tooltip,{showTitle:!1}),Ce.a.createElement(He.Coord,{reflect:"y"}),Ce.a.createElement(He.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Kt,tr){return{name:Kt,value:tr}}]})))}}]),c}(ge.Component),tt=Ie()(gt),It=i("CIdX"),K=i.n(It),Ze=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){var d;Object(D.a)(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.state={radio:1},d.timer=0,d.root=null,d.node=null,d.resize=function(){if(d.root){var se=d.props.height,oe=se===void 0?1:se,le=d.root.parentNode,Tt=le.offsetWidth;d.setState({radio:Tt<oe?Tt/oe:1})}},d}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){var v=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return v.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(v){var L=this.props.percent;v.percent!==L&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(v){var L=this.props,j=L.percent,se=L.color,oe=se===void 0?"#1890FF":se,le=j/100,Tt=this;if(cancelAnimationFrame(this.timer),!this.node||le!==0&&!le)return;var Xt=this.node,Kt=Xt.getContext("2d");if(!Kt)return;var tr=Xt.width,Cr=Xt.height,Fr=tr/2,ln=2,hn=Fr-ln;Kt.beginPath(),Kt.lineWidth=ln*2;for(var $n=tr-ln,sa=$n/8,fa=.2,ja=fa,_a=ln,ii=0,Ka=0,io=.005,Ca=[],Ba=Fr-ln,ac=-(Math.PI/2),ic=!0,lu=ac;lu<ac+2*Math.PI;lu+=1/(8*Math.PI))Ca.push([Fr+Ba*Math.cos(lu),Fr+Ba*Math.sin(lu)]);var Cl=Ca.shift();Kt.strokeStyle=oe,Kt.moveTo(Cl[0],Cl[1]);function nh(){if(!Kt)return;Kt.beginPath(),Kt.save();for(var wl=[],js=_a;js<=_a+$n;js+=20/$n){var kf=ii+(_a+js)/sa,oo=Math.sin(kf)*ja,wu=js,Uu=2*hn*(1-Ka)+(Fr-hn)-sa*oo;Kt.lineTo(wu,Uu),wl.push([wu,Uu])}var jf=wl.shift();Kt.lineTo(_a+$n,Cr),Kt.lineTo(_a,Cr),Kt.lineTo(jf[0],jf[1]);var lo=Kt.createLinearGradient(0,0,0,Cr);lo.addColorStop(0,"#ffffff"),lo.addColorStop(1,oe),Kt.fillStyle=lo,Kt.fill(),Kt.restore()}function jc(){if(!Kt)return;if(Kt.clearRect(0,0,tr,Cr),ic&&v!=="update")if(Ca.length){var wl=Ca.shift();Kt.lineTo(wl[0],wl[1]),Kt.stroke()}else ic=!1,Kt.lineTo(Cl[0],Cl[1]),Kt.stroke(),Ca=[],Kt.globalCompositeOperation="destination-over",Kt.beginPath(),Kt.lineWidth=ln,Kt.arc(Fr,Fr,Ba,0,2*Math.PI,!0),Kt.beginPath(),Kt.save(),Kt.arc(Fr,Fr,Fr-3*ln,0,2*Math.PI,!0),Kt.restore(),Kt.clip(),Kt.fillStyle=oe;else{if(le>=.85){if(ja>fa/4){var js=fa*.01;ja-=js}}else if(le<=.1){if(ja<fa*1.5){var kf=fa*.01;ja+=kf}}else{if(ja<=fa){var oo=fa*.01;ja+=oo}if(ja>=fa){var wu=fa*.01;ja-=wu}}le-Ka>0&&(Ka+=io),le-Ka<0&&(Ka-=io),ii+=.07,nh()}Tt.timer=requestAnimationFrame(jc)}jc()}},{key:"render",value:function(){var v=this,L=this.state.radio,j=this.props,se=j.percent,oe=j.title,le=j.height,Tt=le===void 0?1:le;return Ce.a.createElement("div",{className:K.a.waterWave,ref:function(Kt){return v.root=Kt},style:{transform:"scale(".concat(L,")")}},Ce.a.createElement("div",{style:{width:Tt,height:Tt,overflow:"hidden"}},Ce.a.createElement("canvas",{className:K.a.waterWaveCanvasWrapper,ref:function(Kt){return v.node=Kt},width:Tt*2,height:Tt*2})),Ce.a.createElement("div",{className:K.a.text,style:{width:Tt}},oe&&Ce.a.createElement("span",null,oe),Ce.a.createElement("h4",null,se,"%")))}}]),c}(ge.Component),te=Ie()(Ze),Je=i("WmNS"),zt=i.n(Je),cr=i("9og8"),lt=Object(ge.createContext)({});function dt(){return Object(ge.useContext)(lt)}var Ct=i("8ml+"),pt=i("lwsE"),we=i.n(pt),ut=i("W8MJ"),Ke=i.n(ut),kt=i("7W2i"),yr=i.n(kt),Zr=i("a1gu"),hr=i.n(Zr),jn=i("Nsbk"),yn=i.n(jn),ta=i("lSNA"),ma=i.n(ta),Zn=i("yG8O"),Wn=i.n(Zn),F=i("U+yc"),H=i.n(F),ue=i("1ABj"),pe=i("h1nZ"),rt,yt,Ve,ct,er,rr;function jr(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function nn(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?jr(Object(c),!0).forEach(function(d){ma()(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):jr(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}var ur=(rt=Object(pe.lazyInject)(pe.TYPES.ILogService),yt=Object(pe.lazyInject)(pe.TYPES.IGlobalConfigService),Ve=(rr=function(){function b(p){we()(this,b),Wn()(this,"logger",ct,this),Wn()(this,"configService",er,this),this.config=void 0,this.config=p}return Ke()(b,[{key:"setContainer",value:function(c,d){c.bind(pe.TYPES.MapConfig).toConstantValue(nn(nn({},this.config),{},{id:d})),c.bind(pe.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),b}(),rr),ct=H()(Ve.prototype,"logger",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),er=H()(Ve.prototype,"configService",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve),Wr=i("o0o1"),Tn=i.n(Wr),mr=i("QILm"),Jr=i.n(mr),vn=i("yXPU"),Kn=i.n(vn),_n=i("hi0z"),Hr=i.n(_n),oa=i("Hel2"),Mr=i("IOcx"),va=i("4cb6"),ha={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},da=i("J4zp"),Ki=i.n(da),Fi=Math.PI/180,xa=function(){function b(){we()(this,b),this.projectionMatrix=Mr.b.create(),this.viewMatrix=Mr.b.create(),this.viewProjectionMatrix=Mr.b.create(),this.ViewProjectionMatrixUncentered=Mr.b.create(),this.viewUncenteredMatrix=Mr.b.create(),this.zoom=void 0,this.center=void 0}return Ke()(b,[{key:"syncWithMapCamera",value:function(c){var d=c.zoom,v=d===void 0?1:d,L=c.pitch,j=L===void 0?0:L,se=c.bearing,oe=se===void 0?0:se,le=c.center,Tt=le===void 0?[0,0]:le,Xt=c.offsetOrigin,Kt=Xt===void 0?[0,0]:Xt,tr=c.cameraHeight,Cr=tr===void 0?1:tr,Fr=c.aspect,ln=Fr===void 0?1:Fr,hn=c.near,$n=hn===void 0?.1:hn,sa=c.far,fa=sa===void 0?1e3:sa,ja=c.fov,_a=ja===void 0?0:ja;this.zoom=v,this.center=Tt;var ii=j*Fi,Ka=(360-oe)*Fi;Mr.b.perspective(this.projectionMatrix,_a,ln,$n,fa);var io=Mr.d.fromValues(Cr*Math.sin(ii)*Math.sin(Ka),-Cr*Math.sin(ii)*Math.cos(Ka),Cr*Math.cos(ii)),Ca=Mr.d.fromValues(-Math.cos(ii)*Math.sin(Ka),Math.cos(ii)*Math.cos(Ka),Math.sin(ii));Mr.b.lookAt(this.viewMatrix,io,Mr.d.fromValues(0,0,0),Ca),this.viewUncenteredMatrix=Mr.b.clone(this.viewMatrix),Mr.b.translate(this.viewMatrix,this.viewMatrix,Mr.d.fromValues(-Kt[0],Kt[1],0)),Mr.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Mr.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=Ki()(this.center,2),d=c[0],v=c[1];return[d,v]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){var v=85.0511287798,L=Math.max(Math.min(v,c[1]),-v),j=256<<20,se=Math.PI/180,oe=c[0]*se,le=L*se;le=Math.log(Math.tan(Math.PI/4+le/2));var Tt=.5/Math.PI,Xt=.5,Kt=-.5/Math.PI;return se=.5,oe=j*(Tt*oe+Xt)-215440491,le=-(j*(Kt*le+se)-106744817),[oe,le]}}]),b}(),di,Ga,In,Oi,$i,Ti,Io,fu,hu,pa,ws,po,Za,Pu;function Mi(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function _i(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Mi(Object(c),!0).forEach(function(d){ma()(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Mi(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}i("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var _o=0;window.forceWebGL=!0;var as="15cd8a57710d40c9b7c0e3cc120f1200",So="1.4.15",Ol="amap-script",Os=!1,so=[],du=12,Ft=(di=Object(va.injectable)(),Ga=Object(va.inject)(pe.TYPES.IGlobalConfigService),In=Object(va.inject)(pe.TYPES.ILogService),Oi=Object(va.inject)(pe.TYPES.MapConfig),$i=Object(va.inject)(pe.TYPES.ICoordinateSystemService),Ti=Object(va.inject)(pe.TYPES.IEventEmitter),di(Io=(fu=(Pu=function(){function b(){var p=this;we()(this,b),this.map=void 0,Wn()(this,"configService",hu,this),Wn()(this,"logger",pa,this),Wn()(this,"config",ws,this),Wn()(this,"coordinateSystemService",po,this),Wn()(this,"eventEmitter",Za,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var d=c.camera,v=d.fov,L=d.near,j=d.far,se=d.height,oe=d.pitch,le=d.rotation,Tt=d.aspect,Xt=d.position,Kt=p.getCenter(),tr=Kt.lng,Cr=Kt.lat;p.cameraChangedCallback&&(p.viewport.syncWithMapCamera({aspect:Tt,bearing:360-le,far:j,fov:v,cameraHeight:se,near:L,pitch:oe,zoom:p.map.getZoom()-1,center:[tr,Cr],offsetOrigin:[Xt.x,Xt.y]}),p.viewport.getZoom()>du?p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.P20_OFFSET):p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.P20),p.cameraChangedCallback(p.viewport))}}return Ke()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var d=c.getElementsByClassName("amap-maps")[0];this.markerContainer=oa.a.create("div","l7-marker-container",d)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(c,d)}},{key:"off",value:function(c,d){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,d):this.map.off(c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),d=c.getNorthEast(),v=c.getSouthWest(),L=this.getCenter(),j=L.lng>d.getLng()||L.lng<v.getLng()?180-d.getLng():d.getLng(),se=L.lng<v.getLng()?v.getLng()-180:v.getLng();return[[se,v.getLat()],[j,d.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,d){this.map.setZoomAndCenter(c,d)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var d=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:d.getLng(),lat:d.getLat()}}},{key:"lngLatToPixel",value:function(c){var d=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:d.getX(),y:d.getY()}}},{key:"containerToLngLat",value:function(c){var d=new AMap.Pixel(c[0],c[1]),v=this.map.containerToLngLat(d);return{lng:v==null?void 0:v.getLng(),lat:v==null?void 0:v.getLat()}}},{key:"lngLatToContainer",value:function(c){var d=new AMap.LngLat(c[0],c[1]),v=this.map.lngLatToContainer(d);return{x:v.getX(),y:v.getY()}}},{key:"lngLatToMercator",value:function(c,d){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,d,v){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},se=this.viewport.projectFlat(c),oe=Mr.b.create();return Mr.b.translate(oe,oe,Mr.d.fromValues(se[0],se[1],d)),Mr.b.scale(oe,oe,Mr.d.fromValues(L[0],L[1],L[2])),Mr.b.rotateX(oe,oe,v[0]),Mr.b.rotateY(oe,oe,v[1]),Mr.b.rotateZ(oe,oe,v[2]),oe}},{key:"init",value:function(){var p=Kn()(Tn.a.mark(function d(){var v=this,L,j,se,oe,le,Tt,Xt,Kt,tr,Cr,Fr,ln,hn,$n;return Tn.a.wrap(function(fa){for(;;)switch(fa.prev=fa.next){case 0:return L=this.config,j=L.id,se=L.style,oe=se===void 0?"light":se,le=L.minZoom,Tt=le===void 0?0:le,Xt=L.maxZoom,Kt=Xt===void 0?18:Xt,tr=L.token,Cr=tr===void 0?as:tr,Fr=L.mapInstance,ln=L.plugin,hn=ln===void 0?[]:ln,$n=Jr()(L,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),fa.next=3,new Promise(function(ja){var _a=function(){if(Fr)v.map=Fr,v.$mapContainer=v.map.getContainer(),setTimeout(function(){v.map.on("camerachange",v.handleCameraChanged),ja()},30);else{v.$mapContainer=v.creatAmapContainer(j);var Ka=new AMap.Map(v.$mapContainer,_i({mapStyle:v.getMapStyle(oe),zooms:[Tt,Kt],viewMode:"3D"},$n));Ka.on("camerachange",v.handleCameraChanged),v.map=Ka,setTimeout(function(){ja()},10)}};!Os&&!Fr?(Cr===as&&v.logger.warn(v.configService.getSceneWarninfo("MapToken")),Os=!0,hn.push("Map3D"),Hr.a.load({key:Cr,version:So,plugins:hn}).then(function(ii){_a(),so.length&&(so.forEach(function(Ka){return Ka()}),so=[])}).catch(function(ii){throw new Error(ii)})):Os&&window.AMap||Fr?_a():so.push(_a)});case 3:this.viewport=new xa;case 4:case"end":return fa.stop()}},d,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var d,v=(d=this.getContainer())===null||d===void 0?void 0:d.getElementsByClassName("amap-layer")[0],L=c==="jpg"?v==null?void 0:v.toDataURL("image/jpeg"):v==null?void 0:v.toDataURL("image/png");return L}},{key:"emit",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).emit.apply(d,[c].concat(L))}},{key:"once",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).once.apply(d,[c].concat(L))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(Ol);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return ha[c]?ha[c]:c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var v=document.createElement("div");return v.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,v.id="l7_amap_div"+_o++,d.appendChild(v),v}}]),b}(),Pu),hu=H()(fu.prototype,"configService",[Ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pa=H()(fu.prototype,"logger",[In],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=H()(fu.prototype,"config",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),po=H()(fu.prototype,"coordinateSystemService",[$i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Za=H()(fu.prototype,"eventEmitter",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fu))||Io);function Re(b){var p=Mt();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Mt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var dr=function(b){yr()(c,b);var p=Re(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"getServiceConstructor",value:function(){return Ft}}]),c}(ur);function en(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function xn(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?en(Object(c),!0).forEach(function(d){zn(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):en(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}function zn(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function Gi(b,p){return Ml(b)||nl(b,p)||Do(b,p)||mo()}function mo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Do(b,p){if(!b)return;if(typeof b=="string")return To(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return To(b,p)}function To(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function nl(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function Ml(b){if(Array.isArray(b))return b}var eu=Ce.a.memo(function(b){var p=b.style,c=b.className,d=b.map,v=b.option,L=b.onSceneLoaded,j=Object(ge.createRef)(),se=Object(ge.useState)(),oe=Gi(se,2),le=oe[0],Tt=oe[1];return Object(ge.useEffect)(function(){var Xt=new Ct.Scene(xn(xn({id:j.current},v),{},{map:new dr(d)}));return Xt.on("loaded",function(){Tt(Xt),L&&L(Xt)}),function(){Xt.destroy()}},[]),Object(ge.useEffect)(function(){le&&d.style&&le.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(ge.useEffect)(function(){le&&d.zoom&&le.setZoom(d.zoom)},[d.zoom]),Object(ge.useEffect)(function(){le&&d.center&&le.setCenter(d.center)},[JSON.stringify(d.center)]),Object(ge.useEffect)(function(){le&&d.pitch&&le.setPitch(d.pitch)},[d.pitch]),Object(ge.useEffect)(function(){le&&d.rotation&&le.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(lt.Provider,{value:le},Object(ge.createElement)("div",{ref:j,style:p,className:c},le&&b.children))}),uf=eu,bs=i("4ZJM"),Vu=i.n(bs),tu=i("1OyB"),Ao=i("vuIU"),is=i("md7G"),Gu=i("foSv"),al=i("Ji7U"),Ms=i("JX7q"),$a=i("ODXe"),Hu=i("bl9R");function Wu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function il(b,p){var c=Hu.transformMat4([],p,b);return Hu.scale(c,c,1/c[3]),c}function sc(b,p){var c=b%p;return c<0?p+c:c}function wt(b,p,c){return c*p+(1-c)*b}var qt=i("ZaHm"),wr=i("ZxFD"),Xn=i("n+fv");function Xa(b,p){if(!b)throw new Error(p||"viewport-mercator-project: assertion failed.")}var ni=Math.PI,to=ni/4,Sa=ni/180,Ii=180/ni,qo=512,gi=4003e4,os=1.5;function ru(b){return Math.pow(2,b)}function pu(b){return Math.log2(b)}function ss(b,p){var c=Object($a.a)(b,2),d=c[0],v=c[1];Xa(Number.isFinite(d)&&Number.isFinite(p)),Xa(Number.isFinite(v)&&v>=-90&&v<=90,"invalid latitude"),p*=qo;var L=d*Sa,j=v*Sa,se=p*(L+ni)/(2*ni),oe=p*(ni-Math.log(Math.tan(to+j*.5)))/(2*ni);return[se,oe]}function Zu(b,p){var c=Object($a.a)(b,2),d=c[0],v=c[1];p*=qo;var L=d/p*(2*ni)-ni,j=2*(Math.atan(Math.exp(ni-v/p*(2*ni)))-to);return[L*Ii,j*Ii]}function mu(b){var p=b.latitude;Xa(Number.isFinite(p));var c=Math.cos(p*Sa);return pu(gi*c)-9}function ol(b){var p=b.latitude,c=b.longitude,d=b.zoom,v=b.scale,L=b.highPrecision,j=L===void 0?!1:L;v=v!==void 0?v:ru(d),Xa(Number.isFinite(p)&&Number.isFinite(c)&&Number.isFinite(v));var se={},oe=qo*v,le=Math.cos(p*Sa),Tt=oe/360,Xt=Tt/le,Kt=oe/gi/le;if(se.pixelsPerMeter=[Kt,-Kt,Kt],se.metersPerPixel=[1/Kt,-1/Kt,1/Kt],se.pixelsPerDegree=[Tt,-Xt,Kt],se.degreesPerPixel=[1/Tt,-1/Xt,1/Kt],j){var tr=Sa*Math.tan(p*Sa)/le,Cr=Tt*tr/2,Fr=oe/gi*tr,ln=Fr/Xt*Kt;se.pixelsPerDegree2=[0,-Cr,Fr],se.pixelsPerMeter2=[ln,0,ln]}return se}function Lu(b,p){var c=Object($a.a)(b,3),d=c[0],v=c[1],L=c[2],j=Object($a.a)(p,3),se=j[0],oe=j[1],le=j[2],Tt=1,Xt=ol({longitude:d,latitude:v,scale:Tt,highPrecision:!0}),Kt=Xt.pixelsPerMeter,tr=Xt.pixelsPerMeter2,Cr=ss(b,Tt);Cr[0]+=se*(Kt[0]+tr[0]*oe),Cr[1]+=oe*(Kt[1]+tr[1]*oe);var Fr=Zu(Cr,Tt),ln=(L||0)+(le||0);return Number.isFinite(L)||Number.isFinite(le)?[Fr[0],Fr[1],ln]:Fr}function Xu(b){var p=b.height,c=b.pitch,d=b.bearing,v=b.altitude,L=b.center,j=L===void 0?null:L,se=b.flipY,oe=se===void 0?!1:se,le=Wu();return qt.translate(le,le,[0,0,-v]),qt.scale(le,le,[1,1,1/p]),qt.rotateX(le,le,-c*Sa),qt.rotateZ(le,le,d*Sa),oe&&qt.scale(le,le,[1,-1,1]),j&&qt.translate(le,le,Xn.negate([],j)),le}function uc(b){var p=b.width,c=b.height,d=b.altitude,v=d===void 0?os:d,L=b.pitch,j=L===void 0?0:L,se=b.nearZMultiplier,oe=se===void 0?1:se,le=b.farZMultiplier,Tt=le===void 0?1:le,Xt=j*Sa,Kt=Math.atan(.5/v),tr=Math.sin(Kt)*v/Math.sin(Math.PI/2-Xt-Kt),Cr=Math.cos(Math.PI/2-Xt)*tr+v;return{fov:2*Math.atan(c/2/v),aspect:p/c,focalDistance:v,near:oe,far:Cr*Tt}}function lf(b){var p=b.width,c=b.height,d=b.pitch,v=b.altitude,L=b.nearZMultiplier,j=b.farZMultiplier,se=uc({width:p,height:c,altitude:v,pitch:d,nearZMultiplier:L,farZMultiplier:j}),oe=se.fov,le=se.aspect,Tt=se.near,Xt=se.far,Kt=qt.perspective([],oe,le,Tt,Xt);return Kt}function Ec(b,p){var c=Object($a.a)(b,3),d=c[0],v=c[1],L=c[2],j=L===void 0?0:L;return Xa(Number.isFinite(d)&&Number.isFinite(v)&&Number.isFinite(j)),il(p,[d,v,j,1])}function Hi(b,p){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=Object($a.a)(b,3),v=d[0],L=d[1],j=d[2];if(Xa(Number.isFinite(v)&&Number.isFinite(L),"invalid pixel coordinate"),Number.isFinite(j)){var se=il(p,[v,L,j,1]);return se}var oe=il(p,[v,L,0,1]),le=il(p,[v,L,1,1]),Tt=oe[2],Xt=le[2],Kt=Tt===Xt?0:((c||0)-Tt)/(Xt-Tt);return wr.lerp([],oe,le,Kt)}var Vc=Wu(),Gc=function(){function b(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=p.width,d=p.height,v=p.viewMatrix,L=v===void 0?Vc:v,j=p.projectionMatrix,se=j===void 0?Vc:j;Object(tu.a)(this,b),this.width=c||1,this.height=d||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=L,this.projectionMatrix=se;var oe=Wu();qt.multiply(oe,oe,this.projectionMatrix),qt.multiply(oe,oe,this.viewMatrix),this.viewProjectionMatrix=oe;var le=Wu();qt.scale(le,le,[this.width/2,-this.height/2,1]),qt.translate(le,le,[1,-1,0]),qt.multiply(le,le,this.viewProjectionMatrix);var Tt=qt.invert(Wu(),le);if(!Tt)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=le,this.pixelUnprojectionMatrix=Tt,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(Ao.a)(b,[{key:"equals",value:function(c){return c instanceof b?c.width===this.width&&c.height===this.height&&qt.equals(c.projectionMatrix,this.projectionMatrix)&&qt.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=d.topLeft,L=v===void 0?!0:v,j=this.projectPosition(c),se=Ec(j,this.pixelProjectionMatrix),oe=Object($a.a)(se,2),le=oe[0],Tt=oe[1],Xt=L?Tt:this.height-Tt;return c.length===2?[le,Xt]:[le,Xt,se[2]]}},{key:"unproject",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=d.topLeft,L=v===void 0?!0:v,j=d.targetZ,se=Object($a.a)(c,3),oe=se[0],le=se[1],Tt=se[2],Xt=L?le:this.height-le,Kt=j&&j*this.pixelsPerMeter,tr=Hi([oe,Xt,Tt],this.pixelUnprojectionMatrix,Kt),Cr=this.unprojectPosition(tr),Fr=Object($a.a)(Cr,3),ln=Fr[0],hn=Fr[1],$n=Fr[2];return Number.isFinite(Tt)?[ln,hn,$n]:Number.isFinite(j)?[ln,hn,j]:[ln,hn]}},{key:"projectPosition",value:function(c){var d=this.projectFlat(c),v=Object($a.a)(d,2),L=v[0],j=v[1],se=(c[2]||0)*this.pixelsPerMeter;return[L,j,se]}},{key:"unprojectPosition",value:function(c){var d=this.unprojectFlat(c),v=Object($a.a)(d,2),L=v[0],j=v[1],se=(c[2]||0)/this.pixelsPerMeter;return[L,j,se]}},{key:"projectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),b}();function Tf(b){var p=b.width,c=b.height,d=b.bounds,v=b.minExtent,L=v===void 0?0:v,j=b.maxZoom,se=j===void 0?24:j,oe=b.padding,le=oe===void 0?0:oe,Tt=b.offset,Xt=Tt===void 0?[0,0]:Tt,Kt=Object($a.a)(d,2),tr=Object($a.a)(Kt[0],2),Cr=tr[0],Fr=tr[1],ln=Object($a.a)(Kt[1],2),hn=ln[0],$n=ln[1];if(Number.isFinite(le)){var sa=le;le={top:sa,bottom:sa,left:sa,right:sa}}else Xa(Number.isFinite(le.top)&&Number.isFinite(le.bottom)&&Number.isFinite(le.left)&&Number.isFinite(le.right));var fa=new Hc({width:p,height:c,longitude:0,latitude:0,zoom:0}),ja=fa.project([Cr,$n]),_a=fa.project([hn,Fr]),ii=[Math.max(Math.abs(_a[0]-ja[0]),L),Math.max(Math.abs(_a[1]-ja[1]),L)],Ka=[p-le.left-le.right-Math.abs(Xt[0])*2,c-le.top-le.bottom-Math.abs(Xt[1])*2];Xa(Ka[0]>0&&Ka[1]>0);var io=Ka[0]/ii[0],Ca=Ka[1]/ii[1],Ba=(le.right-le.left)/2/io,ac=(le.bottom-le.top)/2/Ca,ic=[(_a[0]+ja[0])/2+Ba,(_a[1]+ja[1])/2+ac],lu=fa.unproject(ic),Cl=fa.zoom+Math.log2(Math.abs(Math.min(io,Ca)));return{longitude:lu[0],latitude:lu[1],zoom:Math.min(Cl,se)}}var Hc=function(b){Object(al.a)(p,b);function p(){var c,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=d.width,L=d.height,j=d.latitude,se=j===void 0?0:j,oe=d.longitude,le=oe===void 0?0:oe,Tt=d.zoom,Xt=Tt===void 0?0:Tt,Kt=d.pitch,tr=Kt===void 0?0:Kt,Cr=d.bearing,Fr=Cr===void 0?0:Cr,ln=d.altitude,hn=ln===void 0?1.5:ln,$n=d.nearZMultiplier,sa=d.farZMultiplier;Object(tu.a)(this,p),v=v||1,L=L||1;var fa=ru(Xt);hn=Math.max(.75,hn);var ja=ss([le,se],fa);ja[2]=0;var _a=lf({width:v,height:L,pitch:tr,bearing:Fr,altitude:hn,nearZMultiplier:$n||1/L,farZMultiplier:sa||1.01}),ii=Xu({height:L,center:ja,pitch:tr,bearing:Fr,altitude:hn,flipY:!0});return c=Object(is.a)(this,Object(Gu.a)(p).call(this,{width:v,height:L,viewMatrix:ii,projectionMatrix:_a})),c.latitude=se,c.longitude=le,c.zoom=Xt,c.pitch=tr,c.bearing=Fr,c.altitude=hn,c.scale=fa,c.center=ja,c.pixelsPerMeter=ol(Object(Ms.a)(Object(Ms.a)(c))).pixelsPerMeter[2],Object.freeze(Object(Ms.a)(Object(Ms.a)(c))),c}return Object(Ao.a)(p,[{key:"projectFlat",value:function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return ss(d,v)}},{key:"unprojectFlat",value:function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Zu(d,v)}},{key:"getMapCenterByLngLatPosition",value:function(d){var v=d.lngLat,L=d.pos,j=Hi(L,this.pixelUnprojectionMatrix),se=ss(v,this.scale),oe=wr.add([],se,wr.negate([],j)),le=wr.add([],this.center,oe);return Zu(le,this.scale)}},{key:"getLocationAtPoint",value:function(d){var v=d.lngLat,L=d.pos;return this.getMapCenterByLngLatPosition({lngLat:v,pos:L})}},{key:"fitBounds",value:function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=this.width,j=this.height,se=Tf(Object.assign({width:L,height:j,bounds:d},v)),oe=se.longitude,le=se.latitude,Tt=se.zoom;return new p({width:L,height:j,longitude:oe,latitude:le,zoom:Tt})}}]),p}(Gc),_f=function(){function b(){we()(this,b),this.viewport=void 0}return Ke()(b,[{key:"syncWithMapCamera",value:function(c){var d=c.center,v=c.zoom,L=c.pitch,j=c.bearing,se=c.viewportHeight,oe=c.viewportWidth;this.viewport=new Hc({width:oe,height:se,longitude:d&&d[0],latitude:d&&d[1],zoom:v,pitch:L,bearing:j})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),b}(),Pi={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Ru,Pl,nu,Wc,lc,vu,Zc,Fs,au,Ll,Tc,yi,cc,Uf;function fc(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function Bf(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?fc(Object(c),!0).forEach(function(d){ma()(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):fc(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Vu.a;var _c={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Rl=0,pl=12,Ps="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",hc=(Ru=Object(va.injectable)(),Pl=Object(va.inject)(pe.TYPES.MapConfig),nu=Object(va.inject)(pe.TYPES.IGlobalConfigService),Wc=Object(va.inject)(pe.TYPES.ILogService),lc=Object(va.inject)(pe.TYPES.ICoordinateSystemService),vu=Object(va.inject)(pe.TYPES.IEventEmitter),Ru(Zc=(Fs=(Uf=function(){function b(){var p=this;we()(this,b),this.map=void 0,Wn()(this,"config",au,this),Wn()(this,"configService",Ll,this),Wn()(this,"logger",Tc,this),Wn()(this,"coordinateSystemService",yi,this),Wn()(this,"eventEmitter",cc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=p.map.getCenter().wrap(),d=c.lat,v=c.lng;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[v,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>pl?p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Ke()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=oa.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(_c[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(_c[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){var v=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),L=v.x,j=L===void 0?0:L,se=v.y,oe=se===void 0?0:se,le=v.z,Tt=le===void 0?0:le;return{x:j,y:oe,z:Tt}}},{key:"getModelMatrix",value:function(c,d,v){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},se=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),oe=se.meterInMercatorCoordinateUnits(),le=Mr.b.create();return Mr.b.translate(le,le,Mr.d.fromValues(se.x-j.x,se.y-j.y,se.z||0-j.z)),Mr.b.scale(le,le,Mr.d.fromValues(oe*L[0],-oe*L[1],oe*L[2])),Mr.b.rotateX(le,le,v[0]),Mr.b.rotateY(le,le,v[1]),Mr.b.rotateZ(le,le,v[2]),le}},{key:"init",value:function(){var p=Kn()(Tn.a.mark(function d(){var v,L,j,se,oe,le,Tt,Xt,Kt,tr,Cr,Fr,ln;return Tn.a.wrap(function($n){for(;;)switch($n.prev=$n.next){case 0:v=this.config,L=v.id,j=L===void 0?"map":L,se=v.attributionControl,oe=se===void 0?!1:se,le=v.style,Tt=le===void 0?"light":le,Xt=v.token,Kt=Xt===void 0?Ps:Xt,tr=v.rotation,Cr=tr===void 0?0:tr,Fr=v.mapInstance,ln=Jr()(v,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new _f,!Fr&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Kt===Ps&&Tt!=="blank"&&!window.mapboxgl.accessToken&&!Fr&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!Fr&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Kt),Fr?(this.map=Fr,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(j),this.map=new window.mapboxgl.Map(Bf({container:this.$mapContainer,style:this.getMapStyle(Tt),attributionControl:oe,bearing:Cr},ln))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return $n.stop()}},d,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).emit.apply(d,[c].concat(L))}},{key:"once",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).once.apply(d,[c].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),v=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return v}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var v=document.createElement("div");return v.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,v.id="l7_mapbox_div"+Rl++,d.appendChild(v),v}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Pi[c]?Pi[c]:c}}]),b}(),Uf),au=H()(Fs.prototype,"config",[Pl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ll=H()(Fs.prototype,"configService",[nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=H()(Fs.prototype,"logger",[Wc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yi=H()(Fs.prototype,"coordinateSystemService",[lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cc=H()(Fs.prototype,"eventEmitter",[vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fs))||Zc);function Fo(b){var p=Il();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Il(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var ml=function(b){yr()(c,b);var p=Fo(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"getServiceConstructor",value:function(){return hc}}]),c}(ur);function Xc(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function vl(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Xc(Object(c),!0).forEach(function(d){iu(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Xc(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}function iu(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function Yc(b,p){return Sc(b)||dc(b,p)||Af(b,p)||Sf()}function Sf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Af(b,p){if(!b)return;if(typeof b=="string")return Dl(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Dl(b,p)}function Dl(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function dc(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function Sc(b){if(Array.isArray(b))return b}var Nl=Ce.a.memo(function(b){var p=b.style,c=b.className,d=b.map,v=b.option,L=b.onSceneLoaded,j=Object(ge.createRef)(),se=Object(ge.useState)(),oe=Yc(se,2),le=oe[0],Tt=oe[1];return Object(ge.useEffect)(function(){var Xt=new Ct.Scene(vl(vl({id:j.current},v),{},{map:new ml(d)}));return Xt.on("loaded",function(){Tt(Xt),L&&L(Xt)}),function(){Xt.destroy()}},[]),Object(ge.useEffect)(function(){le&&d.style&&le.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(ge.useEffect)(function(){le&&d.zoom&&le.setZoom(d.zoom)},[d.zoom]),Object(ge.useEffect)(function(){le&&d.center&&le.setCenter(d.center)},[JSON.stringify(d.center)]),Object(ge.useEffect)(function(){le&&d.pitch&&le.setPitch(d.pitch)},[d.pitch]),Object(ge.useEffect)(function(){le&&d.rotation&&le.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(lt.Provider,{value:le},Object(ge.createElement)("div",{ref:j,style:p,className:c},le&&b.children))}),Yu=Nl,Cf=i("PJYZ"),gl=i.n(Cf),pc=i("QkVN"),Co=i.n(pc),Vf=i("uhBA"),Kc=i("cDf5"),Ac=i.n(Kc),cf=i("zvhG"),ff=i.n(cf);function hf(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=kl(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function kl(b,p){if(!b)return;if(typeof b=="string")return jl(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return jl(b,p)}function jl(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var zl;function Di(b,p,c){var d=c-p,v=((b-p)%d+d)%d+p;return v===p?c:v}function ou(b,p,c){return Math.min(c,Math.max(p,b))}function Uo(b,p,c){return b*(1-c)+p*c}function Bo(b,p,c,d){var v=new ff.a(b,p,c,d);return function(L){return v.solve(L)}}var ui=Bo(.25,.1,.25,1);function li(){return window.matchMedia?(zl==null&&(zl=window.matchMedia("(prefers-reduced-motion: reduce)")),zl.matches):!1}function sl(b,p){var c={},d=hf(p),v;try{for(d.s();!(v=d.n()).done;){var L=v.value;L in b&&(c[L]=b[L])}}catch(j){d.e(j)}finally{d.f()}return c}var us=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),mc=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,wf=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function Of(b){var p=mc(b);return{cancel:function(){return wf(p)}}}var No=function(){Ke()(b,null,[{key:"convert",value:function(c){return c instanceof b?c:new b(c)}}]);function b(p,c){we()(this,b),this.ne=void 0,this.sw=void 0,p&&(c?this.setSouthWest(p).setNorthEast(c):p.length===4?this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]]):this.setSouthWest(p[0]).setNorthEast(p[1]))}return Ke()(b,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof oi?new oi(c.lng,c.lat):oi.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof oi?new oi(c.lng,c.lat):oi.convert(c),this}},{key:"extend",value:function(c){var d=this.sw,v=this.ne,L,j;if(c instanceof oi)L=c,j=c;else if(c instanceof b){if(L=c.sw,j=c.ne,!L||!j)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var se=c;return this.extend(b.convert(se))}else{var oe=c;return this.extend(oi.convert(oe))}return this}return!d&&!v?(this.sw=new oi(L.lng,L.lat),this.ne=new oi(j.lng,j.lat)):(d.lng=Math.min(L.lng,d.lng),d.lat=Math.min(L.lat,d.lat),v.lng=Math.max(j.lng,v.lng),v.lat=Math.max(j.lat,v.lat)),this}},{key:"getCenter",value:function(){return new oi((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new oi(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new oi(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var d=oi.convert(c),v=d.lng,L=d.lat,j=this.sw.lat<=L&&L<=this.ne.lat,se=this.sw.lng<=v&&v<=this.ne.lng;return this.sw.lng>this.ne.lng&&(se=this.sw.lng>=v&&v>=this.ne.lng),j&&se}}]),b}(),yl=63710088e-1,oi=function(){Ke()(b,null,[{key:"convert",value:function(c){if(c instanceof b)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new b(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&Ac()(c)==="object"&&c!==null){var d="lng"in c?c.lng:c.lon;return new b(Number(d),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function b(p,c){if(we()(this,b),this.lng=void 0,this.lat=void 0,isNaN(p)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(p,", ").concat(c,")"));if(this.lng=+p,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Ke()(b,[{key:"wrap",value:function(){return new b(Di(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=40075017,v=360*c/d,L=v/Math.cos(Math.PI/180*this.lat);return new No(new b(this.lng-L,this.lat-v),new b(this.lng+L,this.lat+v))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var d=Math.PI/180,v=this.lat*d,L=c.lat*d,j=Math.sin(v)*Math.sin(L)+Math.cos(v)*Math.cos(L)*Math.cos((c.lng-this.lng)*d),se=yl*Math.acos(Math.min(j,1));return se}}]),b}(),Ia=function(){Ke()(b,null,[{key:"convert",value:function(c){return c instanceof b?c:Array.isArray(c)?new b(c[0],c[1]):c}}]);function b(p,c){we()(this,b),this.x=void 0,this.y=void 0,this.x=p,this.y=c}return Ke()(b,[{key:"clone",value:function(){return new b(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var d=Math.cos(c),v=Math.sin(c),L=d*this.x-v*this.y,j=v*this.x+d*this.y;return this.x=L,this.y=j,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,d){var v=Math.cos(c),L=Math.sin(c),j=d.x+v*(this.x-d.x)-L*(this.y-d.y),se=d.y+L*(this.x-d.x)+v*(this.y-d.y);return this.x=j,this.y=se,this}},{key:"roateAround",value:function(c,d){return this.clone()._rotateAround(c,d)}},{key:"_matMult",value:function(c){var d=c[0]*this.x+c[1]*this.y,v=c[2]*this.x+c[3]*this.y;return this.x=d,this.y=v,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var d=c.x-this.x,v=c.y-this.y;return d*d+v*v}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)}}]),b}(),xs=function(){function b(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(we()(this,b),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(p)||p<0||isNaN(c)||c<0||isNaN(d)||d<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=p,this.bottom=c,this.left=d,this.right=v}return Ke()(b,[{key:"interpolate",value:function(c,d,v){return d.top!=null&&c.top!=null&&(this.top=Uo(c.top,d.top,v)),d.bottom!=null&&c.bottom!=null&&(this.bottom=Uo(c.bottom,d.bottom,v)),d.left!=null&&c.left!=null&&(this.left=Uo(c.left,d.left,v)),d.right!=null&&c.right!=null&&(this.right=Uo(c.right,d.right,v)),this}},{key:"getCenter",value:function(c,d){var v=ou((this.left+c-this.right)/2,0,c),L=ou((this.top+d-this.bottom)/2,0,d);return new Ia(v,L)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new b(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),b}(),ls=2*Math.PI*yl;function Iu(b){return ls*Math.cos(b*Math.PI/180)}function bn(b){return(180+b)/360}function Es(b){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))/360}function Us(b,p){return b/Iu(p)}function Cc(b){return b*360-180}function gu(b){var p=180-b*360;return 360/Math.PI*Math.atan(Math.exp(p*Math.PI/180))-90}function yu(b,p){return b*Iu(gu(p))}function bu(b){return 1/Math.cos(b*Math.PI/180)}var Sn=function(){Ke()(b,null,[{key:"fromLngLat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=oi.convert(c);return new b(bn(v.lng),Es(v.lat),Us(d,v.lat))}}]);function b(p,c){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;we()(this,b),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+p,this.y=+c,this.z=+d}return Ke()(b,[{key:"toLngLat",value:function(){return new oi(Cc(this.x),gu(this.y))}},{key:"toAltitude",value:function(){return yu(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/ls*bu(gu(this.y))}}]),b}();function Si(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=$c(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function $c(b,p){if(!b)return;if(typeof b=="string")return wc(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return wc(b,p)}function wc(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var Fl=8192,Du=function(){Ke()(b,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Ia(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var d=-Di(c,-180,180)*Math.PI/180;if(this.angle===d)return;this.unmodified=!1,this.angle=d,this.calcMatrices(),this.rotationMatrix=Mr.a.create(),Mr.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var d=ou(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===d)return;this.unmodified=!1,this._pitch=d,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var d=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===d)return;this.unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function b(p,c,d,v,L){we()(this,b),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=L===void 0?!0:L,this._minZoom=p||0,this._maxZoom=c||22,this._minPitch=d==null?0:d,this._maxPitch=v==null?60:v,this.setMaxBounds(),this.width=0,this.height=0,this._center=new oi(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new xs,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Ke()(b,[{key:"clone",value:function(){var c=new b(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,d,v){this.unmodified=!1,this.edgeInsets.interpolate(c,d,v),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var d=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,d)}},{key:"resize",value:function(c,d){this.width=c,this.height=d,this.pixelsToGLUnits=[2/c,-2/d],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var d=ou(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Ia(bn(c.lng)*this.worldSize,Es(d)*this.worldSize)}},{key:"unproject",value:function(c){return new Sn(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,d){var v=this.pointCoordinate(d),L=this.pointCoordinate(this.centerPoint),j=this.locationCoordinate(c),se=new Sn(j.x-(v.x-L.x),j.y-(v.y-L.y));this.center=this.coordinateLocation(se),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var d=0,v=new Float32Array([c.x,c.y,0,1]),L=new Float32Array([c.x,c.y,1,1]);Mr.e.transformMat4(v,v,this.pixelMatrixInverse),Mr.e.transformMat4(L,L,this.pixelMatrixInverse);var j=v[3],se=L[3],oe=v[0]/j,le=L[0]/se,Tt=v[1]/j,Xt=L[1]/se,Kt=v[2]/j,tr=L[2]/se,Cr=Kt===tr?0:(d-Kt)/(tr-Kt);return new Sn(Uo(oe,le,Cr)/this.worldSize,Uo(Tt,Xt,Cr)/this.worldSize)}},{key:"getBounds",value:function(){return new No().extend(this.pointLocation(new Ia(0,0))).extend(this.pointLocation(new Ia(this.width,0))).extend(this.pointLocation(new Ia(this.width,this.height))).extend(this.pointLocation(new Ia(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new No([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new Ia(0,0)),d=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),v=Mr.e.transformMat4(d,d,this.pixelMatrix);return v[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,d=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Ia(0,d))}},{key:"getCameraQueryGeometry",value:function(c){var d=this.getCameraPoint();if(c.length===1)return[c[0],d];var v=d.x,L=d.y,j=d.x,se=d.y,oe=Si(c),le;try{for(oe.s();!(le=oe.n()).done;){var Tt=le.value;v=Math.min(v,Tt.x),L=Math.min(L,Tt.y),j=Math.max(j,Tt.x),se=Math.max(se,Tt.y)}}catch(Xt){oe.e(Xt)}finally{oe.f()}return[new Ia(v,L),new Ia(j,L),new Ia(j,se),new Ia(v,se),new Ia(v,L)]}},{key:"coordinatePoint",value:function(c){var d=Mr.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return Mr.e.transformMat4(d,d,this.pixelMatrix),new Ia(d[0]/d[3],d[1]/d[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return Sn.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,d=90,v=-180,L=180,j,se,oe,le,Tt=this.size,Xt=this.unmodified;if(this.latRange){var Kt=this.latRange;c=Es(Kt[1])*this.worldSize,d=Es(Kt[0])*this.worldSize,j=d-c<Tt.y?Tt.y/(d-c):0}if(this.lngRange){var tr=this.lngRange;v=bn(tr[0])*this.worldSize,L=bn(tr[1])*this.worldSize,se=L-v<Tt.x?Tt.x/(L-v):0}var Cr=this.point,Fr=Math.max(se||0,j||0);if(Fr){this.center=this.unproject(new Ia(se?(L+v)/2:Cr.x,j?(d+c)/2:Cr.y)),this.zoom+=this.scaleZoom(Fr),this.unmodified=Xt,this.constraining=!1;return}if(this.latRange){var ln=Cr.y,hn=Tt.y/2;ln-hn<c&&(le=c+hn),ln+hn>d&&(le=d-hn)}if(this.lngRange){var $n=Cr.x,sa=Tt.x/2;$n-sa<v&&(oe=v+sa),$n+sa>L&&(oe=L-sa)}(oe!==void 0||le!==void 0)&&(this.center=this.unproject(new Ia(oe!==void 0?oe:Cr.x,le!==void 0?le:Cr.y))),this.unmodified=Xt,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var v=Math.PI/2+this._pitch,L=this._fov*(.5+d.y/this.height),j=Math.sin(L)*this.cameraToCenterDistance/Math.sin(ou(Math.PI-v-L,.01,Math.PI-.01)),se=this.point,oe=se.x,le=se.y,Tt=Math.cos(Math.PI/2-this._pitch)*j+this.cameraToCenterDistance,Xt=Tt*1.01,Kt=this.height/50,tr=Mr.b.create();Mr.b.perspective(tr,this._fov,this.width/this.height,Kt,Xt),tr[8]=-d.x*2/this.width,tr[9]=d.y*2/this.height,Mr.b.scale(tr,tr,[1,-1,1]),Mr.b.translate(tr,tr,[0,0,-this.cameraToCenterDistance]),Mr.b.rotateX(tr,tr,this._pitch),Mr.b.rotateZ(tr,tr,this.angle),Mr.b.translate(tr,tr,[-oe,-le,0]),this.mercatorMatrix=Mr.b.scale(Mr.b.create(),tr,[this.worldSize,this.worldSize,this.worldSize]),Mr.b.scale(tr,tr,Mr.d.fromValues(1,1,Us(1,this.center.lat)*this.worldSize)),this.projMatrix=tr,this.invProjMatrix=Mr.b.invert(Mr.b.create(),this.projMatrix);var Cr=this.width%2/2,Fr=this.height%2/2,ln=Math.cos(this.angle),hn=Math.sin(this.angle),$n=oe-Math.round(oe)+ln*Cr+hn*Fr,sa=le-Math.round(le)+ln*Fr+hn*Cr,fa=Mr.b.clone(tr);if(Mr.b.translate(fa,fa,[$n>.5?$n-1:$n,sa>.5?sa-1:sa,0]),this.alignedProjMatrix=fa,tr=Mr.b.create(),Mr.b.scale(tr,tr,[this.width/2,-this.height/2,1]),Mr.b.translate(tr,tr,[1,-1,0]),this.labelPlaneMatrix=tr,tr=Mr.b.create(),Mr.b.scale(tr,tr,[1,-1,1]),Mr.b.translate(tr,tr,[-1,-1,0]),Mr.b.scale(tr,tr,[2/this.width,2/this.height,1]),this.glCoordMatrix=tr,this.pixelMatrix=Mr.b.multiply(Mr.b.create(),this.labelPlaneMatrix,this.projMatrix),tr=Mr.b.invert(Mr.b.create(),this.pixelMatrix),!tr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=tr,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),b}(),Ua=function b(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};we()(this,b),this.type=void 0,Co()(this,c),this.type=p};function Oc(b){var p=Bs();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Bs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var bl=function(b){yr()(c,b);var p=Oc(c);function c(d){var v;we()(this,c),v=p.call(this),v.transform=void 0,v.options=void 0,v.moving=void 0,v.zooming=void 0,v.rotating=void 0,v.pitching=void 0,v.padding=void 0,v.bearingSnap=void 0,v.easeEndTimeoutID=void 0,v.easeStart=void 0,v.easeOptions=void 0,v.easeId=void 0,v.onEaseFrame=void 0,v.onEaseEnd=void 0,v.easeFrameId=void 0,v.renderFrameCallback=function(){var Tt=Math.min((us()-v.easeStart)/v.easeOptions.duration,1);v.onEaseFrame(v.easeOptions.easing(Tt)),Tt<1?v.easeFrameId=v.requestRenderFrame(v.renderFrameCallback):v.stop()},v.options=d;var L=d.minZoom,j=d.maxZoom,se=d.minPitch,oe=d.maxPitch,le=d.renderWorldCopies;return v.moving=!1,v.zooming=!1,v.bearingSnap=d.bearingSnap,v.transform=new Du(L,j,se,oe,le),v}return Ke()(c,[{key:"requestRenderFrame",value:function(v){return 0}},{key:"cancelRenderFrame",value:function(v){return}},{key:"getCenter",value:function(){var v=this.transform.center,L=v.lng,j=v.lat;return new oi(L,j)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(v,L){return this.jumpTo({center:v},L)}},{key:"setPitch",value:function(v,L){return this.jumpTo({pitch:v},L),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(v,L,j){return this.easeTo(Co()({center:v},L),j)}},{key:"zoomOut",value:function(v,L){return this.zoomTo(this.getZoom()-1,v,L),this}},{key:"setBearing",value:function(v,L){return this.jumpTo({bearing:v},L),this}},{key:"setZoom",value:function(v,L){return this.jumpTo({zoom:v},L),this}},{key:"zoomIn",value:function(v,L){return this.zoomTo(this.getZoom()+1,v,L),this}},{key:"zoomTo",value:function(v,L,j){return this.easeTo(Co()({zoom:v},L),j)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(v,L){return this.jumpTo({padding:v},L),this}},{key:"rotateTo",value:function(v,L,j){return this.easeTo(Co()({bearing:v},L),j)}},{key:"resetNorth",value:function(v,L){return this.rotateTo(0,Co()({duration:1e3},v),L),this}},{key:"resetNorthPitch",value:function(v,L){return this.easeTo(Co()({bearing:0,pitch:0,duration:1e3},v),L),this}},{key:"fitBounds",value:function(v,L,j){return this.fitInternal(this.cameraForBounds(v,L),L,j)}},{key:"cameraForBounds",value:function(v,L){return v=No.convert(v),this.cameraForBoxAndBearing(v.getNorthWest(),v.getSouthEast(),0,L)}},{key:"snapToNorth",value:function(v,L){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(v,L):this}},{key:"jumpTo",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=arguments.length>1?arguments[1]:void 0;this.stop();var j=this.transform,se=!1,oe=!1,le=!1;return v.zoom&&j.zoom!==+v.zoom&&(se=!0,j.zoom=+v.zoom),v.center!==void 0&&(j.center=oi.convert(v.center)),v.bearing&&j.bearing!==+v.bearing&&(oe=!0,j.bearing=+v.bearing),v.pitch&&j.pitch!==+v.pitch&&(le=!0,j.pitch=+v.pitch),v.padding!=null&&!j.isPaddingEqual(v.padding)&&(j.padding=v.padding),this.emit("movestart",new Ua("movestart",L)),this.emit("move",new Ua("move",L)),se&&(this.emit("zoomstart",new Ua("zoomstart",L)),this.emit("zoom",new Ua("zoom",L)),this.emit("zoomend",new Ua("zoomend",L))),oe&&(this.emit("rotatestart",new Ua("rotatestart",L)),this.emit("rotate",new Ua("rotate",L)),this.emit("rotateend",new Ua("rotateend",L))),le&&(this.emit("pitchstart",new Ua("pitchstart",L)),this.emit("pitch",new Ua("pitch",L)),this.emit("pitchend",new Ua("pitchend",L))),this.emit("moveend",new Ua("moveend",L))}},{key:"easeTo",value:function(){var v=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1?arguments[1]:void 0;L=Co()({offset:[0,0],duration:500,easing:ui},L),(L.animate===!1||!L.essential&&li())&&(L.duration=0);var se=this.transform,oe=this.getZoom(),le=this.getBearing(),Tt=this.getPitch(),Xt=this.getPadding(),Kt=L.zoom?+L.zoom:oe,tr=L.bearing?this.normalizeBearing(L.bearing,le):le,Cr=L.pitch?+L.pitch:Tt,Fr=L.padding?L.padding:se.padding,ln=Ia.convert(L.offset),hn=se.centerPoint.add(ln),$n=se.pointLocation(hn),sa=oi.convert(L.center||$n);this.normalizeCenter(sa);var fa=se.project($n),ja=se.project(sa).sub(fa),_a=se.zoomScale(Kt-oe),ii,Ka;L.around&&(ii=oi.convert(L.around),Ka=se.locationPoint(ii));var io={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Kt!==oe,this.rotating=this.rotating||le!==tr,this.pitching=this.pitching||Cr!==Tt,this.padding=!se.isPaddingEqual(Fr),this.easeId=L.easeId,this.prepareEase(j,L.noMoveStart,io),clearTimeout(this.easeEndTimeoutID),this.ease(function(Ca){if(v.zooming&&(se.zoom=Uo(oe,Kt,Ca)),v.rotating&&(se.bearing=Uo(le,tr,Ca)),v.pitching&&(se.pitch=Uo(Tt,Cr,Ca)),v.padding&&(se.interpolatePadding(Xt,Fr,Ca),hn=se.centerPoint.add(ln)),ii)se.setLocationAtPoint(ii,Ka);else{var Ba=se.zoomScale(se.zoom-oe),ac=Kt>oe?Math.min(2,_a):Math.max(.5,_a),ic=Math.pow(ac,1-Ca),lu=se.unproject(fa.add(ja.mult(Ca*ic)).mult(Ba));se.setLocationAtPoint(se.renderWorldCopies?lu.wrap():lu,hn)}v.fireMoveEvents(j)},function(Ca){v.afterEase(j,Ca)},L),this}},{key:"flyTo",value:function(){var v=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1?arguments[1]:void 0;if(!L.essential&&li()){var se=sl(L,["center","zoom","bearing","pitch","around"]);return this.jumpTo(se,j)}this.stop(),L=Co()({offset:[0,0],speed:1.2,curve:1.42,easing:ui},L);var oe=this.transform,le=this.getZoom(),Tt=this.getBearing(),Xt=this.getPitch(),Kt=this.getPadding(),tr=L.zoom?ou(+L.zoom,oe.minZoom,oe.maxZoom):le,Cr=L.bearing?this.normalizeBearing(L.bearing,Tt):Tt,Fr=L.pitch?+L.pitch:Xt,ln="padding"in L?L.padding:oe.padding,hn=oe.zoomScale(tr-le),$n=Ia.convert(L.offset),sa=oe.centerPoint.add($n),fa=oe.pointLocation(sa),ja=oi.convert(L.center||fa);this.normalizeCenter(ja);var _a=oe.project(fa),ii=oe.project(ja).sub(_a),Ka=L.curve,io=Math.max(oe.width,oe.height),Ca=io/hn,Ba=ii.mag();if("minZoom"in L){var ac=ou(Math.min(L.minZoom,le,tr),oe.minZoom,oe.maxZoom),ic=io/oe.zoomScale(ac-le);Ka=Math.sqrt(ic/Ba*2)}var lu=Ka*Ka;function Cl(lo){var fl=(Ca*Ca-io*io+(lo?-1:1)*lu*lu*Ba*Ba)/(2*(lo?Ca:io)*lu*Ba);return Math.log(Math.sqrt(fl*fl+1)-fl)}function nh(lo){return(Math.exp(lo)-Math.exp(-lo))/2}function jc(lo){return(Math.exp(lo)+Math.exp(-lo))/2}function wl(lo){return nh(lo)/jc(lo)}var js=Cl(0),kf=function(fl){return jc(js)/jc(js+Ka*fl)},oo=function(fl){return io*((jc(js)*wl(js+Ka*fl)-nh(js))/lu)/Ba},wu=(Cl(1)-js)/Ka;if(Math.abs(Ba)<1e-6||!isFinite(wu)){if(Math.abs(io-Ca)<1e-6)return this.easeTo(L,j);var Uu=Ca<io?-1:1;wu=Math.abs(Math.log(Ca/io))/Ka,oo=function(){return 0},kf=function(fl){return Math.exp(Uu*Ka*fl)}}if("duration"in L)L.duration=+L.duration;else{var jf="screenSpeed"in L?+L.screenSpeed/Ka:+L.speed;L.duration=1e3*wu/jf}return L.maxDuration&&L.duration>L.maxDuration&&(L.duration=0),this.zooming=!0,this.rotating=Tt!==Cr,this.pitching=Fr!==Xt,this.padding=!oe.isPaddingEqual(ln),this.prepareEase(j,!1),this.ease(function(lo){var fl=lo*wu,zf=1/kf(fl);oe.zoom=lo===1?tr:le+oe.scaleZoom(zf),v.rotating&&(oe.bearing=Uo(Tt,Cr,lo)),v.pitching&&(oe.pitch=Uo(Xt,Fr,lo)),v.padding&&(oe.interpolatePadding(Kt,ln,lo),sa=oe.centerPoint.add($n));var zc=lo===1?ja:oe.unproject(_a.add(ii.mult(oo(fl))).mult(zf));oe.setLocationAtPoint(oe.renderWorldCopies?zc.wrap():zc,sa),v.fireMoveEvents(j)},function(){return v.afterEase(j)},L),this}},{key:"fitScreenCoordinates",value:function(v,L,j,se,oe){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Ia.convert(v)),this.transform.pointLocation(Ia.convert(L)),j,se),se,oe)}},{key:"stop",value:function(v,L){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var j=this.onEaseEnd;delete this.onEaseEnd,j.call(this,L)}return this}},{key:"normalizeBearing",value:function(v,L){v=Di(v,-180,180);var j=Math.abs(v-L);return Math.abs(v-360-L)<j&&(v-=360),Math.abs(v+360-L)<j&&(v+=360),v}},{key:"normalizeCenter",value:function(v){var L=this.transform;if(!L.renderWorldCopies||L.lngRange)return;var j=v.lng-L.center.lng;v.lng+=j>180?-360:j<-180?360:0}},{key:"fireMoveEvents",value:function(v){this.emit("move",new Ua("move",v)),this.zooming&&this.emit("zoom",new Ua("zoom",v)),this.rotating&&this.emit("rotate",new Ua("rotate",v)),this.pitching&&this.emit("rotate",new Ua("pitch",v))}},{key:"prepareEase",value:function(v){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!L&&!j.moving&&this.emit("movestart",new Ua("movestart",v)),this.zooming&&!j.zooming&&this.emit("zoomstart",new Ua("zoomstart",v)),this.rotating&&!j.rotating&&this.emit("rotatestart",new Ua("rotatestart",v)),this.pitching&&!j.pitching&&this.emit("pitchstart",new Ua("pitchstart",v))}},{key:"afterEase",value:function(v,L){if(this.easeId&&L&&this.easeId===L)return;delete this.easeId;var j=this.zooming,se=this.rotating,oe=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,j&&this.emit("zoomend",new Ua("zoomend",v)),se&&this.emit("rotateend",new Ua("rotateend",v)),oe&&this.emit("pitchend",new Ua("pitchend",v)),this.emit("moveend",new Ua("moveend",v))}},{key:"ease",value:function(v,L,j){j.animate===!1||j.duration===0?(v(1),L()):(this.easeStart=us(),this.easeOptions=j,this.onEaseFrame=v,this.onEaseEnd=L,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(v,L,j,se){var oe={top:0,bottom:0,right:0,left:0};if(se=Co()({padding:oe,offset:[0,0],maxZoom:this.transform.maxZoom},se),typeof se.padding=="number"){var le=se.padding;se.padding={top:le,bottom:le,right:le,left:le}}se.padding=Co()(oe,se.padding);var Tt=this.transform,Xt=Tt.padding,Kt=Tt.project(oi.convert(v)),tr=Tt.project(oi.convert(L)),Cr=Kt.rotate(-j*Math.PI/180),Fr=tr.rotate(-j*Math.PI/180),ln=new Ia(Math.max(Cr.x,Fr.x),Math.max(Cr.y,Fr.y)),hn=new Ia(Math.min(Cr.x,Fr.x),Math.min(Cr.y,Fr.y)),$n=ln.sub(hn),sa=(Tt.width-(Xt.left+Xt.right+se.padding.left+se.padding.right))/$n.x,fa=(Tt.height-(Xt.top+Xt.bottom+se.padding.top+se.padding.bottom))/$n.y;if(fa<0||sa<0)return;var ja=Math.min(Tt.scaleZoom(Tt.scale*Math.min(sa,fa)),se.maxZoom),_a=Ia.convert(se.offset),ii=(se.padding.left-se.padding.right)/2,Ka=(se.padding.top-se.padding.bottom)/2,io=new Ia(_a.x+ii,_a.y+Ka),Ca=io.mult(Tt.scale/Tt.zoomScale(ja)),Ba=Tt.unproject(Kt.add(tr).div(2).sub(Ca));return{center:Ba,zoom:ja,bearing:j}}},{key:"fitInternal",value:function(v,L,j){return v?(L=Co()(v,L),delete L.padding,L.linear?this.easeTo(L,j):this.flyTo(L,j)):this}}]),c}(Vf.EventEmitter);function df(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Mc(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function Mc(b,p){if(!b)return;if(typeof b=="string")return Ul(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ul(b,p)}function Ul(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var Ls={},Yo=Ls;Ls.create=function(b,p,c){var d=window.document.createElement(b);return p!==void 0&&(d.className=p),c&&c.appendChild(d),d},Ls.createNS=function(b,p){var c=window.document.createElementNS(b,p);return c};var Ji=window.document&&window.document.documentElement.style;function bi(b){if(!Ji)return b[0];var p=df(b),c;try{for(p.s();!(c=p.n()).done;){var d=c.value;if(d in Ji)return d}}catch(v){p.e(v)}finally{p.f()}return b[0]}var Qi=bi(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Ku;Ls.disableDrag=function(){Ji&&Qi&&(Ku=Ji[Qi],Ji[Qi]="none")},Ls.enableDrag=function(){Ji&&Qi&&(Ji[Qi]=Ku)};var vo=bi(["transform","WebkitTransform"]);Ls.setTransform=function(b,p){b.style[vo]=p};var es=!1;try{var xu=Object.defineProperty({},"passive",{get:function(){es=!0}});window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch(b){es=!1}Ls.addEventListener=function(b,p,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&es?b.addEventListener(p,c,d):b.addEventListener(p,c,d.capture)},Ls.removeEventListener=function(b,p,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&es?b.removeEventListener(p,c,d):b.removeEventListener(p,c,d.capture)};var Nu=function b(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",b,!0)};Ls.suppressClick=function(){window.addEventListener("click",Nu,!0),window.setTimeout(function(){window.removeEventListener("click",Nu,!0)},0)},Ls.mousePos=function(b,p){var c=b.getBoundingClientRect();return new Ia(p.clientX-c.left-b.clientLeft,p.clientY-c.top-b.clientTop)},Ls.touchPos=function(b,p){var c=b.getBoundingClientRect(),d=[],v=df(p),L;try{for(v.s();!(L=v.n()).done;){var j=L.value;d.push(new Ia(j.clientX-c.left-b.clientLeft,j.clientY-c.top-b.clientTop))}}catch(se){v.e(se)}finally{v.f()}return d},Ls.mouseButton=function(b){return typeof window.InstallTrigger!="undefined"&&b.button===2&&b.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},Ls.remove=function(b){b.parentNode&&b.parentNode.removeChild(b)};function Vo(b){var p=xl();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function xl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Vn=function(b){yr()(c,b);var p=Vo(c);function c(d,v,L){var j,se=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};we()(this,c);var oe=Yo.mousePos(v.getCanvasContainer(),L),le=v.unproject(oe);return j=p.call(this,d,Co()({point:oe,lngLat:le,originalEvent:L},se)),j.type=void 0,j.target=void 0,j.originalEvent=void 0,j.point=void 0,j.lngLat=void 0,j.defaultPrevented=void 0,j.defaultPrevented=!1,j.target=v,j}return Ke()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Ua);function la(b){var p=go();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function go(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var $u=function(b){yr()(c,b);var p=la(c);function c(d,v,L){var j;we()(this,c);var se=d==="touchend"?L.changedTouches:L.touches,oe=Yo.touchPos(v.getCanvasContainer(),se),le=oe.map(function(Kt){return v.unproject(Kt)}),Tt=oe.reduce(function(Kt,tr,Cr,Fr){return Kt.add(tr.div(Fr.length))},new Ia(0,0)),Xt=v.unproject(Tt);return j=p.call(this,d,{points:oe,point:Tt,lngLats:le,lngLat:Xt,originalEvent:L}),j.type=void 0,j.target=void 0,j.originalEvent=void 0,j.lngLat=void 0,j.point=void 0,j.points=void 0,j.lngLats=void 0,j.defaultPrevented=void 0,j.defaultPrevented=!1,j}return Ke()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Ua);function Vs(b){var p=Ui();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Ui(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var cs=function(b){yr()(c,b);var p=Vs(c);function c(d,v,L){var j;return we()(this,c),j=p.call(this,d,{originalEvent:L}),j.type=void 0,j.originalEvent=void 0,j.defaultPrevented=void 0,j.target=void 0,j.defaultPrevented=!1,j}return Ke()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Ua),Jc=function(){function b(p){we()(this,b),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=p}return Ke()(b,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new Vn(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Vn("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new Vn(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),b}(),Gs=function(){function b(p,c){we()(this,b),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=p,this.el=p.getCanvasContainer(),this.container=p.getContainer(),this.clickTolerance=c.clickTolerance||1}return Ke()(b,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,d){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;Yo.disableDrag(),this.startPos=this.lastPos=d,this.active=!0}},{key:"mousemoveWindow",value:function(c,d){if(!this.active)return;var v=d;if(this.lastPos.equals(v)||!this.box&&v.dist(this.startPos)<this.clickTolerance)return;var L=this.startPos;this.lastPos=v,this.box||(this.box=Yo.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var j=Math.min(L.x,v.x),se=Math.max(L.x,v.x),oe=Math.min(L.y,v.y),le=Math.max(L.y,v.y);Yo.setTransform(this.box,"translate(".concat(j,"px,").concat(oe,"px)")),this.box&&(this.box.style.width="".concat(se-j,"px"),this.box.style.height="".concat(le-oe,"px"))}},{key:"mouseupWindow",value:function(c,d){var v=this;if(!this.active)return;if(c.button!==0)return;var L=this.startPos,j=d;if(this.reset(),Yo.suppressClick(),L.x===j.x&&L.y===j.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new Ua("boxzoomend",{originalEvent:c})),{cameraAnimation:function(oe){return oe.fitScreenCoordinates(L,j,v.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(Yo.remove(this.box),this.box=null),Yo.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,d){return this.map.emit(c,new Ua(c,{originalEvent:d}))}}]),b}(),Li=Gs,Ni=function(){function b(){we()(this,b),this.enabled=void 0,this.active=void 0,this.reset()}return Ke()(b,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,d){return c.preventDefault(),{cameraAnimation:function(L){L.easeTo({duration:300,zoom:L.getZoom()+(c.shiftKey?-1:1),around:L.unproject(d)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function Bl(b){var p=Eu();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Eu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Vl=function(b){yr()(c,b);var p=Bl(c);function c(){var d;we()(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.type="renderFrame",d.timeStamp=void 0,d}return c}(Ua);function vc(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=ku(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function ku(b,p){if(!b)return;if(typeof b=="string")return ts(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ts(b,p)}function ts(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var Ju={linearity:.3,easing:Bo(0,0,.3,1)},ul=Co()({deceleration:2500,maxSpeed:1400},Ju),Mf=Co()({deceleration:20,maxSpeed:1400},Ju),Gl=Co()({deceleration:1e3,maxSpeed:360},Ju),Qc=Co()({deceleration:1e3,maxSpeed:90},Ju),pf=function(){function b(p){we()(this,b),this.map=void 0,this.inertiaBuffer=void 0,this.map=p,this.clear()}return Ke()(b,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:us(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,d=us(),v=160;c.length>0&&d-c[0].time>v;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var d={zoom:0,bearing:0,pitch:0,pan:new Ia(0,0),pinchAround:void 0,around:void 0},v=vc(this.inertiaBuffer),L;try{for(v.s();!(L=v.n()).done;){var j=L.value.settings;d.zoom+=j.zoomDelta||0,d.bearing+=j.bearingDelta||0,d.pitch+=j.pitchDelta||0,j.panDelta&&d.pan._add(j.panDelta),j.around&&(d.around=j.around),j.pinchAround&&(d.pinchAround=j.pinchAround)}}catch(Fr){v.e(Fr)}finally{v.f()}var se=this.inertiaBuffer[this.inertiaBuffer.length-1],oe=se.time-this.inertiaBuffer[0].time,le={};if(d.pan.mag()){var Tt=ju(d.pan.mag(),oe,Co()({},ul,c||{}));le.offset=d.pan.mult(Tt.amount/d.pan.mag()),le.center=this.map.transform.center,Ts(le,Tt)}if(d.zoom){var Xt=ju(d.zoom,oe,Mf);le.zoom=this.map.transform.zoom+Xt.amount,Ts(le,Xt)}if(d.bearing){var Kt=ju(d.bearing,oe,Gl);le.bearing=this.map.transform.bearing+ou(Kt.amount,-179,179),Ts(le,Kt)}if(d.pitch){var tr=ju(d.pitch,oe,Qc);le.pitch=this.map.transform.pitch+tr.amount,Ts(le,tr)}if(le.zoom||le.bearing){var Cr=d.pinchAround===void 0?d.around:d.pinchAround;le.around=Cr?this.map.unproject(Cr):this.map.getCenter()}return this.clear(),Co()(le,{noMoveStart:!0})}}]),b}();function Ts(b,p){(!b.duration||b.duration<p.duration)&&(b.duration=p.duration,b.easing=p.easing)}function ju(b,p,c){var d=c.maxSpeed,v=c.linearity,L=c.deceleration,j=ou(b*v/(p/1e3),-d,d),se=Math.abs(j)/(L*v);return{easing:c.easing,duration:se*1e3,amount:j*(se/2)}}var ll={panStep:100,bearingStep:15,pitchStep:10},mf=function(){function b(){we()(this,b),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var p=ll;this.panStep=p.panStep,this.bearingStep=p.bearingStep,this.pitchStep=p.pitchStep}return Ke()(b,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var d=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var v=0,L=0,j=0,se=0,oe=0;switch(c.keyCode){case 61:case 107:case 171:case 187:v=1;break;case 189:case 109:case 173:v=-1;break;case 37:c.shiftKey?L=-1:(c.preventDefault(),se=-1);break;case 39:c.shiftKey?L=1:(c.preventDefault(),se=1);break;case 38:c.shiftKey?j=1:(c.preventDefault(),oe=-1);break;case 40:c.shiftKey?j=-1:(c.preventDefault(),oe=1);break;default:return}return{cameraAnimation:function(Tt){var Xt=Tt.getZoom();Tt.easeTo({duration:300,easeId:"keyboardHandler",easing:El,zoom:v?Math.round(Xt)+v*(c.shiftKey?2:1):Xt,bearing:Tt.getBearing()+L*d.bearingStep,pitch:Tt.getPitch()+j*d.pitchStep,offset:[-se*d.panStep,-oe*d.panStep],center:Tt.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function El(b){return b*(2-b)}var Hl=mf,cl=function(){function b(p,c){we()(this,b),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=p,this.clickTolerance=c.clickTolerance}return Ke()(b,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new cs(c.type,this.map,c))}},{key:"mousedown",value:function(c,d){return this.mousedownPos=d,this.firePreventable(new Vn(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new Vn(c.type,this.map,c))}},{key:"click",value:function(c,d){if(this.mousedownPos&&this.mousedownPos.dist(d)>=this.clickTolerance)return;this.map.emit(c.type,new Vn(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new Vn(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new Vn(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new Vn(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new $u(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new $u(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new $u(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new $u(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),b}(),Rs=i("iWIM"),Tl=i.n(Rs),Wl,Qu=0,s=2,a=(Wl={},ma()(Wl,Qu,1),ma()(Wl,s,2),Wl);function n(b,p){var c=a[p];return b.buttons===void 0||(b.buttons&c)!==c}var l=function(){function b(p){we()(this,b),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=p.clickTolerance||1}return Ke()(b,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,d){if(this.lastPoint)return;var v=Yo.mouseButton(c);if(!this.correctButton(c,v))return;this.lastPoint=d,this.eventButton=v}},{key:"mousemoveWindow",value:function(c,d){var v=this.lastPoint;if(!v)return;if(c.preventDefault(),n(c,this.eventButton)){this.reset();return}return!this.moved&&d.dist(v)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=d,this.move(v,d))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var d=Yo.mouseButton(c);if(d!==this.eventButton)return;this.moved&&Yo.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,d){return!1}},{key:"move",value:function(c,d){return}}]),b}();function y(b){var p=O();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function O(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var R=function(b){yr()(c,b);var p=y(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"mousedown",value:function(v,L){Tl()(yn()(c.prototype),"mousedown",this).call(this,v,L),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(v,L){return{around:L,panDelta:L.sub(v)}}},{key:"correctButton",value:function(v,L){return L===Qu&&!v.ctrlKey}}]),c}(l);function k(b){var p=ie();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function ie(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Ee=function(b){yr()(c,b);var p=k(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"correctButton",value:function(v,L){return L===Qu&&v.ctrlKey||L===s}},{key:"move",value:function(v,L){var j=-.5,se=(L.y-v.y)*j;if(se)return this.active=!0,{pitchDelta:se}}},{key:"contextmenu",value:function(v){v.preventDefault()}}]),c}(l);function We(b){var p=$e();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function $e(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var qe=function(b){yr()(c,b);var p=We(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"contextmenu",value:function(v){v.preventDefault()}},{key:"correctButton",value:function(v,L){return L===Qu&&v.ctrlKey||L===s}},{key:"move",value:function(v,L){var j=.8,se=(L.x-v.x)*j;if(se)return this.active=!0,{bearingDelta:se}}}]),c}(l),Lt=4.000244140625,Rt=1/100,Gt=1/450,Dt=2,jt=function(){function b(p,c){var d=this;we()(this,b),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!d.frameId)return;if(d.frameId=null,!d.isActive())return;var v=d.map.transform;if(d.delta!==0){var L=d.type==="wheel"&&Math.abs(d.delta)>Lt?d.wheelZoomRate:d.defaultZoomRate,j=Dt/(1+Math.exp(-Math.abs(d.delta*L)));d.delta<0&&j!==0&&(j=1/j);var se=typeof d.targetZoom=="number"?v.zoomScale(d.targetZoom):v.scale;d.targetZoom=Math.min(v.maxZoom,Math.max(v.minZoom,v.scaleZoom(se*j))),d.type==="wheel"&&(d.startZoom=v.zoom,d.easing=d.smoothOutEasing(200)),d.delta=0}var oe=typeof d.targetZoom=="number"?d.targetZoom:v.zoom,le=d.startZoom,Tt=d.easing,Xt=!1,Kt;if(d.type==="wheel"&&le&&Tt){var tr=Math.min((us()-d.lastWheelEventTime)/200,1),Cr=Tt(tr);Kt=Uo(le,oe,Cr),tr<1?d.frameId||(d.frameId=!0):Xt=!0}else Kt=oe,Xt=!0;return d.active=!0,Xt&&(d.active=!1,d.finishTimeout=setTimeout(function(){d.zooming=!1,d.handler.triggerRenderFrame(),delete d.targetZoom,delete d.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Xt,zoomDelta:Kt-v.zoom,around:d.aroundPoint,originalEvent:d.lastWheelEvent}},this.map=p,this.el=p.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=Rt,this.wheelZoomRate=Gt}return Ke()(b,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var d=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,v=us(),L=v-(this.lastWheelEventTime||0);this.lastWheelEventTime=v,d!==0&&d%Lt===0?this.type="wheel":d!==0&&Math.abs(d)<4?this.type="trackpad":L>400?(this.type=null,this.lastValue=d,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(L*d)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,d+=this.lastValue)),c.shiftKey&&d&&(d=d/4),this.type&&(this.lastWheelEvent=c,this.delta-=d,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var d=Yo.mousePos(this.el,c);this.around=oi.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(d)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var d=ui;if(this.prevEase){var v=this.prevEase,L=(us()-v.start)/v.duration,j=v.easing(L+.01)-v.easing(L),se=.27/Math.sqrt(j*j+1e-4)*.01,oe=Math.sqrt(.27*.27-se*se);d=Bo(se,oe,.25,1)}return this.prevEase={start:us(),duration:c,easing:d},d}}]),b}(),ir=jt,Qt=function(){function b(p,c){we()(this,b),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=p,this.tapZoom=c}return Ke()(b,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),b}(),Lr=function(){function b(p,c,d){we()(this,b),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=p,this.mousePan=c,this.touchPan=d}return Ke()(b,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),b}(),gr=function(){function b(p,c,d){we()(this,b),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=p.pitchWithRotate,this.mouseRotate=c,this.mousePitch=d}return Ke()(b,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),b}(),Ar=function(){function b(p,c,d,v){we()(this,b),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=p,this.touchZoom=c,this.touchRotate=d,this.tapDragZoom=v,this.rotationDisabled=!1,this.enabled=!0}return Ke()(b,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),b}();function Or(b,p){for(var c={},d=0;d<b.length;d++)c[b[d].identifier]=p[d];return c}function Kr(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Qr(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function Qr(b,p){if(!b)return;if(typeof b=="string")return dn(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return dn(b,p)}function dn(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function wn(b){var p=new Ia(0,0),c=Kr(b),d;try{for(c.s();!(d=c.n()).done;){var v=d.value;p._add(v)}}catch(L){c.e(L)}finally{c.f()}return p.div(b.length)}var ra=500,ya=500,Ta=30,Ja=function(){function b(p){we()(this,b),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=p.numTouches}return Ke()(b,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,d,v){if((this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),v.length===this.numTouches&&(this.centroid=wn(d),this.touches=Or(v,d))}},{key:"touchmove",value:function(c,d,v){if(this.aborted||!this.centroid)return;var L=Or(v,d);for(var j in this.touches)if(this.touches[j]){var se=this.touches[j],oe=L[j];(!oe||oe.dist(se)>Ta)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,d,v){if((!this.centroid||c.timeStamp-this.startTime>ya)&&(this.aborted=!0),v.length===0){var L=!this.aborted&&this.centroid;if(this.reset(),L)return L}}}]),b}(),Mn=function(){function b(p){we()(this,b),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Ja(p),this.numTaps=p.numTaps,this.reset()}return Ke()(b,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,d,v){this.singleTap.touchstart(c,d,v)}},{key:"touchmove",value:function(c,d,v){this.singleTap.touchmove(c,d,v)}},{key:"touchend",value:function(c,d,v){var L=this.singleTap.touchend(c,d,v);if(L){var j=c.timeStamp-this.lastTime<ra,se=!this.lastTap||this.lastTap.dist(L)<Ta;if((!j||!se)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=L,this.count===this.numTaps)return this.reset(),L}}}]),b}(),ba=function(){function b(){we()(this,b),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new Mn({numTouches:1,numTaps:1}),this.reset()}return Ke()(b,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,d,v){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>ra&&this.reset(),this.tapTime?v.length>0&&(this.swipePoint=d[0],this.swipeTouch=v[0].identifier):this.tap.touchstart(c,d,v)}},{key:"touchmove",value:function(c,d,v){if(!this.tapTime)this.tap.touchmove(c,d,v);else if(this.swipePoint){if(v[0].identifier!==this.swipeTouch)return;var L=d[0],j=L.y-this.swipePoint.y;return this.swipePoint=L,c.preventDefault(),this.active=!0,{zoomDelta:j/128}}}},{key:"touchend",value:function(c,d,v){if(this.tapTime)this.swipePoint&&(v.length===0&&this.reset());else{var L=this.tap.touchend(c,d,v);L&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}(),ca=function(){function b(){we()(this,b),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new Mn({numTouches:1,numTaps:2}),this.zoomOut=new Mn({numTouches:2,numTaps:1}),this.reset()}return Ke()(b,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,d,v){this.zoomIn.touchstart(c,d,v),this.zoomOut.touchstart(c,d,v)}},{key:"touchmove",value:function(c,d,v){this.zoomIn.touchmove(c,d,v),this.zoomOut.touchmove(c,d,v)}},{key:"touchend",value:function(c,d,v){var L=this,j=this.zoomIn.touchend(c,d,v),se=this.zoomOut.touchend(c,d,v);if(j)return this.active=!0,c.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(le){return le.easeTo({duration:300,zoom:le.getZoom()+1,around:le.unproject(j)},{originalEvent:c})}};if(se)return this.active=!0,c.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(le){return le.easeTo({duration:300,zoom:le.getZoom()-1,around:le.unproject(se)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}(),Fn=function(){function b(p){we()(this,b),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=p.clickTolerance||1,this.reset()}return Ke()(b,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Ia(0,0)}},{key:"touchstart",value:function(c,d,v){return this.calculateTransform(c,d,v)}},{key:"touchmove",value:function(c,d,v){return this.active?(c.preventDefault(),this.calculateTransform(c,d,v)):void 0}},{key:"touchend",value:function(c,d,v){this.calculateTransform(c,d,v),this.active&&v.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,d,v){v.length>0&&(this.active=!0);var L=Or(v,d),j=new Ia(0,0),se=new Ia(0,0),oe=0;for(var le in L)if(L[le]){var Tt=L[le],Xt=this.touches[le];Xt&&(j._add(Tt),se._add(Tt.sub(Xt)),oe++,L[le]=Tt)}if(this.touches=L,oe<this.minTouches||!se.mag())return;var Kt=se.div(oe);if(this.sum._add(Kt),this.sum.mag()<this.clickTolerance)return;var tr=j.div(oe);return{around:tr,panDelta:Kt}}}]),b}(),Ma=function(){function b(){we()(this,b),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return Ke()(b,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,d,v){return}},{key:"touchstart",value:function(c,d,v){if(this.firstTwoTouches||v.length<2)return;this.firstTwoTouches=[v[0].identifier,v[1].identifier],this.start([d[0],d[1]])}},{key:"touchmove",value:function(c,d,v){if(!this.firstTwoTouches)return;c.preventDefault();var L=Ki()(this.firstTwoTouches,2),j=L[0],se=L[1],oe=Qn(v,d,j),le=Qn(v,d,se);if(!oe||!le)return;var Tt=this.aroundCenter?null:oe.add(le).div(2);return this.move([oe,le],Tt,c)}},{key:"touchend",value:function(c,d,v){if(!this.firstTwoTouches)return;var L=Ki()(this.firstTwoTouches,2),j=L[0],se=L[1],oe=Qn(v,d,j),le=Qn(v,d,se);if(oe&&le)return;this.active&&Yo.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function Qn(b,p,c){for(var d=0;d<b.length;d++)if(b[d].identifier===c)return p[d]}function Da(b){var p=ai();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function ai(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function uo(b){return Math.abs(b.y)>Math.abs(b.x)}var ro=100,Wi=function(b){yr()(c,b);var p=Da(c);function c(){var d;we()(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.valid=void 0,d.firstMove=void 0,d.lastPoints=void 0,d}return Ke()(c,[{key:"reset",value:function(){Tl()(yn()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(v){this.lastPoints=v,uo(v[0].sub(v[1]))&&(this.valid=!1)}},{key:"move",value:function(v,L,j){var se=v[0].sub(this.lastPoints[0]),oe=v[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(se,oe,j.timeStamp),!this.valid)return;this.lastPoints=v,this.active=!0;var le=(se.y+oe.y)/2,Tt=-.5;return{pitchDelta:le*Tt}}},{key:"gestureBeginsVertically",value:function(v,L,j){if(this.valid!==void 0)return this.valid;var se=2,oe=v.mag()>=se,le=L.mag()>=se;if(!oe&&!le)return;if(!oe||!le)return this.firstMove===void 0&&(this.firstMove=j),j-this.firstMove<ro?void 0:!1;var Tt=v.y>0===L.y>0;return uo(v)&&uo(L)&&Tt}}]),c}(Ma);function xi(b){var p=no();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function no(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Go=25;function Tu(b,p){return b.angleWith(p)*180/Math.PI}var _l=function(b){yr()(c,b);var p=xi(c);function c(){var d;we()(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.minDiameter=void 0,d}return Ke()(c,[{key:"reset",value:function(){Tl()(yn()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(v){this.startVector=this.vector=v[0].sub(v[1]),this.minDiameter=v[0].dist(v[1])}},{key:"move",value:function(v,L){var j=this.vector;return this.vector=v[0].sub(v[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:Tu(this.vector,j),pinchAround:L})}},{key:"isBelowThreshold",value:function(v){this.minDiameter=Math.min(this.minDiameter,v.mag());var L=Math.PI*this.minDiameter,j=Go/L*360,se=Tu(v,this.startVector);return Math.abs(se)<j}}]),c}(Ma);function Hs(b){var p=fs();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function fs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Ws=.1;function Zl(b,p){return Math.log(b/p)/Math.LN2}var _u=function(b){yr()(c,b);var p=Hs(c);function c(){var d;we()(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.distance=void 0,d.startDistance=void 0,d}return Ke()(c,[{key:"reset",value:function(){Tl()(yn()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(v){this.startDistance=this.distance=v[0].dist(v[1])}},{key:"move",value:function(v,L){var j=this.distance;return this.distance=v[0].dist(v[1]),!this.active&&Math.abs(Zl(this.distance,this.startDistance))<Ws?void 0:(this.active=!0,{zoomDelta:Zl(this.distance,j),pinchAround:L})}}]),c}(Ma);function Is(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Xl(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function Xl(b,p){if(!b)return;if(typeof b=="string")return Su(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Su(b,p)}function Su(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var Yl=function(p){return p.zoom||p.drag||p.pitch||p.rotate};function Au(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}var wo=function(){function b(p,c){var d=this;we()(this,b),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(Xt){d.handleEvent(Xt,"".concat(Xt.type,"Window"))},this.handleEvent=function(Xt,Kt){if(Xt.type==="blur"){d.stop();return}d.updatingCamera=!0;var tr=Xt.type==="renderFrame"?void 0:Xt,Cr={needsRenderFrame:!1},Fr={},ln={},hn=Xt.touches?d.getMapTouches(Xt.touches):void 0,$n=hn?Yo.touchPos(d.el,hn):Yo.mousePos(d.el,Xt),sa=Is(d.handlers),fa;try{for(sa.s();!(fa=sa.n()).done;){var ja=fa.value,_a=ja.handlerName,ii=ja.handler,Ka=ja.allowed;if(!ii.isEnabled())continue;var io=void 0;if(d.blockedByActive(ln,Ka,_a))ii.reset();else{var Ca=Kt||Xt.type;ii&&ii[Ca]&&(io=ii[Ca](Xt,$n,hn),d.mergeIHandlerResult(Cr,Fr,io,_a,tr),io&&io.needsRenderFrame&&d.triggerRenderFrame())}(io||ii.isActive())&&(ln[_a]=ii)}}catch(lu){sa.e(lu)}finally{sa.f()}var Ba={};for(var ac in d.previousActiveHandlers)ln[ac]||(Ba[ac]=tr);d.previousActiveHandlers=ln,(Object.keys(Ba).length||Au(Cr))&&(d.changes.push([Cr,Fr,Ba]),d.triggerRenderFrame()),(Object.keys(ln).length||Au(Cr))&&d.map.stop(!0),d.updatingCamera=!1;var ic=Cr.cameraAnimation;ic&&(d.inertia.clear(),d.fireEvents({},{}),d.changes=[],ic(d.map))},this.map=p,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new pf(p),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var v=this.el;this.listeners=[[v,"touchstart",{passive:!1}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];var L=Is(this.listeners),j;try{for(L.s();!(j=L.n()).done;){var se=Ki()(j.value,3),oe=se[0],le=se[1],Tt=se[2];Yo.addEventListener(oe,le,oe===window.document?this.handleWindowEvent:this.handleEvent,Tt)}}catch(Xt){L.e(Xt)}finally{L.f()}}return Ke()(b,[{key:"destroy",value:function(){var c=Is(this.listeners),d;try{for(c.s();!(d=c.n()).done;){var v=Ki()(d.value,3),L=v[0],j=v[1],se=v[2];Yo.removeEventListener(L,j,L===window.document?this.handleWindowEvent:this.handleEvent,se)}}catch(oe){c.e(oe)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Is(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var v=d.value.handler;v.reset()}}catch(L){c.e(L)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Is(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var v=d.value.handler;if(v.isActive())return!0}}catch(L){c.e(L)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(Yl(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,d,v,L,j){if(!v)return;Co()(c,v);var se={handlerName:L,originalEvent:v.originalEvent||j};v.zoomDelta!==void 0&&(d.zoom=se),v.panDelta!==void 0&&(d.drag=se),v.pitchDelta!==void 0&&(d.pitch=se),v.bearingDelta!==void 0&&(d.rotate=se)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(d){delete c.frameId,c.handleEvent(new Vl("renderFrame",{timeStamp:d})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var d=this.map,v=d.getCanvasContainer();this.add("mapEvent",new cl(d,c));var L=d.boxZoom=new Li(d,c);this.add("boxZoom",L);var j=new ca,se=new Ni;d.doubleClickZoom=new Qt(se,j),this.add("tapZoom",j),this.add("clickZoom",se);var oe=new ba;this.add("tapDragZoom",oe);var le=d.touchPitch=new Wi;this.add("touchPitch",le);var Tt=new Ee(c),Xt=new qe(c);d.dragRotate=new gr(c,Tt,Xt),this.add("mouseRotate",Tt,["mousePitch"]),this.add("mousePitch",Xt,["mouseRotate"]);var Kt=new R(c),tr=new Fn(c);d.dragPan=new Lr(v,Kt,tr),this.add("mousePan",Kt),this.add("touchPan",tr,["touchZoom","touchRotate"]);var Cr=new _l,Fr=new _u;d.touchZoomRotate=new Ar(v,Fr,Cr,oe),this.add("touchRotate",Cr,["touchPan","touchZoom"]),this.add("touchZoom",Fr,["touchPan","touchRotate"]);var ln=d.scrollZoom=new ir(d,this);this.add("scrollZoom",ln,["mousePan"]);var hn=d.keyboard=new Hl;this.add("keyboard",hn),this.add("blockableMapEvent",new Jc(d));for(var $n=0,sa=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];$n<sa.length;$n++){var fa=sa[$n];c.interactive&&c[fa]&&d[fa].enable(c[fa])}}},{key:"add",value:function(c,d,v){this.handlers.push({handlerName:c,handler:d,allowed:v}),this.handlersById[c]=d}},{key:"blockedByActive",value:function(c,d,v){for(var L in c){if(L===v)continue;if(!d||d.indexOf(L)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var d=[],v=Is(c),L;try{for(v.s();!(L=v.n()).done;){var j=L.value,se=j.target;this.el.contains(se)&&d.push(j)}}catch(oe){v.e(oe)}finally{v.f()}return d}},{key:"applyChanges",value:function(){var c={},d={},v={},L=Is(this.changes),j;try{for(L.s();!(j=L.n()).done;){var se=Ki()(j.value,3),oe=se[0],le=se[1],Tt=se[2];oe.panDelta&&(c.panDelta=(c.panDelta||new Ia(0,0))._add(oe.panDelta)),oe.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+oe.zoomDelta),oe.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+oe.bearingDelta),oe.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+oe.pitchDelta),oe.around!==void 0&&(c.around=oe.around),oe.pinchAround!==void 0&&(c.pinchAround=oe.pinchAround),oe.noInertia&&(c.noInertia=oe.noInertia),Co()(d,le),Co()(v,Tt)}}catch(Xt){L.e(Xt)}finally{L.f()}this.updateMapTransform(c,d,v),this.changes=[]}},{key:"updateMapTransform",value:function(c,d,v){var L=this.map,j=L.transform;if(!Au(c))return this.fireEvents(d,v);var se=c.panDelta,oe=c.zoomDelta,le=c.bearingDelta,Tt=c.pitchDelta,Xt=c.pinchAround,Kt=c.around;Xt!==void 0&&(Kt=Xt),L.stop(!0),Kt=Kt||L.transform.centerPoint;var tr=j.pointLocation(se?Kt.sub(se):Kt);le&&(j.bearing+=le),Tt&&(j.pitch+=Tt),oe&&(j.zoom+=oe),j.setLocationAtPoint(tr,Kt),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(d,v)}},{key:"fireEvents",value:function(c,d){var v=this,L=Yl(this.eventsInProgress),j=Yl(c),se={};for(var oe in c)if(c[oe]){var le=c[oe].originalEvent;this.eventsInProgress[oe]||(se["".concat(oe,"start")]=le),this.eventsInProgress[oe]=c[oe]}!L&&j&&this.fireEvent("movestart",j.originalEvent);for(var Tt in se)se[Tt]&&this.fireEvent(Tt,se[Tt]);c.rotate&&(this.bearingChanged=!0),j&&this.fireEvent("move",j.originalEvent);for(var Xt in c)if(c[Xt]){var Kt=c[Xt].originalEvent;this.fireEvent(Xt,Kt)}var tr={},Cr;for(var Fr in this.eventsInProgress)if(this.eventsInProgress[Fr]){var ln=this.eventsInProgress[Fr],hn=ln.handlerName,$n=ln.originalEvent;this.handlersById[hn].isActive()||(delete this.eventsInProgress[Fr],Cr=d[hn]||$n,tr["".concat(Fr,"end")]=Cr)}for(var sa in tr)tr[sa]&&this.fireEvent(sa,tr[sa]);var fa=Yl(this.eventsInProgress);if((L||j)&&!fa){this.updatingCamera=!0;var ja=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),_a=function(Ka){return Ka!==0&&-v.bearingSnap<Ka&&Ka<v.bearingSnap};ja?(_a(ja.bearing||this.map.getBearing())&&(ja.bearing=0),this.map.easeTo(ja,{originalEvent:Cr})):(this.map.emit("moveend",new Ua("moveend",{originalEvent:Cr})),_a(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,d){this.map.emit(c,new Ua(c,d?{originalEvent:d}:{}))}}]),b}(),zu=wo,Kl=i("DzJC"),qc=i.n(Kl),Oo=function(){function b(p){var c=this;we()(this,b),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var d=c.getCurrentHash();if(d.length>=3&&!d.some(function(L){return isNaN(+L)})){var v=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(d[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:v,pitch:+(d[4]||0)}),!0}return!1},this.getCurrentHash=function(){var d=window.location.hash.replace("#","");if(c.hashName){var v;return d.split("&").map(function(L){return L.split("=")}).forEach(function(L){L[0]===c.hashName&&(v=L)}),(v&&v[1]||"").split("/")}return d.split("/")},this.updateHashUnthrottled=function(){var d=c.getHashString();try{window.history.replaceState(window.history.state,"",d)}catch(v){}},this.hashName=p&&encodeURIComponent(p),this.updateHash=qc()(this.updateHashUnthrottled,30*1e3/100)}return Ke()(b,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var d=this.map.getCenter(),v=Math.round(this.map.getZoom()*100)/100,L=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),j=Math.pow(10,L),se=Math.round(d.lng*j)/j,oe=Math.round(d.lat*j)/j,le=this.map.getBearing(),Tt=this.map.getPitch(),Xt="";if(c?Xt+="/".concat(se,"/").concat(oe,"/").concat(v):Xt+="".concat(v,"/").concat(oe,"/").concat(se),(le||Tt)&&(Xt+="/".concat(Math.round(le*10)/10)),Tt&&(Xt+="/".concat(Math.round(Tt))),this.hashName){var Kt=this.hashName,tr=!1,Cr=window.location.hash.slice(1).split("&").map(function(Fr){var ln=Fr.split("=")[0];return ln===Kt?(tr=!0,"".concat(ln,"=").concat(Xt)):Fr}).filter(function(Fr){return Fr});return tr||Cr.push("".concat(Kt,"=").concat(Xt)),"#".concat(Cr.join("&"))}return"#".concat(Xt)}}]),b}(),Ds=Oo,rs=null,Zi=[],Zs=30,ao=1e3/Zs,Ns=window.performance,Xs={create:"create",load:"load",fullLoad:"fullLoad"},qu={mark:function(p){Ns.mark(p)},frame:function(p){var c=p;if(rs!=null){var d=c-rs;Zi.push(d)}rs=c},clearMetrics:function(){rs=null,Zi=[],Ns.clearMeasures("loadTime"),Ns.clearMeasures("fullLoadTime");for(var p in Xs)Ns.clearMarks(Xs[p])},getPerformanceMetrics:function(){var p=Ns.measure("loadTime",Xs.create,Xs.load).duration,c=Ns.measure("fullLoadTime",Xs.create,Xs.fullLoad).duration,d=Zi.length,v=Zi.reduce(function(oe,le){return oe+le},0)/d/1e3,L=1/v,j=Zi.filter(function(oe){return oe>ao}).reduce(function(oe,le){return oe+(le-ao)/ao},0),se=j/(d+j)*100;return{loadTime:p,fullLoadTime:c,fps:L,percentDroppedFrames:se}}};function gc(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=$l(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var d=0,v=function(){};return{s:v,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(le){throw le},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,se;return{s:function(){c=b[Symbol.iterator]()},n:function(){var le=c.next();return L=le.done,le},e:function(le){j=!0,se=le},f:function(){try{!L&&c.return!=null&&c.return()}finally{if(j)throw se}}}}function $l(b,p){if(!b)return;if(typeof b=="string")return Jl(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Jl(b,p)}function Jl(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}var Ys=function(){function b(){we()(this,b),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Ke()(b,[{key:"add",value:function(c){var d=++this.id,v=this.queue;return v.push({callback:c,id:d,cancelled:!1}),d}},{key:"remove",value:function(c){var d=this.currentlyRunning,v=d?this.queue.concat(d):this.queue,L=gc(v),j;try{for(L.s();!(j=L.n()).done;){var se=j.value;if(se.id===c){se.cancelled=!0;return}}}catch(oe){L.e(oe)}finally{L.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=this.currentlyRunning=this.queue;this.queue=[];var v=gc(d),L;try{for(v.s();!(L=v.n()).done;){var j=L.value;if(j.cancelled)continue;if(j.callback(c),this.cleared)break}}catch(se){v.e(se)}finally{v.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),b}(),Ho=Ys;function ef(b){var p=Ql();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Ql(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}i("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var ql=-2,_s=22,ec=0,vf=60,Pf={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:ql,maxZoom:_s,minPitch:ec,maxPitch:vf,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},oh=function(b){yr()(c,b);var p=ef(c);function c(d){var v;we()(this,c),v=p.call(this,Co()({},Pf,d)),v.doubleClickZoom=void 0,v.dragRotate=void 0,v.dragPan=void 0,v.touchZoomRotate=void 0,v.scrollZoom=void 0,v.keyboard=void 0,v.touchPitch=void 0,v.boxZoom=void 0,v.handlers=void 0,v.container=void 0,v.canvas=void 0,v.canvasContainer=void 0,v.renderTaskQueue=new Ho,v.frame=void 0,v.trackResize=!0,v.hash=void 0,v.onWindowOnline=function(){v.update()},v.onWindowResize=function(j){v.trackResize&&v.resize({originalEvent:j}).update()},v.initContainer(),v.resize(),v.handlers=new zu(gl()(v),v.options),typeof window!="undefined"&&(window.addEventListener("online",v.onWindowOnline,!1),window.addEventListener("resize",v.onWindowResize,!1),window.addEventListener("orientationchange",v.onWindowResize,!1));var L=typeof d.hash=="string"&&d.hash||void 0;return d.hash&&(v.hash=new Ds(L).addTo(gl()(v))),(!v.hash||!v.hash.onHashChange())&&(v.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(v.resize(),v.fitBounds(d.bounds,Co()({},d.fitBoundsOptions,{duration:0})))),v}return Ke()(c,[{key:"resize",value:function(v){var L=this.containerDimensions(),j=L[0],se=L[1];this.transform.resize(j,se);var oe=!this.moving;return oe&&(this.stop(),this.emit("movestart",new Event("movestart",v)),this.emit("move",new Event("move",v))),this.emit("resize",new Event("resize",v)),oe&&this.emit("moveend",new Event("moveend",v)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(v){return this.transform.locationPoint(oi.convert(v))}},{key:"unproject",value:function(v){return this.transform.pointLocation(Ia.convert(v))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(v){this.transform.setMaxBounds(No.convert(v))}},{key:"setStyle",value:function(v){return}},{key:"setMinZoom",value:function(v){if(v=v==null?ql:v,v>=ql&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between ".concat(ql," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(v){if(v=v==null?_s:v,v>=this.transform.minZoom)return this.transform.maxZoom=v,this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(v){if(v=v==null?ec:v,v<ec)throw new Error("minPitch must be greater than or equal to ".concat(ec));if(v>=ec&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between ".concat(ec," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(v){if(v=v==null?vf:v,v>vf)throw new Error("maxPitch must be less than or equal to ".concat(vf));if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(v){this.transform.renderWorldCopies=!!v}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(v){return this.update(),this.renderTaskQueue.add(v)}},{key:"cancelRenderFrame",value:function(v){return this.renderTaskQueue.remove(v)}},{key:"triggerRepaint",value:function(){var v=this;this.frame||(this.frame=Of(function(L){qu.frame(L),v.frame=null,v.update(L)}))}},{key:"update",value:function(v){var L=this;this.frame||(this.frame=Of(function(j){qu.frame(j),L.frame=null,L.renderTaskQueue.run(v)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var v=this.container;v.classList.add("l7-map");var L=this.canvasContainer=oa.a.create("div","l7-canvas-container",v);this.options.interactive&&L.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var v=0,L=0;return this.container&&(v=this.container.clientWidth||400,L=this.container.clientHeight||300),[v,L]}},{key:"resizeCanvas",value:function(v,L){var j=window.devicePixelRatio||1;this.canvas.width=j*v,this.canvas.height=j*L,this.canvas.style.width="".concat(v,"px"),this.canvas.style.height="".concat(L,"px")}}]),c}(bl),el=function(){function b(){we()(this,b),this.viewport=void 0}return Ke()(b,[{key:"syncWithMapCamera",value:function(c){var d=c.center,v=c.zoom,L=c.pitch,j=c.bearing,se=c.viewportHeight,oe=c.viewportWidth;this.viewport=new Hc({width:oe,height:se,longitude:d&&d[0],latitude:d&&d[1],zoom:v,pitch:L,bearing:j})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),b}(),gf={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},tc,tf,rf,Lf,$f,Pc,Lc,Rc,Jf,Rf,Qf,Ic,sh,yo;function rc(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function yf(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?rc(Object(c),!0).forEach(function(d){ma()(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):rc(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}var nc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},nf=12,Dc=(tc=Object(va.injectable)(),tf=Object(va.inject)(pe.TYPES.MapConfig),rf=Object(va.inject)(pe.TYPES.IGlobalConfigService),Lf=Object(va.inject)(pe.TYPES.ILogService),$f=Object(va.inject)(pe.TYPES.ICoordinateSystemService),Pc=Object(va.inject)(pe.TYPES.IEventEmitter),tc(Lc=(Rc=(yo=function(){function b(){var p=this;we()(this,b),this.map=void 0,Wn()(this,"config",Jf,this),Wn()(this,"configService",Rf,this),Wn()(this,"logger",Qf,this),Wn()(this,"coordinateSystemService",Ic,this),Wn()(this,"eventEmitter",sh,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=p.map.getCenter(),d=c.lat,v=c.lng;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[v,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>nf?p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(pe.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Ke()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=oa.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){pe.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(nc[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(nc[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,d,v){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var p=Kn()(Tn.a.mark(function d(){var v,L,j,se,oe,le,Tt,Xt,Kt,tr,Cr;return Tn.a.wrap(function(ln){for(;;)switch(ln.prev=ln.next){case 0:v=this.config,L=v.id,j=L===void 0?"map":L,se=v.attributionControl,oe=se===void 0?!1:se,le=v.style,Tt=le===void 0?"light":le,Xt=v.rotation,Kt=Xt===void 0?0:Xt,tr=v.mapInstance,Cr=Jr()(v,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new el,tr?(this.map=tr,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(j),this.map=new oh(yf({container:this.$mapContainer,style:this.getMapStyle(Tt),bearing:Kt},Cr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return ln.stop()}},d,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).emit.apply(d,[c].concat(L))}},{key:"once",value:function(c){for(var d,v=arguments.length,L=new Array(v>1?v-1:0),j=1;j<v;j++)L[j-1]=arguments[j];(d=this.eventEmitter).once.apply(d,[c].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),v=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return v}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;return typeof c=="string"&&(d=document.getElementById(c)),d}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:gf[c]?gf[c]:c}}]),b}(),yo),Jf=H()(Rc.prototype,"config",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf=H()(Rc.prototype,"configService",[rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=H()(Rc.prototype,"logger",[Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic=H()(Rc.prototype,"coordinateSystemService",[$f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sh=H()(Rc.prototype,"eventEmitter",[Pc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rc))||Lc);function Fu(b){var p=Nc();return function(){var d=yn()(b),v;if(p){var L=yn()(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return hr()(this,v)}}function Nc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var kc=function(b){yr()(c,b);var p=Fu(c);function c(){return we()(this,c),p.apply(this,arguments)}return Ke()(c,[{key:"getServiceConstructor",value:function(){return Dc}}]),c}(ur);function bf(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function xf(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?bf(Object(c),!0).forEach(function(d){Gf(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):bf(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}function Gf(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function yc(b,p){return V(b)||N(b,p)||ee(b,p)||Sl()}function Sl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ee(b,p){if(!b)return;if(typeof b=="string")return ae(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ae(b,p)}function ae(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function N(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function V(b){if(Array.isArray(b))return b}var Te=Ce.a.memo(function(b){var p=b.style,c=b.className,d=b.map,v=b.option,L=b.onSceneLoaded,j=Object(ge.createRef)(),se=Object(ge.useState)(),oe=yc(se,2),le=oe[0],Tt=oe[1];return Object(ge.useEffect)(function(){var Xt=new Ct.Scene(xf(xf({id:j.current},v),{},{map:new kc(d)}));return Xt.on("loaded",function(){Tt(Xt),L&&L(Xt)}),function(){Xt.destroy()}},[]),Object(ge.useEffect)(function(){le&&d.style&&le.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(ge.useEffect)(function(){le&&d.zoom&&le.setZoom(d.zoom)},[d.zoom]),Object(ge.useEffect)(function(){le&&d.center&&le.setCenter(d.center)},[JSON.stringify(d.center)]),Object(ge.useEffect)(function(){le&&d.pitch&&le.setPitch(d.pitch)},[d.pitch]),Object(ge.useEffect)(function(){le&&d.rotation&&le.setRotation(d.rotation)},[d.rotation]),Ce.a.createElement(lt.Provider,{value:le},Object(ge.createElement)("div",{ref:j,style:p,className:c},le&&b.children))}),it=Te;function Zt(b,p){return Gn(b)||on(b,p)||nr(b,p)||ar()}function ar(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nr(b,p){if(!b)return;if(typeof b=="string")return Dr(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Dr(b,p)}function Dr(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function on(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function Gn(b){if(Array.isArray(b))return b}var na=Ce.a.memo(function(b){var p=b.style,c=b.className,d=b.map,v=Object(ge.createRef)(),L=Object(ge.useState)(),j=Zt(L,2),se=j[0],oe=j[1];return Object(ge.useEffect)(function(){var le=new Ct.Scene({id:v.current,map:d});return le.on("loaded",function(){oe(le)}),function(){le.destroy()}},[]),Ce.a.createElement(lt.Provider,{value:se},Object(ge.createElement)("div",{ref:v,style:p,className:c},se&&b.children))});function aa(b,p){return qi(b)||Ha(b,p)||Ya(b,p)||si()}function si(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ya(b,p){if(!b)return;if(typeof b=="string")return Ri(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ri(b,p)}function Ri(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function Ha(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function qi(b){if(Array.isArray(b))return b}var hs=Ce.a.memo(function(p){var c=dt(),d=Object(ge.useState)(),v=aa(d,2),L=v[1],j=p.type,se=p.position;return Object(ge.useEffect)(function(){var oe;switch(j){case"scale":oe=new Ct.Scale({position:se||"bottomright"});break;case"zoom":oe=new Ct.Zoom({position:se||"topright"});break;case"logo":oe=new Ct.Logo({position:se||"bottomleft"})}return L(oe),c.addControl(oe),function(){c.removeControl(oe)}},[j,se]),null}),Xi=i("i8i4"),pi=ge.useEffect,ks=ge.useState;function Yi(b){var p=b.className,c=b.style,d=b.children,v=b.position,L=dt(),j=document.createElement("div");return pi(function(){var se=new Ct.Control({position:v});return se.onAdd=function(){if(p&&(j.className=p),c){var oe=Object.keys(c).map(function(le){return"".concat(le,":").concat(c[le])}).join(";");j.style.cssText=oe}return j},L.addControl(se),function(){L.removeControl(se)}},[]),Object(Xi.createPortal)(d,j)}var bo=Object(ge.createContext)({});function ds(){return Object(ge.useContext)(bo)}var Ai=ge.useEffect,xo=ge.memo(function(p){var c=p.layer,d=p.active;return Ai(function(){c.active(d.option)},[JSON.stringify(d)]),null}),Aa=ge.useEffect,ko=ge.memo(function(p){var c=p.layer,d=p.animate;return Aa(function(){c.animate(d)},[JSON.stringify(d)]),null}),bc=ge.useEffect,Hf=ge.memo(function(p){var c=p.layer,d=p.color;return bc(function(){d.field?c.color(d.field,d.values):c.color(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Ks=ge.useEffect,uh=ge.memo(function(p){var c=p.layer,d=p.filter;return Ks(function(){d.field&&c.filter(d.field,d.values)},[d.field,d.values,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Vh=ge.useEffect,Wf=ge.memo(function(p){var c=p.layer,d=p.scale;return Vh(function(){c.scale(d.values)},[d.values]),null}),If=ge.useEffect,qf=ge.memo(function(p){var c=p.layer,d=p.select;return If(function(){c.select(d.option)},[JSON.stringify(d)]),null}),Ch=ge.useEffect,wh=ge.memo(function(p){var c=p.layer,d=p.shape;return Ch(function(){d.field?c.shape(d.field,d.values):c.shape(d.values)},[d.field,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Df=ge.useEffect,eh=ge.memo(function(p){var c=p.layer,d=p.size;return Df(function(){d.field?c.size(d.field,d.values):c.size(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null});function th(b,p){if(b==null)return{};var c=Oh(b,p),d,v;if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(b);for(v=0;v<L.length;v++){if(d=L[v],p.indexOf(d)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(b,d))continue;c[d]=b[d]}}return c}function Oh(b,p){if(b==null)return{};var c={},d=Object.keys(b),v,L;for(L=0;L<d.length;L++){if(v=d[L],p.indexOf(v)>=0)continue;c[v]=b[v]}return c}var rh=ge.useEffect,Nf=ge.memo(function(p){var c=p.layer,d=p.source,v=d.data,L=th(d,["data"]);return rh(function(){c.inited?c.setData(v,L):c.source(v,L),L.autoFit&&c.fitBounds(L&&L.fitBoundsOptions)},[v,JSON.stringify(L)]),null}),vh=ge.useEffect,lh=ge.memo(function(p){var c=p.layer,d=p.style;return vh(function(){c.style(d)},Object.keys(d).map(function(v){return d[v]})),null});function fe(b,p){return Rr(b)||Ur(b,p)||Nt(b,p)||ke()}function ke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nt(b,p){if(!b)return;if(typeof b=="string")return vr(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vr(b,p)}function vr(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,d=new Array(p);c<p;c++)d[c]=b[c];return d}function Ur(b,p){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))return;var c=[],d=!0,v=!1,L=void 0;try{for(var j=b[Symbol.iterator](),se;!(d=(se=j.next()).done)&&!(c.push(se.value),p&&c.length===p);d=!0);}catch(oe){v=!0,L=oe}finally{try{!d&&j.return!=null&&j.return()}finally{if(v)throw L}}return c}function Rr(b){if(Array.isArray(b))return b}var Er=ge.useEffect,Yr=ge.useState;function qr(b,p){var c=p.source,d=p.color,v=p.shape,L=p.style,j=p.size,se=p.scale,oe=p.active,le=p.select,Tt=p.filter,Xt=p.animate,Kt=p.options,tr=p.onLayerLoaded,Cr=dt(),Fr=Yr(),ln=fe(Fr,2),hn=ln[0],$n=ln[1];if(!hn){var sa;switch(b){case"polygonLayer":sa=new Ct.PolygonLayer(Kt);break;case"lineLayer":sa=new Ct.LineLayer(Kt);break;case"pointLayer":sa=new Ct.PointLayer(Kt);break;case"heatmapLayer":sa=new Ct.HeatmapLayer(Kt);break;case"rasterLayer":sa=new Ct.RasterLayer(Kt);break;case"imageLayer":sa=new Ct.ImageLayer(Kt);break;case"citybuildingLayer":sa=new Ct.CityBuildingLayer(Kt);break;default:sa=new Ct.PolygonLayer(Kt)}sa.on("inited",function(){tr&&tr(sa,Cr)}),$n(sa)}return Er(function(){if(hn!==void 0)return Cr.addLayer(hn),function(){Cr.removeLayer(hn)}},[]),Er(function(){hn&&Cr.render()}),Er(function(){hn&&hn.inited&&Kt&&hn.updateLayerConfig(Kt)},[Kt==null?void 0:Kt.minZoom,Kt==null?void 0:Kt.maxZoom,Kt==null?void 0:Kt.visible]),Er(function(){hn&&hn.inited&&Kt&&Kt.zIndex&&hn.setIndex(Kt.zIndex)},[Kt==null?void 0:Kt.zIndex]),Er(function(){hn&&hn.inited&&Kt&&Kt.blend&&hn.setBlend(Kt.blend)},[Kt==null?void 0:Kt.blend]),hn!=null?ge.createElement(bo.Provider,{value:hn},ge.createElement(Nf,{layer:hn,source:c}),se&&ge.createElement(Wf,{layer:hn,scale:se}),d&&ge.createElement(Hf,{layer:hn,color:d}),j&&ge.createElement(eh,{layer:hn,size:j}),v&&ge.createElement(wh,{layer:hn,shape:v}),L&&ge.createElement(lh,{layer:hn,style:L}),oe&&ge.createElement(xo,{layer:hn,active:oe}),le&&ge.createElement(qf,{layer:hn,select:le}),Tt&&ge.createElement(uh,{layer:hn,filter:Tt}),Xt&&ge.createElement(ko,{layer:hn,animate:Xt}),p.children):null}var sn=ge.memo(function(p){return qr("polygonLayer",p)}),an=ge.memo(function(p){return qr("lineLayer",p)}),cn=ge.memo(function(p){return qr("pointLayer",p)}),An=ge.memo(function(p){return qr("heatmapLayer",p)}),pn=ge.memo(function(p){return qr("rasterLayer",p)}),un=ge.memo(function(p){return qr("imagelayer",p)}),Tr=ge.memo(function(p){return qr("citybuildinglayer",p)}),xr=ge.useEffect,tn=ge.memo(function(b){var p=b.type,c=b.handler,d=ds();return xr(function(){return d.off(p,c),d.on(p,c),function(){d.off(p,c)}},[p,c]),null}),Ln=i("dgMf"),kr=ge.memo(function(b){var p=b.className,c=b.style,d=b.title,v=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return ge.createElement("div",null,ge.createElement("div",null,v.map(function(L,j){return ge.createElement("div",{key:j.toString(),style:{background:L.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-v.length)/v.length+"%",marginRight:"1%",padding:5}})})),ge.createElement("div",null,v.map(function(L,j){return ge.createElement("div",{key:j.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-v.length)/v.length+"%",marginRight:"1%"}},L.title)})))});function Yn(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yn=function(c){return typeof c}:Yn=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Yn(b)}function $r(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(b);p&&(d=d.filter(function(v){return Object.getOwnPropertyDescriptor(b,v).enumerable})),c.push.apply(c,d)}return c}function Br(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?$r(Object(c),!0).forEach(function(d){Gr(b,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):$r(Object(c)).forEach(function(d){Object.defineProperty(b,d,Object.getOwnPropertyDescriptor(c,d))})}return b}function Gr(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function Xr(b,p){if(!(b instanceof p))throw new TypeError("Cannot call a class as a function")}function Hn(b,p){for(var c=0;c<p.length;c++){var d=p[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(b,d.key,d)}}function qn(b,p,c){return p&&Hn(b.prototype,p),c&&Hn(b,c),b}function fn(b,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(p&&p.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),p&&rn(b,p)}function rn(b,p){return rn=Object.setPrototypeOf||function(d,v){return d.__proto__=v,d},rn(b,p)}function zr(b){var p=Un();return function(){var d=Fa(b),v;if(p){var L=Fa(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return Ea(this,v)}}function Ea(b,p){return p&&(Yn(p)==="object"||typeof p=="function")?p:Wa(b)}function Wa(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function Un(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function Fa(b){return Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Fa(b)}var Pa=function(b){fn(c,b);var p=zr(c);function c(d){var v;return Xr(this,c),v=p.call(this,d),v.el=document.createElement("div"),v}return qn(c,[{key:"componentDidMount",value:function(){var v=this.props,L=v.lnglat,j=v.children,se=v.option,oe=new Ct.Popup(Br(Br({},se),{},{stopPropagation:!1}));L&&oe.setLnglat(L),j&&oe.setDOMContent(this.el),this.popup=oe,this.scene.addPopup(oe)}},{key:"componentDidUpdate",value:function(v){var L,j,se,oe,le,Tt,Xt=Array.isArray(v.lnglat)?v.lnglat:[v==null||((L=v.lnglat)===null||L===void 0)?void 0:L.lng,v==null||((j=v.lnglat)===null||j===void 0)?void 0:j.lat],Kt=Array.isArray(this.props.lnglat)?this.props.lnglat:[(se=this.props)===null||se===void 0||((oe=se.lnglat)===null||oe===void 0)?void 0:oe.lng,(le=this.props)===null||le===void 0||((Tt=le.lnglat)===null||Tt===void 0)?void 0:Tt.lat],tr=Xt.toString()!==Kt.toString();tr&&(this.popup.remove(),this.popup=new Ct.Popup(Br(Br({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var v=this;return ge.createElement(lt.Consumer,{},function(L){return L&&(v.scene=L),Object(Xi.createPortal)(v.props.children,v.el)})}}]),c}(ge.PureComponent);function Na(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Na=function(c){return typeof c}:Na=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Na(b)}function Ci(b,p){if(!(b instanceof p))throw new TypeError("Cannot call a class as a function")}function Wo(b,p){for(var c=0;c<p.length;c++){var d=p[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(b,d.key,d)}}function Mo(b,p,c){return p&&Wo(b.prototype,p),c&&Wo(b,c),b}function ti(b,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(p&&p.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),p&&jo(b,p)}function jo(b,p){return jo=Object.setPrototypeOf||function(d,v){return d.__proto__=v,d},jo(b,p)}function Bi(b){var p=$o();return function(){var d=Po(b),v;if(p){var L=Po(this).constructor;v=Reflect.construct(d,arguments,L)}else v=d.apply(this,arguments);return Ss(this,v)}}function Ss(b,p){return p&&(Na(p)==="object"||typeof p=="function")?p:Ko(b)}function Ko(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function Po(b){return Po=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Po(b)}var su=function(b){ti(c,b);var p=Bi(c);function c(d){var v;return Ci(this,c),v=p.call(this,d),v.el=document.createElement("div"),v}return Mo(c,[{key:"componentDidMount",value:function(){var v=this.props,L=v.lnglat,j=v.children,se=v.option,oe=v.onMarkerLoaded,le=new Ct.Marker(se);L&&le.setLnglat(L),j&&le.setElement(this.el),this.marker=le,oe&&oe(le),this.scene.addMarker(le)}},{key:"componentDidUpdate",value:function(v){var L,j=(v==null?void 0:v.lnglat.toString())!==((L=this.props)===null||L===void 0?void 0:L.lnglat.toString());j&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var v=this;return ge.createElement(lt.Consumer,{},function(L){return L&&(v.scene=L),Object(Xi.createPortal)(v.props.children,v.el)})}}]),c}(ge.PureComponent),Jo=ge.useEffect,ia=ge.memo(function(b){var p=b.type,c=b.handler,d=dt();return Jo(function(){return d.on(p,c),function(){d.off(p,c)}},[p]),null}),uu=ia,wi=ge.useEffect,Cn=ge.memo(function(p){var c=p.name,d=p.url,v=dt();return wi(function(){v.addImage(c,d)},[c,d]),null}),ka=i("tbuW"),Qa=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Lo=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){var d;Object(D.a)(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.state={data:null,grid:null,loading:!1},d}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){var d=Object(cr.a)(zt.a.mark(function L(){var j,se,oe,le;return zt.a.wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:return Xt.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Kt){return Kt.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Kt){return Kt.json()})]);case 2:j=Xt.sent,se=Object(J.a)(j,2),oe=se[0],le=se[1],this.setState({data:oe,grid:le,loading:!0});case 7:case"end":return Xt.stop()}},L,this)}));function v(){return d.apply(this,arguments)}return v}()},{key:"render",value:function(){var v=this.state,L=v.data,j=v.grid,se=v.loading;return se===!1?ge.createElement(ka.a,null):ge.createElement(Yu,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},j&&ge.createElement(An,{key:"1",source:{data:j,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),L&&[ge.createElement(cn,{key:"2",options:{autoFit:!0},source:{data:L},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Qa},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),ge.createElement(cn,{key:"5",source:{data:L},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(le){return le>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),c}(ge.Component),Cu={Pie:I,WaterWave:te,Gauge:Bt,MiniArea:G,TagCloud:tt,Map:Lo},Al=i("oBTY"),Ot=i("H+7v"),_r=i.n(Ot);function br(b){return b*1<10?"0".concat(b):b}function On(){for(var b=[],p=0;p<24;p+=1)b.push({x:"".concat(br(p),":00"),y:Math.floor(Math.random()*200)+p*50});return b}var Ra=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){var d;Object(D.a)(this,c);for(var v=arguments.length,L=new Array(v),j=0;j<v;j++)L[j]=arguments[j];return d=p.call.apply(p,[this].concat(L)),d.state={activeData:On()},d.timer=void 0,d.requestRef=void 0,d.loopData=function(){d.requestRef=requestAnimationFrame(function(){d.timer=window.setTimeout(function(){d.setState({activeData:On()},function(){d.loopData()})},1e3)})},d}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var v=this.state.activeData,L=v===void 0?[]:v;return Ce.a.createElement("div",{className:_r.a.activeChart},Ce.a.createElement(je.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Ce.a.createElement("div",{style:{marginTop:32}},Ce.a.createElement(G,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:L})),L&&Ce.a.createElement("div",null,Ce.a.createElement("div",{className:_r.a.activeChartGrid},Ce.a.createElement("p",null,Object(Al.a)(L).sort()[L.length-1].y+200," \u4EBF\u5143"),Ce.a.createElement("p",null,Object(Al.a)(L).sort()[Math.floor(L.length/2)].y," \u4EBF\u5143")),Ce.a.createElement("div",{className:_r.a.dashedLine},Ce.a.createElement("div",{className:_r.a.line})),Ce.a.createElement("div",{className:_r.a.dashedLine},Ce.a.createElement("div",{className:_r.a.line}))),L&&Ce.a.createElement("div",{className:_r.a.activeChartLegend},Ce.a.createElement("span",null,"00:00"),Ce.a.createElement("span",null,L[Math.floor(L.length/2)].x),Ce.a.createElement("span",null,L[L.length-1].x)))}}]),c}(ge.Component),vt=i("Wnft"),Qe=i.n(vt),Ht=je.a.Countdown,lr=Date.now()+1e3*60*60*24*2+1e3*30,fr=function(b){Object(q.a)(c,b);var p=Object(he.a)(c);function c(){return Object(D.a)(this,c),p.apply(this,arguments)}return Object(Y.a)(c,[{key:"componentDidMount",value:function(){var v=this.props.dispatch;v({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var v=this.props,L=v.dashboardAndmonitor,j=v.loading,se=L.tags;return Ce.a.createElement(ht.a,null,Ce.a.createElement(Ce.a.Fragment,null,Ce.a.createElement(z.a,{gutter:24},Ce.a.createElement(W.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},Ce.a.createElement(z.a,null,Ce.a.createElement(W.a,{md:6,sm:12,xs:24},Ce.a.createElement(je.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:Et()(124543233).format("0,0")})),Ce.a.createElement(W.a,{md:6,sm:12,xs:24},Ce.a.createElement(je.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),Ce.a.createElement(W.a,{md:6,sm:12,xs:24},Ce.a.createElement(Ht,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:lr,format:"HH:mm:ss:SSS"})),Ce.a.createElement(W.a,{md:6,sm:12,xs:24},Ce.a.createElement(je.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:Et()(234).format("0,0")}))),Ce.a.createElement("div",{className:Qe.a.mapChart},Ce.a.createElement(Lo,null)))),Ce.a.createElement(W.a,{xl:6,lg:24,md:24,sm:24,xs:24},Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},Ce.a.createElement(Ra,null)),Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},Ce.a.createElement(Bt,{title:Object(Ge.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),Ce.a.createElement(z.a,{gutter:24},Ce.a.createElement(W.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:Qe.a.pieCard},Ce.a.createElement(z.a,{style:{padding:"16px 0"}},Ce.a.createElement(W.a,{span:8},Ce.a.createElement(I,{animate:!1,percent:28,title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),Ce.a.createElement(W.a,{span:8},Ce.a.createElement(I,{animate:!1,color:"#5DDECF",percent:22,title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),Ce.a.createElement(W.a,{span:8},Ce.a.createElement(I,{animate:!1,color:"#2FC25B",percent:32,title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),Ce.a.createElement(W.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:j,bordered:!1,bodyStyle:{overflow:"hidden"}},Ce.a.createElement(tt,{data:se||[],height:161}))),Ce.a.createElement(W.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Ce.a.createElement(m.a,{title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},Ce.a.createElement(te,{height:161,title:Ce.a.createElement(Ge.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),c}(ge.Component),$t=E.default=Object(Ge.c)(function(b){var p=b.dashboardAndmonitor,c=b.loading;return{dashboardAndmonitor:p,loading:c.models.dashboardAndmonitor}})(fr)},aF1E:function(Le,E,i){"use strict";i.d(E,"a",function(){return o});var T=i("lSNA"),m=i.n(T);function Z(W,D){var Y=Object.keys(W);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(W);D&&(q=q.filter(function(he){return Object.getOwnPropertyDescriptor(W,he).enumerable})),Y.push.apply(Y,q)}return Y}function z(W){for(var D=1;D<arguments.length;D++){var Y=arguments[D]!=null?arguments[D]:{};D%2?Z(Object(Y),!0).forEach(function(q){m()(W,q,Y[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(Y)):Z(Object(Y)).forEach(function(q){Object.defineProperty(W,q,Object.getOwnPropertyDescriptor(Y,q))})}return W}function o(W,D){var Y=D.sourceField,q=D.targetField,he=D.data,X={};return he.forEach(function(je){X[je[Y]]=je}),W.dataArray=W.dataArray.map(function(je){var Ge=je[q];return z(z({},je),X[Ge])}),W}},aHsQ:function(Le,E,i){"use strict";var T=i("cIOH"),m=i.n(T),Z=i("6D9b"),z=i.n(Z),o=i("cWXX")},aPG5:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),Z=i("qK8v"),z=i("ujMp"),o=i("cSJO"),W=function(he,X,je){try{return je()}catch(Ge){throw Z.isStackOverflowExeption(Ge)?new Error(T.CIRCULAR_DEPENDENCY_IN_FACTORY(he,X.toString())):Ge}},D=function q(he){return function(X){X.parentContext.setCurrentRequest(X);var je=X.bindings,Ge=X.childRequests,ge=X.target&&X.target.isArray(),Ce=!X.parentRequest||!X.parentRequest.target||!X.target||!X.parentRequest.target.matchesArray(X.target.serviceIdentifier);if(ge&&Ce)return Ge.map(function(Ye){var xt=q(he);return xt(Ye)});var ht=null;if(X.target.isOptional()&&je.length===0)return;var Ne=je[0],Et=Ne.scope===m.BindingScopeEnum.Singleton,He=Ne.scope===m.BindingScopeEnum.Request;if(Et&&Ne.activated)return Ne.cache;if(He&&he!==null&&he.has(Ne.id))return he.get(Ne.id);if(Ne.type===m.BindingTypeEnum.ConstantValue)ht=Ne.cache;else if(Ne.type===m.BindingTypeEnum.Function)ht=Ne.cache;else if(Ne.type===m.BindingTypeEnum.Constructor)ht=Ne.implementationType;else if(Ne.type===m.BindingTypeEnum.DynamicValue&&Ne.dynamicValue!==null)ht=W("toDynamicValue",Ne.serviceIdentifier,function(){return Ne.dynamicValue(X.parentContext)});else if(Ne.type===m.BindingTypeEnum.Factory&&Ne.factory!==null)ht=W("toFactory",Ne.serviceIdentifier,function(){return Ne.factory(X.parentContext)});else if(Ne.type===m.BindingTypeEnum.Provider&&Ne.provider!==null)ht=W("toProvider",Ne.serviceIdentifier,function(){return Ne.provider(X.parentContext)});else if(Ne.type===m.BindingTypeEnum.Instance&&Ne.implementationType!==null)ht=o.resolveInstance(Ne.implementationType,Ge,q(he));else{var mt=z.getServiceIdentifierAsString(X.serviceIdentifier);throw new Error(T.INVALID_BINDING_TYPE+" "+mt)}return typeof Ne.onActivation=="function"&&(ht=Ne.onActivation(X.parentContext,ht)),Et&&(Ne.cache=ht,Ne.activated=!0),He&&he!==null&&!he.has(Ne.id)&&he.set(Ne.id,ht),ht}};function Y(q){var he=D(q.plan.rootRequest.requestScope);return he(q.plan.rootRequest)}E.resolve=Y},asDA:function(Le,E){function i(T,m,Z,z){var o=-1,W=T==null?0:T.length;for(z&&W&&(Z=T[++o]);++o<W;)Z=m(Z,T[o],o,T);return Z}Le.exports=i},b2z7:function(Le,E){var i=/\w*$/;function T(m){var Z=new m.constructor(m.source,i.exec(m));return Z.lastIndex=m.lastIndex,Z}Le.exports=T},bB6j:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Normal="normal",m.PostProcessing="post-processing"})(T||(T={}))},bTtR:function(Le,E){},bYl4:function(Le,E){},bahg:function(Le,E){function i(T){return T.split("")}Le.exports=i},bl9R:function(Le,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return Z}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return W}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return Y}),i.d(E,"multiply",function(){return q}),i.d(E,"divide",function(){return he}),i.d(E,"ceil",function(){return X}),i.d(E,"floor",function(){return je}),i.d(E,"min",function(){return Ge}),i.d(E,"max",function(){return ge}),i.d(E,"round",function(){return Ce}),i.d(E,"scale",function(){return ht}),i.d(E,"scaleAndAdd",function(){return Ne}),i.d(E,"distance",function(){return Et}),i.d(E,"squaredDistance",function(){return He}),i.d(E,"length",function(){return mt}),i.d(E,"squaredLength",function(){return Ye}),i.d(E,"negate",function(){return xt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ie}),i.d(E,"dot",function(){return De}),i.d(E,"cross",function(){return ze}),i.d(E,"lerp",function(){return at}),i.d(E,"random",function(){return Pe}),i.d(E,"transformMat4",function(){return ot}),i.d(E,"transformQuat",function(){return Bt}),i.d(E,"zero",function(){return Wt}),i.d(E,"str",function(){return sr}),i.d(E,"exactEquals",function(){return ne}),i.d(E,"equals",function(){return $}),i.d(E,"sub",function(){return G}),i.d(E,"mul",function(){return Ae}),i.d(E,"div",function(){return xe}),i.d(E,"dist",function(){return Se}),i.d(E,"sqrDist",function(){return ve}),i.d(E,"len",function(){return et}),i.d(E,"sqrLen",function(){return Yt}),i.d(E,"forEach",function(){return At});var T=i("yU0y");function m(){var ye=new T.a(4);return T.a!=Float32Array&&(ye[0]=0,ye[1]=0,ye[2]=0,ye[3]=0),ye}function Z(ye){var be=new T.a(4);return be[0]=ye[0],be[1]=ye[1],be[2]=ye[2],be[3]=ye[3],be}function z(ye,be,Ue,st){var Me=new T.a(4);return Me[0]=ye,Me[1]=be,Me[2]=Ue,Me[3]=st,Me}function o(ye,be){return ye[0]=be[0],ye[1]=be[1],ye[2]=be[2],ye[3]=be[3],ye}function W(ye,be,Ue,st,Me){return ye[0]=be,ye[1]=Ue,ye[2]=st,ye[3]=Me,ye}function D(ye,be,Ue){return ye[0]=be[0]+Ue[0],ye[1]=be[1]+Ue[1],ye[2]=be[2]+Ue[2],ye[3]=be[3]+Ue[3],ye}function Y(ye,be,Ue){return ye[0]=be[0]-Ue[0],ye[1]=be[1]-Ue[1],ye[2]=be[2]-Ue[2],ye[3]=be[3]-Ue[3],ye}function q(ye,be,Ue){return ye[0]=be[0]*Ue[0],ye[1]=be[1]*Ue[1],ye[2]=be[2]*Ue[2],ye[3]=be[3]*Ue[3],ye}function he(ye,be,Ue){return ye[0]=be[0]/Ue[0],ye[1]=be[1]/Ue[1],ye[2]=be[2]/Ue[2],ye[3]=be[3]/Ue[3],ye}function X(ye,be){return ye[0]=Math.ceil(be[0]),ye[1]=Math.ceil(be[1]),ye[2]=Math.ceil(be[2]),ye[3]=Math.ceil(be[3]),ye}function je(ye,be){return ye[0]=Math.floor(be[0]),ye[1]=Math.floor(be[1]),ye[2]=Math.floor(be[2]),ye[3]=Math.floor(be[3]),ye}function Ge(ye,be,Ue){return ye[0]=Math.min(be[0],Ue[0]),ye[1]=Math.min(be[1],Ue[1]),ye[2]=Math.min(be[2],Ue[2]),ye[3]=Math.min(be[3],Ue[3]),ye}function ge(ye,be,Ue){return ye[0]=Math.max(be[0],Ue[0]),ye[1]=Math.max(be[1],Ue[1]),ye[2]=Math.max(be[2],Ue[2]),ye[3]=Math.max(be[3],Ue[3]),ye}function Ce(ye,be){return ye[0]=Math.round(be[0]),ye[1]=Math.round(be[1]),ye[2]=Math.round(be[2]),ye[3]=Math.round(be[3]),ye}function ht(ye,be,Ue){return ye[0]=be[0]*Ue,ye[1]=be[1]*Ue,ye[2]=be[2]*Ue,ye[3]=be[3]*Ue,ye}function Ne(ye,be,Ue,st){return ye[0]=be[0]+Ue[0]*st,ye[1]=be[1]+Ue[1]*st,ye[2]=be[2]+Ue[2]*st,ye[3]=be[3]+Ue[3]*st,ye}function Et(ye,be){var Ue=be[0]-ye[0],st=be[1]-ye[1],Me=be[2]-ye[2],ft=be[3]-ye[3];return Math.hypot(Ue,st,Me,ft)}function He(ye,be){var Ue=be[0]-ye[0],st=be[1]-ye[1],Me=be[2]-ye[2],ft=be[3]-ye[3];return Ue*Ue+st*st+Me*Me+ft*ft}function mt(ye){var be=ye[0],Ue=ye[1],st=ye[2],Me=ye[3];return Math.hypot(be,Ue,st,Me)}function Ye(ye){var be=ye[0],Ue=ye[1],st=ye[2],Me=ye[3];return be*be+Ue*Ue+st*st+Me*Me}function xt(ye,be){return ye[0]=-be[0],ye[1]=-be[1],ye[2]=-be[2],ye[3]=-be[3],ye}function _t(ye,be){return ye[0]=1/be[0],ye[1]=1/be[1],ye[2]=1/be[2],ye[3]=1/be[3],ye}function Ie(ye,be){var Ue=be[0],st=be[1],Me=be[2],ft=be[3],w=Ue*Ue+st*st+Me*Me+ft*ft;return w>0&&(w=1/Math.sqrt(w)),ye[0]=Ue*w,ye[1]=st*w,ye[2]=Me*w,ye[3]=ft*w,ye}function De(ye,be){return ye[0]*be[0]+ye[1]*be[1]+ye[2]*be[2]+ye[3]*be[3]}function ze(ye,be,Ue,st){var Me=Ue[0]*st[1]-Ue[1]*st[0],ft=Ue[0]*st[2]-Ue[2]*st[0],w=Ue[0]*st[3]-Ue[3]*st[0],I=Ue[1]*st[2]-Ue[2]*st[1],J=Ue[1]*st[3]-Ue[3]*st[1],ce=Ue[2]*st[3]-Ue[3]*st[2],Be=be[0],Xe=be[1],gt=be[2],tt=be[3];return ye[0]=Xe*ce-gt*J+tt*I,ye[1]=-(Be*ce)+gt*w-tt*ft,ye[2]=Be*J-Xe*w+tt*Me,ye[3]=-(Be*I)+Xe*ft-gt*Me,ye}function at(ye,be,Ue,st){var Me=be[0],ft=be[1],w=be[2],I=be[3];return ye[0]=Me+st*(Ue[0]-Me),ye[1]=ft+st*(Ue[1]-ft),ye[2]=w+st*(Ue[2]-w),ye[3]=I+st*(Ue[3]-I),ye}function Pe(ye,be){be=be||1;var Ue,st,Me,ft,w,I;do Ue=T.c()*2-1,st=T.c()*2-1,w=Ue*Ue+st*st;while(w>=1);do Me=T.c()*2-1,ft=T.c()*2-1,I=Me*Me+ft*ft;while(I>=1);var J=Math.sqrt((1-w)/I);return ye[0]=be*Ue,ye[1]=be*st,ye[2]=be*Me*J,ye[3]=be*ft*J,ye}function ot(ye,be,Ue){var st=be[0],Me=be[1],ft=be[2],w=be[3];return ye[0]=Ue[0]*st+Ue[4]*Me+Ue[8]*ft+Ue[12]*w,ye[1]=Ue[1]*st+Ue[5]*Me+Ue[9]*ft+Ue[13]*w,ye[2]=Ue[2]*st+Ue[6]*Me+Ue[10]*ft+Ue[14]*w,ye[3]=Ue[3]*st+Ue[7]*Me+Ue[11]*ft+Ue[15]*w,ye}function Bt(ye,be,Ue){var st=be[0],Me=be[1],ft=be[2],w=Ue[0],I=Ue[1],J=Ue[2],ce=Ue[3],Be=ce*st+I*ft-J*Me,Xe=ce*Me+J*st-w*ft,gt=ce*ft+w*Me-I*st,tt=-w*st-I*Me-J*ft;return ye[0]=Be*ce+tt*-w+Xe*-J-gt*-I,ye[1]=Xe*ce+tt*-I+gt*-w-Be*-J,ye[2]=gt*ce+tt*-J+Be*-I-Xe*-w,ye[3]=be[3],ye}function Wt(ye){return ye[0]=0,ye[1]=0,ye[2]=0,ye[3]=0,ye}function sr(ye){return"vec4("+ye[0]+", "+ye[1]+", "+ye[2]+", "+ye[3]+")"}function ne(ye,be){return ye[0]===be[0]&&ye[1]===be[1]&&ye[2]===be[2]&&ye[3]===be[3]}function $(ye,be){var Ue=ye[0],st=ye[1],Me=ye[2],ft=ye[3],w=be[0],I=be[1],J=be[2],ce=be[3];return Math.abs(Ue-w)<=T.b*Math.max(1,Math.abs(Ue),Math.abs(w))&&Math.abs(st-I)<=T.b*Math.max(1,Math.abs(st),Math.abs(I))&&Math.abs(Me-J)<=T.b*Math.max(1,Math.abs(Me),Math.abs(J))&&Math.abs(ft-ce)<=T.b*Math.max(1,Math.abs(ft),Math.abs(ce))}var G=Y,Ae=q,xe=he,Se=Et,ve=He,et=mt,Yt=Ye,At=function(){var ye=m();return function(be,Ue,st,Me,ft,w){var I,J;for(Ue||(Ue=4),st||(st=0),Me?J=Math.min(Me*Ue+st,be.length):J=be.length,I=st;I<J;I+=Ue)ye[0]=be[I],ye[1]=be[I+1],ye[2]=be[I+2],ye[3]=be[I+3],ft(ye,ye,w),be[I]=ye[0],be[I+1]=ye[1],be[I+2]=ye[2],be[I+3]=ye[3];return be}}()},bzyH:function(Le,E){},cSJO:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),Z=i("xfSm");function z(Y,q,he){var X=q.filter(function(Ge){return Ge.target!==null&&Ge.target.type===m.TargetTypeEnum.ClassProperty}),je=X.map(he);return X.forEach(function(Ge,ge){var Ce="";Ce=Ge.target.name.value();var ht=je[ge];Y[Ce]=ht}),Y}function o(Y,q){return new(Y.bind.apply(Y,[void 0].concat(q)))}function W(Y,q){if(Reflect.hasMetadata(Z.POST_CONSTRUCT,Y)){var he=Reflect.getMetadata(Z.POST_CONSTRUCT,Y);try{q[he.value]()}catch(X){throw new Error(T.POST_CONSTRUCT_ERROR(Y.name,X.message))}}}function D(Y,q,he){var X=null;if(q.length>0){var je=q.filter(function(ge){return ge.target!==null&&ge.target.type===m.TargetTypeEnum.ConstructorArgument}),Ge=je.map(he);X=o(Y,Ge),X=z(X,q,he)}else X=new Y;return W(Y,X),X}E.resolveInstance=D},cWXX:function(Le,E,i){"use strict";var T=i("cIOH"),m=i.n(T),Z=i("oIFs"),z=i.n(Z)},cWyK:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(He,mt,Ye){if(He===null)return;for(var xt,_t,Ie,De,ze,at,Pe,ot=0,Bt=0,Wt,sr=He.type,ne=sr==="FeatureCollection",$=sr==="Feature",G=ne?He.features.length:1,Ae=0;Ae<G;Ae++){Pe=ne?He.features[Ae].geometry:$?He.geometry:He,Wt=Pe?Pe.type==="GeometryCollection":!1,ze=Wt?Pe.geometries.length:1;for(var xe=0;xe<ze;xe++){var Se=0,ve=0;if(De=Wt?Pe.geometries[xe]:Pe,De===null)continue;at=De.coordinates;var et=De.type;ot=Ye&&(et==="Polygon"||et==="MultiPolygon")?1:0;switch(et){case null:break;case"Point":if(mt(at,Bt,Ae,Se,ve)===!1)return!1;Bt++,Se++;break;case"LineString":case"MultiPoint":for(xt=0;xt<at.length;xt++){if(mt(at[xt],Bt,Ae,Se,ve)===!1)return!1;Bt++,et==="MultiPoint"&&Se++}et==="LineString"&&Se++;break;case"Polygon":case"MultiLineString":for(xt=0;xt<at.length;xt++){for(_t=0;_t<at[xt].length-ot;_t++){if(mt(at[xt][_t],Bt,Ae,Se,ve)===!1)return!1;Bt++}et==="MultiLineString"&&Se++,et==="Polygon"&&ve++}et==="Polygon"&&Se++;break;case"MultiPolygon":for(xt=0;xt<at.length;xt++){for(ve=0,_t=0;_t<at[xt].length;_t++){for(Ie=0;Ie<at[xt][_t].length-ot;Ie++){if(mt(at[xt][_t][Ie],Bt,Ae,Se,ve)===!1)return!1;Bt++}ve++}Se++}break;case"GeometryCollection":for(xt=0;xt<De.geometries.length;xt++)if(m(De.geometries[xt],mt,Ye)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function Z(He,mt,Ye,xt){var _t=Ye;return m(He,function(Ie,De,ze,at,Pe){De===0&&Ye===void 0?_t=Ie:_t=mt(_t,Ie,De,ze,at,Pe)},xt),_t}function z(He,mt){var Ye;switch(He.type){case"FeatureCollection":for(Ye=0;Ye<He.features.length&&!(mt(He.features[Ye].properties,Ye)===!1);Ye++);break;case"Feature":mt(He.properties,0);break}}function o(He,mt,Ye){var xt=Ye;return z(He,function(_t,Ie){Ie===0&&Ye===void 0?xt=_t:xt=mt(xt,_t,Ie)}),xt}function W(He,mt){if(He.type==="Feature")mt(He,0);else if(He.type==="FeatureCollection")for(var Ye=0;Ye<He.features.length&&!(mt(He.features[Ye],Ye)===!1);Ye++);}function D(He,mt,Ye){var xt=Ye;return W(He,function(_t,Ie){Ie===0&&Ye===void 0?xt=_t:xt=mt(xt,_t,Ie)}),xt}function Y(He){var mt=[];return m(He,function(Ye){mt.push(Ye)}),mt}function q(He,mt){var Ye,xt,_t,Ie,De,ze,at,Pe,ot,Bt,Wt=0,sr=He.type==="FeatureCollection",ne=He.type==="Feature",$=sr?He.features.length:1;for(Ye=0;Ye<$;Ye++){for(ze=sr?He.features[Ye].geometry:ne?He.geometry:He,Pe=sr?He.features[Ye].properties:ne?He.properties:{},ot=sr?He.features[Ye].bbox:ne?He.bbox:void 0,Bt=sr?He.features[Ye].id:ne?He.id:void 0,at=ze?ze.type==="GeometryCollection":!1,De=at?ze.geometries.length:1,_t=0;_t<De;_t++){if(Ie=at?ze.geometries[_t]:ze,Ie===null){if(mt(null,Wt,Pe,ot,Bt)===!1)return!1;continue}switch(Ie.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(mt(Ie,Wt,Pe,ot,Bt)===!1)return!1;break}case"GeometryCollection":{for(xt=0;xt<Ie.geometries.length;xt++)if(mt(Ie.geometries[xt],Wt,Pe,ot,Bt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Wt++}}function he(He,mt,Ye){var xt=Ye;return q(He,function(_t,Ie,De,ze,at){Ie===0&&Ye===void 0?xt=_t:xt=mt(xt,_t,Ie,De,ze,at)}),xt}function X(He,mt){q(He,function(Ye,xt,_t,Ie,De){var ze=Ye===null?null:Ye.type;switch(ze){case null:case"Point":case"LineString":case"Polygon":return mt(T.feature(Ye,_t,{bbox:Ie,id:De}),xt,0)===!1?!1:void 0}var at;switch(ze){case"MultiPoint":at="Point";break;case"MultiLineString":at="LineString";break;case"MultiPolygon":at="Polygon";break}for(var Pe=0;Pe<Ye.coordinates.length;Pe++){var ot=Ye.coordinates[Pe],Bt={type:at,coordinates:ot};if(mt(T.feature(Bt,_t),xt,Pe)===!1)return!1}})}function je(He,mt,Ye){var xt=Ye;return X(He,function(_t,Ie,De){Ie===0&&De===0&&Ye===void 0?xt=_t:xt=mt(xt,_t,Ie,De)}),xt}function Ge(He,mt){X(He,function(Ye,xt,_t){var Ie=0;if(!Ye.geometry)return;var De=Ye.geometry.type;if(De==="Point"||De==="MultiPoint")return;var ze,at=0,Pe=0,ot=0;if(m(Ye,function(Bt,Wt,sr,ne,$){if(ze===void 0||xt>at||ne>Pe||$>ot){ze=Bt,at=xt,Pe=ne,ot=$,Ie=0;return}var G=T.lineString([ze,Bt],Ye.properties);if(mt(G,xt,_t,$,Ie)===!1)return!1;Ie++,ze=Bt})===!1)return!1})}function ge(He,mt,Ye){var xt=Ye,_t=!1;return Ge(He,function(Ie,De,ze,at,Pe){_t===!1&&Ye===void 0?xt=Ie:xt=mt(xt,Ie,De,ze,at,Pe),_t=!0}),xt}function Ce(He,mt){if(!He)throw new Error("geojson is required");X(He,function(Ye,xt,_t){if(Ye.geometry===null)return;var Ie=Ye.geometry.type,De=Ye.geometry.coordinates;switch(Ie){case"LineString":if(mt(Ye,xt,_t,0,0)===!1)return!1;break;case"Polygon":for(var ze=0;ze<De.length;ze++)if(mt(T.lineString(De[ze],Ye.properties),xt,_t,ze)===!1)return!1;break}})}function ht(He,mt,Ye){var xt=Ye;return Ce(He,function(_t,Ie,De,ze){Ie===0&&Ye===void 0?xt=_t:xt=mt(xt,_t,Ie,De,ze)}),xt}function Ne(He,mt){if(mt=mt||{},!T.isObject(mt))throw new Error("options is invalid");var Ye=mt.featureIndex||0,xt=mt.multiFeatureIndex||0,_t=mt.geometryIndex||0,Ie=mt.segmentIndex||0,De=mt.properties,ze;switch(He.type){case"FeatureCollection":Ye<0&&(Ye=He.features.length+Ye),De=De||He.features[Ye].properties,ze=He.features[Ye].geometry;break;case"Feature":De=De||He.properties,ze=He.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ze=He;break;default:throw new Error("geojson is invalid")}if(ze===null)return null;var at=ze.coordinates;switch(ze.type){case"Point":case"MultiPoint":return null;case"LineString":return Ie<0&&(Ie=at.length+Ie-1),T.lineString([at[Ie],at[Ie+1]],De,mt);case"Polygon":return _t<0&&(_t=at.length+_t),Ie<0&&(Ie=at[_t].length+Ie-1),T.lineString([at[_t][Ie],at[_t][Ie+1]],De,mt);case"MultiLineString":return xt<0&&(xt=at.length+xt),Ie<0&&(Ie=at[xt].length+Ie-1),T.lineString([at[xt][Ie],at[xt][Ie+1]],De,mt);case"MultiPolygon":return xt<0&&(xt=at.length+xt),_t<0&&(_t=at[xt].length+_t),Ie<0&&(Ie=at[xt][_t].length-Ie-1),T.lineString([at[xt][_t][Ie],at[xt][_t][Ie+1]],De,mt)}throw new Error("geojson is invalid")}function Et(He,mt){if(mt=mt||{},!T.isObject(mt))throw new Error("options is invalid");var Ye=mt.featureIndex||0,xt=mt.multiFeatureIndex||0,_t=mt.geometryIndex||0,Ie=mt.coordIndex||0,De=mt.properties,ze;switch(He.type){case"FeatureCollection":Ye<0&&(Ye=He.features.length+Ye),De=De||He.features[Ye].properties,ze=He.features[Ye].geometry;break;case"Feature":De=De||He.properties,ze=He.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ze=He;break;default:throw new Error("geojson is invalid")}if(ze===null)return null;var at=ze.coordinates;switch(ze.type){case"Point":return T.point(at,De,mt);case"MultiPoint":return xt<0&&(xt=at.length+xt),T.point(at[xt],De,mt);case"LineString":return Ie<0&&(Ie=at.length+Ie),T.point(at[Ie],De,mt);case"Polygon":return _t<0&&(_t=at.length+_t),Ie<0&&(Ie=at[_t].length+Ie),T.point(at[_t][Ie],De,mt);case"MultiLineString":return xt<0&&(xt=at.length+xt),Ie<0&&(Ie=at[xt].length+Ie),T.point(at[xt][Ie],De,mt);case"MultiPolygon":return xt<0&&(xt=at.length+xt),_t<0&&(_t=at[xt].length+_t),Ie<0&&(Ie=at[xt][_t].length-Ie),T.point(at[xt][_t][Ie],De,mt)}throw new Error("geojson is invalid")}E.coordEach=m,E.coordReduce=Z,E.propEach=z,E.propReduce=o,E.featureEach=W,E.featureReduce=D,E.coordAll=Y,E.geomEach=q,E.geomReduce=he,E.flattenEach=X,E.flattenReduce=je,E.segmentEach=Ge,E.segmentReduce=ge,E.lineEach=Ce,E.lineReduce=ht,E.findSegment=Ne,E.findPoint=Et},cZ5Q:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function Z(){return function(z){if(Reflect.hasOwnMetadata(m.PARAM_TYPES,z))throw new Error(T.DUPLICATED_INJECTABLE_DECORATOR);var o=Reflect.getMetadata(m.DESIGN_PARAM_TYPES,z)||[];return Reflect.defineMetadata(m.PARAM_TYPES,o,z),z}}E.injectable=Z},cZlC:function(Le,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"c",function(){return m}),i.d(E,"a",function(){return Z});var T;(function(z){z.LINEAR="linear",z.POWER="power",z.LOG="log",z.IDENTITY="identity",z.TIME="time",z.QUANTILE="quantile",z.QUANTIZE="quantize",z.THRESHOLD="threshold",z.CAT="cat"})(T||(T={}));var m;(function(z){z.CONSTANT="constant",z.VARIABLE="variable"})(m||(m={}));var Z;(function(z){z[z.Attribute=0]="Attribute",z[z.InstancedAttribute=1]="InstancedAttribute",z[z.Uniform=2]="Uniform"})(Z||(Z={}))},"cq/+":function(Le,E,i){var T=i("mc0g"),m=T();Le.exports=m},cvCv:function(Le,E){function i(T){return function(){return T}}Le.exports=i},d9O0:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=0;function m(){return T++}E.id=m},d9mD:function(Le,E,i){Le.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(Le,E,i){var T=i("yGk4"),m=i("vN+2"),Z=i("rEGp"),z=1/0,o=T&&1/Z(new T([,-0]))[1]==z?function(W){return new T(W)}:m;Le.exports=o},dTAl:function(Le,E,i){var T=i("GoyQ"),m=Object.create,Z=function(){function z(){}return function(o){if(!T(o))return{};if(m)return m(o);z.prototype=o;var W=new z;return z.prototype=void 0,W}}();Le.exports=Z},dVn5:function(Le,E){var i=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function T(m){return m.match(i)||[]}Le.exports=T},dX1H:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("d9O0"),Z=i("GXnB"),z=i("zxMA"),o=function(){function W(D,Y,q,he){this.id=m.id(),this.type=D,this.serviceIdentifier=q,this.name=new z.QueryableString(Y||""),this.metadata=new Array;var X=null;typeof he=="string"?X=new Z.Metadata(T.NAMED_TAG,he):he instanceof Z.Metadata&&(X=he),X!==null&&this.metadata.push(X)}return W.prototype.hasTag=function(D){for(var Y=0,q=this.metadata;Y<q.length;Y++){var he=q[Y];if(he.key===D)return!0}return!1},W.prototype.isArray=function(){return this.hasTag(T.MULTI_INJECT_TAG)},W.prototype.matchesArray=function(D){return this.matchesTag(T.MULTI_INJECT_TAG)(D)},W.prototype.isNamed=function(){return this.hasTag(T.NAMED_TAG)},W.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG})},W.prototype.isOptional=function(){return this.matchesTag(T.OPTIONAL_TAG)(!0)},W.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===T.NAMED_TAG})[0]:null},W.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG}):null},W.prototype.matchesNamedTag=function(D){return this.matchesTag(T.NAMED_TAG)(D)},W.prototype.matchesTag=function(D){var Y=this;return function(q){for(var he=0,X=Y.metadata;he<X.length;he++){var je=X[he];if(je.key===D&&je.value===q)return!0}return!1}},W}();E.Target=o},dgMf:function(Le,E,i){Le.exports={color:"color"}},doU7:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};E.BindingCount=T},dt0z:function(Le,E,i){var T=i("zoYe");function m(Z){return Z==null?"":T(Z)}Le.exports=m},dxzI:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.ContainerModule=m;var Z=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.AsyncContainerModule=Z},eUgh:function(Le,E){function i(T,m){for(var Z=-1,z=T==null?0:T.length,o=Array(z);++Z<z;)o[Z]=m(T[Z],Z,T);return o}Le.exports=i},"eg+a":function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Le,E,i){"use strict";i.d(E,"d",function(){return kc}),i.d(E,"b",function(){return yc}),i.d(E,"a",function(){return Sl});var T=i("mNvP"),m=i("uhBA"),Z=i.n(m),z=i("4cb6"),o=i("APxj"),W=i.n(o),D=i("bB6j"),Y=i("lSNA"),q=i.n(Y),he=i("lwsE"),X=i.n(he),je=i("W8MJ"),Ge=i.n(je),ge=i("Hel2"),Ce=i("rxlC"),ht=i.n(Ce);function Ne(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Et(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Ne(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Ne(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function He(ee,ae){var N;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(N=mt(ee))||ae&&ee&&typeof ee.length=="number"){N&&(ee=N);var V=0,Te=function(){};return{s:Te,n:function(){return V>=ee.length?{done:!0}:{done:!1,value:ee[V++]}},e:function(Dr){throw Dr},f:Te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var it=!0,Zt=!1,ar;return{s:function(){N=ee[Symbol.iterator]()},n:function(){var Dr=N.next();return it=Dr.done,Dr},e:function(Dr){Zt=!0,ar=Dr},f:function(){try{!it&&N.return!=null&&N.return()}finally{if(Zt)throw ar}}}}function mt(ee,ae){if(!ee)return;if(typeof ee=="string")return Ye(ee,ae);var N=Object.prototype.toString.call(ee).slice(8,-1);if(N==="Object"&&ee.constructor&&(N=ee.constructor.name),N==="Map"||N==="Set")return Array.from(ee);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Ye(ee,ae)}function Ye(ee,ae){(ae==null||ae>ee.length)&&(ae=ee.length);for(var N=0,V=new Array(ae);N<ae;N++)V[N]=ee[N];return V}var xt=30;function _t(ee){var ae=ee.characterSet,N=ee.getFontWidth,V=ee.fontHeight,Te=ee.buffer,it=ee.maxCanvasWidth,Zt=ee.mapping,ar=Zt===void 0?{}:Zt,nr=ee.xOffset,Dr=nr===void 0?0:nr,on=ee.yOffset,Gn=on===void 0?0:on,na=0,aa=Dr;Array.from(ae).forEach(function(Ya,Ri){if(!ar[Ya]){var Ha=N(Ya,Ri);aa+xt>it&&(aa=0,na++),ar[Ya]={x:aa,y:Gn+na*xt,width:xt,height:xt,advance:Ha},aa+=xt}});var si=V+Te*2;return{mapping:ar,xOffset:aa,yOffset:Gn+na*si,canvasHeight:ze(Gn+(na+1)*si)}}function Ie(ee,ae,N){var V=0,Te=0,it=0,Zt=[],ar={},nr=He(ee),Dr;try{for(nr.s();!(Dr=nr.n()).done;){var on=Dr.value;if(!ar[on.id]){var Gn=on.height,na=on.width;V+na+ae>N&&(De(ar,Zt,Te),V=0,Te=it+Te+ae,it=0,Zt=[]),Zt.push({icon:on,xOffset:V}),V=V+na+ae,it=Math.max(it,Gn)}}}catch(si){nr.e(si)}finally{nr.f()}Zt.length>0&&De(ar,Zt,Te);var aa=ze(it+Te+ae);return{mapping:ar,canvasHeight:aa}}function De(ee,ae,N){var V=He(ae),Te;try{for(V.s();!(Te=V.n()).done;){var it=Te.value,Zt=it.icon,ar=it.xOffset;ee[Zt.id]=Et(Et({},Zt),{},{x:ar,y:N,image:Zt.image})}}catch(nr){V.e(nr)}finally{V.f()}}function ze(ee){return Math.pow(2,Math.ceil(Math.log2(ee)))}var at,Pe,ot;function Bt(ee,ae){var N;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(N=Wt(ee))||ae&&ee&&typeof ee.length=="number"){N&&(ee=N);var V=0,Te=function(){};return{s:Te,n:function(){return V>=ee.length?{done:!0}:{done:!1,value:ee[V++]}},e:function(Dr){throw Dr},f:Te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var it=!0,Zt=!1,ar;return{s:function(){N=ee[Symbol.iterator]()},n:function(){var Dr=N.next();return it=Dr.done,Dr},e:function(Dr){Zt=!0,ar=Dr},f:function(){try{!it&&N.return!=null&&N.return()}finally{if(Zt)throw ar}}}}function Wt(ee,ae){if(!ee)return;if(typeof ee=="string")return sr(ee,ae);var N=Object.prototype.toString.call(ee).slice(8,-1);if(N==="Object"&&ee.constructor&&(N=ee.constructor.name),N==="Map"||N==="Set")return Array.from(ee);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return sr(ee,ae)}function sr(ee,ae){(ae==null||ae>ee.length)&&(ae=ee.length);for(var N=0,V=new Array(ae);N<ae;N++)V[N]=ee[N];return V}function ne(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function $(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?ne(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):ne(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}var G=Me(),Ae="sans-serif",xe="normal",Se=24,ve=3,et=.25,Yt=8,At=1024,ye=1,be=1,Ue=3,st=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Me(){for(var ee=[],ae=32;ae<128;ae++)ee.push(String.fromCharCode(ae));return ee}function ft(ee,ae,N,V){ee.font="".concat(V," ").concat(N,"px ").concat(ae),ee.fillStyle="black",ee.textBaseline="middle"}function w(ee,ae){for(var N=0;N<ee.length;N++)ae.data[4*N+3]=ee[N]}var I=(at=Object(z.injectable)(),at(Pe=(ot=function(){function ee(){X()(this,ee),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new ge.b(Ue)}return Ge()(ee,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ae,fontWeight:xe,characterSet:G,fontSize:Se,buffer:ve,sdf:!0,cutoff:et,radius:Yt},this.key=""}},{key:"addIconGlyphs",value:function(N){var V=this;N.forEach(function(Te){V.iconFontGlyphs[Te.name]=Te.unicode})}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=$($({},this.fontOptions),N),this.key=this.getKey();var V=this.getNewChars(this.key,this.fontOptions.characterSet),Te=this.cache.get(this.key);if(Te&&V.length===0)return;var it=this.generateFontAtlas(this.key,V,Te);this.fontAtlas=it,this.cache.set(this.key,it)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(N,V,Te){var it=this.fontOptions,Zt=it.fontFamily,ar=it.fontWeight,nr=it.fontSize,Dr=it.buffer,on=it.sdf,Gn=it.radius,na=it.cutoff,aa=Te&&Te.data;aa||(aa=document.createElement("canvas"),aa.width=At);var si=aa.getContext("2d");ft(si,Zt,nr,ar);var Ya=_t($({getFontWidth:function(bc){return si.measureText(bc).width},fontHeight:nr*be,buffer:Dr,characterSet:V,maxCanvasWidth:At},Te&&{mapping:Te.mapping,xOffset:Te.xOffset,yOffset:Te.yOffset})),Ri=Ya.mapping,Ha=Ya.canvasHeight,qi=Ya.xOffset,hs=Ya.yOffset;if(aa.height!==Ha){var Xi=si.getImageData(0,0,aa.width,aa.height);aa.height=Ha,si.putImageData(Xi,0,0)}if(ft(si,Zt,nr,ar),on){var pi=new ht.a(nr,Dr,Gn,na,Zt,ar),ks=si.getImageData(0,0,pi.size,pi.size),Yi=Bt(V),bo;try{for(Yi.s();!(bo=Yi.n()).done;){var ds=bo.value;w(pi.draw(ds),ks),si.putImageData(ks,Ri[ds].x,Ri[ds].y)}}catch(ko){Yi.e(ko)}finally{Yi.f()}}else{var Ai=Bt(V),xo;try{for(Ai.s();!(xo=Ai.n()).done;){var Aa=xo.value;si.fillText(Aa,Ri[Aa].x,Ri[Aa].y+nr*ye)}}catch(ko){Ai.e(ko)}finally{Ai.f()}}return{xOffset:qi,yOffset:hs,mapping:Ri,data:aa,width:aa.width,height:aa.height}}},{key:"getKey",value:function(){var N=this.fontOptions,V=N.fontFamily,Te=N.fontWeight,it=N.fontSize,Zt=N.buffer,ar=N.sdf,nr=N.radius,Dr=N.cutoff;return ar?"".concat(V," ").concat(Te," ").concat(it," ").concat(Zt," ").concat(nr," ").concat(Dr):"".concat(V," ").concat(Te," ").concat(it," ").concat(Zt)}},{key:"getNewChars",value:function(N,V){var Te=this.cache.get(N);if(!Te)return V;var it=[],Zt=Te.mapping,ar=new Set(Object.keys(Zt)),nr=new Set(V);return nr.forEach(function(Dr){ar.has(Dr)||it.push(Dr)}),it}},{key:"scale",get:function(){return be}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}}]),ee}(),ot))||Pe),J=i("7W2i"),ce=i.n(J),Be=i("a1gu"),Xe=i.n(Be),gt=i("Nsbk"),tt=i.n(gt),It,K,Ze;function te(ee){var ae=Je();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Je(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var zt=3,cr=1024,lt=64,dt=(It=Object(z.injectable)(),It(K=(Ze=function(ee){ce()(N,ee);var ae=te(N);function N(){var V;X()(this,N);for(var Te=arguments.length,it=new Array(Te),Zt=0;Zt<Te;Zt++)it[Zt]=arguments[Zt];return V=ae.call.apply(ae,[this].concat(it)),V.canvasHeight=void 0,V.texture=void 0,V.canvas=void 0,V.iconData=void 0,V.iconMap=void 0,V.ctx=void 0,V}return Ge()(N,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Te,it){var Zt=this,ar=new Image;if(this.hasImage(Te))throw new Error("Image Id already exists");this.iconData.push({id:Te,width:lt,height:lt}),this.updateIconMap(),this.loadImage(it).then(function(nr){ar=nr;var Dr=Zt.iconData.find(function(on){return on.id===Te});Dr&&(Dr.image=ar),Zt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Te){return this.iconMap.hasOwnProperty(Te)}},{key:"removeImage",value:function(Te){this.hasImage(Te)&&(this.iconData=this.iconData.filter(function(it){return it.id!==Te}),delete this.iconMap[Te],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Te=this;this.canvas.width=cr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(it){var Zt=Te.iconMap[it],ar=Zt.x,nr=Zt.y,Dr=Zt.image;Dr&&Te.ctx.drawImage(Dr,ar,nr,lt,lt)})}},{key:"updateIconMap",value:function(){var Te=Ie(this.iconData,zt,cr),it=Te.mapping,Zt=Te.canvasHeight;this.iconMap=it,this.canvasHeight=Zt}},{key:"loadImage",value:function(Te){return new Promise(function(it,Zt){if(Te instanceof HTMLImageElement){it(Te);return}var ar=new Image;ar.crossOrigin="anonymous",ar.onload=function(){it(ar)},ar.onerror=function(){Zt(new Error("Could not load image at "+Te))},ar.src=Te instanceof File?URL.createObjectURL(Te):Te})}}]),N}(m.EventEmitter),Ze))||K),Ct=i("J4zp"),pt=i.n(Ct),we=i("IOcx"),ut,Ke,kt,yr=(ut=Object(z.injectable)(),ut(Ke=(kt=function(){function ee(){X()(this,ee),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Ge()(ee,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=we.b.invert(we.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),V=pt()(N,2),Te=V[0],it=V[1];return[Te,it]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,V){return this.viewport.projectFlat(N,V)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,V){var Te=we.b.fromTranslation(we.b.create(),[N,V,0]);this.jitteredProjectionMatrix=we.b.multiply(we.b.create(),Te,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=we.b.multiply(we.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ee}(),kt))||Ke),Zr,hr,jn;function yn(ee,ae){var N;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(N=ta(ee))||ae&&ee&&typeof ee.length=="number"){N&&(ee=N);var V=0,Te=function(){};return{s:Te,n:function(){return V>=ee.length?{done:!0}:{done:!1,value:ee[V++]}},e:function(Dr){throw Dr},f:Te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var it=!0,Zt=!1,ar;return{s:function(){N=ee[Symbol.iterator]()},n:function(){var Dr=N.next();return it=Dr.done,Dr},e:function(Dr){Zt=!0,ar=Dr},f:function(){try{!it&&N.return!=null&&N.return()}finally{if(Zt)throw ar}}}}function ta(ee,ae){if(!ee)return;if(typeof ee=="string")return ma(ee,ae);var N=Object.prototype.toString.call(ee).slice(8,-1);if(N==="Object"&&ee.constructor&&(N=ee.constructor.name),N==="Map"||N==="Set")return Array.from(ee);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return ma(ee,ae)}function ma(ee,ae){(ae==null||ae>ee.length)&&(ae=ee.length);for(var N=0,V=new Array(ae);N<ae;N++)V[N]=ee[N];return V}var Zn=(Zr=Object(z.injectable)(),Zr(hr=(jn=function(){function ee(){X()(this,ee),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Ge()(ee,[{key:"init",value:function(N,V){this.container=N.container,this.scene=V,this.mapsService=V.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,V){var Te=V.get(D.a.IMapService);Te.map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(V){return V.controlOption.name===N})}},{key:"removeControl",value:function(N){var V=this.controls.indexOf(N);return V>-1&&this.controls.splice(V,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(V){V.addTo(N.scene),N.controls.push(V)}),this.unAddControls=[]}},{key:"destroy",value:function(){var N=yn(this.controls),V;try{for(N.s();!(V=N.n()).done;){var Te=V.value;Te.remove()}}catch(it){N.e(it)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},V="l7-",Te=this.controlContainer=ge.a.create("div",V+"control-container",this.container);function it(Zt,ar){var nr=V+Zt+" "+V+ar;N[Zt+ar]=ge.a.create("div",nr,Te)}it("top","left"),it("top","right"),it("bottom","left"),it("bottom","right")}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&ge.a.remove(this.controlCorners[N]);this.controlContainer&&ge.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ee}(),jn))||hr),Wn,F,H,ue=(Wn=Object(z.injectable)(),Wn(F=(H=function(){function ee(){X()(this,ee),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Ge()(ee,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var V=this.markerLayers.indexOf(N);V>-1&&this.markerLayers.splice(V,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(V){V.addTo(N.scene),N.markers.push(V)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(V){N.markerLayers.push(V),V.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var V=this.markers.indexOf(N);V>-1&&this.markers.splice(V,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),ee}(),H))||F),pe,rt,yt,Ve=(pe=Object(z.injectable)(),pe(rt=(yt=function(){function ee(){X()(this,ee),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Ge()(ee,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}}]),ee}(),yt))||rt),ct=i("QkVN"),er=i.n(ct),rr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},jr=rr,nn,ur,Wr;function Tn(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function mr(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Tn(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Tn(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}var Jr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},vn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},Kn=(nn=Object(z.injectable)(),nn(ur=(Wr=function(){function ee(){X()(this,ee),this.sceneConfigCache={},this.layerConfigCache={}}return Ge()(ee,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return jr[N]}},{key:"setSceneConfig",value:function(N,V){this.sceneConfigCache[N]=mr(mr({},Jr),V)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,V,Te){this.layerConfigCache[V]=mr({},er()({},this.sceneConfigCache[N],vn,Te))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ee}(),Wr))||ur),_n=i("yG8O"),Hr=i.n(_n),oa=i("U+yc"),Mr=i.n(oa),va=i("1ABj"),ha=Math.PI/180,da=512,Ki=4003e4;function Fi(ee){var ae=ee.latitude,N=ae===void 0?0:ae,V=ee.zoom,Te=V===void 0?0:V,it=ee.scale,Zt=ee.highPrecision,ar=Zt===void 0?!1:Zt,nr=ee.flipY,Dr=nr===void 0?!1:nr;it=it!==void 0?it:Math.pow(2,Te);var on={},Gn=da*it,na=Math.cos(N*ha),aa=Gn/360,si=aa/na,Ya=Gn/Ki/na;if(on.pixelsPerMeter=[Ya,-Ya,Ya],on.metersPerPixel=[1/Ya,-1/Ya,1/Ya],on.pixelsPerDegree=[aa,-si,Ya],on.degreesPerPixel=[1/aa,-1/si,1/Ya],ar){var Ri=ha*Math.tan(N*ha)/na,Ha=aa*Ri/2,qi=Gn/Ki*Ri,hs=qi/si*Ya;on.pixelsPerDegree2=[0,-Ha,qi],on.pixelsPerMeter2=[hs,0,hs],Dr&&(on.pixelsPerDegree2[1]=-on.pixelsPerDegree2[1],on.pixelsPerMeter2[1]=-on.pixelsPerMeter2[1])}return Dr&&(on.pixelsPerMeter[1]=-on.pixelsPerMeter[1],on.metersPerPixel[1]=-on.metersPerPixel[1],on.pixelsPerDegree[1]=-on.pixelsPerDegree[1],on.degreesPerPixel[1]=-on.degreesPerPixel[1]),on}var xa=i("HthE"),di,Ga,In,Oi,$i,Ti,Io=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],fu=(di=Object(z.injectable)(),Ga=Object(z.inject)(D.a.ICameraService),di(In=(Oi=(Ti=function(){function ee(){X()(this,ee),this.needRefresh=!0,Hr()(this,"cameraService",$i,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Ge()(ee,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),V=this.cameraService.getZoomScale(),Te=this.cameraService.getCenter(),it=Fi({latitude:Te[1],zoom:N}),Zt=it.pixelsPerMeter,ar=it.pixelsPerDegree;this.viewportCenter=Te,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Zt,this.pixelsPerDegree=ar,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===xa.a.LNGLAT||this.coordinateSystem===xa.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===xa.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Te,N):this.coordinateSystem===xa.a.P20_OFFSET&&this.calculateLnglatOffset(Te,N,V,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,V,Te,it){var Zt=Fi({latitude:N[1],zoom:V,scale:Te,flipY:it,highPrecision:!0}),ar=Zt.pixelsPerMeter,nr=Zt.pixelsPerDegree,Dr=Zt.pixelsPerDegree2,on=this.cameraService.getViewMatrix(),Gn=this.cameraService.getProjectionMatrix(),na=we.b.multiply([],Gn,on),aa=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,V));this.viewportCenterProjection=we.e.transformMat4([],[aa[0],aa[1],0,1],na),on=this.cameraService.getViewMatrixUncentered()||on,na=we.b.multiply([],Gn,on),na=we.b.multiply([],na,Io),this.cameraService.setViewProjectionMatrix(na),this.pixelsPerMeter=ar,this.pixelsPerDegree=nr,this.pixelsPerDegree2=Dr}}]),ee}(),Ti),$i=Mr()(Oi.prototype,"cameraService",[Ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oi))||In),hu=i("PJYZ"),pa=i.n(hu),ws=i("yLV6"),po=i.n(ws),Za=i("V1cb"),Pu,Mi,_i,_o,as,So,Ol,Os;function so(ee){var ae=du();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Ft={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Re=(Pu=Object(z.injectable)(),Mi=Object(z.inject)(D.a.IMapService),_i=Object(z.inject)(D.a.ILogService),Pu(_o=(as=(Os=function(ee){ce()(N,ee);var ae=so(N);function N(){var V;X()(this,N);for(var Te=arguments.length,it=new Array(Te),Zt=0;Zt<Te;Zt++)it[Zt]=arguments[Zt];return V=ae.call.apply(ae,[this].concat(it)),Hr()(V,"mapService",So,pa()(V)),Hr()(V,"logger",Ol,pa()(V)),V.hammertime=void 0,V.lastClickTime=0,V.lastClickXY=[-1,-1],V.clickTimer=void 0,V.$containter=void 0,V.onDrag=function(ar){var nr=V.interactionEvent(ar);nr.type=Ft[nr.type],V.emit(Za.a.Drag,nr)},V.onHammer=function(ar){ar.srcEvent.stopPropagation();var nr=V.interactionEvent(ar);V.emit(Za.a.Hover,nr)},V.onTouch=function(ar){var nr=ar.touches[0];V.onHover({x:nr.pageX,y:nr.pageY,type:"touch"})},V.onHover=function(ar){var nr=ar.clientX,Dr=ar.clientY,on=nr,Gn=Dr,na=ar.type,aa=V.mapService.getMapContainer();if(aa){var si=aa.getBoundingClientRect(),Ya=si.top,Ri=si.left;on=on-Ri-aa.clientLeft,Gn=Gn-Ya-aa.clientTop}var Ha=V.mapService.containerToLngLat([on,Gn]);if(na==="click"){if("ontouchstart"in document.documentElement===!0)return;V.isDoubleTap(on,Gn,Ha);return}if(na==="touch"){V.isDoubleTap(on,Gn,Ha);return}na!=="click"&&na!=="dblclick"&&V.emit(Za.a.Hover,{x:on,y:Gn,lngLat:Ha,type:na,target:ar})},V}return Ge()(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Za.a.Hover)}},{key:"triggerHover",value:function(Te){var it=Te.x,Zt=Te.y;this.emit(Za.a.Hover,{x:it,y:Zt})}},{key:"triggerSelect",value:function(Te){this.emit(Za.a.Select,{featureId:Te})}},{key:"triggerActive",value:function(Te){this.emit(Za.a.Active,{featureId:Te})}},{key:"addEventListenerOnMap",value:function(){var Te=this.mapService.getMapContainer();if(Te){var it=new po.a.Manager(Te);it.add(new po.a.Tap({event:"dblclick",taps:2})),it.add(new po.a.Tap({event:"click"})),it.add(new po.a.Pan({threshold:0,pointers:0})),it.add(new po.a.Press({})),it.on("dblclick click",this.onHammer),it.on("panstart panmove panend pancancel",this.onDrag),Te.addEventListener("mousemove",this.onHover),Te.addEventListener("mousedown",this.onHover),Te.addEventListener("mouseup",this.onHover),Te.addEventListener("contextmenu",this.onHover),this.hammertime=it,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Te=this.mapService.getMapContainer();Te&&(Te.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Te.removeEventListener("mousedown",this.onHover),Te.removeEventListener("mouseup",this.onHover),Te.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Te){var it=Te.type,Zt=Te.pointerType,ar,nr;Zt==="touch"?(nr=Math.floor(Te.pointers[0].clientY),ar=Math.floor(Te.pointers[0].clientX)):(nr=Math.floor(Te.srcEvent.y),ar=Math.floor(Te.srcEvent.x));var Dr=this.mapService.getMapContainer();if(Dr){var on=Dr.getBoundingClientRect(),Gn=on.top,na=on.left;ar-=na,nr-=Gn}var aa=this.mapService.containerToLngLat([ar,nr]);return{x:ar,y:nr,lngLat:aa,type:it,target:Te.srcEvent}}},{key:"isDoubleTap",value:function(Te,it,Zt){var ar=this,nr=new Date().getTime(),Dr="click";nr-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Te)<10&&Math.abs(this.lastClickXY[1]-it)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Dr="dblclick",this.emit(Za.a.Hover,{x:Te,y:it,lngLat:Zt,type:Dr})):(this.lastClickTime=nr,this.lastClickXY=[Te,it],this.clickTimer=setTimeout(function(){Dr="click",ar.emit(Za.a.Hover,{x:Te,y:it,lngLat:Zt,type:Dr})},400))}}]),N}(Z.a),Os),So=Mr()(as.prototype,"mapService",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ol=Mr()(as.prototype,"logger",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as))||_o),Mt=i("o0o1"),dr=i.n(Mt),en=i("yXPU"),xn=i.n(en),zn=i("o+pz"),Gi,mo,Do,To,nl,Ml,eu,uf,bs,Vu,tu,Ao;function is(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Gu(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?is(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):is(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}var al=(Gi=Object(z.injectable)(),mo=Object(z.inject)(D.a.IRendererService),Do=Object(z.inject)(D.a.IGlobalConfigService),To=Object(z.inject)(D.a.IInteractionService),nl=Object(z.inject)(D.a.ILayerService),Gi(Ml=(eu=(Ao=function(){function ee(){var ae=this;X()(this,ee),Hr()(this,"rendererService",uf,this),Hr()(this,"configService",bs,this),Hr()(this,"interactionService",Vu,this),Hr()(this,"layerService",tu,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(N,V){var Te,it=V.x,Zt=V.y,ar=V.lngLat,nr=V.type,Dr=V.target,on=!1,Gn=ae.rendererService,na=Gn.getViewportSize,aa=Gn.readPixels,si=Gn.getContainer,Ya=si().getBoundingClientRect(),Ri=Ya.width,Ha=Ya.height;Ri*=window.devicePixelRatio,Ha*=window.devicePixelRatio;var qi=N.getLayerConfig(),hs=qi.enableHighlight,Xi=qi.enableSelect,pi=it*window.devicePixelRatio,ks=Zt*window.devicePixelRatio;if(pi>Ri-1*window.devicePixelRatio||pi<0||ks>Ha-1*window.devicePixelRatio||ks<0)return!1;var Yi;if(Yi=aa({x:Math.floor(pi/ae.pickBufferScale),y:Math.floor((Ha-(Zt+1)*window.devicePixelRatio)/ae.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:ae.pickingFBO}),Yi[0]!==0||Yi[1]!==0||Yi[2]!==0){var bo=Object(ge.k)(Yi),ds=N.getSource().getFeatureById(bo);bo!==N.getCurrentPickId()&&nr==="mousemove"&&(nr="mouseenter");var Ai={x:it,y:Zt,type:nr,lngLat:ar,featureId:bo,feature:ds,target:Dr};ds&&(on=!0,N.setCurrentPickId(bo),ae.triggerHoverOnLayer(N,Ai))}else{var xo={x:it,y:Zt,lngLat:ar,type:N.getCurrentPickId()!==null&&nr==="mousemove"?"mouseout":"un"+nr,featureId:null,target:Dr,feature:null};ae.triggerHoverOnLayer(N,Gu(Gu({},xo),{},{type:"unpick"})),ae.triggerHoverOnLayer(N,xo),N.setCurrentPickId(null)}if(hs&&ae.highlightPickedFeature(N,Yi),Xi&&nr==="click"&&((Te=Yi)===null||Te===void 0?void 0:Te.toString())!==[0,0,0,0].toString()){var Aa=Object(ge.k)(Yi);N.getCurrentSelectedId()===null||Aa!==N.getCurrentSelectedId()?(ae.selectFeature(N,Yi),N.setCurrentSelectedId(Aa)):(ae.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return on}}return Ge()(ee,[{key:"init",value:function(N){var V=this.rendererService,Te=V.createTexture2D,it=V.createFramebuffer,Zt=V.getViewportSize,ar=V.getContainer,nr=ar().getBoundingClientRect(),Dr=nr.width,on=nr.height;Dr*=window.devicePixelRatio,on*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=it({color:Te({width:Math.round(Dr/this.pickBufferScale),height:Math.round(on/this.pickBufferScale),wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})}),this.interactionService.on(Za.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var ae=xn()(dr.a.mark(function V(Te){return dr.a.wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Zt.next=2;break}return Zt.abrupt("return");case 2:return this.alreadyInPicking=!0,Zt.next=5,this.pickingLayers(Te);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Zt.stop()}},V,this)}));function N(V){return ae.apply(this,arguments)}return N}()},{key:"pickingLayers",value:function(){var ae=xn()(dr.a.mark(function V(Te){var it=this,Zt,ar,nr,Dr,on,Gn,na,aa;return dr.a.wrap(function(Ya){for(;;)switch(Ya.prev=Ya.next){case 0:Zt=this.rendererService,ar=Zt.getViewportSize,nr=Zt.useFramebuffer,Dr=Zt.clear,on=Zt.getContainer,Gn=on().getBoundingClientRect(),na=Gn.width,aa=Gn.height,na*=window.devicePixelRatio,aa*=window.devicePixelRatio,(this.width!==na||this.height!==aa)&&(this.pickingFBO.resize({width:Math.round(na/this.pickBufferScale),height:Math.round(aa/this.pickBufferScale)}),this.width=na,this.height=aa),nr(this.pickingFBO,function(){var Ri=it.layerService.getLayers();Ri.filter(function(Ha){return Ha.needPick(Te.type)}).reverse().some(function(Ha){Dr({framebuffer:it.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ha.hooks.beforePickingEncode.call(),Ha.renderModels(),Ha.hooks.afterPickingEncode.call();var qi=it.pickFromPickingFBO(Ha,Te);return qi&&!Ha.getLayerConfig().enablePropagation})});case 6:case"end":return Ya.stop()}},V,this)}));function N(V){return ae.apply(this,arguments)}return N}()},{key:"triggerHoverOnLayer",value:function(N,V){N.emit(V.type,V)}},{key:"highlightPickedFeature",value:function(N,V){var Te=pt()(V,3),it=Te[0],Zt=Te[1],ar=Te[2];N.hooks.beforeHighlight.call([it,Zt,ar])}},{key:"selectFeature",value:function(N,V){var Te=pt()(V,3),it=Te[0],Zt=Te[1],ar=Te[2];N.hooks.beforeSelect.call([it,Zt,ar])}}]),ee}(),Ao),uf=Mr()(eu.prototype,"rendererService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=Mr()(eu.prototype,"configService",[Do],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vu=Mr()(eu.prototype,"interactionService",[To],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=Mr()(eu.prototype,"layerService",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eu))||Ml),Ms=function(){function ee(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;X()(this,ee),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=ae}return Ge()(ee,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var V=(typeof performance=="undefined"?Date:performance).now();N=(V-this.oldTime)/1e3,this.oldTime=V,this.elapsedTime+=N}return N}}]),ee}(),$a,Hu,Wu,il,sc,wt,qt,wr,Xn=($a=Object(z.injectable)(),Hu=Object(z.inject)(D.a.IRendererService),Wu=Object(z.inject)(D.a.IGlobalConfigService),$a(il=(sc=(wr=function(){function ee(){X()(this,ee),this.clock=new Ms,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Hr()(this,"renderService",wt,this),Hr()(this,"configService",qt,this)}return Ge()(ee,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(V){return V.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(V){return V.name===N})}},{key:"remove",value:function(N){var V=this.layers.indexOf(N);V>-1&&this.layers.splice(V,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(N){return N.inited}).filter(function(N){return N.isVisible()}).forEach(function(N){N.hooks.beforeRenderData.call(),N.hooks.beforeRender.call(),N.render(),N.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,V){return N.zIndex-V.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ee}(),wr),wt=Mr()(sc.prototype,"renderService",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Mr()(sc.prototype,"configService",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sc))||il),Xa=i("QILm"),ni=i.n(Xa),to=i("RIqP"),Sa=i.n(to),Ii=i("J2iB"),qo=i.n(Ii),gi=function(){function ee(ae){var N=this;X()(this,ee),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(V){if(V.length===0){var Te;return((Te=N.scale)===null||Te===void 0?void 0:Te.defaultValues)||[]}return V.map(function(it,Zt){var ar,nr=(ar=N.scale)===null||ar===void 0?void 0:ar.scalers[Zt].func,Dr=nr(it);return Dr})},this.setProps(ae)}return Ge()(ee,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var V;if((V=this.scale)===null||V===void 0?void 0:V.callback){var Te,it=(Te=this.scale)===null||Te===void 0?void 0:Te.callback.apply(Te,Sa()(N));if(!qo()(it))return[it]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ee}(),os,ru,pu,ss,Zu,mu,ol;function Lu(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Xu(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Lu(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Lu(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function uc(ee){return new Promise(function(ae){return setTimeout(ae,ee)})}var lf=(os={},q()(os,zn.a.FLOAT,4),q()(os,zn.a.UNSIGNED_BYTE,1),q()(os,zn.a.UNSIGNED_SHORT,2),os),Ec=(ru=Object(z.injectable)(),pu=Object(z.inject)(D.a.IRendererService),ru(ss=(Zu=(ol=function(){function ee(){X()(this,ee),this.attributesAndIndices=void 0,Hr()(this,"rendererService",mu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Ge()(ee,[{key:"registerStyleAttribute",value:function(N){var V=this.getLayerStyleAttribute(N.name||"");return V?V.setProps(N):(V=new gi(N),this.attributes.push(V)),V}},{key:"updateStyleAttribute",value:function(N,V,Te){var it=this.getLayerStyleAttribute(N);it||(it=this.registerStyleAttribute(Xu(Xu({},V),{},{name:N})));var Zt=V.scale;Zt&&it&&(it.scale=Zt,it.needRescale=!0,it.needRemapping=!0,it.needRegenerateVertices=!0,Te&&Te.featureRange&&(it.featureRange=Te.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(V){return V.name===N})}},{key:"getLayerAttributeScale",value:function(N){var V,Te=this.getLayerStyleAttribute(N),it=Te==null||((V=Te.scale)===null||V===void 0)?void 0:V.scalers;return it&&it[0]?it[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,V){var Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,it=arguments.length>3?arguments[3]:void 0,Zt=this.attributes.find(function(Xi){return Xi.name===N});if(Zt&&Zt.descriptor){var ar=Zt.descriptor,nr=ar.update,Dr=ar.buffer,on=ar.size,Gn=on===void 0?0:on,na=lf[Dr.type||zn.a.FLOAT];if(nr){var aa=this.featureLayout,si=aa.elements,Ya=aa.sizePerElement,Ri=si.slice(Te,it);if(!Ri.length)return;var Ha=Ri[0].offset,qi=Ha*Gn*na,hs=Ri.map(function(Xi,pi){for(var ks=Xi.featureIdx,Yi=Xi.vertices,bo=Xi.normals,ds=Yi.length/Ya,Ai=[],xo=0;xo<ds;xo++){var Aa=bo?bo.slice(xo*3,xo*3+3):[];Ai.push.apply(Ai,Sa()(nr(V[ks],ks,Yi.slice(xo*Ya,xo*Ya+Ya),pi,Aa)))}return Ai}).reduce(function(Xi,pi){return Xi.push.apply(Xi,Sa()(pi)),Xi},[]);Zt.vertexAttribute.updateBuffer({data:hs,offset:qi})}}}},{key:"createAttributesAndIndices",value:function(N,V){var Te=this;this.featureLayout={sizePerElement:0,elements:[]},V&&(this.triangulation=V);var it=this.attributes.map(function(Ha){return Ha.resetDescriptor(),Ha.descriptor}),Zt=0,ar=[],nr=[],Dr=[],on=3;N.forEach(function(Ha,qi){var hs=Te.triangulation(Ha),Xi=hs.indices,pi=hs.vertices,ks=hs.normals,Yi=hs.size;Xi.forEach(function(xo){nr.push(xo+Zt)}),on=Yi;var bo=pi.length/Yi;Te.featureLayout.sizePerElement=on,Te.featureLayout.elements.push({featureIdx:qi,vertices:pi,normals:ks,offset:Zt}),Zt+=bo;for(var ds=function(Aa){var ko=(ks==null?void 0:ks.slice(Aa*3,Aa*3+3))||[],bc=pi.slice(Aa*Yi,Aa*Yi+Yi);it.forEach(function(Hf,Ks){if(Hf&&Hf.update){var uh;(uh=Hf.buffer.data).push.apply(uh,Sa()(Hf.update(Ha,qi,bc,Aa,ko)))}})},Ai=0;Ai<bo;Ai++)ds(Ai)});var Gn=this.rendererService,na=Gn.createAttribute,aa=Gn.createBuffer,si=Gn.createElements,Ya={};it.forEach(function(Ha,qi){if(Ha){var hs=Ha.buffer,Xi=Ha.update,pi=Ha.name,ks=ni()(Ha,["buffer","update","name"]),Yi=na(Xu({buffer:aa(hs)},ks));Ya[Ha.name||""]=Yi,Te.attributes[qi].vertexAttribute=Yi}});var Ri=si({data:nr,type:zn.a.UNSIGNED_INT,count:nr.length});return this.attributesAndIndices={attributes:Ya,elements:Ri},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(V){V.vertexAttribute&&V.vertexAttribute.destroy()}),(N=this.attributesAndIndices)===null||N===void 0||N.elements.destroy(),this.attributes=[]}}]),ee}(),ol),mu=Mr()(Zu.prototype,"rendererService",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zu))||ss),Hi=i("U8pU"),Vc=i("KQm4"),Gc=i("rePB"),Tf=i("1OyB"),Hc=i("vuIU"),_f=i("5ku3"),Pi=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Ru=Object(_f.a)();function Pl(ee){try{var ae=window[ee],N="__storage_test__";return ae.setItem(N,N),ae.removeItem(N),ae}catch(V){return null}}var nu=function(){function ee(ae,N){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(Tf.a)(this,ee),this.storage=Pl(V),this.id=ae,this.config={},Object.assign(this.config,N),this._loadConfiguration()}return Object(Hc.a)(ee,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(N){return this.config={},this.updateConfiguration(N)}},{key:"updateConfiguration",value:function(N){if(Object.assign(this.config,N),this.storage){var V=JSON.stringify(this.config);this.storage.setItem(this.id,V)}return this}},{key:"_loadConfiguration",value:function(){var N={};if(this.storage){var V=this.storage.getItem(this.id);N=V?JSON.parse(V):{}}return Object.assign(this.config,N),this}}]),ee}();function Wc(ee){var ae;return ee<10?ae="".concat(ee.toFixed(2),"ms"):ee<100?ae="".concat(ee.toFixed(1),"ms"):ee<1e3?ae="".concat(ee.toFixed(0),"ms"):ae="".concat((ee/1e3).toFixed(2),"s"),ae}function lc(ee){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(ae-ee.length,0);return"".concat(" ".repeat(N)).concat(ee)}function vu(ee){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(ae-ee.length,0);return"".concat(ee).concat(" ".repeat(N))}function Zc(ee){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=1e-16,V=ae.isInteger,Te=V===void 0?!1:V;if(Array.isArray(ee)||ArrayBuffer.isView(ee))return Fs(ee,ae);if(!Number.isFinite(ee))return String(ee);if(Math.abs(ee)<N)return Te?"0":"0.";if(Te)return ee.toFixed(0);if(Math.abs(ee)>100&&Math.abs(ee)<1e4)return ee.toFixed(0);var it=ee.toPrecision(2),Zt=it.indexOf(".0");return Zt===it.length-2?it.slice(0,-1):it}function Fs(ee,ae){for(var N=ae.maxElts,V=N===void 0?16:N,Te=ae.size,it=Te===void 0?1:Te,Zt="[",ar=0;ar<ee.length&&ar<V;++ar)ar>0&&(Zt+=",".concat(ar%it===0?" ":"")),Zt+=Zc(ee[ar],ae);var nr=ee.length>V?"...":"]";return"".concat(Zt).concat(nr)}function au(ee,ae,N){var V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Te=ee.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ee.width>V&&(N=Math.min(N,V/ee.width));var it=ee.width*N,Zt=ee.height*N,ar=["font-size:1px;","padding:".concat(Math.floor(Zt/2),"px ").concat(Math.floor(it/2),"px;"),"line-height:".concat(Zt,"px;"),"background:url(".concat(Te,");"),"background-size:".concat(it,"px ").concat(Zt,"px;"),"color:transparent;"].join("");return["".concat(ae," %c+"),ar]}var Ll={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Tc(ee){return typeof ee=="string"?Ll[ee.toUpperCase()]||Ll.WHITE:ee}function yi(ee,ae,N){return!Ru&&typeof ee=="string"&&(ae&&(ae=Tc(ae),ee="[".concat(ae,"m").concat(ee,"[39m")),N&&(ae=Tc(N),ee="[".concat(N+10,"m").concat(ee,"[49m"))),ee}function cc(ee){if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(ee=Uf(ee))){var ae=0,N=function(){};return{s:N,n:function(){return ae>=ee.length?{done:!0}:{done:!1,value:ee[ae++]}},e:function(nr){throw nr},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var V,Te=!0,it=!1,Zt;return{s:function(){V=ee[Symbol.iterator]()},n:function(){var nr=V.next();return Te=nr.done,nr},e:function(nr){it=!0,Zt=nr},f:function(){try{!Te&&V.return!=null&&V.return()}finally{if(it)throw Zt}}}}function Uf(ee,ae){if(!ee)return;if(typeof ee=="string")return fc(ee,ae);var N=Object.prototype.toString.call(ee).slice(8,-1);if(N==="Object"&&ee.constructor&&(N=ee.constructor.name),N==="Map"||N==="Set")return Array.from(N);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return fc(ee,ae)}function fc(ee,ae){(ae==null||ae>ee.length)&&(ae=ee.length);for(var N=0,V=new Array(ae);N<ae;N++)V[N]=ee[N];return V}function Bf(ee){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],N=Object.getPrototypeOf(ee),V=Object.getOwnPropertyNames(N),Te=cc(V),it;try{var Zt=function(){var nr=it.value;typeof ee[nr]=="function"&&(ae.find(function(Dr){return nr===Dr})||(ee[nr]=ee[nr].bind(ee)))};for(Te.s();!(it=Te.n()).done;)Zt()}catch(ar){Te.e(ar)}finally{Te.f()}}function _c(ee,ae){if(!ee)throw new Error(ae||"Assertion failed")}var Rl=i("K9nA");function pl(){var ee;if(Ru&&Rl.b.performance)ee=Rl.b.performance.now();else if(Rl.a.hrtime){var ae=Rl.a.hrtime();ee=ae[0]*1e3+ae[1]/1e6}else ee=Date.now();return ee}var Ps={debug:Ru&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},hc={enabled:!0,level:0};function Fo(){}var Il={},ml={once:!0};function Xc(ee){for(var ae in ee)for(var N in ee[ae])return N||"untitled";return"empty"}var vl=function(){function ee(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=ae.id;Object(Tf.a)(this,ee),this.id=N,this.VERSION=Pi,this._startTs=pl(),this._deltaTs=pl(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new nu("__probe-".concat(this.id,"__"),hc),this.userData={},this.timeStamp("".concat(this.id," started")),Bf(this),Object.seal(this)}return Object(Hc.a)(ee,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((pl()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((pl()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:N}),this}},{key:"setLevel",value:function(N){return this._storage.updateConfiguration({level:N}),this}},{key:"assert",value:function(N,V){_c(N,V)}},{key:"warn",value:function(N){return this._getLogFunction(0,N,Ps.warn,arguments,ml)}},{key:"error",value:function(N){return this._getLogFunction(0,N,Ps.error,arguments)}},{key:"deprecated",value:function(N,V){return this.warn("`".concat(N,"` is deprecated and will be removed in a later version. Use `").concat(V,"` instead"))}},{key:"removed",value:function(N,V){return this.error("`".concat(N,"` has been removed. Use `").concat(V,"` instead"))}},{key:"probe",value:function(N,V){return this._getLogFunction(N,V,Ps.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(N,V){return this._getLogFunction(N,V,Ps.debug,arguments)}},{key:"info",value:function(N,V){return this._getLogFunction(N,V,console.info,arguments)}},{key:"once",value:function(N,V){return this._getLogFunction(N,V,Ps.debug||Ps.info,arguments,ml)}},{key:"table",value:function(N,V,Te){return V?this._getLogFunction(N,V,console.table||Fo,Te&&[Te],{tag:Xc(V)}):Fo}},{key:"image",value:function(N){var V=N.logLevel,Te=N.priority,it=N.image,Zt=N.message,ar=Zt===void 0?"":Zt,nr=N.scale,Dr=nr===void 0?1:nr;return this._shouldLog(V||Te)?Ru?Dl({image:it,message:ar,scale:Dr}):Af({image:it,message:ar,scale:Dr}):Fo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(N){return this._storage.config[N]}},{key:"set",value:function(N,V){this._storage.updateConfiguration(Object(Gc.a)({},N,V))}},{key:"time",value:function(N,V){return this._getLogFunction(N,V,console.time?console.time:console.info)}},{key:"timeEnd",value:function(N,V){return this._getLogFunction(N,V,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(N,V){return this._getLogFunction(N,V,console.timeStamp||Fo)}},{key:"group",value:function(N,V){var Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Te=Yc({logLevel:N,message:V,opts:Te});var it=Te,Zt=it.collapsed;return Te.method=(Zt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Te)}},{key:"groupCollapsed",value:function(N,V){var Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(N,V,Object.assign({},Te,{collapsed:!0}))}},{key:"groupEnd",value:function(N){return this._getLogFunction(N,"",console.groupEnd||Fo)}},{key:"withGroup",value:function(N,V,Te){this.group(N,V)();try{Te()}finally{this.groupEnd(N)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(N){return this.isEnabled()&&this.getLevel()>=iu(N)}},{key:"_getLogFunction",value:function(N,V,Te){var it=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Zt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(N)){var ar;Zt=Yc({logLevel:N,message:V,args:it,opts:Zt}),Te=Te||Zt.method,_c(Te),Zt.total=this.getTotal(),Zt.delta=this.getDelta(),this._deltaTs=pl();var nr=Zt.tag||Zt.message;if(Zt.once)if(!Il[nr])Il[nr]=pl();else return Fo;return V=Sf(this.id,Zt.message,Zt),(ar=Te).bind.apply(ar,[console,V].concat(Object(Vc.a)(Zt.args)))}return Fo}},{key:"level",set:function(N){this.setLevel(N)},get:function(){return this.getLevel()}},{key:"priority",set:function(N){this.level=N},get:function(){return this.level}}]),ee}();vl.VERSION=Pi;function iu(ee){if(!ee)return 0;var ae;switch(Object(Hi.a)(ee)){case"number":ae=ee;break;case"object":ae=ee.logLevel||ee.priority||0;break;default:return 0}return _c(Number.isFinite(ae)&&ae>=0),ae}function Yc(ee){var ae=ee.logLevel,N=ee.message;ee.logLevel=iu(ae);for(var V=ee.args?Array.from(ee.args):[];V.length&&V.shift()!==N;);ee.args=V;switch(Object(Hi.a)(ae)){case"string":case"function":N!==void 0&&V.unshift(N),ee.message=ae;break;case"object":Object.assign(ee,ae);break;default:}typeof ee.message=="function"&&(ee.message=ee.message());var Te=Object(Hi.a)(ee.message);return _c(Te==="string"||Te==="object"),Object.assign(ee,ee.opts)}function Sf(ee,ae,N){if(typeof ae=="string"){var V=N.time?lc(Wc(N.total)):"";ae=N.time?"".concat(ee,": ").concat(V,"  ").concat(ae):"".concat(ee,": ").concat(ae),ae=yi(ae,N.color,N.background)}return ae}function Af(ee){var ae=ee.image,N=ee.message,V=N===void 0?"":N,Te=ee.scale,it=Te===void 0?1:Te,Zt=null;try{Zt=i(2)}catch(ar){}return Zt?function(){return Zt(ae,{fit:"box",width:"".concat(Math.round(80*it),"%")}).then(function(ar){return console.log(ar)})}:Fo}function Dl(ee){var ae=ee.image,N=ee.message,V=N===void 0?"":N,Te=ee.scale,it=Te===void 0?1:Te;if(typeof ae=="string"){var Zt=new Image;return Zt.onload=function(){var on,Gn=au(Zt,V,it);(on=console).log.apply(on,Object(Vc.a)(Gn))},Zt.src=ae,Fo}var ar=ae.nodeName||"";if(ar.toLowerCase()==="img"){var nr;return(nr=console).log.apply(nr,Object(Vc.a)(au(ae,V,it))),Fo}if(ar.toLowerCase()==="canvas"){var Dr=new Image;return Dr.onload=function(){var on;return(on=console).log.apply(on,Object(Vc.a)(au(Dr,V,it)))},Dr.src=ae.toDataURL(),Fo}return Fo}var dc,Sc,Nl=new vl({id:"L7"}).enable(!1);Nl.priority=5;var Yu=(dc=Object(z.injectable)(),dc(Sc=function(){function ee(){X()(this,ee)}return Ge()(ee,[{key:"error",value:function(N){Nl.error(N)()}},{key:"warn",value:function(N){Nl.probe(1,N)()}},{key:"info",value:function(N){Nl.info(3,N)()}},{key:"debug",value:function(N){Nl.probe(4,N)()}}]),ee}())||Sc),Cf=i("xp6e"),gl=i("iegG"),pc=i.n(gl),Co=window.document.documentElement.style,Vf=0;function Kc(ee){var ae=ee;if(typeof ee=="string"&&(ae=document.getElementById(ee)),ae){var N=document.createElement("div");return N.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,N.id="l7-scene-".concat(Vf++),N.classList.add("l7-scene"),ae.appendChild(N),N}return null}var Ac,cf,ff,hf,kl,jl,zl,Di,ou,Uo,Bo,ui,li,sl,us,mc,wf,Of,No,yl,oi,Ia,xs,ls,Iu,bn,Es,Us,Cc,gu,yu,bu,Sn,Si,$c,wc;function Fl(ee){var ae=Du();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Ua=(Ac=Object(z.injectable)(),cf=Object(z.inject)(D.a.SceneID),ff=Object(z.inject)(D.a.IIconService),hf=Object(z.inject)(D.a.IFontService),kl=Object(z.inject)(D.a.IControlService),jl=Object(z.inject)(D.a.ILogService),zl=Object(z.inject)(D.a.IGlobalConfigService),Di=Object(z.inject)(D.a.IMapService),ou=Object(z.inject)(D.a.ICoordinateSystemService),Uo=Object(z.inject)(D.a.IRendererService),Bo=Object(z.inject)(D.a.ILayerService),ui=Object(z.inject)(D.a.ICameraService),li=Object(z.inject)(D.a.IInteractionService),sl=Object(z.inject)(D.a.IPickingService),us=Object(z.inject)(D.a.IShaderModuleService),mc=Object(z.inject)(D.a.IMarkerService),wf=Object(z.inject)(D.a.IPopupService),Ac(Of=(No=(wc=function(ee){ce()(N,ee);var ae=Fl(N);function N(){var V;return X()(this,N),V=ae.call(this),V.destroyed=!1,V.loaded=!1,Hr()(V,"id",yl,pa()(V)),Hr()(V,"iconService",oi,pa()(V)),Hr()(V,"fontService",Ia,pa()(V)),Hr()(V,"controlService",xs,pa()(V)),Hr()(V,"logger",ls,pa()(V)),Hr()(V,"configService",Iu,pa()(V)),Hr()(V,"map",bn,pa()(V)),Hr()(V,"coordinateSystemService",Es,pa()(V)),Hr()(V,"rendererService",Us,pa()(V)),Hr()(V,"layerService",Cc,pa()(V)),Hr()(V,"cameraService",gu,pa()(V)),Hr()(V,"interactionService",yu,pa()(V)),Hr()(V,"pickingService",bu,pa()(V)),Hr()(V,"shaderModuleService",Sn,pa()(V)),Hr()(V,"markerService",Si,pa()(V)),Hr()(V,"popupService",$c,pa()(V)),V.inited=!1,V.initPromise=void 0,V.rendering=!1,V.$container=void 0,V.canvas=void 0,V.markerContainer=void 0,V.hooks=void 0,V.handleWindowResized=function(){V.emit("resize"),V.$container&&(V.initContainer(),ge.a.triggerResize(),V.coordinateSystemService.needRefresh=!0,V.render())},V.handleMapCameraChanged=function(Te){V.cameraService.update(Te),V.render()},V.hooks={init:new Cf.a},V}return Ge()(N,[{key:"init",value:function(Te){var it=this;this.configService.setSceneConfig(this.id,Te),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",xn()(dr.a.mark(function Zt(){return dr.a.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:return nr.next=2,new Promise(function(Dr){it.map.onCameraChanged(function(on){it.cameraService.init(),it.cameraService.update(on),Dr()}),it.map.init()});case 2:it.map.onCameraChanged(it.handleMapCameraChanged),it.map.addMarkerContainer(),it.markerService.addMarkers(),it.markerService.addMarkerLayers(),it.popupService.initPopup(),it.interactionService.init(),it.interactionService.on(Za.a.Drag,it.addSceneEvent.bind(it)),it.logger.debug("map ".concat(it.id," loaded"));case 10:case"end":return nr.stop()}},Zt)}))),this.hooks.init.tapPromise("initRenderer",xn()(dr.a.mark(function Zt(){var ar;return dr.a.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(ar=Kc(it.configService.getSceneConfig(it.id).id||""),it.$container=ar,!ar){Dr.next=11;break}return it.canvas=ge.a.create("canvas","",ar),it.setCanvas(),Dr.next=7,it.rendererService.init(it.canvas,it.configService.getSceneConfig(it.id));case 7:pc()(it.$container,it.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(it.handleWindowResized),Dr.next=12;break;case 11:it.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:it.pickingService.init(it.id),it.logger.debug("scene ".concat(it.id," renderer loaded"));case 14:case"end":return Dr.stop()}},Zt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Te){this.logger.debug("add layer ".concat(Te.name," to scene ").concat(this.id)),this.layerService.add(Te),this.render()}},{key:"render",value:function(){var V=xn()(dr.a.mark(function it(){return dr.a.wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:if(!(this.rendering||this.destroyed)){ar.next=2;break}return ar.abrupt("return");case 2:if(this.rendering=!0,this.inited){ar.next=13;break}return ar.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return ar.stop()}},it,this)}));function Te(){return V.apply(this,arguments)}return Te}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Te){var it,Zt=(it=this.$container)===null||it===void 0?void 0:it.getElementsByTagName("canvas")[0];this.render();var ar=Te==="jpg"?Zt==null?void 0:Zt.toDataURL("image/jpeg"):Zt==null?void 0:Zt.toDataURL("image/png");return ar}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Te=this.$container.parentElement;Te!==null&&(this.markerContainer=ge.a.create("div","l7-marker-container",Te))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(gl.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Te,it,Zt=window.devicePixelRatio,ar=((Te=this.$container)===null||Te===void 0?void 0:Te.clientWidth)||400,nr=((it=this.$container)===null||it===void 0?void 0:it.clientHeight)||300,Dr=this.canvas;Dr&&(Dr.width=ar*Zt,Dr.height=nr*Zt,Dr.style.width="".concat(ar,"px"),Dr.style.height="".concat(nr,"px")),this.rendererService.viewport({x:0,y:0,width:Zt*ar,height:Zt*nr})}},{key:"setCanvas",value:function(){var Te,it,Zt=window.devicePixelRatio,ar=((Te=this.$container)===null||Te===void 0?void 0:Te.clientWidth)||400,nr=((it=this.$container)===null||it===void 0?void 0:it.clientHeight)||300,Dr=this.canvas;Dr.width=ar*Zt,Dr.height=nr*Zt,Dr.style.width="".concat(ar,"px"),Dr.style.height="".concat(nr,"px")}},{key:"addSceneEvent",value:function(Te){this.emit(Te.type,Te)}}]),N}(m.EventEmitter),wc),yl=Mr()(No.prototype,"id",[cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=Mr()(No.prototype,"iconService",[ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ia=Mr()(No.prototype,"fontService",[hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xs=Mr()(No.prototype,"controlService",[kl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls=Mr()(No.prototype,"logger",[jl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iu=Mr()(No.prototype,"configService",[zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Mr()(No.prototype,"map",[Di],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Es=Mr()(No.prototype,"coordinateSystemService",[ou],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Mr()(No.prototype,"rendererService",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=Mr()(No.prototype,"layerService",[Bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=Mr()(No.prototype,"cameraService",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu=Mr()(No.prototype,"interactionService",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bu=Mr()(No.prototype,"pickingService",[sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=Mr()(No.prototype,"shaderModuleService",[us],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=Mr()(No.prototype,"markerService",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c=Mr()(No.prototype,"popupService",[wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),No))||Of),Oc=i("7tbW"),Bs=i.n(Oc);function bl(ee){var ae=0;switch(ee){case"vec2":case"ivec2":ae=2;break;case"vec3":case"ivec3":ae=3;break;case"vec4":case"ivec4":case"mat2":ae=4;break;case"mat3":ae=9;break;case"mat4":ae=16;break;default:}return ae}var df=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Mc(ee){var ae={};return ee=ee.replace(df,function(N,V,Te){var it=Te.split(":"),Zt=it[0].trim(),ar="";it.length>1&&(ar=it[1].trim());switch(V){case"bool":ar=ar==="true";break;case"float":case"int":ar=Number(ar);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":ar?ar=ar.replace("[","").replace("]","").split(",").reduce(function(nr,Dr){return nr.push(Number(Dr.trim())),nr},[]):ar=new Array(bl(V)).fill(0);break;default:}return ae[Zt]=ar,"uniform ".concat(V," ").concat(Zt,`;
`)}),{content:ee,uniforms:ae}}var Ul,Ls,Yo;function Ji(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function bi(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Ji(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Ji(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}var Qi="#define PI 3.14159265359",Ku=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,vo=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,es=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,xu=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,Nu=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,Vo=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,xl=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Vn=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,la=/precision\s+(high|low|medium)p\s+float/,go=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,$u=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Vs=(Ul=Object(z.injectable)(),Ul(Ls=(Yo=function(){function ee(){X()(this,ee),this.moduleCache={},this.rawContentCache={}}return Ge()(ee,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Qi,fs:Qi}),this.registerModule("decode",{vs:Ku,fs:""}),this.registerModule("projection",{vs:xl,fs:""}),this.registerModule("project",{vs:Vo,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Vn}),this.registerModule("lighting",{vs:es,fs:""}),this.registerModule("light",{vs:vo,fs:""}),this.registerModule("picking",{vs:Nu,fs:xu})}},{key:"registerModule",value:function(N,V){if(this.rawContentCache[N])return;var Te=V.vs,it=V.fs,Zt=V.uniforms,ar=Mc(Te),nr=ar.content,Dr=ar.uniforms,on=Mc(it),Gn=on.content,na=on.uniforms;this.rawContentCache[N]={fs:Gn,uniforms:bi(bi(bi({},Dr),na),Zt),vs:nr}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var V=this;if(this.moduleCache[N])return this.moduleCache[N];var Te=this.rawContentCache[N].vs,it=this.rawContentCache[N].fs,Zt=this.processModule(Te,[],"vs"),ar=Zt.content,nr=Zt.includeList,Dr=this.processModule(it,[],"fs"),on=Dr.content,Gn=Dr.includeList,na=on,aa=Bs()(nr.concat(Gn).concat(N)).reduce(function(si,Ya){return bi(bi({},si),V.rawContentCache[Ya].uniforms)},{});return la.test(on)||(na=go+on),this.moduleCache[N]={fs:na.trim(),uniforms:aa,vs:ar.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,V,Te){var it=this,Zt=N.replace($u,function(ar,nr){var Dr=nr.split(" "),on=Dr[0].replace(/"/g,"");if(V.indexOf(on)>-1)return"";var Gn=it.rawContentCache[on][Te];V.push(on);var na=it.processModule(Gn,V,Te),aa=na.content;return aa});return{content:Zt,includeList:V}}}]),ee}(),Yo))||Ls),Ui=i("iWIM"),cs=i.n(Ui),Jc=i("bPkA"),Gs,Li,Ni,Bl,Eu,Vl,vc=(Gs=Object(z.injectable)(),Li=Object(z.inject)(D.a.IShaderModuleService),Gs(Ni=(Bl=(Vl=function(){function ee(){X()(this,ee),Hr()(this,"shaderModuleService",Eu,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Ge()(ee,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Jc.a.Normal}},{key:"init",value:function(N,V){this.config=V,this.rendererService=N.getContainer().get(D.a.IRendererService),this.cameraService=N.getContainer().get(D.a.ICameraService),this.mapService=N.getContainer().get(D.a.IMapService),this.interactionService=N.getContainer().get(D.a.IInteractionService),this.layerService=N.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(N){}}]),ee}(),Vl),Eu=Mr()(Bl.prototype,"shaderModuleService",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bl))||Ni),ku,ts;function Ju(ee){var ae=ul();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function ul(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Mf=(ku=Object(z.injectable)(),ku(ts=function(ee){ce()(N,ee);var ae=Ju(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Te,it){cs()(tt()(N.prototype),"init",this).call(this,Te,it)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(vc))||ts),Gl,Qc,pf,Ts,ju,ll;function mf(ee,ae){var N;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(N=El(ee))||ae&&ee&&typeof ee.length=="number"){N&&(ee=N);var V=0,Te=function(){};return{s:Te,n:function(){return V>=ee.length?{done:!0}:{done:!1,value:ee[V++]}},e:function(Dr){throw Dr},f:Te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var it=!0,Zt=!1,ar;return{s:function(){N=ee[Symbol.iterator]()},n:function(){var Dr=N.next();return it=Dr.done,Dr},e:function(Dr){Zt=!0,ar=Dr},f:function(){try{!it&&N.return!=null&&N.return()}finally{if(Zt)throw ar}}}}function El(ee,ae){if(!ee)return;if(typeof ee=="string")return Hl(ee,ae);var N=Object.prototype.toString.call(ee).slice(8,-1);if(N==="Object"&&ee.constructor&&(N=ee.constructor.name),N==="Map"||N==="Set")return Array.from(ee);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Hl(ee,ae)}function Hl(ee,ae){(ae==null||ae>ee.length)&&(ae=ee.length);for(var N=0,V=new Array(ae);N<ae;N++)V[N]=ee[N];return V}var cl=(Gl=Object(z.injectable)(),Qc=Object(z.inject)(D.a.IPostProcessor),Gl(pf=(Ts=(ll=function(){function ee(){X()(this,ee),this.passes=[],Hr()(this,"postProcessor",ju,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Ge()(ee,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var ae=xn()(dr.a.mark(function V(){var Te,it,Zt;return dr.a.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:Te=mf(this.passes),nr.prev=1,Te.s();case 3:if((it=Te.n()).done){nr.next=9;break}return Zt=it.value,nr.next=7,Zt.render(this.layer);case 7:nr.next=3;break;case 9:nr.next=14;break;case 11:nr.prev=11,nr.t0=nr.catch(1),Te.e(nr.t0);case 14:return nr.prev=14,Te.f(),nr.finish(14);case 17:this.layer.renderModels();case 18:case"end":return nr.stop()}},V,this,[[1,11,14,17]])}));function N(){return ae.apply(this,arguments)}return N}()},{key:"resize",value:function(N,V){(this.width!==N||this.height!==V)&&(this.width=N,this.height=V)}},{key:"add",value:function(N,V){N.getType()===Jc.a.PostProcessing?this.postProcessor.add(N,this.layer,V):(N.init(this.layer,V),this.passes.push(N))}},{key:"insert",value:function(N,V,Te){N.init(this.layer,V),this.passes.splice(Te,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),ee}(),ll),ju=Mr()(Ts.prototype,"postProcessor",[Qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts))||pf),Rs,Tl,Wl,Qu,s,a;function n(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function l(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?n(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):n(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function y(ee){var ae=O();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function O(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var R=(Rs=Object(z.injectable)(),Tl=Object(z.inject)(D.a.ILogService),Rs(Wl=(Qu=(a=function(ee){ce()(N,ee);var ae=y(N);function N(){var V;X()(this,N);for(var Te=arguments.length,it=new Array(Te),Zt=0;Zt<Te;Zt++)it[Zt]=arguments[Zt];return V=ae.call.apply(ae,[this].concat(it)),Hr()(V,"logger",s,pa()(V)),V.pickingFBO=void 0,V.layer=void 0,V.width=0,V.height=0,V.alreadyInRendering=!1,V.pickFromPickingFBO=function(ar){var nr=ar.x,Dr=ar.y,on=ar.lngLat,Gn=ar.type;if(!V.layer.isVisible()||!V.layer.needPick(Gn))return;var na=V.rendererService,aa=na.getViewportSize,si=na.readPixels,Ya=na.useFramebuffer,Ri=aa(),Ha=Ri.width,qi=Ri.height,hs=V.layer.getLayerConfig(),Xi=hs.enableHighlight,pi=hs.enableSelect,ks=nr*window.devicePixelRatio,Yi=Dr*window.devicePixelRatio;if(ks>Ha||ks<0||Yi>qi||Yi<0)return;var bo;Ya(V.pickingFBO,function(){var ds;if(bo=si({x:Math.round(ks),y:Math.round(qi-(Dr+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:V.pickingFBO}),bo[0]!==0||bo[1]!==0||bo[2]!==0){V.logger.debug("picked");var Ai=Object(ge.k)(bo),xo=V.layer.getSource().getFeatureById(Ai),Aa={x:nr,y:Dr,type:Gn,lngLat:on,featureId:Ai,feature:xo};xo&&(V.layer.setCurrentPickId(Ai),V.triggerHoverOnLayer(Aa))}else{var ko={x:nr,y:Dr,lngLat:on,type:V.layer.getCurrentPickId()===null?"un"+Gn:"mouseout",featureId:null,feature:null};V.triggerHoverOnLayer(l(l({},ko),{},{type:"unpick"})),V.triggerHoverOnLayer(ko),V.layer.setCurrentPickId(null)}Xi&&V.highlightPickedFeature(bo),pi&&Gn==="click"&&((ds=bo)===null||ds===void 0?void 0:ds.toString())!==[0,0,0,0].toString()&&V.selectFeature(bo)})},V}return Ge()(N,[{key:"getType",value:function(){return Jc.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Te,it){cs()(tt()(N.prototype),"init",this).call(this,Te,it),this.layer=Te;var Zt=this.rendererService,ar=Zt.createTexture2D,nr=Zt.createFramebuffer,Dr=Zt.getViewportSize,on=Dr(),Gn=on.width,na=on.height;this.pickingFBO=nr({color:ar({width:Gn,height:na,wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})}),this.interactionService.on(Za.a.Hover,this.pickFromPickingFBO),this.interactionService.on(Za.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Za.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Te){var it=this;if(this.alreadyInRendering)return;var Zt=this.rendererService,ar=Zt.getViewportSize,nr=Zt.useFramebuffer,Dr=Zt.clear,on=ar(),Gn=on.width,na=on.height;this.alreadyInRendering=!0,(this.width!==Gn||this.height!==na)&&(this.pickingFBO.resize({width:Gn,height:na}),this.width=Gn,this.height=na),nr(this.pickingFBO,function(){Dr({framebuffer:it.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var aa=it.layer.multiPassRenderer.getRenderFlag();it.layer.multiPassRenderer.setRenderFlag(!1),Te.hooks.beforePickingEncode.call(),Te.render(),Te.hooks.afterPickingEncode.call(),it.layer.multiPassRenderer.setRenderFlag(aa),it.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Te){this.layer.emit(Te.type,Te)}},{key:"highlightPickedFeature",value:function(Te){var it=pt()(Te,3),Zt=it[0],ar=it[1],nr=it[2];this.layer.hooks.beforeHighlight.call([Zt,ar,nr]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Te){var it=pt()(Te,3),Zt=it[0],ar=it[1],nr=it[2];this.layer.hooks.beforeSelect.call([Zt,ar,nr]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Te){var it=Te.featureId,Zt=Object(ge.l)(it);this.selectFeature(new Uint8Array(Zt))}},{key:"highlightFeatureHandle",value:function(Te){var it=Te.featureId,Zt=Object(ge.l)(it);this.highlightPickedFeature(new Uint8Array(Zt))}}]),N}(vc),a),s=Mr()(Qu.prototype,"logger",[Tl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qu))||Wl),k=i("+em5"),ie,Ee;function We(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function $e(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?We(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):We(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function qe(ee){var ae=Lt();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Lt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Rt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Gt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Dt=(ie=Object(z.injectable)(),ie(Ee=function(ee){ce()(N,ee);var ae=qe(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Gt,fs:Rt});var Te=this.shaderModuleService.getModule("blur-pass"),it=Te.vs,Zt=Te.fs,ar=Te.uniforms,nr=this.rendererService.getViewportSize(),Dr=nr.width,on=nr.height;return{vs:it,fs:Zt,uniforms:$e($e({},ar),{},{u_ViewportSize:[Dr,on]})}}},{key:"convertOptionsToUniforms",value:function(Te){var it={};return qo()(Te.blurRadius)||(it.u_BlurDir=[Te.blurRadius,0]),it}}]),N}(k.a))||Ee),jt,ir;function Qt(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Lr(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Qt(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Qt(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function gr(ee){var ae=Ar();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Ar(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Or=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Kr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Qr=(jt=Object(z.injectable)(),jt(ir=function(ee){ce()(N,ee);var ae=gr(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Kr,fs:Or});var Te=this.shaderModuleService.getModule("blur-pass"),it=Te.vs,Zt=Te.fs,ar=Te.uniforms,nr=this.rendererService.getViewportSize(),Dr=nr.width,on=nr.height;return{vs:it,fs:Zt,uniforms:Lr(Lr({},ar),{},{u_ViewportSize:[Dr,on]})}}},{key:"convertOptionsToUniforms",value:function(Te){var it={};return qo()(Te.blurRadius)||(it.u_BlurDir=[0,Te.blurRadius]),it}}]),N}(k.a))||ir),dn,wn;function ra(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function ya(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?ra(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):ra(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function Ta(ee){var ae=Ja();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Ja(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Mn=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,ba=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ca=(dn=Object(z.injectable)(),dn(wn=function(ee){ce()(N,ee);var ae=Ta(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:ba,fs:Mn});var Te=this.shaderModuleService.getModule("colorhalftone-pass"),it=Te.vs,Zt=Te.fs,ar=Te.uniforms,nr=this.rendererService.getViewportSize(),Dr=nr.width,on=nr.height;return{vs:it,fs:Zt,uniforms:ya(ya({},ar),{},{u_ViewportSize:[Dr,on]})}}}]),N}(k.a))||wn),Fn,Ma;function Qn(ee){var ae=Da();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Da(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var ai=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,uo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ro=(Fn=Object(z.injectable)(),Fn(Ma=function(ee){ce()(N,ee);var ae=Qn(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:uo,fs:ai}),this.shaderModuleService.getModule("copy-pass")}}]),N}(k.a))||Ma),Wi,xi;function no(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Go(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?no(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):no(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function Tu(ee){var ae=_l();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function _l(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Hs=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,fs=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ws=(Wi=Object(z.injectable)(),Wi(xi=function(ee){ce()(N,ee);var ae=Tu(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:fs,fs:Hs});var Te=this.shaderModuleService.getModule("hexagonalpixelate-pass"),it=Te.vs,Zt=Te.fs,ar=Te.uniforms,nr=this.rendererService.getViewportSize(),Dr=nr.width,on=nr.height;return{vs:it,fs:Zt,uniforms:Go(Go({},ar),{},{u_ViewportSize:[Dr,on]})}}}]),N}(k.a))||xi),Zl,_u;function Is(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Xl(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Is(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Is(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function Su(ee){var ae=Yl();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Yl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Au=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,wo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,zu=(Zl=Object(z.injectable)(),Zl(_u=function(ee){ce()(N,ee);var ae=Su(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:wo,fs:Au});var Te=this.shaderModuleService.getModule("ink-pass"),it=Te.vs,Zt=Te.fs,ar=Te.uniforms,nr=this.rendererService.getViewportSize(),Dr=nr.width,on=nr.height;return{vs:it,fs:Zt,uniforms:Xl(Xl({},ar),{},{u_ViewportSize:[Dr,on]})}}}]),N}(k.a))||_u),Kl,qc;function Oo(ee){var ae=Ds();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function Ds(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var rs=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Zi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Zs=(Kl=Object(z.injectable)(),Kl(qc=function(ee){ce()(N,ee);var ae=Oo(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Zi,fs:rs}),this.shaderModuleService.getModule("noise-pass")}}]),N}(k.a))||qc),ao,Ns;function Xs(ee){var ae=qu();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function qu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var gc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$l=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Jl=(ao=Object(z.injectable)(),ao(Ns=function(ee){ce()(N,ee);var ae=Xs(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:gc,fs:$l}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(k.a))||Ns),Ys,Ho,ef,Ql,ql,_s,ec,vf=(Ys=Object(z.injectable)(),Ho=Object(z.inject)(D.a.IRendererService),ef=Object(z.postConstruct)(),Ys(Ql=(ql=(ec=function(){function ee(){X()(this,ee),Hr()(this,"rendererService",_s,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Ge()(ee,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var ae=xn()(dr.a.mark(function V(Te){var it,Zt;return dr.a.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:it=0;case 1:if(!(it<this.passes.length)){nr.next=10;break}return Zt=this.passes[it],Zt.setRenderToScreen(this.isLastEnabledPass(it)),nr.next=6,Zt.render(Te);case 6:it!==this.passes.length-1&&this.swap();case 7:it++,nr.next=1;break;case 10:case"end":return nr.stop()}},V,this)}));function N(V){return ae.apply(this,arguments)}return N}()},{key:"resize",value:function(N,V){this.readFBO.resize({width:N,height:V}),this.writeFBO.resize({width:N,height:V})}},{key:"add",value:function(N,V,Te){N.init(V,Te),this.passes.push(N)}},{key:"insert",value:function(N,V,Te,it){N.init(Te,it),this.passes.splice(V,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(V){return V.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var V=N+1;V<this.passes.length;V++)if(this.passes[V].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),ee}(),ec),_s=Mr()(ql.prototype,"rendererService",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr()(ql.prototype,"init",[ef],Object.getOwnPropertyDescriptor(ql.prototype,"init"),ql.prototype),ql))||Ql),Pf,oh;function el(ee){var ae=gf();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function gf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var tc=(Pf=Object(z.injectable)(),Pf(oh=function(ee){ce()(N,ee);var ae=el(N);function N(){return X()(this,N),ae.apply(this,arguments)}return Ge()(N,[{key:"getType",value:function(){return Jc.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Te,it){cs()(tt()(N.prototype),"init",this).call(this,Te,it)}},{key:"render",value:function(Te){var it=this.rendererService,Zt=it.useFramebuffer,ar=it.clear;Zt(null,function(){ar({color:[0,0,0,0],depth:1,stencil:0}),Te.multiPassRenderer.setRenderFlag(!1),Te.render(),Te.multiPassRenderer.setRenderFlag(!0)})}}]),N}(vc))||oh),tf,rf,Lf,$f,Pc,Lc,Rc,Jf;function Rf(ee,ae){var N=Object.keys(ee);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(ee);ae&&(V=V.filter(function(Te){return Object.getOwnPropertyDescriptor(ee,Te).enumerable})),N.push.apply(N,V)}return N}function Qf(ee){for(var ae=1;ae<arguments.length;ae++){var N=arguments[ae]!=null?arguments[ae]:{};ae%2?Rf(Object(N),!0).forEach(function(V){q()(ee,V,N[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(N)):Rf(Object(N)).forEach(function(V){Object.defineProperty(ee,V,Object.getOwnPropertyDescriptor(N,V))})}return ee}function Ic(ee){var ae=sh();return function(){var V=tt()(ee),Te;if(ae){var it=tt()(this).constructor;Te=Reflect.construct(V,arguments,it)}else Te=V.apply(this,arguments);return Xe()(this,Te)}}function sh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var yo=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,rc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,yf=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function nc(ee,ae){for(var N=0,V=1/ae,Te=ee;Te>0;)N=N+V*(Te%ae),Te=Math.floor(Te/ae),V=V/ae;return N}var nf=1,Dc=(tf=Object(z.injectable)(),rf=Object(z.inject)(D.a.IShaderModuleService),Lf=Object(z.inject)(D.a.ILogService),tf($f=(Pc=(Jf=function(ee){ce()(N,ee);var ae=Ic(N);function N(){var V;X()(this,N);for(var Te=arguments.length,it=new Array(Te),Zt=0;Zt<Te;Zt++)it[Zt]=arguments[Zt];return V=ae.call.apply(ae,[this].concat(it)),Hr()(V,"shaderModuleService",Lc,pa()(V)),Hr()(V,"logger",Rc,pa()(V)),V.haltonSequence=[],V.accumulatingId=0,V.frame=0,V.timer=void 0,V.sampleRenderTarget=void 0,V.prevRenderTarget=void 0,V.outputRenderTarget=void 0,V.copyRenderTarget=void 0,V.blendModel=void 0,V.outputModel=void 0,V.copyModel=void 0,V}return Ge()(N,[{key:"getType",value:function(){return Jc.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Te,it){cs()(tt()(N.prototype),"init",this).call(this,Te,it);var Zt=this.rendererService,ar=Zt.createFramebuffer,nr=Zt.createTexture2D;this.sampleRenderTarget=ar({color:nr({width:1,height:1,wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=ar({color:nr({width:1,height:1,wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=ar({color:nr({width:1,height:1,wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=ar({color:nr({width:1,height:1,wrapS:zn.a.CLAMP_TO_EDGE,wrapT:zn.a.CLAMP_TO_EDGE})});for(var Dr=0;Dr<30;Dr++)this.haltonSequence.push([nc(Dr,2),nc(Dr,3)]);this.blendModel=this.createTriangleModel("blend-pass",yo),this.outputModel=this.createTriangleModel("copy-pass",rc,{blend:{enable:!0,func:{srcRGB:zn.a.ONE,dstRGB:zn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:zn.a.ONE,dstAlpha:zn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:zn.a.FUNC_ADD,alpha:zn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",rc)}},{key:"render",value:function(Te){var it=this,Zt=this.rendererService,ar=Zt.clear,nr=Zt.getViewportSize,Dr=Zt.useFramebuffer,on=nr(),Gn=on.width,na=on.height;this.sampleRenderTarget.resize({width:Gn,height:na}),this.prevRenderTarget.resize({width:Gn,height:na}),this.outputRenderTarget.resize({width:Gn,height:na}),this.copyRenderTarget.resize({width:Gn,height:na}),this.resetFrame(),this.stopAccumulating();var aa=Te.multiPassRenderer.getPostProcessor().getReadFBO();Dr(aa,function(){ar({color:[0,0,0,0],depth:1,stencil:0,framebuffer:aa}),Te.multiPassRenderer.setRenderFlag(!1),Te.render(),Te.multiPassRenderer.setRenderFlag(!0)});var si=function Ya(Ri){if(!it.accumulatingId||Ri!==it.accumulatingId)return;it.isFinished()||(it.doRender(Te),requestAnimationFrame(function(){Ya(Ri)}))};this.accumulatingId=nf++,this.timer=window.setTimeout(function(){si(it.accumulatingId)},50)}},{key:"doRender",value:function(Te){var it=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Zt=this.rendererService,ar=Zt.clear,nr=Zt.getViewportSize,Dr=Zt.useFramebuffer,on=nr(),Gn=on.width,na=on.height,aa=Te.getLayerConfig(),si=aa.jitterScale,Ya=si===void 0?1:si,Ri=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Ri[0]*2-1)/Gn*Ya,(Ri[1]*2-1)/na*Ya),Te.multiPassRenderer.setRenderFlag(!1),Te.hooks.beforeRender.call(),Dr(this.sampleRenderTarget,function(){ar({color:[0,0,0,0],depth:1,stencil:0,framebuffer:it.sampleRenderTarget}),Te.render()}),Te.hooks.afterRender.call(),Te.multiPassRenderer.setRenderFlag(!0);var Ha=Te.getLayerConfig();Dr(this.outputRenderTarget,function(){it.blendModel.draw({uniforms:{u_opacity:Ha.opacity||1,u_MixRatio:it.frame===0?1:.9,u_Diffuse1:it.sampleRenderTarget,u_Diffuse2:it.frame===0?Te.multiPassRenderer.getPostProcessor().getReadFBO():it.prevRenderTarget}})}),this.frame===0&&ar({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Dr(this.copyRenderTarget,function(){it.outputModel.draw({uniforms:{u_Texture:it.outputRenderTarget}})}),Dr(Te.multiPassRenderer.getPostProcessor().getReadFBO(),function(){it.copyModel.draw({uniforms:{u_Texture:it.copyRenderTarget}})}),Te.multiPassRenderer.getPostProcessor().render(Te));var qi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=qi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Te,it,Zt){this.shaderModuleService.registerModule(Te,{vs:yf,fs:it});var ar=this.shaderModuleService.getModule(Te),nr=ar.vs,Dr=ar.fs,on=ar.uniforms,Gn=this.rendererService,na=Gn.createAttribute,aa=Gn.createBuffer,si=Gn.createModel;return si(Qf({vs:nr,fs:Dr,attributes:{a_Position:na({buffer:aa({data:[-4,-4,4,-4,0,4],type:zn.a.FLOAT}),size:2})},uniforms:Qf({},on),depth:{enable:!1},count:3},Zt))}}]),N}(vc),Jf),Lc=Mr()(Pc.prototype,"shaderModuleService",[rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rc=Mr()(Pc.prototype,"logger",[Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pc))||$f),Fu=new z.Container;Fu.bind(D.a.IGlobalConfigService).to(Kn).inSingletonScope(),Fu.bind(D.a.IShaderModuleService).to(Vs).inSingletonScope(),Fu.bind(D.a.ILogService).to(Yu).inSingletonScope(),Object(z.decorate)(Object(z.injectable)(),m.EventEmitter),Fu.bind(D.a.IEventEmitter).to(m.EventEmitter);var Nc=W()(Fu,!1),kc=function(ae){var N=Nc.lazyInject(ae);return function(V,Te,it){N.call(this,V,Te),it&&(it.initializer=function(){return V[Te]})}},bf=function(ae){var N=Nc.lazyMultiInject(ae);return function(V,Te,it){N.call(this,V,Te),it&&(it.initializer=function(){return V[Te]})}},xf=E.c=Fu,Gf=0;function yc(){var ee=new z.Container;return ee.parent=Fu,ee.bind(D.a.SceneID).toConstantValue("".concat(Gf++)),ee.bind(D.a.ILayerService).to(Xn).inSingletonScope(),ee.bind(D.a.ISceneService).to(Ua).inSingletonScope(),ee.bind(D.a.ICameraService).to(yr).inSingletonScope(),ee.bind(D.a.ICoordinateSystemService).to(fu).inSingletonScope(),ee.bind(D.a.IInteractionService).to(Re).inSingletonScope(),ee.bind(D.a.IPickingService).to(al).inSingletonScope(),ee.bind(D.a.IControlService).to(Zn).inSingletonScope(),ee.bind(D.a.IMarkerService).to(ue).inSingletonScope(),ee.bind(D.a.IIconService).to(dt).inSingletonScope(),ee.bind(D.a.IFontService).to(I).inSingletonScope(),ee.bind(D.a.IPopupService).to(Ve).inSingletonScope(),ee.bind(D.a.INormalPass).to(Mf).whenTargetNamed("clear"),ee.bind(D.a.INormalPass).to(R).whenTargetNamed("pixelPicking"),ee.bind(D.a.INormalPass).to(tc).whenTargetNamed("render"),ee.bind(D.a.INormalPass).to(Dc).whenTargetNamed("taa"),ee.bind(D.a.IFactoryNormalPass).toFactory(function(ae){return function(N){return ae.container.getNamed(D.a.INormalPass,N)}}),ee.bind(D.a.IPostProcessingPass).to(ro).whenTargetNamed("copy"),ee.bind(D.a.IPostProcessingPass).to(Dt).whenTargetNamed("blurH"),ee.bind(D.a.IPostProcessingPass).to(Qr).whenTargetNamed("blurV"),ee.bind(D.a.IPostProcessingPass).to(Zs).whenTargetNamed("noise"),ee.bind(D.a.IPostProcessingPass).to(Jl).whenTargetNamed("sepia"),ee.bind(D.a.IPostProcessingPass).to(ca).whenTargetNamed("colorHalftone"),ee.bind(D.a.IPostProcessingPass).to(Ws).whenTargetNamed("hexagonalPixelate"),ee.bind(D.a.IPostProcessingPass).to(zu).whenTargetNamed("ink"),ee.bind(D.a.IFactoryPostProcessingPass).toFactory(function(ae){return function(N){var V=ae.container.getNamed(D.a.IPostProcessingPass,N);return V.setName(N),V}}),ee}function Sl(ee){var ae=new z.Container;return ae.parent=ee,ae.bind(D.a.IStyleAttributeService).to(Ec).inSingletonScope(),ae.bind(D.a.IMultiPassRenderer).to(cl).inSingletonScope(),ae.bind(D.a.IPostProcessor).to(vf).inSingletonScope(),ae}},fbrv:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Yk9n"),m=i("MON2"),Z=i("FV85"),z=i("xfSm"),o=i("ujMp");E.getFunctionName=o.getFunctionName;var W=i("dX1H");function D(ge,Ce){var ht=o.getFunctionName(Ce),Ne=Y(ge,ht,Ce,!1);return Ne}E.getDependencies=D;function Y(ge,Ce,ht,Ne){var Et=ge.getConstructorMetadata(ht),He=Et.compilerGeneratedMetadata;if(He===void 0){var mt=m.MISSING_INJECTABLE_ANNOTATION+" "+Ce+".";throw new Error(mt)}var Ye=Et.userGeneratedMetadata,xt=Object.keys(Ye),_t=ht.length===0&&xt.length>0,Ie=_t?xt.length:ht.length,De=he(Ne,Ce,He,Ye,Ie),ze=X(ge,ht),at=De.concat(ze);return at}function q(ge,Ce,ht,Ne,Et){var He=Et[ge.toString()]||[],mt=Ge(He),Ye=mt.unmanaged!==!0,xt=Ne[ge],_t=mt.inject||mt.multiInject;if(xt=_t||xt,xt instanceof T.LazyServiceIdentifer&&(xt=xt.unwrap()),Ye){var Ie=xt===Object,De=xt===Function,ze=xt===void 0,at=Ie||De||ze;if(!Ce&&at){var Pe=m.MISSING_INJECT_ANNOTATION+" argument "+ge+" in class "+ht+".";throw new Error(Pe)}var ot=new W.Target(Z.TargetTypeEnum.ConstructorArgument,mt.targetName,xt);return ot.metadata=He,ot}return null}function he(ge,Ce,ht,Ne,Et){for(var He=[],mt=0;mt<Et;mt++){var Ye=mt,xt=q(Ye,ge,Ce,ht,Ne);xt!==null&&He.push(xt)}return He}function X(ge,Ce){for(var ht=ge.getPropertiesMetadata(Ce),Ne=[],Et=Object.keys(ht),He=0,mt=Et;He<mt.length;He++){var Ye=mt[He],xt=ht[Ye],_t=Ge(ht[Ye]),Ie=_t.targetName||Ye,De=_t.inject||_t.multiInject,ze=new W.Target(Z.TargetTypeEnum.ClassProperty,Ie,De);ze.metadata=xt,Ne.push(ze)}var at=Object.getPrototypeOf(Ce.prototype).constructor;if(at!==Object){var Pe=X(ge,at);Ne=Ne.concat(Pe)}return Ne}function je(ge,Ce){var ht=Object.getPrototypeOf(Ce.prototype).constructor;if(ht!==Object){var Ne=o.getFunctionName(ht),Et=Y(ge,Ne,ht,!0),He=Et.map(function(xt){return xt.metadata.filter(function(_t){return _t.key===z.UNMANAGED_TAG})}),mt=[].concat.apply([],He).length,Ye=Et.length-mt;return Ye>0?Ye:je(ge,ht)}else return 0}E.getBaseClassDependencyCount=je;function Ge(ge){var Ce={};return ge.forEach(function(ht){Ce[ht.key.toString()]=ht.value}),{inject:Ce[z.INJECT_TAG],multiInject:Ce[z.MULTI_INJECT_TAG],targetName:Ce[z.NAME_TAG],unmanaged:Ce[z.UNMANAGED_TAG]}}},fbvF:function(Le,E,i){(function(T,m){Le.exports=m()})(this,function(){"use strict";var T=function(ke){return ke instanceof Uint8Array||ke instanceof Uint16Array||ke instanceof Uint32Array||ke instanceof Int8Array||ke instanceof Int16Array||ke instanceof Int32Array||ke instanceof Float32Array||ke instanceof Float64Array||ke instanceof Uint8ClampedArray},m=function(ke,Nt){for(var vr=Object.keys(Nt),Ur=0;Ur<vr.length;++Ur)ke[vr[Ur]]=Nt[vr[Ur]];return ke},Z=`
`;function z(fe){return typeof atob!="undefined"?atob(fe):"base64:"+fe}function o(fe){var ke=new Error("(regl) "+fe);throw console.error(ke),ke}function W(fe,ke){fe||o(ke)}function D(fe){return fe?": "+fe:""}function Y(fe,ke,Nt){fe in ke||o("unknown parameter ("+fe+")"+D(Nt)+". possible values: "+Object.keys(ke).join())}function q(fe,ke){T(fe)||o("invalid parameter type"+D(ke)+". must be a typed array")}function he(fe,ke){switch(ke){case"number":return typeof fe=="number";case"object":return typeof fe=="object";case"string":return typeof fe=="string";case"boolean":return typeof fe=="boolean";case"function":return typeof fe=="function";case"undefined":return typeof fe=="undefined";case"symbol":return typeof fe=="symbol"}}function X(fe,ke,Nt){he(fe,ke)||o("invalid parameter type"+D(Nt)+". expected "+ke+", got "+typeof fe)}function je(fe,ke){fe>=0&&(fe|0)===fe||o("invalid parameter type, ("+fe+")"+D(ke)+". must be a nonnegative integer")}function Ge(fe,ke,Nt){ke.indexOf(fe)<0&&o("invalid value"+D(Nt)+". must be one of: "+ke)}var ge=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ce(fe){Object.keys(fe).forEach(function(ke){ge.indexOf(ke)<0&&o('invalid regl constructor argument "'+ke+'". must be one of '+ge)})}function ht(fe,ke){for(fe=fe+"";fe.length<ke;)fe=" "+fe;return fe}function Ne(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Et(fe,ke){this.number=fe,this.line=ke,this.errors=[]}function He(fe,ke,Nt){this.file=fe,this.line=ke,this.message=Nt}function mt(){var fe=new Error,ke=(fe.stack||fe).toString(),Nt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ke);if(Nt)return Nt[1];var vr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ke);return vr?vr[1]:"unknown"}function Ye(){var fe=new Error,ke=(fe.stack||fe).toString(),Nt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ke);if(Nt)return Nt[1];var vr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ke);return vr?vr[1]:"unknown"}function xt(fe,ke){var Nt=fe.split(`
`),vr=1,Ur=0,Rr={unknown:new Ne,0:new Ne};Rr.unknown.name=Rr[0].name=ke||mt(),Rr.unknown.lines.push(new Et(0,""));for(var Er=0;Er<Nt.length;++Er){var Yr=Nt[Er],qr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Yr);if(qr)switch(qr[1]){case"line":var sn=/(\d+)(\s+\d+)?/.exec(qr[2]);sn&&(vr=sn[1]|0,sn[2]&&(Ur=sn[2]|0,Ur in Rr||(Rr[Ur]=new Ne)));break;case"define":var an=/SHADER_NAME(_B64)?\s+(.*)$/.exec(qr[2]);an&&(Rr[Ur].name=an[1]?z(an[2]):an[2]);break}Rr[Ur].lines.push(new Et(vr++,Yr))}return Object.keys(Rr).forEach(function(cn){var An=Rr[cn];An.lines.forEach(function(pn){An.index[pn.number]=pn})}),Rr}function _t(fe){var ke=[];return fe.split(`
`).forEach(function(Nt){if(Nt.length<5)return;var vr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Nt);vr?ke.push(new He(vr[1]|0,vr[2]|0,vr[3].trim())):Nt.length>0&&ke.push(new He("unknown",0,Nt))}),ke}function Ie(fe,ke){ke.forEach(function(Nt){var vr=fe[Nt.file];if(vr){var Ur=vr.index[Nt.line];if(Ur){Ur.errors.push(Nt),vr.hasErrors=!0;return}}fe.unknown.hasErrors=!0,fe.unknown.lines[0].errors.push(Nt)})}function De(fe,ke,Nt,vr,Ur){if(!fe.getShaderParameter(ke,fe.COMPILE_STATUS)){var Rr=fe.getShaderInfoLog(ke),Er=vr===fe.FRAGMENT_SHADER?"fragment":"vertex";sr(Nt,"string",Er+" shader source must be a string",Ur);var Yr=xt(Nt,Ur),qr=_t(Rr);Ie(Yr,qr),Object.keys(Yr).forEach(function(sn){var an=Yr[sn];if(!an.hasErrors)return;var cn=[""],An=[""];function pn(un,Tr){cn.push(un),An.push(Tr||"")}pn("file number "+sn+": "+an.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),an.lines.forEach(function(un){if(un.errors.length>0){pn(ht(un.number,4)+"|  ","background-color:yellow; font-weight:bold"),pn(un.line+Z,"color:red; background-color:yellow; font-weight:bold");var Tr=0;un.errors.forEach(function(xr){var tn=xr.message,Ln=/^\s*'(.*)'\s*:\s*(.*)$/.exec(tn);if(Ln){var kr=Ln[1];tn=Ln[2];switch(kr){case"assign":kr="=";break}Tr=Math.max(un.line.indexOf(kr,Tr),0)}else Tr=0;pn(ht("| ",6)),pn(ht("^^^",Tr+3)+Z,"font-weight:bold"),pn(ht("| ",6)),pn(tn+Z,"font-weight:bold")}),pn(ht("| ",6)+Z)}else pn(ht(un.number,4)+"|  "),pn(un.line+Z,"color:red")}),typeof document!="undefined"&&!window.chrome?(An[0]=cn.join("%c"),console.log.apply(console,An)):console.log(cn.join(""))}),W.raise("Error compiling "+Er+" shader, "+Yr[0].name)}}function ze(fe,ke,Nt,vr,Ur){if(!fe.getProgramParameter(ke,fe.LINK_STATUS)){var Rr=fe.getProgramInfoLog(ke),Er=xt(Nt,Ur),Yr=xt(vr,Ur),qr='Error linking program with vertex shader, "'+Yr[0].name+'", and fragment shader "'+Er[0].name+'"';typeof document!="undefined"?console.log("%c"+qr+Z+"%c"+Rr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(qr+Z+Rr),W.raise(qr)}}function at(fe){fe._commandRef=mt()}function Pe(fe,ke,Nt,vr){at(fe);function Ur(qr){return qr?vr.id(qr):0}fe._fragId=Ur(fe.static.frag),fe._vertId=Ur(fe.static.vert);function Rr(qr,sn){Object.keys(sn).forEach(function(an){qr[vr.id(an)]=!0})}var Er=fe._uniformSet={};Rr(Er,ke.static),Rr(Er,ke.dynamic);var Yr=fe._attributeSet={};Rr(Yr,Nt.static),Rr(Yr,Nt.dynamic),fe._hasCount="count"in fe.static||"count"in fe.dynamic||"elements"in fe.static||"elements"in fe.dynamic}function ot(fe,ke){var Nt=Ye();o(fe+" in command "+(ke||mt())+(Nt==="unknown"?"":" called from "+Nt))}function Bt(fe,ke,Nt){fe||ot(ke,Nt||mt())}function Wt(fe,ke,Nt,vr){fe in ke||ot("unknown parameter ("+fe+")"+D(Nt)+". possible values: "+Object.keys(ke).join(),vr||mt())}function sr(fe,ke,Nt,vr){he(fe,ke)||ot("invalid parameter type"+D(Nt)+". expected "+ke+", got "+typeof fe,vr||mt())}function ne(fe){fe()}function $(fe,ke,Nt){fe.texture?Ge(fe.texture._texture.internalformat,ke,"unsupported texture format for attachment"):Ge(fe.renderbuffer._renderbuffer.format,Nt,"unsupported renderbuffer format for attachment")}var G=33071,Ae=9728,xe=9984,Se=9985,ve=9986,et=9987,Yt=5120,At=5121,ye=5122,be=5123,Ue=5124,st=5125,Me=5126,ft=32819,w=32820,I=33635,J=34042,ce=36193,Be={};Be[Yt]=Be[At]=1,Be[ye]=Be[be]=Be[ce]=Be[I]=Be[ft]=Be[w]=2,Be[Ue]=Be[st]=Be[Me]=Be[J]=4;function Xe(fe,ke){return fe===w||fe===ft||fe===I?2:fe===J?4:Be[fe]*ke}function gt(fe){return!(fe&fe-1)&&!!fe}function tt(fe,ke,Nt){var vr,Ur=ke.width,Rr=ke.height,Er=ke.channels;W(Ur>0&&Ur<=Nt.maxTextureSize&&Rr>0&&Rr<=Nt.maxTextureSize,"invalid texture shape"),(fe.wrapS!==G||fe.wrapT!==G)&&W(gt(Ur)&&gt(Rr),"incompatible wrap mode for texture, both width and height must be power of 2"),ke.mipmask===1?Ur!==1&&Rr!==1&&W(fe.minFilter!==xe&&fe.minFilter!==ve&&fe.minFilter!==Se&&fe.minFilter!==et,"min filter requires mipmap"):(W(gt(Ur)&&gt(Rr),"texture must be a square power of 2 to support mipmapping"),W(ke.mipmask===(Ur<<1)-1,"missing or incomplete mipmap data")),ke.type===Me&&(Nt.extensions.indexOf("oes_texture_float_linear")<0&&W(fe.minFilter===Ae&&fe.magFilter===Ae,"filter not supported, must enable oes_texture_float_linear"),W(!fe.genMipmaps,"mipmap generation not supported with float textures"));var Yr=ke.images;for(vr=0;vr<16;++vr)if(Yr[vr]){var qr=Ur>>vr,sn=Rr>>vr;W(ke.mipmask&1<<vr,"missing mipmap data");var an=Yr[vr];if(W(an.width===qr&&an.height===sn,"invalid shape for mip images"),W(an.format===ke.format&&an.internalformat===ke.internalformat&&an.type===ke.type,"incompatible type for mip image"),!an.compressed)if(an.data){var cn=Math.ceil(Xe(an.type,Er)*qr/an.unpackAlignment)*an.unpackAlignment;W(an.data.byteLength===cn*sn,"invalid data for image, buffer size is inconsistent with image format")}else an.element||an.copy}else fe.genMipmaps||W((ke.mipmask&1<<vr)===0,"extra mipmap data");ke.compressed&&W(!fe.genMipmaps,"mipmap generation for compressed images not supported")}function It(fe,ke,Nt,vr){var Ur=fe.width,Rr=fe.height,Er=fe.channels;W(Ur>0&&Ur<=vr.maxTextureSize&&Rr>0&&Rr<=vr.maxTextureSize,"invalid texture shape"),W(Ur===Rr,"cube map must be square"),W(ke.wrapS===G&&ke.wrapT===G,"wrap mode not supported by cube map");for(var Yr=0;Yr<Nt.length;++Yr){var qr=Nt[Yr];W(qr.width===Ur&&qr.height===Rr,"inconsistent cube map face shape"),ke.genMipmaps&&(W(!qr.compressed,"can not generate mipmap for compressed textures"),W(qr.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var sn=qr.images,an=0;an<16;++an){var cn=sn[an];if(cn){var An=Ur>>an,pn=Rr>>an;W(qr.mipmask&1<<an,"missing mipmap data"),W(cn.width===An&&cn.height===pn,"invalid shape for mip images"),W(cn.format===fe.format&&cn.internalformat===fe.internalformat&&cn.type===fe.type,"incompatible type for mip image"),cn.compressed||(cn.data?W(cn.data.byteLength===An*pn*Math.max(Xe(cn.type,Er),cn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):cn.element||cn.copy)}}}}var K=m(W,{optional:ne,raise:o,commandRaise:ot,command:Bt,parameter:Y,commandParameter:Wt,constructor:Ce,type:X,commandType:sr,isTypedArray:q,nni:je,oneOf:Ge,shaderError:De,linkError:ze,callSite:Ye,saveCommandRef:at,saveDrawInfo:Pe,framebufferFormat:$,guessCommand:mt,texture2D:tt,textureCube:It}),Ze=0,te=0,Je=5,zt=6;function cr(fe,ke){this.id=Ze++,this.type=fe,this.data=ke}function lt(fe){return fe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function dt(fe){if(fe.length===0)return[];var ke=fe.charAt(0),Nt=fe.charAt(fe.length-1);if(fe.length>1&&ke===Nt&&(ke==='"'||ke==="'"))return['"'+lt(fe.substr(1,fe.length-2))+'"'];var vr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(fe);if(vr)return dt(fe.substr(0,vr.index)).concat(dt(vr[1])).concat(dt(fe.substr(vr.index+vr[0].length)));var Ur=fe.split(".");if(Ur.length===1)return['"'+lt(fe)+'"'];for(var Rr=[],Er=0;Er<Ur.length;++Er)Rr=Rr.concat(dt(Ur[Er]));return Rr}function Ct(fe){return"["+dt(fe).join("][")+"]"}function pt(fe,ke){return new cr(fe,Ct(ke+""))}function we(fe){return typeof fe=="function"&&!fe._reglType||fe instanceof cr}function ut(fe,ke){if(typeof fe=="function")return new cr(te,fe);if(typeof fe=="number"||typeof fe=="boolean")return new cr(Je,fe);if(Array.isArray(fe))return new cr(zt,fe.map(function(Nt,vr){return ut(Nt,ke+"["+vr+"]")}));if(fe instanceof cr)return fe;K(!1,"invalid option type in uniform "+ke)}var Ke={DynamicVariable:cr,define:pt,isDynamic:we,unbox:ut,accessor:Ct},kt={next:typeof requestAnimationFrame=="function"?function(fe){return requestAnimationFrame(fe)}:function(fe){return setTimeout(fe,16)},cancel:typeof cancelAnimationFrame=="function"?function(fe){return cancelAnimationFrame(fe)}:clearTimeout},yr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var fe={"":0},ke=[""];return{id:function(vr){var Ur=fe[vr];return Ur||(Ur=fe[vr]=ke.length,ke.push(vr),Ur)},str:function(vr){return ke[vr]}}}function hr(fe,ke,Nt){var vr=document.createElement("canvas");m(vr.style,{border:0,margin:0,padding:0,top:0,left:0}),fe.appendChild(vr),fe===document.body&&(vr.style.position="absolute",m(fe.style,{margin:0,padding:0}));function Ur(){var Yr=window.innerWidth,qr=window.innerHeight;if(fe!==document.body){var sn=fe.getBoundingClientRect();Yr=sn.right-sn.left,qr=sn.bottom-sn.top}vr.width=Nt*Yr,vr.height=Nt*qr,m(vr.style,{width:Yr+"px",height:qr+"px"})}var Rr;fe!==document.body&&typeof ResizeObserver=="function"?(Rr=new ResizeObserver(function(){setTimeout(Ur)}),Rr.observe(fe)):window.addEventListener("resize",Ur,!1);function Er(){Rr?Rr.disconnect():window.removeEventListener("resize",Ur),fe.removeChild(vr)}return Ur(),{canvas:vr,onDestroy:Er}}function jn(fe,ke){function Nt(vr){try{return fe.getContext(vr,ke)}catch(Ur){return null}}return Nt("webgl")||Nt("experimental-webgl")||Nt("webgl-experimental")}function yn(fe){return typeof fe.nodeName=="string"&&typeof fe.appendChild=="function"&&typeof fe.getBoundingClientRect=="function"}function ta(fe){return typeof fe.drawArrays=="function"||typeof fe.drawElements=="function"}function ma(fe){return typeof fe=="string"?fe.split():(K(Array.isArray(fe),"invalid extension array"),fe)}function Zn(fe){return typeof fe=="string"?(K(typeof document!="undefined","not supported outside of DOM"),document.querySelector(fe)):fe}function Wn(fe){var ke=fe||{},Nt,vr,Ur,Rr,Er={},Yr=[],qr=[],sn=typeof window=="undefined"?1:window.devicePixelRatio,an=!1,cn=function(Tr){Tr&&K.raise(Tr)},An=function(){};if(typeof ke=="string"?(K(typeof document!="undefined","selector queries only supported in DOM enviroments"),Nt=document.querySelector(ke),K(Nt,"invalid query string for element")):typeof ke=="object"?yn(ke)?Nt=ke:ta(ke)?(Rr=ke,Ur=Rr.canvas):(K.constructor(ke),"gl"in ke?Rr=ke.gl:"canvas"in ke?Ur=Zn(ke.canvas):"container"in ke&&(vr=Zn(ke.container)),"attributes"in ke&&(Er=ke.attributes,K.type(Er,"object","invalid context attributes")),"extensions"in ke&&(Yr=ma(ke.extensions)),"optionalExtensions"in ke&&(qr=ma(ke.optionalExtensions)),"onDone"in ke&&(K.type(ke.onDone,"function","invalid or missing onDone callback"),cn=ke.onDone),"profile"in ke&&(an=!!ke.profile),"pixelRatio"in ke&&(sn=+ke.pixelRatio,K(sn>0,"invalid pixel ratio"))):K.raise("invalid arguments to regl"),Nt&&(Nt.nodeName.toLowerCase()==="canvas"?Ur=Nt:vr=Nt),!Rr){if(!Ur){K(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pn=hr(vr||document.body,cn,sn);if(!pn)return null;Ur=pn.canvas,An=pn.onDestroy}Er.premultipliedAlpha===void 0&&(Er.premultipliedAlpha=!0),Rr=jn(Ur,Er)}return Rr?{gl:Rr,canvas:Ur,container:vr,extensions:Yr,optionalExtensions:qr,pixelRatio:sn,profile:an,onDone:cn,onDestroy:An}:(An(),cn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function F(fe,ke){var Nt={};function vr(Er){K.type(Er,"string","extension name must be string");var Yr=Er.toLowerCase(),qr;try{qr=Nt[Yr]=fe.getExtension(Yr)}catch(sn){}return!!qr}for(var Ur=0;Ur<ke.extensions.length;++Ur){var Rr=ke.extensions[Ur];if(!vr(Rr))return ke.onDestroy(),ke.onDone('"'+Rr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ke.optionalExtensions.forEach(vr),{extensions:Nt,restore:function(){Object.keys(Nt).forEach(function(Yr){if(Nt[Yr]&&!vr(Yr))throw new Error("(regl): error restoring extension "+Yr)})}}}function H(fe,ke){for(var Nt=Array(fe),vr=0;vr<fe;++vr)Nt[vr]=ke(vr);return Nt}var ue=5120,pe=5121,rt=5122,yt=5123,Ve=5124,ct=5125,er=5126;function rr(fe){for(var ke=16;ke<=1<<28;ke*=16)if(fe<=ke)return ke;return 0}function jr(fe){var ke,Nt;return ke=(fe>65535)<<4,fe>>>=ke,Nt=(fe>255)<<3,fe>>>=Nt,ke|=Nt,Nt=(fe>15)<<2,fe>>>=Nt,ke|=Nt,Nt=(fe>3)<<1,fe>>>=Nt,ke|=Nt,ke|fe>>1}function nn(){var fe=H(8,function(){return[]});function ke(Rr){var Er=rr(Rr),Yr=fe[jr(Er)>>2];return Yr.length>0?Yr.pop():new ArrayBuffer(Er)}function Nt(Rr){fe[jr(Rr.byteLength)>>2].push(Rr)}function vr(Rr,Er){var Yr=null;switch(Rr){case ue:Yr=new Int8Array(ke(Er),0,Er);break;case pe:Yr=new Uint8Array(ke(Er),0,Er);break;case rt:Yr=new Int16Array(ke(2*Er),0,Er);break;case yt:Yr=new Uint16Array(ke(2*Er),0,Er);break;case Ve:Yr=new Int32Array(ke(4*Er),0,Er);break;case ct:Yr=new Uint32Array(ke(4*Er),0,Er);break;case er:Yr=new Float32Array(ke(4*Er),0,Er);break;default:return null}return Yr.length!==Er?Yr.subarray(0,Er):Yr}function Ur(Rr){Nt(Rr.buffer)}return{alloc:ke,free:Nt,allocType:vr,freeType:Ur}}var ur=nn();ur.zero=nn();var Wr=3408,Tn=3410,mr=3411,Jr=3412,vn=3413,Kn=3414,_n=3415,Hr=33901,oa=33902,Mr=3379,va=3386,ha=34921,da=36347,Ki=36348,Fi=35661,xa=35660,di=34930,Ga=36349,In=34076,Oi=34024,$i=7936,Ti=7937,Io=7938,fu=35724,hu=34047,pa=36063,ws=34852,po=3553,Za=34067,Pu=34069,Mi=33984,_i=6408,_o=5126,as=5121,So=36160,Ol=36053,Os=36064,so=16384,du=function(ke,Nt){var vr=1;Nt.ext_texture_filter_anisotropic&&(vr=ke.getParameter(hu));var Ur=1,Rr=1;Nt.webgl_draw_buffers&&(Ur=ke.getParameter(ws),Rr=ke.getParameter(pa));var Er=!!Nt.oes_texture_float;if(Er){var Yr=ke.createTexture();ke.bindTexture(po,Yr),ke.texImage2D(po,0,_i,1,1,0,_i,_o,null);var qr=ke.createFramebuffer();if(ke.bindFramebuffer(So,qr),ke.framebufferTexture2D(So,Os,po,Yr,0),ke.bindTexture(po,null),ke.checkFramebufferStatus(So)!==Ol)Er=!1;else{ke.viewport(0,0,1,1),ke.clearColor(1,0,0,1),ke.clear(so);var sn=ur.allocType(_o,4);ke.readPixels(0,0,1,1,_i,_o,sn),ke.getError()?Er=!1:(ke.deleteFramebuffer(qr),ke.deleteTexture(Yr),Er=sn[0]===1),ur.freeType(sn)}}var an=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),cn=!0;if(!an){var An=ke.createTexture(),pn=ur.allocType(as,36);ke.activeTexture(Mi),ke.bindTexture(Za,An),ke.texImage2D(Pu,0,_i,3,3,0,_i,as,pn),ur.freeType(pn),ke.bindTexture(Za,null),ke.deleteTexture(An),cn=!ke.getError()}return{colorBits:[ke.getParameter(Tn),ke.getParameter(mr),ke.getParameter(Jr),ke.getParameter(vn)],depthBits:ke.getParameter(Kn),stencilBits:ke.getParameter(_n),subpixelBits:ke.getParameter(Wr),extensions:Object.keys(Nt).filter(function(un){return!!Nt[un]}),maxAnisotropic:vr,maxDrawbuffers:Ur,maxColorAttachments:Rr,pointSizeDims:ke.getParameter(Hr),lineWidthDims:ke.getParameter(oa),maxViewportDims:ke.getParameter(va),maxCombinedTextureUnits:ke.getParameter(Fi),maxCubeMapSize:ke.getParameter(In),maxRenderbufferSize:ke.getParameter(Oi),maxTextureUnits:ke.getParameter(di),maxTextureSize:ke.getParameter(Mr),maxAttributes:ke.getParameter(ha),maxVertexUniforms:ke.getParameter(da),maxVertexTextureUnits:ke.getParameter(xa),maxVaryingVectors:ke.getParameter(Ki),maxFragmentUniforms:ke.getParameter(Ga),glsl:ke.getParameter(fu),renderer:ke.getParameter(Ti),vendor:ke.getParameter($i),version:ke.getParameter(Io),readFloat:Er,npotTextureCube:cn}};function Ft(fe){return!!fe&&typeof fe=="object"&&Array.isArray(fe.shape)&&Array.isArray(fe.stride)&&typeof fe.offset=="number"&&fe.shape.length===fe.stride.length&&(Array.isArray(fe.data)||T(fe.data))}var Re=function(ke){return Object.keys(ke).map(function(Nt){return ke[Nt]})},Mt={shape:mo,flatten:Gi};function dr(fe,ke,Nt){for(var vr=0;vr<ke;++vr)Nt[vr]=fe[vr]}function en(fe,ke,Nt,vr){for(var Ur=0,Rr=0;Rr<ke;++Rr)for(var Er=fe[Rr],Yr=0;Yr<Nt;++Yr)vr[Ur++]=Er[Yr]}function xn(fe,ke,Nt,vr,Ur,Rr){for(var Er=Rr,Yr=0;Yr<ke;++Yr)for(var qr=fe[Yr],sn=0;sn<Nt;++sn)for(var an=qr[sn],cn=0;cn<vr;++cn)Ur[Er++]=an[cn]}function zn(fe,ke,Nt,vr,Ur){for(var Rr=1,Er=Nt+1;Er<ke.length;++Er)Rr*=ke[Er];var Yr=ke[Nt];if(ke.length-Nt===4){var qr=ke[Nt+1],sn=ke[Nt+2],an=ke[Nt+3];for(Er=0;Er<Yr;++Er)xn(fe[Er],qr,sn,an,vr,Ur),Ur+=Rr}else for(Er=0;Er<Yr;++Er)zn(fe[Er],ke,Nt+1,vr,Ur),Ur+=Rr}function Gi(fe,ke,Nt,vr){var Ur=1;if(ke.length)for(var Rr=0;Rr<ke.length;++Rr)Ur*=ke[Rr];else Ur=0;var Er=vr||ur.allocType(Nt,Ur);switch(ke.length){case 0:break;case 1:dr(fe,ke[0],Er);break;case 2:en(fe,ke[0],ke[1],Er);break;case 3:xn(fe,ke[0],ke[1],ke[2],Er,0);break;default:zn(fe,ke,0,Er,0)}return Er}function mo(fe){for(var ke=[],Nt=fe;Nt.length;Nt=Nt[0])ke.push(Nt.length);return ke}var Do={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},To=5120,nl=5122,Ml=5124,eu=5121,uf=5123,bs=5125,Vu=5126,tu=5126,Ao={int8:To,int16:nl,int32:Ml,uint8:eu,uint16:uf,uint32:bs,float:Vu,float32:tu},is=35048,Gu=35040,al={dynamic:is,stream:Gu,static:35044},Ms=Mt.flatten,$a=Mt.shape,Hu=35044,Wu=35040,il=5121,sc=5126,wt=[];wt[5120]=1,wt[5122]=2,wt[5124]=4,wt[5121]=1,wt[5123]=2,wt[5125]=4,wt[5126]=4;function qt(fe){return Do[Object.prototype.toString.call(fe)]|0}function wr(fe,ke){for(var Nt=0;Nt<ke.length;++Nt)fe[Nt]=ke[Nt]}function Xn(fe,ke,Nt,vr,Ur,Rr,Er){for(var Yr=0,qr=0;qr<Nt;++qr)for(var sn=0;sn<vr;++sn)fe[Yr++]=ke[Ur*qr+Rr*sn+Er]}function Xa(fe,ke,Nt,vr){var Ur=0,Rr={};function Er(Tr){this.id=Ur++,this.buffer=fe.createBuffer(),this.type=Tr,this.usage=Hu,this.byteLength=0,this.dimension=1,this.dtype=il,this.persistentData=null,Nt.profile&&(this.stats={size:0})}Er.prototype.bind=function(){fe.bindBuffer(this.type,this.buffer)},Er.prototype.destroy=function(){An(this)};var Yr=[];function qr(Tr,xr){var tn=Yr.pop();return tn||(tn=new Er(Tr)),tn.bind(),cn(tn,xr,Wu,0,1,!1),tn}function sn(Tr){Yr.push(Tr)}function an(Tr,xr,tn){Tr.byteLength=xr.byteLength,fe.bufferData(Tr.type,xr,tn)}function cn(Tr,xr,tn,Ln,kr,Yn){var $r;if(Tr.usage=tn,Array.isArray(xr)){if(Tr.dtype=Ln||sc,xr.length>0){var Br;if(Array.isArray(xr[0])){$r=$a(xr);for(var Gr=1,Xr=1;Xr<$r.length;++Xr)Gr*=$r[Xr];Tr.dimension=Gr,Br=Ms(xr,$r,Tr.dtype),an(Tr,Br,tn),Yn?Tr.persistentData=Br:ur.freeType(Br)}else if(typeof xr[0]=="number"){Tr.dimension=kr;var Hn=ur.allocType(Tr.dtype,xr.length);wr(Hn,xr),an(Tr,Hn,tn),Yn?Tr.persistentData=Hn:ur.freeType(Hn)}else T(xr[0])?(Tr.dimension=xr[0].length,Tr.dtype=Ln||qt(xr[0])||sc,Br=Ms(xr,[xr.length,xr[0].length],Tr.dtype),an(Tr,Br,tn),Yn?Tr.persistentData=Br:ur.freeType(Br)):K.raise("invalid buffer data")}}else if(T(xr))Tr.dtype=Ln||qt(xr),Tr.dimension=kr,an(Tr,xr,tn),Yn&&(Tr.persistentData=new Uint8Array(new Uint8Array(xr.buffer)));else if(Ft(xr)){$r=xr.shape;var qn=xr.stride,fn=xr.offset,rn=0,zr=0,Ea=0,Wa=0;$r.length===1?(rn=$r[0],zr=1,Ea=qn[0],Wa=0):$r.length===2?(rn=$r[0],zr=$r[1],Ea=qn[0],Wa=qn[1]):K.raise("invalid shape"),Tr.dtype=Ln||qt(xr.data)||sc,Tr.dimension=zr;var Un=ur.allocType(Tr.dtype,rn*zr);Xn(Un,xr.data,rn,zr,Ea,Wa,fn),an(Tr,Un,tn),Yn?Tr.persistentData=Un:ur.freeType(Un)}else xr instanceof ArrayBuffer?(Tr.dtype=il,Tr.dimension=kr,an(Tr,xr,tn),Yn&&(Tr.persistentData=new Uint8Array(new Uint8Array(xr)))):K.raise("invalid buffer data")}function An(Tr){ke.bufferCount--,vr(Tr);var xr=Tr.buffer;K(xr,"buffer must not be deleted already"),fe.deleteBuffer(xr),Tr.buffer=null,delete Rr[Tr.id]}function pn(Tr,xr,tn,Ln){ke.bufferCount++;var kr=new Er(xr);Rr[kr.id]=kr;function Yn(Gr){var Xr=Hu,Hn=null,qn=0,fn=0,rn=1;return Array.isArray(Gr)||T(Gr)||Ft(Gr)||Gr instanceof ArrayBuffer?Hn=Gr:typeof Gr=="number"?qn=Gr|0:Gr&&(K.type(Gr,"object","buffer arguments must be an object, a number or an array"),"data"in Gr&&(K(Hn===null||Array.isArray(Hn)||T(Hn)||Ft(Hn),"invalid data for buffer"),Hn=Gr.data),"usage"in Gr&&(K.parameter(Gr.usage,al,"invalid buffer usage"),Xr=al[Gr.usage]),"type"in Gr&&(K.parameter(Gr.type,Ao,"invalid buffer type"),fn=Ao[Gr.type]),"dimension"in Gr&&(K.type(Gr.dimension,"number","invalid dimension"),rn=Gr.dimension|0),"length"in Gr&&(K.nni(qn,"buffer length must be a nonnegative integer"),qn=Gr.length|0)),kr.bind(),Hn?cn(kr,Hn,Xr,fn,rn,Ln):(qn&&fe.bufferData(kr.type,qn,Xr),kr.dtype=fn||il,kr.usage=Xr,kr.dimension=rn,kr.byteLength=qn),Nt.profile&&(kr.stats.size=kr.byteLength*wt[kr.dtype]),Yn}function $r(Gr,Xr){K(Xr+Gr.byteLength<=kr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Gr.byteLength+" starting from offset "+Xr+" to a buffer of size "+kr.byteLength),fe.bufferSubData(kr.type,Xr,Gr)}function Br(Gr,Xr){var Hn=(Xr||0)|0,qn;if(kr.bind(),T(Gr)||Gr instanceof ArrayBuffer)$r(Gr,Hn);else if(Array.isArray(Gr)){if(Gr.length>0)if(typeof Gr[0]=="number"){var fn=ur.allocType(kr.dtype,Gr.length);wr(fn,Gr),$r(fn,Hn),ur.freeType(fn)}else if(Array.isArray(Gr[0])||T(Gr[0])){qn=$a(Gr);var rn=Ms(Gr,qn,kr.dtype);$r(rn,Hn),ur.freeType(rn)}else K.raise("invalid buffer data")}else if(Ft(Gr)){qn=Gr.shape;var zr=Gr.stride,Ea=0,Wa=0,Un=0,Fa=0;qn.length===1?(Ea=qn[0],Wa=1,Un=zr[0],Fa=0):qn.length===2?(Ea=qn[0],Wa=qn[1],Un=zr[0],Fa=zr[1]):K.raise("invalid shape");var Pa=Array.isArray(Gr.data)?kr.dtype:qt(Gr.data),Na=ur.allocType(Pa,Ea*Wa);Xn(Na,Gr.data,Ea,Wa,Un,Fa,Gr.offset),$r(Na,Hn),ur.freeType(Na)}else K.raise("invalid data for buffer subdata");return Yn}return tn||Yn(Tr),Yn._reglType="buffer",Yn._buffer=kr,Yn.subdata=Br,Nt.profile&&(Yn.stats=kr.stats),Yn.destroy=function(){An(kr)},Yn}function un(){Re(Rr).forEach(function(Tr){Tr.buffer=fe.createBuffer(),fe.bindBuffer(Tr.type,Tr.buffer),fe.bufferData(Tr.type,Tr.persistentData||Tr.byteLength,Tr.usage)})}return Nt.profile&&(ke.getTotalBufferSize=function(){var Tr=0;return Object.keys(Rr).forEach(function(xr){Tr+=Rr[xr].stats.size}),Tr}),{create:pn,createStream:qr,destroyStream:sn,clear:function(){Re(Rr).forEach(An),Yr.forEach(An)},getBuffer:function(xr){return xr&&xr._buffer instanceof Er?xr._buffer:null},restore:un,_initBuffer:cn}}var ni=0,to=0,Sa=1,Ii=1,qo=4,gi=4,os={points:ni,point:to,lines:Sa,line:Ii,triangles:qo,triangle:gi,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ru=0,pu=1,ss=4,Zu=5120,mu=5121,ol=5122,Lu=5123,Xu=5124,uc=5125,lf=34963,Ec=35040,Hi=35044;function Vc(fe,ke,Nt,vr){var Ur={},Rr=0,Er={uint8:mu,uint16:Lu};ke.oes_element_index_uint&&(Er.uint32=uc);function Yr(un){this.id=Rr++,Ur[this.id]=this,this.buffer=un,this.primType=ss,this.vertCount=0,this.type=0}Yr.prototype.bind=function(){this.buffer.bind()};var qr=[];function sn(un){var Tr=qr.pop();return Tr||(Tr=new Yr(Nt.create(null,lf,!0,!1)._buffer)),cn(Tr,un,Ec,-1,-1,0,0),Tr}function an(un){qr.push(un)}function cn(un,Tr,xr,tn,Ln,kr,Yn){un.buffer.bind();var $r;if(Tr){var Br=Yn;!Yn&&(!T(Tr)||Ft(Tr)&&!T(Tr.data))&&(Br=ke.oes_element_index_uint?uc:Lu),Nt._initBuffer(un.buffer,Tr,xr,Br,3)}else fe.bufferData(lf,kr,xr),un.buffer.dtype=$r||mu,un.buffer.usage=xr,un.buffer.dimension=3,un.buffer.byteLength=kr;if($r=Yn,!Yn){switch(un.buffer.dtype){case mu:case Zu:$r=mu;break;case Lu:case ol:$r=Lu;break;case uc:case Xu:$r=uc;break;default:K.raise("unsupported type for element array")}un.buffer.dtype=$r}un.type=$r,K($r!==uc||!!ke.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Gr=Ln;Gr<0&&(Gr=un.buffer.byteLength,$r===Lu?Gr>>=1:$r===uc&&(Gr>>=2)),un.vertCount=Gr;var Xr=tn;if(tn<0){Xr=ss;var Hn=un.buffer.dimension;Hn===1&&(Xr=ru),Hn===2&&(Xr=pu),Hn===3&&(Xr=ss)}un.primType=Xr}function An(un){vr.elementsCount--,K(un.buffer!==null,"must not double destroy elements"),delete Ur[un.id],un.buffer.destroy(),un.buffer=null}function pn(un,Tr){var xr=Nt.create(null,lf,!0),tn=new Yr(xr._buffer);vr.elementsCount++;function Ln(kr){if(!kr)xr(),tn.primType=ss,tn.vertCount=0,tn.type=mu;else if(typeof kr=="number")xr(kr),tn.primType=ss,tn.vertCount=kr|0,tn.type=mu;else{var Yn=null,$r=Hi,Br=-1,Gr=-1,Xr=0,Hn=0;Array.isArray(kr)||T(kr)||Ft(kr)?Yn=kr:(K.type(kr,"object","invalid arguments for elements"),"data"in kr&&(Yn=kr.data,K(Array.isArray(Yn)||T(Yn)||Ft(Yn),"invalid data for element buffer")),"usage"in kr&&(K.parameter(kr.usage,al,"invalid element buffer usage"),$r=al[kr.usage]),"primitive"in kr&&(K.parameter(kr.primitive,os,"invalid element buffer primitive"),Br=os[kr.primitive]),"count"in kr&&(K(typeof kr.count=="number"&&kr.count>=0,"invalid vertex count for elements"),Gr=kr.count|0),"type"in kr&&(K.parameter(kr.type,Er,"invalid buffer type"),Hn=Er[kr.type]),"length"in kr?Xr=kr.length|0:(Xr=Gr,Hn===Lu||Hn===ol?Xr*=2:(Hn===uc||Hn===Xu)&&(Xr*=4))),cn(tn,Yn,$r,Br,Gr,Xr,Hn)}return Ln}return Ln(un),Ln._reglType="elements",Ln._elements=tn,Ln.subdata=function(kr,Yn){return xr.subdata(kr,Yn),Ln},Ln.destroy=function(){An(tn)},Ln}return{create:pn,createStream:sn,destroyStream:an,getElements:function(Tr){return typeof Tr=="function"&&Tr._elements instanceof Yr?Tr._elements:null},clear:function(){Re(Ur).forEach(An)}}}var Gc=new Float32Array(1),Tf=new Uint32Array(Gc.buffer),Hc=5123;function _f(fe){for(var ke=ur.allocType(Hc,fe.length),Nt=0;Nt<fe.length;++Nt)if(isNaN(fe[Nt]))ke[Nt]=65535;else if(fe[Nt]===Infinity)ke[Nt]=31744;else if(fe[Nt]===-Infinity)ke[Nt]=64512;else{Gc[0]=fe[Nt];var vr=Tf[0],Ur=vr>>>31<<15,Rr=(vr<<1>>>24)-127,Er=vr>>13&(1<<10)-1;if(Rr<-24)ke[Nt]=Ur;else if(Rr<-14){var Yr=-14-Rr;ke[Nt]=Ur+(Er+(1<<10)>>Yr)}else Rr>15?ke[Nt]=Ur+31744:ke[Nt]=Ur+(Rr+15<<10)+Er}return ke}function Pi(fe){return Array.isArray(fe)||T(fe)}var Ru=function(ke){return!(ke&ke-1)&&!!ke},Pl=34467,nu=3553,Wc=34067,lc=34069,vu=6408,Zc=6406,Fs=6407,au=6409,Ll=6410,Tc=32854,yi=32855,cc=36194,Uf=32819,fc=32820,Bf=33635,_c=34042,Rl=6402,pl=34041,Ps=35904,hc=35906,Fo=36193,Il=33776,ml=33777,Xc=33778,vl=33779,iu=35986,Yc=35987,Sf=34798,Af=35840,Dl=35841,dc=35842,Sc=35843,Nl=36196,Yu=5121,Cf=5123,gl=5125,pc=5126,Co=10242,Vf=10243,Kc=10497,Ac=33071,cf=33648,ff=10240,hf=10241,kl=9728,jl=9729,zl=9984,Di=9985,ou=9986,Uo=9987,Bo=33170,ui=4352,li=4353,sl=4354,us=34046,mc=3317,wf=37440,Of=37441,No=37443,yl=37444,oi=33984,Ia=[zl,ou,Di,Uo],xs=[0,au,Ll,Fs,vu],ls={};ls[au]=ls[Zc]=ls[Rl]=1,ls[pl]=ls[Ll]=2,ls[Fs]=ls[Ps]=3,ls[vu]=ls[hc]=4;function Iu(fe){return"[object "+fe+"]"}var bn=Iu("HTMLCanvasElement"),Es=Iu("OffscreenCanvas"),Us=Iu("CanvasRenderingContext2D"),Cc=Iu("ImageBitmap"),gu=Iu("HTMLImageElement"),yu=Iu("HTMLVideoElement"),bu=Object.keys(Do).concat([bn,Es,Us,Cc,gu,yu]),Sn=[];Sn[Yu]=1,Sn[pc]=4,Sn[Fo]=2,Sn[Cf]=2,Sn[gl]=4;var Si=[];Si[Tc]=2,Si[yi]=2,Si[cc]=2,Si[pl]=4,Si[Il]=.5,Si[ml]=.5,Si[Xc]=1,Si[vl]=1,Si[iu]=.5,Si[Yc]=1,Si[Sf]=1,Si[Af]=.5,Si[Dl]=.25,Si[dc]=.5,Si[Sc]=.25,Si[Nl]=.5;function $c(fe){return Array.isArray(fe)&&(fe.length===0||typeof fe[0]=="number")}function wc(fe){if(!Array.isArray(fe))return!1;var ke=fe.length;return!(ke===0||!Pi(fe[0]))}function Fl(fe){return Object.prototype.toString.call(fe)}function Du(fe){return Fl(fe)===bn}function Ua(fe){return Fl(fe)===Es}function Oc(fe){return Fl(fe)===Us}function Bs(fe){return Fl(fe)===Cc}function bl(fe){return Fl(fe)===gu}function df(fe){return Fl(fe)===yu}function Mc(fe){if(!fe)return!1;var ke=Fl(fe);return bu.indexOf(ke)>=0?!0:$c(fe)||wc(fe)||Ft(fe)}function Ul(fe){return Do[Object.prototype.toString.call(fe)]|0}function Ls(fe,ke){var Nt=ke.length;switch(fe.type){case Yu:case Cf:case gl:case pc:var vr=ur.allocType(fe.type,Nt);vr.set(ke),fe.data=vr;break;case Fo:fe.data=_f(ke);break;default:K.raise("unsupported texture type, must specify a typed array")}}function Yo(fe,ke){return ur.allocType(fe.type===Fo?pc:fe.type,ke)}function Ji(fe,ke){fe.type===Fo?(fe.data=_f(ke),ur.freeType(ke)):fe.data=ke}function bi(fe,ke,Nt,vr,Ur,Rr){for(var Er=fe.width,Yr=fe.height,qr=fe.channels,sn=Er*Yr*qr,an=Yo(fe,sn),cn=0,An=0;An<Yr;++An)for(var pn=0;pn<Er;++pn)for(var un=0;un<qr;++un)an[cn++]=ke[Nt*pn+vr*An+Ur*un+Rr];Ji(fe,an)}function Qi(fe,ke,Nt,vr,Ur,Rr){var Er;if(typeof Si[fe]!="undefined"?Er=Si[fe]:Er=ls[fe]*Sn[ke],Rr&&(Er*=6),Ur){for(var Yr=0,qr=Nt;qr>=1;)Yr+=Er*qr*qr,qr/=2;return Yr}else return Er*Nt*vr}function Ku(fe,ke,Nt,vr,Ur,Rr,Er){var Yr={"don't care":ui,"dont care":ui,nice:sl,fast:li},qr={repeat:Kc,clamp:Ac,mirror:cf},sn={nearest:kl,linear:jl},an=m({mipmap:Uo,"nearest mipmap nearest":zl,"linear mipmap nearest":Di,"nearest mipmap linear":ou,"linear mipmap linear":Uo},sn),cn={none:0,browser:yl},An={uint8:Yu,rgba4:Uf,rgb565:Bf,"rgb5 a1":fc},pn={alpha:Zc,luminance:au,"luminance alpha":Ll,rgb:Fs,rgba:vu,rgba4:Tc,"rgb5 a1":yi,rgb565:cc},un={};ke.ext_srgb&&(pn.srgb=Ps,pn.srgba=hc),ke.oes_texture_float&&(An.float32=An.float=pc),ke.oes_texture_half_float&&(An.float16=An["half float"]=Fo),ke.webgl_depth_texture&&(m(pn,{depth:Rl,"depth stencil":pl}),m(An,{uint16:Cf,uint32:gl,"depth stencil":_c})),ke.webgl_compressed_texture_s3tc&&m(un,{"rgb s3tc dxt1":Il,"rgba s3tc dxt1":ml,"rgba s3tc dxt3":Xc,"rgba s3tc dxt5":vl}),ke.webgl_compressed_texture_atc&&m(un,{"rgb atc":iu,"rgba atc explicit alpha":Yc,"rgba atc interpolated alpha":Sf}),ke.webgl_compressed_texture_pvrtc&&m(un,{"rgb pvrtc 4bppv1":Af,"rgb pvrtc 2bppv1":Dl,"rgba pvrtc 4bppv1":dc,"rgba pvrtc 2bppv1":Sc}),ke.webgl_compressed_texture_etc1&&(un["rgb etc1"]=Nl);var Tr=Array.prototype.slice.call(fe.getParameter(Pl));Object.keys(un).forEach(function(Ot){var _r=un[Ot];Tr.indexOf(_r)>=0&&(pn[Ot]=_r)});var xr=Object.keys(pn);Nt.textureFormats=xr;var tn=[];Object.keys(pn).forEach(function(Ot){var _r=pn[Ot];tn[_r]=Ot});var Ln=[];Object.keys(An).forEach(function(Ot){var _r=An[Ot];Ln[_r]=Ot});var kr=[];Object.keys(sn).forEach(function(Ot){var _r=sn[Ot];kr[_r]=Ot});var Yn=[];Object.keys(an).forEach(function(Ot){var _r=an[Ot];Yn[_r]=Ot});var $r=[];Object.keys(qr).forEach(function(Ot){var _r=qr[Ot];$r[_r]=Ot});var Br=xr.reduce(function(Ot,_r){var br=pn[_r];return br===au||br===Zc||br===au||br===Ll||br===Rl||br===pl||ke.ext_srgb&&(br===Ps||br===hc)?Ot[br]=br:br===yi||_r.indexOf("rgba")>=0?Ot[br]=vu:Ot[br]=Fs,Ot},{});function Gr(){this.internalformat=vu,this.format=vu,this.type=Yu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yl,this.width=0,this.height=0,this.channels=0}function Xr(Ot,_r){Ot.internalformat=_r.internalformat,Ot.format=_r.format,Ot.type=_r.type,Ot.compressed=_r.compressed,Ot.premultiplyAlpha=_r.premultiplyAlpha,Ot.flipY=_r.flipY,Ot.unpackAlignment=_r.unpackAlignment,Ot.colorSpace=_r.colorSpace,Ot.width=_r.width,Ot.height=_r.height,Ot.channels=_r.channels}function Hn(Ot,_r){if(typeof _r!="object"||!_r)return;if("premultiplyAlpha"in _r&&(K.type(_r.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ot.premultiplyAlpha=_r.premultiplyAlpha),"flipY"in _r&&(K.type(_r.flipY,"boolean","invalid texture flip"),Ot.flipY=_r.flipY),"alignment"in _r&&(K.oneOf(_r.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ot.unpackAlignment=_r.alignment),"colorSpace"in _r&&(K.parameter(_r.colorSpace,cn,"invalid colorSpace"),Ot.colorSpace=cn[_r.colorSpace]),"type"in _r){var br=_r.type;K(ke.oes_texture_float||!(br==="float"||br==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),K(ke.oes_texture_half_float||!(br==="half float"||br==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),K(ke.webgl_depth_texture||!(br==="uint16"||br==="uint32"||br==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),K.parameter(br,An,"invalid texture type"),Ot.type=An[br]}var On=Ot.width,Ra=Ot.height,vt=Ot.channels,Qe=!1;"shape"in _r?(K(Array.isArray(_r.shape)&&_r.shape.length>=2,"shape must be an array"),On=_r.shape[0],Ra=_r.shape[1],_r.shape.length===3&&(vt=_r.shape[2],K(vt>0&&vt<=4,"invalid number of channels"),Qe=!0),K(On>=0&&On<=Nt.maxTextureSize,"invalid width"),K(Ra>=0&&Ra<=Nt.maxTextureSize,"invalid height")):("radius"in _r&&(On=Ra=_r.radius,K(On>=0&&On<=Nt.maxTextureSize,"invalid radius")),"width"in _r&&(On=_r.width,K(On>=0&&On<=Nt.maxTextureSize,"invalid width")),"height"in _r&&(Ra=_r.height,K(Ra>=0&&Ra<=Nt.maxTextureSize,"invalid height")),"channels"in _r&&(vt=_r.channels,K(vt>0&&vt<=4,"invalid number of channels"),Qe=!0)),Ot.width=On|0,Ot.height=Ra|0,Ot.channels=vt|0;var Ht=!1;if("format"in _r){var lr=_r.format;K(ke.webgl_depth_texture||!(lr==="depth"||lr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),K.parameter(lr,pn,"invalid texture format");var fr=Ot.internalformat=pn[lr];Ot.format=Br[fr],lr in An&&("type"in _r||(Ot.type=An[lr])),lr in un&&(Ot.compressed=!0),Ht=!0}!Qe&&Ht?Ot.channels=ls[Ot.format]:Qe&&!Ht?Ot.channels!==xs[Ot.format]&&(Ot.format=Ot.internalformat=xs[Ot.channels]):Ht&&Qe&&K(Ot.channels===ls[Ot.format],"number of channels inconsistent with specified format")}function qn(Ot){fe.pixelStorei(wf,Ot.flipY),fe.pixelStorei(Of,Ot.premultiplyAlpha),fe.pixelStorei(No,Ot.colorSpace),fe.pixelStorei(mc,Ot.unpackAlignment)}function fn(){Gr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function rn(Ot,_r){var br=null;if(Mc(_r)?br=_r:_r&&(K.type(_r,"object","invalid pixel data type"),Hn(Ot,_r),"x"in _r&&(Ot.xOffset=_r.x|0),"y"in _r&&(Ot.yOffset=_r.y|0),Mc(_r.data)&&(br=_r.data)),K(!Ot.compressed||br instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),_r.copy){K(!br,"can not specify copy and data field for the same texture");var On=Ur.viewportWidth,Ra=Ur.viewportHeight;Ot.width=Ot.width||On-Ot.xOffset,Ot.height=Ot.height||Ra-Ot.yOffset,Ot.needsCopy=!0,K(Ot.xOffset>=0&&Ot.xOffset<On&&Ot.yOffset>=0&&Ot.yOffset<Ra&&Ot.width>0&&Ot.width<=On&&Ot.height>0&&Ot.height<=Ra,"copy texture read out of bounds")}else if(!br)Ot.width=Ot.width||1,Ot.height=Ot.height||1,Ot.channels=Ot.channels||4;else if(T(br))Ot.channels=Ot.channels||4,Ot.data=br,!("type"in _r)&&Ot.type===Yu&&(Ot.type=Ul(br));else if($c(br))Ot.channels=Ot.channels||4,Ls(Ot,br),Ot.alignment=1,Ot.needsFree=!0;else if(Ft(br)){var vt=br.data;!Array.isArray(vt)&&Ot.type===Yu&&(Ot.type=Ul(vt));var Qe=br.shape,Ht=br.stride,lr,fr,$t,b,p,c;Qe.length===3?($t=Qe[2],c=Ht[2]):(K(Qe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),$t=1,c=1),lr=Qe[0],fr=Qe[1],b=Ht[0],p=Ht[1],Ot.alignment=1,Ot.width=lr,Ot.height=fr,Ot.channels=$t,Ot.format=Ot.internalformat=xs[$t],Ot.needsFree=!0,bi(Ot,vt,b,p,c,br.offset)}else if(Du(br)||Ua(br)||Oc(br))Du(br)||Ua(br)?Ot.element=br:Ot.element=br.canvas,Ot.width=Ot.element.width,Ot.height=Ot.element.height,Ot.channels=4;else if(Bs(br))Ot.element=br,Ot.width=br.width,Ot.height=br.height,Ot.channels=4;else if(bl(br))Ot.element=br,Ot.width=br.naturalWidth,Ot.height=br.naturalHeight,Ot.channels=4;else if(df(br))Ot.element=br,Ot.width=br.videoWidth,Ot.height=br.videoHeight,Ot.channels=4;else if(wc(br)){var d=Ot.width||br[0].length,v=Ot.height||br.length,L=Ot.channels;Pi(br[0][0])?L=L||br[0][0].length:L=L||1;for(var j=Mt.shape(br),se=1,oe=0;oe<j.length;++oe)se*=j[oe];var le=Yo(Ot,se);Mt.flatten(br,j,"",le),Ji(Ot,le),Ot.alignment=1,Ot.width=d,Ot.height=v,Ot.channels=L,Ot.format=Ot.internalformat=xs[L],Ot.needsFree=!0}Ot.type===pc?K(Nt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ot.type===Fo&&K(Nt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function zr(Ot,_r,br){var On=Ot.element,Ra=Ot.data,vt=Ot.internalformat,Qe=Ot.format,Ht=Ot.type,lr=Ot.width,fr=Ot.height;qn(Ot),On?fe.texImage2D(_r,br,Qe,Qe,Ht,On):Ot.compressed?fe.compressedTexImage2D(_r,br,vt,lr,fr,0,Ra):Ot.needsCopy?(vr(),fe.copyTexImage2D(_r,br,Qe,Ot.xOffset,Ot.yOffset,lr,fr,0)):fe.texImage2D(_r,br,Qe,lr,fr,0,Qe,Ht,Ra||null)}function Ea(Ot,_r,br,On,Ra){var vt=Ot.element,Qe=Ot.data,Ht=Ot.internalformat,lr=Ot.format,fr=Ot.type,$t=Ot.width,b=Ot.height;qn(Ot),vt?fe.texSubImage2D(_r,Ra,br,On,lr,fr,vt):Ot.compressed?fe.compressedTexSubImage2D(_r,Ra,br,On,Ht,$t,b,Qe):Ot.needsCopy?(vr(),fe.copyTexSubImage2D(_r,Ra,br,On,Ot.xOffset,Ot.yOffset,$t,b)):fe.texSubImage2D(_r,Ra,br,On,$t,b,lr,fr,Qe)}var Wa=[];function Un(){return Wa.pop()||new fn}function Fa(Ot){Ot.needsFree&&ur.freeType(Ot.data),fn.call(Ot),Wa.push(Ot)}function Pa(){Gr.call(this),this.genMipmaps=!1,this.mipmapHint=ui,this.mipmask=0,this.images=Array(16)}function Na(Ot,_r,br){var On=Ot.images[0]=Un();Ot.mipmask=1,On.width=Ot.width=_r,On.height=Ot.height=br,On.channels=Ot.channels=4}function Ci(Ot,_r){var br=null;if(Mc(_r))br=Ot.images[0]=Un(),Xr(br,Ot),rn(br,_r),Ot.mipmask=1;else if(Hn(Ot,_r),Array.isArray(_r.mipmap))for(var On=_r.mipmap,Ra=0;Ra<On.length;++Ra)br=Ot.images[Ra]=Un(),Xr(br,Ot),br.width>>=Ra,br.height>>=Ra,rn(br,On[Ra]),Ot.mipmask|=1<<Ra;else br=Ot.images[0]=Un(),Xr(br,Ot),rn(br,_r),Ot.mipmask=1;Xr(Ot,Ot.images[0]),Ot.compressed&&(Ot.internalformat===Il||Ot.internalformat===ml||Ot.internalformat===Xc||Ot.internalformat===vl)&&K(Ot.width%4===0&&Ot.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Wo(Ot,_r){for(var br=Ot.images,On=0;On<br.length;++On){if(!br[On])return;zr(br[On],_r,On)}}var Mo=[];function ti(){var Ot=Mo.pop()||new Pa;Gr.call(Ot),Ot.mipmask=0;for(var _r=0;_r<16;++_r)Ot.images[_r]=null;return Ot}function jo(Ot){for(var _r=Ot.images,br=0;br<_r.length;++br)_r[br]&&Fa(_r[br]),_r[br]=null;Mo.push(Ot)}function Bi(){this.minFilter=kl,this.magFilter=kl,this.wrapS=Ac,this.wrapT=Ac,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ui}function Ss(Ot,_r){if("min"in _r){var br=_r.min;K.parameter(br,an),Ot.minFilter=an[br],Ia.indexOf(Ot.minFilter)>=0&&!("faces"in _r)&&(Ot.genMipmaps=!0)}if("mag"in _r){var On=_r.mag;K.parameter(On,sn),Ot.magFilter=sn[On]}var Ra=Ot.wrapS,vt=Ot.wrapT;if("wrap"in _r){var Qe=_r.wrap;typeof Qe=="string"?(K.parameter(Qe,qr),Ra=vt=qr[Qe]):Array.isArray(Qe)&&(K.parameter(Qe[0],qr),K.parameter(Qe[1],qr),Ra=qr[Qe[0]],vt=qr[Qe[1]])}else{if("wrapS"in _r){var Ht=_r.wrapS;K.parameter(Ht,qr),Ra=qr[Ht]}if("wrapT"in _r){var lr=_r.wrapT;K.parameter(lr,qr),vt=qr[lr]}}if(Ot.wrapS=Ra,Ot.wrapT=vt,"anisotropic"in _r){var fr=_r.anisotropic;K(typeof fr=="number"&&fr>=1&&fr<=Nt.maxAnisotropic,"aniso samples must be between 1 and "),Ot.anisotropic=_r.anisotropic}if("mipmap"in _r){var $t=!1;switch(typeof _r.mipmap){case"string":K.parameter(_r.mipmap,Yr,"invalid mipmap hint"),Ot.mipmapHint=Yr[_r.mipmap],Ot.genMipmaps=!0,$t=!0;break;case"boolean":$t=Ot.genMipmaps=_r.mipmap;break;case"object":K(Array.isArray(_r.mipmap),"invalid mipmap type"),Ot.genMipmaps=!1,$t=!0;break;default:K.raise("invalid mipmap type")}$t&&!("min"in _r)&&(Ot.minFilter=zl)}}function Ko(Ot,_r){fe.texParameteri(_r,hf,Ot.minFilter),fe.texParameteri(_r,ff,Ot.magFilter),fe.texParameteri(_r,Co,Ot.wrapS),fe.texParameteri(_r,Vf,Ot.wrapT),ke.ext_texture_filter_anisotropic&&fe.texParameteri(_r,us,Ot.anisotropic),Ot.genMipmaps&&(fe.hint(Bo,Ot.mipmapHint),fe.generateMipmap(_r))}var $o=0,Po={},su=Nt.maxTextureUnits,Jo=Array(su).map(function(){return null});function ia(Ot){Gr.call(this),this.mipmask=0,this.internalformat=vu,this.id=$o++,this.refCount=1,this.target=Ot,this.texture=fe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Bi,Er.profile&&(this.stats={size:0})}function uu(Ot){fe.activeTexture(oi),fe.bindTexture(Ot.target,Ot.texture)}function wi(){var Ot=Jo[0];Ot?fe.bindTexture(Ot.target,Ot.texture):fe.bindTexture(nu,null)}function Cn(Ot){var _r=Ot.texture;K(_r,"must not double destroy texture");var br=Ot.unit,On=Ot.target;br>=0&&(fe.activeTexture(oi+br),fe.bindTexture(On,null),Jo[br]=null),fe.deleteTexture(_r),Ot.texture=null,Ot.params=null,Ot.pixels=null,Ot.refCount=0,delete Po[Ot.id],Rr.textureCount--}m(ia.prototype,{bind:function(){var _r=this;_r.bindCount+=1;var br=_r.unit;if(br<0){for(var On=0;On<su;++On){var Ra=Jo[On];if(Ra){if(Ra.bindCount>0)continue;Ra.unit=-1}Jo[On]=_r,br=On;break}br>=su&&K.raise("insufficient number of texture units"),Er.profile&&Rr.maxTextureUnits<br+1&&(Rr.maxTextureUnits=br+1),_r.unit=br,fe.activeTexture(oi+br),fe.bindTexture(_r.target,_r.texture)}return br},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Cn(this)}});function ka(Ot,_r){var br=new ia(nu);Po[br.id]=br,Rr.textureCount++;function On(Qe,Ht){var lr=br.texInfo;Bi.call(lr);var fr=ti();return typeof Qe=="number"?typeof Ht=="number"?Na(fr,Qe|0,Ht|0):Na(fr,Qe|0,Qe|0):Qe?(K.type(Qe,"object","invalid arguments to regl.texture"),Ss(lr,Qe),Ci(fr,Qe)):Na(fr,1,1),lr.genMipmaps&&(fr.mipmask=(fr.width<<1)-1),br.mipmask=fr.mipmask,Xr(br,fr),K.texture2D(lr,fr,Nt),br.internalformat=fr.internalformat,On.width=fr.width,On.height=fr.height,uu(br),Wo(fr,nu),Ko(lr,nu),wi(),jo(fr),Er.profile&&(br.stats.size=Qi(br.internalformat,br.type,fr.width,fr.height,lr.genMipmaps,!1)),On.format=tn[br.internalformat],On.type=Ln[br.type],On.mag=kr[lr.magFilter],On.min=Yn[lr.minFilter],On.wrapS=$r[lr.wrapS],On.wrapT=$r[lr.wrapT],On}function Ra(Qe,Ht,lr,fr){K(!!Qe,"must specify image data");var $t=Ht|0,b=lr|0,p=fr|0,c=Un();return Xr(c,br),c.width=0,c.height=0,rn(c,Qe),c.width=c.width||(br.width>>p)-$t,c.height=c.height||(br.height>>p)-b,K(br.type===c.type&&br.format===c.format&&br.internalformat===c.internalformat,"incompatible format for texture.subimage"),K($t>=0&&b>=0&&$t+c.width<=br.width&&b+c.height<=br.height,"texture.subimage write out of bounds"),K(br.mipmask&1<<p,"missing mipmap data"),K(c.data||c.element||c.needsCopy,"missing image data"),uu(br),Ea(c,nu,$t,b,p),wi(),Fa(c),On}function vt(Qe,Ht){var lr=Qe|0,fr=Ht|0||lr;if(lr===br.width&&fr===br.height)return On;On.width=br.width=lr,On.height=br.height=fr,uu(br);for(var $t=0;br.mipmask>>$t;++$t){var b=lr>>$t,p=fr>>$t;if(!b||!p)break;fe.texImage2D(nu,$t,br.format,b,p,0,br.format,br.type,null)}return wi(),Er.profile&&(br.stats.size=Qi(br.internalformat,br.type,lr,fr,!1,!1)),On}return On(Ot,_r),On.subimage=Ra,On.resize=vt,On._reglType="texture2d",On._texture=br,Er.profile&&(On.stats=br.stats),On.destroy=function(){br.decRef()},On}function Qa(Ot,_r,br,On,Ra,vt){var Qe=new ia(Wc);Po[Qe.id]=Qe,Rr.cubeCount++;var Ht=new Array(6);function lr(b,p,c,d,v,L){var j,se=Qe.texInfo;for(Bi.call(se),j=0;j<6;++j)Ht[j]=ti();if(typeof b=="number"||!b){var oe=b|0||1;for(j=0;j<6;++j)Na(Ht[j],oe,oe)}else if(typeof b=="object")if(p)Ci(Ht[0],b),Ci(Ht[1],p),Ci(Ht[2],c),Ci(Ht[3],d),Ci(Ht[4],v),Ci(Ht[5],L);else if(Ss(se,b),Hn(Qe,b),"faces"in b){var le=b.faces;for(K(Array.isArray(le)&&le.length===6,"cube faces must be a length 6 array"),j=0;j<6;++j)K(typeof le[j]=="object"&&!!le[j],"invalid input for cube map face"),Xr(Ht[j],Qe),Ci(Ht[j],le[j])}else for(j=0;j<6;++j)Ci(Ht[j],b);else K.raise("invalid arguments to cube map");for(Xr(Qe,Ht[0]),Nt.npotTextureCube||K(Ru(Qe.width)&&Ru(Qe.height),"your browser does not support non power or two texture dimensions"),se.genMipmaps?Qe.mipmask=(Ht[0].width<<1)-1:Qe.mipmask=Ht[0].mipmask,K.textureCube(Qe,se,Ht,Nt),Qe.internalformat=Ht[0].internalformat,lr.width=Ht[0].width,lr.height=Ht[0].height,uu(Qe),j=0;j<6;++j)Wo(Ht[j],lc+j);for(Ko(se,Wc),wi(),Er.profile&&(Qe.stats.size=Qi(Qe.internalformat,Qe.type,lr.width,lr.height,se.genMipmaps,!0)),lr.format=tn[Qe.internalformat],lr.type=Ln[Qe.type],lr.mag=kr[se.magFilter],lr.min=Yn[se.minFilter],lr.wrapS=$r[se.wrapS],lr.wrapT=$r[se.wrapT],j=0;j<6;++j)jo(Ht[j]);return lr}function fr(b,p,c,d,v){K(!!p,"must specify image data"),K(typeof b=="number"&&b===(b|0)&&b>=0&&b<6,"invalid face");var L=c|0,j=d|0,se=v|0,oe=Un();return Xr(oe,Qe),oe.width=0,oe.height=0,rn(oe,p),oe.width=oe.width||(Qe.width>>se)-L,oe.height=oe.height||(Qe.height>>se)-j,K(Qe.type===oe.type&&Qe.format===oe.format&&Qe.internalformat===oe.internalformat,"incompatible format for texture.subimage"),K(L>=0&&j>=0&&L+oe.width<=Qe.width&&j+oe.height<=Qe.height,"texture.subimage write out of bounds"),K(Qe.mipmask&1<<se,"missing mipmap data"),K(oe.data||oe.element||oe.needsCopy,"missing image data"),uu(Qe),Ea(oe,lc+b,L,j,se),wi(),Fa(oe),lr}function $t(b){var p=b|0;if(p===Qe.width)return;lr.width=Qe.width=p,lr.height=Qe.height=p,uu(Qe);for(var c=0;c<6;++c)for(var d=0;Qe.mipmask>>d;++d)fe.texImage2D(lc+c,d,Qe.format,p>>d,p>>d,0,Qe.format,Qe.type,null);return wi(),Er.profile&&(Qe.stats.size=Qi(Qe.internalformat,Qe.type,lr.width,lr.height,!1,!0)),lr}return lr(Ot,_r,br,On,Ra,vt),lr.subimage=fr,lr.resize=$t,lr._reglType="textureCube",lr._texture=Qe,Er.profile&&(lr.stats=Qe.stats),lr.destroy=function(){Qe.decRef()},lr}function Lo(){for(var Ot=0;Ot<su;++Ot)fe.activeTexture(oi+Ot),fe.bindTexture(nu,null),Jo[Ot]=null;Re(Po).forEach(Cn),Rr.cubeCount=0,Rr.textureCount=0}Er.profile&&(Rr.getTotalTextureSize=function(){var Ot=0;return Object.keys(Po).forEach(function(_r){Ot+=Po[_r].stats.size}),Ot});function Cu(){for(var Ot=0;Ot<su;++Ot){var _r=Jo[Ot];_r&&(_r.bindCount=0,_r.unit=-1,Jo[Ot]=null)}Re(Po).forEach(function(br){br.texture=fe.createTexture(),fe.bindTexture(br.target,br.texture);for(var On=0;On<32;++On){if((br.mipmask&1<<On)===0)continue;if(br.target===nu)fe.texImage2D(nu,On,br.internalformat,br.width>>On,br.height>>On,0,br.internalformat,br.type,null);else for(var Ra=0;Ra<6;++Ra)fe.texImage2D(lc+Ra,On,br.internalformat,br.width>>On,br.height>>On,0,br.internalformat,br.type,null)}Ko(br.texInfo,br.target)})}function Al(){for(var Ot=0;Ot<su;++Ot){var _r=Jo[Ot];_r&&(_r.bindCount=0,_r.unit=-1,Jo[Ot]=null),fe.activeTexture(oi+Ot),fe.bindTexture(nu,null),fe.bindTexture(Wc,null)}}return{create2D:ka,createCube:Qa,clear:Lo,getTexture:function(_r){return null},restore:Cu,refresh:Al}}var vo=36161,es=32854,xu=32855,Nu=36194,Vo=33189,xl=36168,Vn=34041,la=35907,go=34836,$u=34842,Vs=34843,Ui=[];Ui[es]=2,Ui[xu]=2,Ui[Nu]=2,Ui[Vo]=2,Ui[xl]=1,Ui[Vn]=4,Ui[la]=4,Ui[go]=16,Ui[$u]=8,Ui[Vs]=6;function cs(fe,ke,Nt){return Ui[fe]*ke*Nt}var Jc=function(ke,Nt,vr,Ur,Rr){var Er={rgba4:es,rgb565:Nu,"rgb5 a1":xu,depth:Vo,stencil:xl,"depth stencil":Vn};Nt.ext_srgb&&(Er.srgba=la),Nt.ext_color_buffer_half_float&&(Er.rgba16f=$u,Er.rgb16f=Vs),Nt.webgl_color_buffer_float&&(Er.rgba32f=go);var Yr=[];Object.keys(Er).forEach(function(un){var Tr=Er[un];Yr[Tr]=un});var qr=0,sn={};function an(un){this.id=qr++,this.refCount=1,this.renderbuffer=un,this.format=es,this.width=0,this.height=0,Rr.profile&&(this.stats={size:0})}an.prototype.decRef=function(){--this.refCount<=0&&cn(this)};function cn(un){var Tr=un.renderbuffer;K(Tr,"must not double destroy renderbuffer"),ke.bindRenderbuffer(vo,null),ke.deleteRenderbuffer(Tr),un.renderbuffer=null,un.refCount=0,delete sn[un.id],Ur.renderbufferCount--}function An(un,Tr){var xr=new an(ke.createRenderbuffer());sn[xr.id]=xr,Ur.renderbufferCount++;function tn(kr,Yn){var $r=0,Br=0,Gr=es;if(typeof kr=="object"&&kr){var Xr=kr;if("shape"in Xr){var Hn=Xr.shape;K(Array.isArray(Hn)&&Hn.length>=2,"invalid renderbuffer shape"),$r=Hn[0]|0,Br=Hn[1]|0}else"radius"in Xr&&($r=Br=Xr.radius|0),"width"in Xr&&($r=Xr.width|0),"height"in Xr&&(Br=Xr.height|0);"format"in Xr&&(K.parameter(Xr.format,Er,"invalid renderbuffer format"),Gr=Er[Xr.format])}else typeof kr=="number"?($r=kr|0,typeof Yn=="number"?Br=Yn|0:Br=$r):kr?K.raise("invalid arguments to renderbuffer constructor"):$r=Br=1;return K($r>0&&Br>0&&$r<=vr.maxRenderbufferSize&&Br<=vr.maxRenderbufferSize,"invalid renderbuffer size"),$r===xr.width&&Br===xr.height&&Gr===xr.format?void 0:(tn.width=xr.width=$r,tn.height=xr.height=Br,xr.format=Gr,ke.bindRenderbuffer(vo,xr.renderbuffer),ke.renderbufferStorage(vo,Gr,$r,Br),K(ke.getError()===0,"invalid render buffer format"),Rr.profile&&(xr.stats.size=cs(xr.format,xr.width,xr.height)),tn.format=Yr[xr.format],tn)}function Ln(kr,Yn){var $r=kr|0,Br=Yn|0||$r;return $r===xr.width&&Br===xr.height||(K($r>0&&Br>0&&$r<=vr.maxRenderbufferSize&&Br<=vr.maxRenderbufferSize,"invalid renderbuffer size"),tn.width=xr.width=$r,tn.height=xr.height=Br,ke.bindRenderbuffer(vo,xr.renderbuffer),ke.renderbufferStorage(vo,xr.format,$r,Br),K(ke.getError()===0,"invalid render buffer format"),Rr.profile&&(xr.stats.size=cs(xr.format,xr.width,xr.height))),tn}return tn(un,Tr),tn.resize=Ln,tn._reglType="renderbuffer",tn._renderbuffer=xr,Rr.profile&&(tn.stats=xr.stats),tn.destroy=function(){xr.decRef()},tn}Rr.profile&&(Ur.getTotalRenderbufferSize=function(){var un=0;return Object.keys(sn).forEach(function(Tr){un+=sn[Tr].stats.size}),un});function pn(){Re(sn).forEach(function(un){un.renderbuffer=ke.createRenderbuffer(),ke.bindRenderbuffer(vo,un.renderbuffer),ke.renderbufferStorage(vo,un.format,un.width,un.height)}),ke.bindRenderbuffer(vo,null)}return{create:An,clear:function(){Re(sn).forEach(cn)},restore:pn}},Gs=36160,Li=36161,Ni=3553,Bl=34069,Eu=36064,Vl=36096,vc=36128,ku=33306,ts=36053,Ju=36054,ul=36055,Mf=36057,Gl=36061,Qc=36193,pf=5121,Ts=5126,ju=6407,ll=6408,mf=6402,El=[ju,ll],Hl=[];Hl[ll]=4,Hl[ju]=3;var cl=[];cl[pf]=1,cl[Ts]=4,cl[Qc]=2;var Rs=32854,Tl=32855,Wl=36194,Qu=33189,s=36168,a=34041,n=35907,l=34836,y=34842,O=34843,R=[Rs,Tl,Wl,n,y,O,l],k={};k[ts]="complete",k[Ju]="incomplete attachment",k[Mf]="incomplete dimensions",k[ul]="incomplete, missing attachment",k[Gl]="unsupported";function ie(fe,ke,Nt,vr,Ur,Rr){var Er={cur:null,next:null,dirty:!1,setFBO:null},Yr=["rgba"],qr=["rgba4","rgb565","rgb5 a1"];ke.ext_srgb&&qr.push("srgba"),ke.ext_color_buffer_half_float&&qr.push("rgba16f","rgb16f"),ke.webgl_color_buffer_float&&qr.push("rgba32f");var sn=["uint8"];ke.oes_texture_half_float&&sn.push("half float","float16"),ke.oes_texture_float&&sn.push("float","float32");function an(fn,rn,zr){this.target=fn,this.texture=rn,this.renderbuffer=zr;var Ea=0,Wa=0;rn?(Ea=rn.width,Wa=rn.height):zr&&(Ea=zr.width,Wa=zr.height),this.width=Ea,this.height=Wa}function cn(fn){fn&&(fn.texture&&fn.texture._texture.decRef(),fn.renderbuffer&&fn.renderbuffer._renderbuffer.decRef())}function An(fn,rn,zr){if(!fn)return;if(fn.texture){var Ea=fn.texture._texture,Wa=Math.max(1,Ea.width),Un=Math.max(1,Ea.height);K(Wa===rn&&Un===zr,"inconsistent width/height for supplied texture"),Ea.refCount+=1}else{var Fa=fn.renderbuffer._renderbuffer;K(Fa.width===rn&&Fa.height===zr,"inconsistent width/height for renderbuffer"),Fa.refCount+=1}}function pn(fn,rn){rn&&(rn.texture?fe.framebufferTexture2D(Gs,fn,rn.target,rn.texture._texture.texture,0):fe.framebufferRenderbuffer(Gs,fn,Li,rn.renderbuffer._renderbuffer.renderbuffer))}function un(fn){var rn=Ni,zr=null,Ea=null,Wa=fn;typeof fn=="object"&&(Wa=fn.data,"target"in fn&&(rn=fn.target|0)),K.type(Wa,"function","invalid attachment data");var Un=Wa._reglType;return Un==="texture2d"?(zr=Wa,K(rn===Ni)):Un==="textureCube"?(zr=Wa,K(rn>=Bl&&rn<Bl+6,"invalid cube map target")):Un==="renderbuffer"?(Ea=Wa,rn=Li):K.raise("invalid regl object for attachment"),new an(rn,zr,Ea)}function Tr(fn,rn,zr,Ea,Wa){if(zr){var Un=vr.create2D({width:fn,height:rn,format:Ea,type:Wa});return Un._texture.refCount=0,new an(Ni,Un,null)}else{var Fa=Ur.create({width:fn,height:rn,format:Ea});return Fa._renderbuffer.refCount=0,new an(Li,null,Fa)}}function xr(fn){return fn&&(fn.texture||fn.renderbuffer)}function tn(fn,rn,zr){fn&&(fn.texture?fn.texture.resize(rn,zr):fn.renderbuffer&&fn.renderbuffer.resize(rn,zr),fn.width=rn,fn.height=zr)}var Ln=0,kr={};function Yn(){this.id=Ln++,kr[this.id]=this,this.framebuffer=fe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function $r(fn){fn.colorAttachments.forEach(cn),cn(fn.depthAttachment),cn(fn.stencilAttachment),cn(fn.depthStencilAttachment)}function Br(fn){var rn=fn.framebuffer;K(rn,"must not double destroy framebuffer"),fe.deleteFramebuffer(rn),fn.framebuffer=null,Rr.framebufferCount--,delete kr[fn.id]}function Gr(fn){var rn;fe.bindFramebuffer(Gs,fn.framebuffer);var zr=fn.colorAttachments;for(rn=0;rn<zr.length;++rn)pn(Eu+rn,zr[rn]);for(rn=zr.length;rn<Nt.maxColorAttachments;++rn)fe.framebufferTexture2D(Gs,Eu+rn,Ni,null,0);fe.framebufferTexture2D(Gs,ku,Ni,null,0),fe.framebufferTexture2D(Gs,Vl,Ni,null,0),fe.framebufferTexture2D(Gs,vc,Ni,null,0),pn(Vl,fn.depthAttachment),pn(vc,fn.stencilAttachment),pn(ku,fn.depthStencilAttachment);var Ea=fe.checkFramebufferStatus(Gs);!fe.isContextLost()&&Ea!==ts&&K.raise("framebuffer configuration not supported, status = "+k[Ea]),fe.bindFramebuffer(Gs,Er.next?Er.next.framebuffer:null),Er.cur=Er.next,fe.getError()}function Xr(fn,rn){var zr=new Yn;Rr.framebufferCount++;function Ea(Un,Fa){var Pa;K(Er.next!==zr,"can not update framebuffer which is currently in use");var Na=0,Ci=0,Wo=!0,Mo=!0,ti=null,jo=!0,Bi="rgba",Ss="uint8",Ko=1,$o=null,Po=null,su=null,Jo=!1;if(typeof Un=="number")Na=Un|0,Ci=Fa|0||Na;else if(!Un)Na=Ci=1;else{K.type(Un,"object","invalid arguments for framebuffer");var ia=Un;if("shape"in ia){var uu=ia.shape;K(Array.isArray(uu)&&uu.length>=2,"invalid shape for framebuffer"),Na=uu[0],Ci=uu[1]}else"radius"in ia&&(Na=Ci=ia.radius),"width"in ia&&(Na=ia.width),"height"in ia&&(Ci=ia.height);("color"in ia||"colors"in ia)&&(ti=ia.color||ia.colors,Array.isArray(ti)&&K(ti.length===1||ke.webgl_draw_buffers,"multiple render targets not supported")),ti||("colorCount"in ia&&(Ko=ia.colorCount|0,K(Ko>0,"invalid color buffer count")),"colorTexture"in ia&&(jo=!!ia.colorTexture,Bi="rgba4"),"colorType"in ia&&(Ss=ia.colorType,jo?(K(ke.oes_texture_float||!(Ss==="float"||Ss==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),K(ke.oes_texture_half_float||!(Ss==="half float"||Ss==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Ss==="half float"||Ss==="float16"?(K(ke.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Bi="rgba16f"):(Ss==="float"||Ss==="float32")&&(K(ke.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Bi="rgba32f"),K.oneOf(Ss,sn,"invalid color type")),"colorFormat"in ia&&(Bi=ia.colorFormat,Yr.indexOf(Bi)>=0?jo=!0:qr.indexOf(Bi)>=0?jo=!1:jo?K.oneOf(ia.colorFormat,Yr,"invalid color format for texture"):K.oneOf(ia.colorFormat,qr,"invalid color format for renderbuffer"))),("depthTexture"in ia||"depthStencilTexture"in ia)&&(Jo=!!(ia.depthTexture||ia.depthStencilTexture),K(!Jo||ke.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ia&&(typeof ia.depth=="boolean"?Wo=ia.depth:($o=ia.depth,Mo=!1)),"stencil"in ia&&(typeof ia.stencil=="boolean"?Mo=ia.stencil:(Po=ia.stencil,Wo=!1)),"depthStencil"in ia&&(typeof ia.depthStencil=="boolean"?Wo=Mo=ia.depthStencil:(su=ia.depthStencil,Wo=!1,Mo=!1))}var wi=null,Cn=null,ka=null,Qa=null;if(Array.isArray(ti))wi=ti.map(un);else if(ti)wi=[un(ti)];else for(wi=new Array(Ko),Pa=0;Pa<Ko;++Pa)wi[Pa]=Tr(Na,Ci,jo,Bi,Ss);K(ke.webgl_draw_buffers||wi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),K(wi.length<=Nt.maxColorAttachments,"too many color attachments, not supported"),Na=Na||wi[0].width,Ci=Ci||wi[0].height,$o?Cn=un($o):Wo&&!Mo&&(Cn=Tr(Na,Ci,Jo,"depth","uint32")),Po?ka=un(Po):Mo&&!Wo&&(ka=Tr(Na,Ci,!1,"stencil","uint8")),su?Qa=un(su):!$o&&!Po&&Mo&&Wo&&(Qa=Tr(Na,Ci,Jo,"depth stencil","depth stencil")),K(!!$o+!!Po+!!su<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Lo=null;for(Pa=0;Pa<wi.length;++Pa)if(An(wi[Pa],Na,Ci),K(!wi[Pa]||wi[Pa].texture&&El.indexOf(wi[Pa].texture._texture.format)>=0||wi[Pa].renderbuffer&&R.indexOf(wi[Pa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Pa+" is invalid"),wi[Pa]&&wi[Pa].texture){var Cu=Hl[wi[Pa].texture._texture.format]*cl[wi[Pa].texture._texture.type];Lo===null?Lo=Cu:K(Lo===Cu,"all color attachments much have the same number of bits per pixel.")}return An(Cn,Na,Ci),K(!Cn||Cn.texture&&Cn.texture._texture.format===mf||Cn.renderbuffer&&Cn.renderbuffer._renderbuffer.format===Qu,"invalid depth attachment for framebuffer object"),An(ka,Na,Ci),K(!ka||ka.renderbuffer&&ka.renderbuffer._renderbuffer.format===s,"invalid stencil attachment for framebuffer object"),An(Qa,Na,Ci),K(!Qa||Qa.texture&&Qa.texture._texture.format===a||Qa.renderbuffer&&Qa.renderbuffer._renderbuffer.format===a,"invalid depth-stencil attachment for framebuffer object"),$r(zr),zr.width=Na,zr.height=Ci,zr.colorAttachments=wi,zr.depthAttachment=Cn,zr.stencilAttachment=ka,zr.depthStencilAttachment=Qa,Ea.color=wi.map(xr),Ea.depth=xr(Cn),Ea.stencil=xr(ka),Ea.depthStencil=xr(Qa),Ea.width=zr.width,Ea.height=zr.height,Gr(zr),Ea}function Wa(Un,Fa){K(Er.next!==zr,"can not resize a framebuffer which is currently in use");var Pa=Math.max(Un|0,1),Na=Math.max(Fa|0||Pa,1);if(Pa===zr.width&&Na===zr.height)return Ea;for(var Ci=zr.colorAttachments,Wo=0;Wo<Ci.length;++Wo)tn(Ci[Wo],Pa,Na);return tn(zr.depthAttachment,Pa,Na),tn(zr.stencilAttachment,Pa,Na),tn(zr.depthStencilAttachment,Pa,Na),zr.width=Ea.width=Pa,zr.height=Ea.height=Na,Gr(zr),Ea}return Ea(fn,rn),m(Ea,{resize:Wa,_reglType:"framebuffer",_framebuffer:zr,destroy:function(){Br(zr),$r(zr)},use:function(Fa){Er.setFBO({framebuffer:Ea},Fa)}})}function Hn(fn){var rn=Array(6);function zr(Wa){var Un;K(rn.indexOf(Er.next)<0,"can not update framebuffer which is currently in use");var Fa={color:null},Pa=0,Na=null,Ci="rgba",Wo="uint8",Mo=1;if(typeof Wa=="number")Pa=Wa|0;else if(!Wa)Pa=1;else{K.type(Wa,"object","invalid arguments for framebuffer");var ti=Wa;if("shape"in ti){var jo=ti.shape;K(Array.isArray(jo)&&jo.length>=2,"invalid shape for framebuffer"),K(jo[0]===jo[1],"cube framebuffer must be square"),Pa=jo[0]}else"radius"in ti&&(Pa=ti.radius|0),"width"in ti?(Pa=ti.width|0,"height"in ti&&K(ti.height===Pa,"must be square")):"height"in ti&&(Pa=ti.height|0);("color"in ti||"colors"in ti)&&(Na=ti.color||ti.colors,Array.isArray(Na)&&K(Na.length===1||ke.webgl_draw_buffers,"multiple render targets not supported")),Na||("colorCount"in ti&&(Mo=ti.colorCount|0,K(Mo>0,"invalid color buffer count")),"colorType"in ti&&(K.oneOf(ti.colorType,sn,"invalid color type"),Wo=ti.colorType),"colorFormat"in ti&&(Ci=ti.colorFormat,K.oneOf(ti.colorFormat,Yr,"invalid color format for texture"))),"depth"in ti&&(Fa.depth=ti.depth),"stencil"in ti&&(Fa.stencil=ti.stencil),"depthStencil"in ti&&(Fa.depthStencil=ti.depthStencil)}var Bi;if(Na)if(Array.isArray(Na))for(Bi=[],Un=0;Un<Na.length;++Un)Bi[Un]=Na[Un];else Bi=[Na];else{Bi=Array(Mo);var Ss={radius:Pa,format:Ci,type:Wo};for(Un=0;Un<Mo;++Un)Bi[Un]=vr.createCube(Ss)}for(Fa.color=Array(Bi.length),Un=0;Un<Bi.length;++Un){var Ko=Bi[Un];K(typeof Ko=="function"&&Ko._reglType==="textureCube","invalid cube map"),Pa=Pa||Ko.width,K(Ko.width===Pa&&Ko.height===Pa,"invalid cube map shape"),Fa.color[Un]={target:Bl,data:Bi[Un]}}for(Un=0;Un<6;++Un){for(var $o=0;$o<Bi.length;++$o)Fa.color[$o].target=Bl+Un;Un>0&&(Fa.depth=rn[0].depth,Fa.stencil=rn[0].stencil,Fa.depthStencil=rn[0].depthStencil),rn[Un]?rn[Un](Fa):rn[Un]=Xr(Fa)}return m(zr,{width:Pa,height:Pa,color:Bi})}function Ea(Wa){var Un,Fa=Wa|0;if(K(Fa>0&&Fa<=Nt.maxCubeMapSize,"invalid radius for cube fbo"),Fa===zr.width)return zr;var Pa=zr.color;for(Un=0;Un<Pa.length;++Un)Pa[Un].resize(Fa);for(Un=0;Un<6;++Un)rn[Un].resize(Fa);return zr.width=zr.height=Fa,zr}return zr(fn),m(zr,{faces:rn,resize:Ea,_reglType:"framebufferCube",destroy:function(){rn.forEach(function(Un){Un.destroy()})}})}function qn(){Er.cur=null,Er.next=null,Er.dirty=!0,Re(kr).forEach(function(fn){fn.framebuffer=fe.createFramebuffer(),Gr(fn)})}return m(Er,{getFramebuffer:function(rn){if(typeof rn=="function"&&rn._reglType==="framebuffer"){var zr=rn._framebuffer;if(zr instanceof Yn)return zr}return null},create:Xr,createCube:Hn,clear:function(){Re(kr).forEach(Br)},restore:qn})}var Ee=5126,We=34962;function $e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ee,this.offset=0,this.stride=0,this.divisor=0}function qe(fe,ke,Nt,vr,Ur){for(var Rr=Nt.maxAttributes,Er=new Array(Rr),Yr=0;Yr<Rr;++Yr)Er[Yr]=new $e;var qr=0,sn={},an={Record:$e,scope:{},state:Er,currentVAO:null,targetVAO:null,restore:An()?kr:function(){},createVAO:Yn,getVAO:un,destroyBuffer:cn,setVAO:An()?Tr:xr,clear:An()?tn:function(){}};function cn($r){for(var Br=0;Br<Er.length;++Br){var Gr=Er[Br];Gr.buffer===$r&&(fe.disableVertexAttribArray(Br),Gr.buffer=null)}}function An(){return ke.oes_vertex_array_object}function pn(){return ke.angle_instanced_arrays}function un($r){return typeof $r=="function"&&$r._vao?$r._vao:null}function Tr($r){if($r===an.currentVAO)return;var Br=An();$r?Br.bindVertexArrayOES($r.vao):Br.bindVertexArrayOES(null),an.currentVAO=$r}function xr($r){if($r===an.currentVAO)return;if($r)$r.bindAttrs();else for(var Br=pn(),Gr=0;Gr<Er.length;++Gr){var Xr=Er[Gr];Xr.buffer?(fe.enableVertexAttribArray(Gr),fe.vertexAttribPointer(Gr,Xr.size,Xr.type,Xr.normalized,Xr.stride,Xr.offfset),Br&&Xr.divisor&&Br.vertexAttribDivisorANGLE(Gr,Xr.divisor)):(fe.disableVertexAttribArray(Gr),fe.vertexAttrib4f(Gr,Xr.x,Xr.y,Xr.z,Xr.w))}an.currentVAO=$r}function tn(){Re(sn).forEach(function($r){$r.destroy()})}function Ln(){this.id=++qr,this.attributes=[];var $r=An();$r?this.vao=$r.createVertexArrayOES():this.vao=null,sn[this.id]=this,this.buffers=[]}Ln.prototype.bindAttrs=function(){for(var $r=pn(),Br=this.attributes,Gr=0;Gr<Br.length;++Gr){var Xr=Br[Gr];Xr.buffer?(fe.enableVertexAttribArray(Gr),fe.bindBuffer(We,Xr.buffer.buffer),fe.vertexAttribPointer(Gr,Xr.size,Xr.type,Xr.normalized,Xr.stride,Xr.offset),$r&&Xr.divisor&&$r.vertexAttribDivisorANGLE(Gr,Xr.divisor)):(fe.disableVertexAttribArray(Gr),fe.vertexAttrib4f(Gr,Xr.x,Xr.y,Xr.z,Xr.w))}for(var Hn=Br.length;Hn<Rr;++Hn)fe.disableVertexAttribArray(Hn)},Ln.prototype.refresh=function(){var $r=An();$r&&($r.bindVertexArrayOES(this.vao),this.bindAttrs(),an.currentVAO=this)},Ln.prototype.destroy=function(){if(this.vao){var $r=An();this===an.currentVAO&&(an.currentVAO=null,$r.bindVertexArrayOES(null)),$r.deleteVertexArrayOES(this.vao),this.vao=null}sn[this.id]&&(delete sn[this.id],vr.vaoCount-=1)};function kr(){var $r=An();$r&&Re(sn).forEach(function(Br){Br.refresh()})}function Yn($r){var Br=new Ln;vr.vaoCount+=1;function Gr(Xr){K(Array.isArray(Xr),"arguments to vertex array constructor must be an array"),K(Xr.length<Rr,"too many attributes"),K(Xr.length>0,"must specify at least one attribute");var Hn={},qn=Br.attributes;qn.length=Xr.length;for(var fn=0;fn<Xr.length;++fn){var rn=Xr[fn],zr=qn[fn]=new $e,Ea=rn.data||rn;if(Array.isArray(Ea)||T(Ea)||Ft(Ea)){var Wa;Br.buffers[fn]&&(Wa=Br.buffers[fn],T(Ea)&&Wa._buffer.byteLength>=Ea.byteLength?Wa.subdata(Ea):(Wa.destroy(),Br.buffers[fn]=null)),Br.buffers[fn]||(Wa=Br.buffers[fn]=Ur.create(rn,We,!1,!0)),zr.buffer=Ur.getBuffer(Wa),zr.size=zr.buffer.dimension|0,zr.normalized=!1,zr.type=zr.buffer.dtype,zr.offset=0,zr.stride=0,zr.divisor=0,zr.state=1,Hn[fn]=1}else Ur.getBuffer(rn)?(zr.buffer=Ur.getBuffer(rn),zr.size=zr.buffer.dimension|0,zr.normalized=!1,zr.type=zr.buffer.dtype,zr.offset=0,zr.stride=0,zr.divisor=0,zr.state=1):Ur.getBuffer(rn.buffer)?(zr.buffer=Ur.getBuffer(rn.buffer),zr.size=(+rn.size||zr.buffer.dimension)|0,zr.normalized=!!rn.normalized||!1,"type"in rn?(K.parameter(rn.type,Ao,"invalid buffer type"),zr.type=Ao[rn.type]):zr.type=zr.buffer.dtype,zr.offset=(rn.offset||0)|0,zr.stride=(rn.stride||0)|0,zr.divisor=(rn.divisor||0)|0,zr.state=1,K(zr.size>=1&&zr.size<=4,"size must be between 1 and 4"),K(zr.offset>=0,"invalid offset"),K(zr.stride>=0&&zr.stride<=255,"stride must be between 0 and 255"),K(zr.divisor>=0,"divisor must be positive"),K(!zr.divisor||!!ke.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in rn?(K(fn>0,"first attribute must not be a constant"),zr.x=+rn.x||0,zr.y=+rn.y||0,zr.z=+rn.z||0,zr.w=+rn.w||0,zr.state=2):K(!1,"invalid attribute spec for location "+fn)}for(var Un=0;Un<Br.buffers.length;++Un)!Hn[Un]&&Br.buffers[Un]&&(Br.buffers[Un].destroy(),Br.buffers[Un]=null);return Br.refresh(),Gr}return Gr.destroy=function(){for(var Xr=0;Xr<Br.buffers.length;++Xr)Br.buffers[Xr]&&Br.buffers[Xr].destroy();Br.buffers.length=0,Br.destroy()},Gr._vao=Br,Gr._reglType="vao",Gr($r)}return an}var Lt=35632,Rt=35633,Gt=35718,Dt=35721;function jt(fe,ke,Nt,vr){var Ur={},Rr={};function Er(Tr,xr,tn,Ln){this.name=Tr,this.id=xr,this.location=tn,this.info=Ln}function Yr(Tr,xr){for(var tn=0;tn<Tr.length;++tn)if(Tr[tn].id===xr.id){Tr[tn].location=xr.location;return}Tr.push(xr)}function qr(Tr,xr,tn){var Ln=Tr===Lt?Ur:Rr,kr=Ln[xr];if(!kr){var Yn=ke.str(xr);kr=fe.createShader(Tr),fe.shaderSource(kr,Yn),fe.compileShader(kr),K.shaderError(fe,kr,Yn,Tr,tn),Ln[xr]=kr}return kr}var sn={},an=[],cn=0;function An(Tr,xr){this.id=cn++,this.fragId=Tr,this.vertId=xr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,vr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pn(Tr,xr,tn){var Ln,kr,Yn=qr(Lt,Tr.fragId),$r=qr(Rt,Tr.vertId),Br=Tr.program=fe.createProgram();if(fe.attachShader(Br,Yn),fe.attachShader(Br,$r),tn)for(Ln=0;Ln<tn.length;++Ln){var Gr=tn[Ln];fe.bindAttribLocation(Br,Gr[0],Gr[1])}fe.linkProgram(Br),K.linkError(fe,Br,ke.str(Tr.fragId),ke.str(Tr.vertId),xr);var Xr=fe.getProgramParameter(Br,Gt);vr.profile&&(Tr.stats.uniformsCount=Xr);var Hn=Tr.uniforms;for(Ln=0;Ln<Xr;++Ln)if(kr=fe.getActiveUniform(Br,Ln),kr)if(kr.size>1)for(var qn=0;qn<kr.size;++qn){var fn=kr.name.replace("[0]","["+qn+"]");Yr(Hn,new Er(fn,ke.id(fn),fe.getUniformLocation(Br,fn),kr))}else Yr(Hn,new Er(kr.name,ke.id(kr.name),fe.getUniformLocation(Br,kr.name),kr));var rn=fe.getProgramParameter(Br,Dt);vr.profile&&(Tr.stats.attributesCount=rn);var zr=Tr.attributes;for(Ln=0;Ln<rn;++Ln)kr=fe.getActiveAttrib(Br,Ln),kr&&Yr(zr,new Er(kr.name,ke.id(kr.name),fe.getAttribLocation(Br,kr.name),kr))}vr.profile&&(Nt.getMaxUniformsCount=function(){var Tr=0;return an.forEach(function(xr){xr.stats.uniformsCount>Tr&&(Tr=xr.stats.uniformsCount)}),Tr},Nt.getMaxAttributesCount=function(){var Tr=0;return an.forEach(function(xr){xr.stats.attributesCount>Tr&&(Tr=xr.stats.attributesCount)}),Tr});function un(){Ur={},Rr={};for(var Tr=0;Tr<an.length;++Tr)pn(an[Tr],null,an[Tr].attributes.map(function(xr){return[xr.location,xr.name]}))}return{clear:function(){var xr=fe.deleteShader.bind(fe);Re(Ur).forEach(xr),Ur={},Re(Rr).forEach(xr),Rr={},an.forEach(function(tn){fe.deleteProgram(tn.program)}),an.length=0,sn={},Nt.shaderCount=0},program:function(xr,tn,Ln,kr){K.command(xr>=0,"missing vertex shader",Ln),K.command(tn>=0,"missing fragment shader",Ln);var Yn=sn[tn];Yn||(Yn=sn[tn]={});var $r=Yn[xr];if($r&&($r.refCount++,!kr))return $r;var Br=new An(tn,xr);return Nt.shaderCount++,pn(Br,Ln,kr),$r||(Yn[xr]=Br),an.push(Br),m(Br,{destroy:function(){if(Br.refCount--,Br.refCount<=0){fe.deleteProgram(Br.program);var Xr=an.indexOf(Br);an.splice(Xr,1),Nt.shaderCount--}Yn[Br.vertId].refCount<=0&&(fe.deleteShader(Rr[Br.vertId]),delete Rr[Br.vertId],delete sn[Br.fragId][Br.vertId]),Object.keys(sn[Br.fragId]).length||(fe.deleteShader(Ur[Br.fragId]),delete Ur[Br.fragId],delete sn[Br.fragId])}})},restore:un,shader:qr,frag:-1,vert:-1}}var ir=6408,Qt=5121,Lr=3333,gr=5126;function Ar(fe,ke,Nt,vr,Ur,Rr,Er){function Yr(an){var cn;ke.next===null?(K(Ur.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),cn=Qt):(K(ke.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),cn=ke.next.colorAttachments[0].texture._texture.type,Rr.oes_texture_float?(K(cn===Qt||cn===gr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),cn===gr&&K(Er.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):K(cn===Qt,"Reading from a framebuffer is only allowed for the type 'uint8'"));var An=0,pn=0,un=vr.framebufferWidth,Tr=vr.framebufferHeight,xr=null;T(an)?xr=an:an&&(K.type(an,"object","invalid arguments to regl.read()"),An=an.x|0,pn=an.y|0,K(An>=0&&An<vr.framebufferWidth,"invalid x offset for regl.read"),K(pn>=0&&pn<vr.framebufferHeight,"invalid y offset for regl.read"),un=(an.width||vr.framebufferWidth-An)|0,Tr=(an.height||vr.framebufferHeight-pn)|0,xr=an.data||null),xr&&(cn===Qt?K(xr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):cn===gr&&K(xr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),K(un>0&&un+An<=vr.framebufferWidth,"invalid width for read pixels"),K(Tr>0&&Tr+pn<=vr.framebufferHeight,"invalid height for read pixels"),Nt();var tn=un*Tr*4;return xr||(cn===Qt?xr=new Uint8Array(tn):cn===gr&&(xr=xr||new Float32Array(tn))),K.isTypedArray(xr,"data buffer for regl.read() must be a typedarray"),K(xr.byteLength>=tn,"data buffer for regl.read() too small"),fe.pixelStorei(Lr,4),fe.readPixels(An,pn,un,Tr,ir,cn,xr),xr}function qr(an){var cn;return ke.setFBO({framebuffer:an.framebuffer},function(){cn=Yr(an)}),cn}function sn(an){return!an||!("framebuffer"in an)?Yr(an):qr(an)}return sn}function Or(fe){return Array.prototype.slice.call(fe)}function Kr(fe){return Or(fe).join("")}function Qr(){var fe=0,ke=[],Nt=[];function vr(cn){for(var An=0;An<Nt.length;++An)if(Nt[An]===cn)return ke[An];var pn="g"+fe++;return ke.push(pn),Nt.push(cn),pn}function Ur(){var cn=[];function An(){cn.push.apply(cn,Or(arguments))}var pn=[];function un(){var Tr="v"+fe++;return pn.push(Tr),arguments.length>0&&(cn.push(Tr,"="),cn.push.apply(cn,Or(arguments)),cn.push(";")),Tr}return m(An,{def:un,toString:function(){return Kr([pn.length>0?"var "+pn.join(",")+";":"",Kr(cn)])}})}function Rr(){var cn=Ur(),An=Ur(),pn=cn.toString,un=An.toString;function Tr(xr,tn){An(xr,tn,"=",cn.def(xr,tn),";")}return m(function(){cn.apply(cn,Or(arguments))},{def:cn.def,entry:cn,exit:An,save:Tr,set:function(tn,Ln,kr){Tr(tn,Ln),cn(tn,Ln,"=",kr,";")},toString:function(){return pn()+un()}})}function Er(){var cn=Kr(arguments),An=Rr(),pn=Rr(),un=An.toString,Tr=pn.toString;return m(An,{then:function(){return An.apply(An,Or(arguments)),this},else:function(){return pn.apply(pn,Or(arguments)),this},toString:function(){var tn=Tr();return tn&&(tn="else{"+tn+"}"),Kr(["if(",cn,"){",un(),"}",tn])}})}var Yr=Ur(),qr={};function sn(cn,An){var pn=[];function un(){var kr="a"+pn.length;return pn.push(kr),kr}An=An||0;for(var Tr=0;Tr<An;++Tr)un();var xr=Rr(),tn=xr.toString,Ln=qr[cn]=m(xr,{arg:un,toString:function(){return Kr(["function(",pn.join(),"){",tn(),"}"])}});return Ln}function an(){var cn=['"use strict";',Yr,"return {"];Object.keys(qr).forEach(function(un){cn.push('"',un,'":',qr[un].toString(),",")}),cn.push("}");var An=Kr(cn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pn=Function.apply(null,ke.concat(An));return pn.apply(null,Nt)}return{global:Yr,link:vr,block:Ur,proc:sn,scope:Rr,cond:Er,compile:an}}var dn="xyzw".split(""),wn=5121,ra=1,ya=2,Ta=0,Ja=1,Mn=2,ba=3,ca=4,Fn=5,Ma=6,Qn="dither",Da="blend.enable",ai="blend.color",uo="blend.equation",ro="blend.func",Wi="depth.enable",xi="depth.func",no="depth.range",Go="depth.mask",Tu="colorMask",_l="cull.enable",Hs="cull.face",fs="frontFace",Ws="lineWidth",Zl="polygonOffset.enable",_u="polygonOffset.offset",Is="sample.alpha",Xl="sample.enable",Su="sample.coverage",Yl="stencil.enable",Au="stencil.mask",wo="stencil.func",zu="stencil.opFront",Kl="stencil.opBack",qc="scissor.enable",Oo="scissor.box",Ds="viewport",rs="profile",Zi="framebuffer",Zs="vert",ao="frag",Ns="elements",Xs="primitive",qu="count",gc="offset",$l="instances",Jl="vao",Ys="Width",Ho="Height",ef=Zi+Ys,Ql=Zi+Ho,ql=Ds+Ys,_s=Ds+Ho,ec="drawingBuffer",vf=ec+Ys,Pf=ec+Ho,oh=[ro,uo,wo,zu,Kl,Su,Ds,Oo,_u],el=34962,gf=34963,tc=35632,tf=35633,rf=3553,Lf=34067,$f=2884,Pc=3042,Lc=3024,Rc=2960,Jf=2929,Rf=3089,Qf=32823,Ic=32926,sh=32928,yo=5126,rc=35664,yf=35665,nc=35666,nf=5124,Dc=35667,Fu=35668,Nc=35669,kc=35670,bf=35671,xf=35672,Gf=35673,yc=35674,Sl=35675,ee=35676,ae=35678,N=35680,V=4,Te=1028,it=1029,Zt=2304,ar=2305,nr=32775,Dr=32776,on=519,Gn=7680,na=0,aa=1,si=32774,Ya=513,Ri=36160,Ha=36064,qi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},hs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Xi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ks={frag:tc,vert:tf},Yi={cw:Zt,ccw:ar};function bo(fe){return Array.isArray(fe)||T(fe)||Ft(fe)}function ds(fe){return fe.sort(function(ke,Nt){return ke===Ds?-1:Nt===Ds?1:ke<Nt?-1:1})}function Ai(fe,ke,Nt,vr){this.thisDep=fe,this.contextDep=ke,this.propDep=Nt,this.append=vr}function xo(fe){return fe&&!(fe.thisDep||fe.contextDep||fe.propDep)}function Aa(fe){return new Ai(!1,!1,!1,fe)}function ko(fe,ke){var Nt=fe.type;if(Nt===Ta){var vr=fe.data.length;return new Ai(!0,vr>=1,vr>=2,ke)}else if(Nt===ca){var Ur=fe.data;return new Ai(Ur.thisDep,Ur.contextDep,Ur.propDep,ke)}else{if(Nt===Fn)return new Ai(!1,!1,!1,ke);if(Nt===Ma){for(var Rr=!1,Er=!1,Yr=!1,qr=0;qr<fe.data.length;++qr){var sn=fe.data[qr];if(sn.type===Ja)Yr=!0;else if(sn.type===Mn)Er=!0;else if(sn.type===ba)Rr=!0;else if(sn.type===Ta){Rr=!0;var an=sn.data;an>=1&&(Er=!0),an>=2&&(Yr=!0)}else sn.type===ca&&(Rr=Rr||sn.data.thisDep,Er=Er||sn.data.contextDep,Yr=Yr||sn.data.propDep)}return new Ai(Rr,Er,Yr,ke)}else return new Ai(Nt===ba,Nt===Mn,Nt===Ja,ke)}}var bc=new Ai(!1,!1,!1,function(){});function Hf(fe,ke,Nt,vr,Ur,Rr,Er,Yr,qr,sn,an,cn,An,pn,un){var Tr=sn.Record,xr={add:32774,subtract:32778,"reverse subtract":32779};Nt.ext_blend_minmax&&(xr.min=nr,xr.max=Dr);var tn=Nt.angle_instanced_arrays,Ln=Nt.webgl_draw_buffers,kr={dirty:!0,profile:un.profile},Yn={},$r=[],Br={},Gr={};function Xr(vt){return vt.replace(".","_")}function Hn(vt,Qe,Ht){var lr=Xr(vt);$r.push(vt),Yn[lr]=kr[lr]=!!Ht,Br[lr]=Qe}function qn(vt,Qe,Ht){var lr=Xr(vt);$r.push(vt),Array.isArray(Ht)?(kr[lr]=Ht.slice(),Yn[lr]=Ht.slice()):kr[lr]=Yn[lr]=Ht,Gr[lr]=Qe}Hn(Qn,Lc),Hn(Da,Pc),qn(ai,"blendColor",[0,0,0,0]),qn(uo,"blendEquationSeparate",[si,si]),qn(ro,"blendFuncSeparate",[aa,na,aa,na]),Hn(Wi,Jf,!0),qn(xi,"depthFunc",Ya),qn(no,"depthRange",[0,1]),qn(Go,"depthMask",!0),qn(Tu,Tu,[!0,!0,!0,!0]),Hn(_l,$f),qn(Hs,"cullFace",it),qn(fs,fs,ar),qn(Ws,Ws,1),Hn(Zl,Qf),qn(_u,"polygonOffset",[0,0]),Hn(Is,Ic),Hn(Xl,sh),qn(Su,"sampleCoverage",[1,!1]),Hn(Yl,Rc),qn(Au,"stencilMask",-1),qn(wo,"stencilFunc",[on,0,-1]),qn(zu,"stencilOpSeparate",[Te,Gn,Gn,Gn]),qn(Kl,"stencilOpSeparate",[it,Gn,Gn,Gn]),Hn(qc,Rf),qn(Oo,"scissor",[0,0,fe.drawingBufferWidth,fe.drawingBufferHeight]),qn(Ds,Ds,[0,0,fe.drawingBufferWidth,fe.drawingBufferHeight]);var fn={gl:fe,context:An,strings:ke,next:Yn,current:kr,draw:cn,elements:Rr,buffer:Ur,shader:an,attributes:sn.state,vao:sn,uniforms:qr,framebuffer:Yr,extensions:Nt,timer:pn,isBufferArgs:bo},rn={primTypes:os,compareFuncs:Xi,blendFuncs:qi,blendEquations:xr,stencilOps:pi,glTypes:Ao,orientationType:Yi};K.optional(function(){fn.isArrayLike=Pi}),Ln&&(rn.backBuffer=[it],rn.drawBuffer=H(vr.maxDrawbuffers,function(vt){return vt===0?[0]:H(vt,function(Qe){return Ha+Qe})}));var zr=0;function Ea(){var vt=Qr(),Qe=vt.link,Ht=vt.global;vt.id=zr++,vt.batchId="0";var lr=Qe(fn),fr=vt.shared={props:"a0"};Object.keys(fn).forEach(function(d){fr[d]=Ht.def(lr,".",d)}),K.optional(function(){vt.CHECK=Qe(K),vt.commandStr=K.guessCommand(),vt.command=Qe(vt.commandStr),vt.assert=function(d,v,L){d("if(!(",v,"))",this.CHECK,".commandRaise(",Qe(L),",",this.command,");")},rn.invalidBlendCombinations=hs});var $t=vt.next={},b=vt.current={};Object.keys(Gr).forEach(function(d){Array.isArray(kr[d])&&($t[d]=Ht.def(fr.next,".",d),b[d]=Ht.def(fr.current,".",d))});var p=vt.constants={};Object.keys(rn).forEach(function(d){p[d]=Ht.def(JSON.stringify(rn[d]))}),vt.invoke=function(d,v){switch(v.type){case Ta:var L=["this",fr.context,fr.props,vt.batchId];return d.def(Qe(v.data),".call(",L.slice(0,Math.max(v.data.length+1,4)),")");case Ja:return d.def(fr.props,v.data);case Mn:return d.def(fr.context,v.data);case ba:return d.def("this",v.data);case ca:return v.data.append(vt,d),v.data.ref;case Fn:return v.data.toString();case Ma:return v.data.map(function(j){return vt.invoke(d,j)})}},vt.attribCache={};var c={};return vt.scopeAttrib=function(d){var v=ke.id(d);if(v in c)return c[v];var L=sn.scope[v];L||(L=sn.scope[v]=new Tr);var j=c[v]=Qe(L);return j},vt}function Wa(vt){var Qe=vt.static,Ht=vt.dynamic,lr;if(rs in Qe){var fr=!!Qe[rs];lr=Aa(function(b,p){return fr}),lr.enable=fr}else if(rs in Ht){var $t=Ht[rs];lr=ko($t,function(b,p){return b.invoke(p,$t)})}return lr}function Un(vt,Qe){var Ht=vt.static,lr=vt.dynamic;if(Zi in Ht){var fr=Ht[Zi];return fr?(fr=Yr.getFramebuffer(fr),K.command(fr,"invalid framebuffer object"),Aa(function(b,p){var c=b.link(fr),d=b.shared;p.set(d.framebuffer,".next",c);var v=d.context;return p.set(v,"."+ef,c+".width"),p.set(v,"."+Ql,c+".height"),c})):Aa(function(b,p){var c=b.shared;p.set(c.framebuffer,".next","null");var d=c.context;return p.set(d,"."+ef,d+"."+vf),p.set(d,"."+Ql,d+"."+Pf),"null"})}else if(Zi in lr){var $t=lr[Zi];return ko($t,function(b,p){var c=b.invoke(p,$t),d=b.shared,v=d.framebuffer,L=p.def(v,".getFramebuffer(",c,")");K.optional(function(){b.assert(p,"!"+c+"||"+L,"invalid framebuffer object")}),p.set(v,".next",L);var j=d.context;return p.set(j,"."+ef,L+"?"+L+".width:"+j+"."+vf),p.set(j,"."+Ql,L+"?"+L+".height:"+j+"."+Pf),L})}else return null}function Fa(vt,Qe,Ht){var lr=vt.static,fr=vt.dynamic;function $t(c){if(c in lr){var d=lr[c];K.commandType(d,"object","invalid "+c,Ht.commandStr);var v=!0,L=d.x|0,j=d.y|0,se,oe;return"width"in d?(se=d.width|0,K.command(se>=0,"invalid "+c,Ht.commandStr)):v=!1,"height"in d?(oe=d.height|0,K.command(oe>=0,"invalid "+c,Ht.commandStr)):v=!1,new Ai(!v&&Qe&&Qe.thisDep,!v&&Qe&&Qe.contextDep,!v&&Qe&&Qe.propDep,function(Xt,Kt){var tr=Xt.shared.context,Cr=se;"width"in d||(Cr=Kt.def(tr,".",ef,"-",L));var Fr=oe;return"height"in d||(Fr=Kt.def(tr,".",Ql,"-",j)),[L,j,Cr,Fr]})}else if(c in fr){var le=fr[c],Tt=ko(le,function(Xt,Kt){var tr=Xt.invoke(Kt,le);K.optional(function(){Xt.assert(Kt,tr+"&&typeof "+tr+'==="object"',"invalid "+c)});var Cr=Xt.shared.context,Fr=Kt.def(tr,".x|0"),ln=Kt.def(tr,".y|0"),hn=Kt.def('"width" in ',tr,"?",tr,".width|0:","(",Cr,".",ef,"-",Fr,")"),$n=Kt.def('"height" in ',tr,"?",tr,".height|0:","(",Cr,".",Ql,"-",ln,")");return K.optional(function(){Xt.assert(Kt,hn+">=0&&"+$n+">=0","invalid "+c)}),[Fr,ln,hn,$n]});return Qe&&(Tt.thisDep=Tt.thisDep||Qe.thisDep,Tt.contextDep=Tt.contextDep||Qe.contextDep,Tt.propDep=Tt.propDep||Qe.propDep),Tt}else return Qe?new Ai(Qe.thisDep,Qe.contextDep,Qe.propDep,function(Xt,Kt){var tr=Xt.shared.context;return[0,0,Kt.def(tr,".",ef),Kt.def(tr,".",Ql)]}):null}var b=$t(Ds);if(b){var p=b;b=new Ai(b.thisDep,b.contextDep,b.propDep,function(c,d){var v=p.append(c,d),L=c.shared.context;return d.set(L,"."+ql,v[2]),d.set(L,"."+_s,v[3]),v})}return{viewport:b,scissor_box:$t(Oo)}}function Pa(vt,Qe){var Ht=vt.static,lr=typeof Ht[ao]=="string"&&typeof Ht[Zs]=="string";if(lr){if(Object.keys(Qe.dynamic).length>0)return null;var fr=Qe.static,$t=Object.keys(fr);if($t.length>0&&typeof fr[$t[0]]=="number"){for(var b=[],p=0;p<$t.length;++p)K(typeof fr[$t[p]]=="number","must specify all vertex attribute locations when using vaos"),b.push([fr[$t[p]]|0,$t[p]]);return b}}return null}function Na(vt,Qe,Ht){var lr=vt.static,fr=vt.dynamic;function $t(v){if(v in lr){var L=ke.id(lr[v]);K.optional(function(){an.shader(ks[v],L,K.guessCommand())});var j=Aa(function(){return L});return j.id=L,j}else if(v in fr){var se=fr[v];return ko(se,function(oe,le){var Tt=oe.invoke(le,se),Xt=le.def(oe.shared.strings,".id(",Tt,")");return K.optional(function(){le(oe.shared.shader,".shader(",ks[v],",",Xt,",",oe.command,");")}),Xt})}return null}var b=$t(ao),p=$t(Zs),c=null,d;return xo(b)&&xo(p)?(c=an.program(p.id,b.id,null,Ht),d=Aa(function(v,L){return v.link(c)})):d=new Ai(b&&b.thisDep||p&&p.thisDep,b&&b.contextDep||p&&p.contextDep,b&&b.propDep||p&&p.propDep,function(v,L){var j=v.shared.shader,se;b?se=b.append(v,L):se=L.def(j,".",ao);var oe;p?oe=p.append(v,L):oe=L.def(j,".",Zs);var le=j+".program("+oe+","+se;return K.optional(function(){le+=","+v.command}),L.def(le+")")}),{frag:b,vert:p,progVar:d,program:c}}function Ci(vt,Qe){var Ht=vt.static,lr=vt.dynamic;function fr(){if(Ns in Ht){var v=Ht[Ns];bo(v)?v=Rr.getElements(Rr.create(v,!0)):v&&(v=Rr.getElements(v),K.command(v,"invalid elements",Qe.commandStr));var L=Aa(function(se,oe){if(v){var le=se.link(v);return se.ELEMENTS=le,le}return se.ELEMENTS=null,null});return L.value=v,L}else if(Ns in lr){var j=lr[Ns];return ko(j,function(se,oe){var le=se.shared,Tt=le.isBufferArgs,Xt=le.elements,Kt=se.invoke(oe,j),tr=oe.def("null"),Cr=oe.def(Tt,"(",Kt,")"),Fr=se.cond(Cr).then(tr,"=",Xt,".createStream(",Kt,");").else(tr,"=",Xt,".getElements(",Kt,");");return K.optional(function(){se.assert(Fr.else,"!"+Kt+"||"+tr,"invalid elements")}),oe.entry(Fr),oe.exit(se.cond(Cr).then(Xt,".destroyStream(",tr,");")),se.ELEMENTS=tr,tr})}return null}var $t=fr();function b(){if(Xs in Ht){var v=Ht[Xs];return K.commandParameter(v,os,"invalid primitve",Qe.commandStr),Aa(function(j,se){return os[v]})}else if(Xs in lr){var L=lr[Xs];return ko(L,function(j,se){var oe=j.constants.primTypes,le=j.invoke(se,L);return K.optional(function(){j.assert(se,le+" in "+oe,"invalid primitive, must be one of "+Object.keys(os))}),se.def(oe,"[",le,"]")})}else if($t)return xo($t)?$t.value?Aa(function(j,se){return se.def(j.ELEMENTS,".primType")}):Aa(function(){return V}):new Ai($t.thisDep,$t.contextDep,$t.propDep,function(j,se){var oe=j.ELEMENTS;return se.def(oe,"?",oe,".primType:",V)});return null}function p(v,L){if(v in Ht){var j=Ht[v]|0;return K.command(!L||j>=0,"invalid "+v,Qe.commandStr),Aa(function(oe,le){return L&&(oe.OFFSET=j),j})}else if(v in lr){var se=lr[v];return ko(se,function(oe,le){var Tt=oe.invoke(le,se);return L&&(oe.OFFSET=Tt,K.optional(function(){oe.assert(le,Tt+">=0","invalid "+v)})),Tt})}else if(L&&$t)return Aa(function(oe,le){return oe.OFFSET="0",0});return null}var c=p(gc,!0);function d(){if(qu in Ht){var v=Ht[qu]|0;return K.command(typeof v=="number"&&v>=0,"invalid vertex count",Qe.commandStr),Aa(function(){return v})}else if(qu in lr){var L=lr[qu];return ko(L,function(oe,le){var Tt=oe.invoke(le,L);return K.optional(function(){oe.assert(le,"typeof "+Tt+'==="number"&&'+Tt+">=0&&"+Tt+"===("+Tt+"|0)","invalid vertex count")}),Tt})}else if($t)if(xo($t)){if($t)return c?new Ai(c.thisDep,c.contextDep,c.propDep,function(oe,le){var Tt=le.def(oe.ELEMENTS,".vertCount-",oe.OFFSET);return K.optional(function(){oe.assert(le,Tt+">=0","invalid vertex offset/element buffer too small")}),Tt}):Aa(function(oe,le){return le.def(oe.ELEMENTS,".vertCount")});var j=Aa(function(){return-1});return K.optional(function(){j.MISSING=!0}),j}else{var se=new Ai($t.thisDep||c.thisDep,$t.contextDep||c.contextDep,$t.propDep||c.propDep,function(oe,le){var Tt=oe.ELEMENTS;return oe.OFFSET?le.def(Tt,"?",Tt,".vertCount-",oe.OFFSET,":-1"):le.def(Tt,"?",Tt,".vertCount:-1")});return K.optional(function(){se.DYNAMIC=!0}),se}return null}return{elements:$t,primitive:b(),count:d(),instances:p($l,!1),offset:c}}function Wo(vt,Qe){var Ht=vt.static,lr=vt.dynamic,fr={};return $r.forEach(function($t){var b=Xr($t);function p(c,d){if($t in Ht){var v=c(Ht[$t]);fr[b]=Aa(function(){return v})}else if($t in lr){var L=lr[$t];fr[b]=ko(L,function(j,se){return d(j,se,j.invoke(se,L))})}}switch($t){case _l:case Da:case Qn:case Yl:case Wi:case qc:case Zl:case Is:case Xl:case Go:return p(function(c){return K.commandType(c,"boolean",$t,Qe.commandStr),c},function(c,d,v){return K.optional(function(){c.assert(d,"typeof "+v+'==="boolean"',"invalid flag "+$t,c.commandStr)}),v});case xi:return p(function(c){return K.commandParameter(c,Xi,"invalid "+$t,Qe.commandStr),Xi[c]},function(c,d,v){var L=c.constants.compareFuncs;return K.optional(function(){c.assert(d,v+" in "+L,"invalid "+$t+", must be one of "+Object.keys(Xi))}),d.def(L,"[",v,"]")});case no:return p(function(c){return K.command(Pi(c)&&c.length===2&&typeof c[0]=="number"&&typeof c[1]=="number"&&c[0]<=c[1],"depth range is 2d array",Qe.commandStr),c},function(c,d,v){K.optional(function(){c.assert(d,c.shared.isArrayLike+"("+v+")&&"+v+".length===2&&typeof "+v+'[0]==="number"&&typeof '+v+'[1]==="number"&&'+v+"[0]<="+v+"[1]","depth range must be a 2d array")});var L=d.def("+",v,"[0]"),j=d.def("+",v,"[1]");return[L,j]});case ro:return p(function(c){K.commandType(c,"object","blend.func",Qe.commandStr);var d="srcRGB"in c?c.srcRGB:c.src,v="srcAlpha"in c?c.srcAlpha:c.src,L="dstRGB"in c?c.dstRGB:c.dst,j="dstAlpha"in c?c.dstAlpha:c.dst;return K.commandParameter(d,qi,b+".srcRGB",Qe.commandStr),K.commandParameter(v,qi,b+".srcAlpha",Qe.commandStr),K.commandParameter(L,qi,b+".dstRGB",Qe.commandStr),K.commandParameter(j,qi,b+".dstAlpha",Qe.commandStr),K.command(hs.indexOf(d+", "+L)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+d+", "+L+")",Qe.commandStr),[qi[d],qi[L],qi[v],qi[j]]},function(c,d,v){var L=c.constants.blendFuncs;K.optional(function(){c.assert(d,v+"&&typeof "+v+'==="object"',"invalid blend func, must be an object")});function j(tr,Cr){var Fr=d.def('"',tr,Cr,'" in ',v,"?",v,".",tr,Cr,":",v,".",tr);return K.optional(function(){c.assert(d,Fr+" in "+L,"invalid "+$t+"."+tr+Cr+", must be one of "+Object.keys(qi))}),Fr}var se=j("src","RGB"),oe=j("dst","RGB");K.optional(function(){var tr=c.constants.invalidBlendCombinations;c.assert(d,tr+".indexOf("+se+'+", "+'+oe+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var le=d.def(L,"[",se,"]"),Tt=d.def(L,"[",j("src","Alpha"),"]"),Xt=d.def(L,"[",oe,"]"),Kt=d.def(L,"[",j("dst","Alpha"),"]");return[le,Xt,Tt,Kt]});case uo:return p(function(c){if(typeof c=="string")return K.commandParameter(c,xr,"invalid "+$t,Qe.commandStr),[xr[c],xr[c]];if(typeof c=="object")return K.commandParameter(c.rgb,xr,$t+".rgb",Qe.commandStr),K.commandParameter(c.alpha,xr,$t+".alpha",Qe.commandStr),[xr[c.rgb],xr[c.alpha]];K.commandRaise("invalid blend.equation",Qe.commandStr)},function(c,d,v){var L=c.constants.blendEquations,j=d.def(),se=d.def(),oe=c.cond("typeof ",v,'==="string"');return K.optional(function(){function le(Tt,Xt,Kt){c.assert(Tt,Kt+" in "+L,"invalid "+Xt+", must be one of "+Object.keys(xr))}le(oe.then,$t,v),c.assert(oe.else,v+"&&typeof "+v+'==="object"',"invalid "+$t),le(oe.else,$t+".rgb",v+".rgb"),le(oe.else,$t+".alpha",v+".alpha")}),oe.then(j,"=",se,"=",L,"[",v,"];"),oe.else(j,"=",L,"[",v,".rgb];",se,"=",L,"[",v,".alpha];"),d(oe),[j,se]});case ai:return p(function(c){return K.command(Pi(c)&&c.length===4,"blend.color must be a 4d array",Qe.commandStr),H(4,function(d){return+c[d]})},function(c,d,v){return K.optional(function(){c.assert(d,c.shared.isArrayLike+"("+v+")&&"+v+".length===4","blend.color must be a 4d array")}),H(4,function(L){return d.def("+",v,"[",L,"]")})});case Au:return p(function(c){return K.commandType(c,"number",b,Qe.commandStr),c|0},function(c,d,v){return K.optional(function(){c.assert(d,"typeof "+v+'==="number"',"invalid stencil.mask")}),d.def(v,"|0")});case wo:return p(function(c){K.commandType(c,"object",b,Qe.commandStr);var d=c.cmp||"keep",v=c.ref||0,L="mask"in c?c.mask:-1;return K.commandParameter(d,Xi,$t+".cmp",Qe.commandStr),K.commandType(v,"number",$t+".ref",Qe.commandStr),K.commandType(L,"number",$t+".mask",Qe.commandStr),[Xi[d],v,L]},function(c,d,v){var L=c.constants.compareFuncs;K.optional(function(){function le(){c.assert(d,Array.prototype.join.call(arguments,""),"invalid stencil.func")}le(v+"&&typeof ",v,'==="object"'),le('!("cmp" in ',v,")||(",v,".cmp in ",L,")")});var j=d.def('"cmp" in ',v,"?",L,"[",v,".cmp]",":",Gn),se=d.def(v,".ref|0"),oe=d.def('"mask" in ',v,"?",v,".mask|0:-1");return[j,se,oe]});case zu:case Kl:return p(function(c){K.commandType(c,"object",b,Qe.commandStr);var d=c.fail||"keep",v=c.zfail||"keep",L=c.zpass||"keep";return K.commandParameter(d,pi,$t+".fail",Qe.commandStr),K.commandParameter(v,pi,$t+".zfail",Qe.commandStr),K.commandParameter(L,pi,$t+".zpass",Qe.commandStr),[$t===Kl?it:Te,pi[d],pi[v],pi[L]]},function(c,d,v){var L=c.constants.stencilOps;K.optional(function(){c.assert(d,v+"&&typeof "+v+'==="object"',"invalid "+$t)});function j(se){return K.optional(function(){c.assert(d,'!("'+se+'" in '+v+")||("+v+"."+se+" in "+L+")","invalid "+$t+"."+se+", must be one of "+Object.keys(pi))}),d.def('"',se,'" in ',v,"?",L,"[",v,".",se,"]:",Gn)}return[$t===Kl?it:Te,j("fail"),j("zfail"),j("zpass")]});case _u:return p(function(c){K.commandType(c,"object",b,Qe.commandStr);var d=c.factor|0,v=c.units|0;return K.commandType(d,"number",b+".factor",Qe.commandStr),K.commandType(v,"number",b+".units",Qe.commandStr),[d,v]},function(c,d,v){K.optional(function(){c.assert(d,v+"&&typeof "+v+'==="object"',"invalid "+$t)});var L=d.def(v,".factor|0"),j=d.def(v,".units|0");return[L,j]});case Hs:return p(function(c){var d=0;return c==="front"?d=Te:c==="back"&&(d=it),K.command(!!d,b,Qe.commandStr),d},function(c,d,v){return K.optional(function(){c.assert(d,v+'==="front"||'+v+'==="back"',"invalid cull.face")}),d.def(v,'==="front"?',Te,":",it)});case Ws:return p(function(c){return K.command(typeof c=="number"&&c>=vr.lineWidthDims[0]&&c<=vr.lineWidthDims[1],"invalid line width, must be a positive number between "+vr.lineWidthDims[0]+" and "+vr.lineWidthDims[1],Qe.commandStr),c},function(c,d,v){return K.optional(function(){c.assert(d,"typeof "+v+'==="number"&&'+v+">="+vr.lineWidthDims[0]+"&&"+v+"<="+vr.lineWidthDims[1],"invalid line width")}),v});case fs:return p(function(c){return K.commandParameter(c,Yi,b,Qe.commandStr),Yi[c]},function(c,d,v){return K.optional(function(){c.assert(d,v+'==="cw"||'+v+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),d.def(v+'==="cw"?'+Zt+":"+ar)});case Tu:return p(function(c){return K.command(Pi(c)&&c.length===4,"color.mask must be length 4 array",Qe.commandStr),c.map(function(d){return!!d})},function(c,d,v){return K.optional(function(){c.assert(d,c.shared.isArrayLike+"("+v+")&&"+v+".length===4","invalid color.mask")}),H(4,function(L){return"!!"+v+"["+L+"]"})});case Su:return p(function(c){K.command(typeof c=="object"&&c,b,Qe.commandStr);var d="value"in c?c.value:1,v=!!c.invert;return K.command(typeof d=="number"&&d>=0&&d<=1,"sample.coverage.value must be a number between 0 and 1",Qe.commandStr),[d,v]},function(c,d,v){K.optional(function(){c.assert(d,v+"&&typeof "+v+'==="object"',"invalid sample.coverage")});var L=d.def('"value" in ',v,"?+",v,".value:1"),j=d.def("!!",v,".invert");return[L,j]})}}),fr}function Mo(vt,Qe){var Ht=vt.static,lr=vt.dynamic,fr={};return Object.keys(Ht).forEach(function($t){var b=Ht[$t],p;if(typeof b=="number"||typeof b=="boolean")p=Aa(function(){return b});else if(typeof b=="function"){var c=b._reglType;c==="texture2d"||c==="textureCube"?p=Aa(function(d){return d.link(b)}):c==="framebuffer"||c==="framebufferCube"?(K.command(b.color.length>0,'missing color attachment for framebuffer sent to uniform "'+$t+'"',Qe.commandStr),p=Aa(function(d){return d.link(b.color[0])})):K.commandRaise('invalid data for uniform "'+$t+'"',Qe.commandStr)}else Pi(b)?p=Aa(function(d){var v=d.global.def("[",H(b.length,function(L){return K.command(typeof b[L]=="number"||typeof b[L]=="boolean","invalid uniform "+$t,d.commandStr),b[L]}),"]");return v}):K.commandRaise('invalid or missing data for uniform "'+$t+'"',Qe.commandStr);p.value=b,fr[$t]=p}),Object.keys(lr).forEach(function($t){var b=lr[$t];fr[$t]=ko(b,function(p,c){return p.invoke(c,b)})}),fr}function ti(vt,Qe){var Ht=vt.static,lr=vt.dynamic,fr={};return Object.keys(Ht).forEach(function($t){var b=Ht[$t],p=ke.id($t),c=new Tr;if(bo(b))c.state=ra,c.buffer=Ur.getBuffer(Ur.create(b,el,!1,!0)),c.type=0;else{var d=Ur.getBuffer(b);if(d)c.state=ra,c.buffer=d,c.type=0;else if(K.command(typeof b=="object"&&b,"invalid data for attribute "+$t,Qe.commandStr),"constant"in b){var v=b.constant;c.buffer="null",c.state=ya,typeof v=="number"?c.x=v:(K.command(Pi(v)&&v.length>0&&v.length<=4,"invalid constant for attribute "+$t,Qe.commandStr),dn.forEach(function(Xt,Kt){Kt<v.length&&(c[Xt]=v[Kt])}))}else{bo(b.buffer)?d=Ur.getBuffer(Ur.create(b.buffer,el,!1,!0)):d=Ur.getBuffer(b.buffer),K.command(!!d,'missing buffer for attribute "'+$t+'"',Qe.commandStr);var L=b.offset|0;K.command(L>=0,'invalid offset for attribute "'+$t+'"',Qe.commandStr);var j=b.stride|0;K.command(j>=0&&j<256,'invalid stride for attribute "'+$t+'", must be integer betweeen [0, 255]',Qe.commandStr);var se=b.size|0;K.command(!("size"in b)||se>0&&se<=4,'invalid size for attribute "'+$t+'", must be 1,2,3,4',Qe.commandStr);var oe=!!b.normalized,le=0;"type"in b&&(K.commandParameter(b.type,Ao,"invalid type for attribute "+$t,Qe.commandStr),le=Ao[b.type]);var Tt=b.divisor|0;"divisor"in b&&(K.command(Tt===0||tn,'cannot specify divisor for attribute "'+$t+'", instancing not supported',Qe.commandStr),K.command(Tt>=0,'invalid divisor for attribute "'+$t+'"',Qe.commandStr)),K.optional(function(){var Xt=Qe.commandStr,Kt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(b).forEach(function(tr){K.command(Kt.indexOf(tr)>=0,'unknown parameter "'+tr+'" for attribute pointer "'+$t+'" (valid parameters are '+Kt+")",Xt)})}),c.buffer=d,c.state=ra,c.size=se,c.normalized=oe,c.type=le||d.dtype,c.offset=L,c.stride=j,c.divisor=Tt}}fr[$t]=Aa(function(Xt,Kt){var tr=Xt.attribCache;if(p in tr)return tr[p];var Cr={isStream:!1};return Object.keys(c).forEach(function(Fr){Cr[Fr]=c[Fr]}),c.buffer&&(Cr.buffer=Xt.link(c.buffer),Cr.type=Cr.type||Cr.buffer+".dtype"),tr[p]=Cr,Cr})}),Object.keys(lr).forEach(function($t){var b=lr[$t];function p(c,d){var v=c.invoke(d,b),L=c.shared,j=c.constants,se=L.isBufferArgs,oe=L.buffer;K.optional(function(){c.assert(d,v+"&&(typeof "+v+'==="object"||typeof '+v+'==="function")&&('+se+"("+v+")||"+oe+".getBuffer("+v+")||"+oe+".getBuffer("+v+".buffer)||"+se+"("+v+'.buffer)||("constant" in '+v+"&&(typeof "+v+'.constant==="number"||'+L.isArrayLike+"("+v+".constant))))",'invalid dynamic attribute "'+$t+'"')});var le={isStream:d.def(!1)},Tt=new Tr;Tt.state=ra,Object.keys(Tt).forEach(function(Cr){le[Cr]=d.def(""+Tt[Cr])});var Xt=le.buffer,Kt=le.type;d("if(",se,"(",v,")){",le.isStream,"=true;",Xt,"=",oe,".createStream(",el,",",v,");",Kt,"=",Xt,".dtype;","}else{",Xt,"=",oe,".getBuffer(",v,");","if(",Xt,"){",Kt,"=",Xt,".dtype;",'}else if("constant" in ',v,"){",le.state,"=",ya,";","if(typeof "+v+'.constant === "number"){',le[dn[0]],"=",v,".constant;",dn.slice(1).map(function(Cr){return le[Cr]}).join("="),"=0;","}else{",dn.map(function(Cr,Fr){return le[Cr]+"="+v+".constant.length>"+Fr+"?"+v+".constant["+Fr+"]:0;"}).join(""),"}}else{","if(",se,"(",v,".buffer)){",Xt,"=",oe,".createStream(",el,",",v,".buffer);","}else{",Xt,"=",oe,".getBuffer(",v,".buffer);","}",Kt,'="type" in ',v,"?",j.glTypes,"[",v,".type]:",Xt,".dtype;",le.normalized,"=!!",v,".normalized;");function tr(Cr){d(le[Cr],"=",v,".",Cr,"|0;")}return tr("size"),tr("offset"),tr("stride"),tr("divisor"),d("}}"),d.exit("if(",le.isStream,"){",oe,".destroyStream(",Xt,");","}"),le}fr[$t]=ko(b,p)}),fr}function jo(vt,Qe){var Ht=vt.static,lr=vt.dynamic;if(Jl in Ht){var fr=Ht[Jl];return fr!==null&&sn.getVAO(fr)===null&&(fr=sn.createVAO(fr)),Aa(function(b){return b.link(sn.getVAO(fr))})}else if(Jl in lr){var $t=lr[Jl];return ko($t,function(b,p){var c=b.invoke(p,$t);return p.def(b.shared.vao+".getVAO("+c+")")})}return null}function Bi(vt){var Qe=vt.static,Ht=vt.dynamic,lr={};return Object.keys(Qe).forEach(function(fr){var $t=Qe[fr];lr[fr]=Aa(function(b,p){return typeof $t=="number"||typeof $t=="boolean"?""+$t:b.link($t)})}),Object.keys(Ht).forEach(function(fr){var $t=Ht[fr];lr[fr]=ko($t,function(b,p){return b.invoke(p,$t)})}),lr}function Ss(vt,Qe,Ht,lr,fr){var $t=vt.static,b=vt.dynamic;K.optional(function(){var tr=[Zi,Zs,ao,Ns,Xs,gc,qu,$l,rs,Jl].concat($r);function Cr(Fr){Object.keys(Fr).forEach(function(ln){K.command(tr.indexOf(ln)>=0,'unknown parameter "'+ln+'"',fr.commandStr)})}Cr($t),Cr(b)});var p=Pa(vt,Qe),c=Un(vt,fr),d=Fa(vt,c,fr),v=Ci(vt,fr),L=Wo(vt,fr),j=Na(vt,fr,p);function se(tr){var Cr=d[tr];Cr&&(L[tr]=Cr)}se(Ds),se(Xr(Oo));var oe=Object.keys(L).length>0,le={framebuffer:c,draw:v,shader:j,state:L,dirty:oe,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(le.profile=Wa(vt,fr),le.uniforms=Mo(Ht,fr),le.drawVAO=le.scopeVAO=jo(vt,fr),!le.drawVAO&&j.program&&!p&&Nt.angle_instanced_arrays){var Tt=!0,Xt=j.program.attributes.map(function(tr){var Cr=Qe.static[tr];return Tt=Tt&&!!Cr,Cr});if(Tt&&Xt.length>0){var Kt=sn.getVAO(sn.createVAO(Xt));le.drawVAO=new Ai(null,null,null,function(tr,Cr){return tr.link(Kt)}),le.useVAO=!0}}return p?le.useVAO=!0:le.attributes=ti(Qe,fr),le.context=Bi(lr,fr),le}function Ko(vt,Qe,Ht){var lr=vt.shared,fr=lr.context,$t=vt.scope();Object.keys(Ht).forEach(function(b){Qe.save(fr,"."+b);var p=Ht[b],c=p.append(vt,Qe);Array.isArray(c)?$t(fr,".",b,"=[",c.join(),"];"):$t(fr,".",b,"=",c,";")}),Qe($t)}function $o(vt,Qe,Ht,lr){var fr=vt.shared,$t=fr.gl,b=fr.framebuffer,p;Ln&&(p=Qe.def(fr.extensions,".webgl_draw_buffers"));var c=vt.constants,d=c.drawBuffer,v=c.backBuffer,L;Ht?L=Ht.append(vt,Qe):L=Qe.def(b,".next"),lr||Qe("if(",L,"!==",b,".cur){"),Qe("if(",L,"){",$t,".bindFramebuffer(",Ri,",",L,".framebuffer);"),Ln&&Qe(p,".drawBuffersWEBGL(",d,"[",L,".colorAttachments.length]);"),Qe("}else{",$t,".bindFramebuffer(",Ri,",null);"),Ln&&Qe(p,".drawBuffersWEBGL(",v,");"),Qe("}",b,".cur=",L,";"),lr||Qe("}")}function Po(vt,Qe,Ht){var lr=vt.shared,fr=lr.gl,$t=vt.current,b=vt.next,p=lr.current,c=lr.next,d=vt.cond(p,".dirty");$r.forEach(function(v){var L=Xr(v);if(L in Ht.state)return;var j,se;if(L in b){j=b[L],se=$t[L];var oe=H(kr[L].length,function(Tt){return d.def(j,"[",Tt,"]")});d(vt.cond(oe.map(function(Tt,Xt){return Tt+"!=="+se+"["+Xt+"]"}).join("||")).then(fr,".",Gr[L],"(",oe,");",oe.map(function(Tt,Xt){return se+"["+Xt+"]="+Tt}).join(";"),";"))}else{j=d.def(c,".",L);var le=vt.cond(j,"!==",p,".",L);d(le),L in Br?le(vt.cond(j).then(fr,".enable(",Br[L],");").else(fr,".disable(",Br[L],");"),p,".",L,"=",j,";"):le(fr,".",Gr[L],"(",j,");",p,".",L,"=",j,";")}}),Object.keys(Ht.state).length===0&&d(p,".dirty=false;"),Qe(d)}function su(vt,Qe,Ht,lr){var fr=vt.shared,$t=vt.current,b=fr.current,p=fr.gl;ds(Object.keys(Ht)).forEach(function(c){var d=Ht[c];if(lr&&!lr(d))return;var v=d.append(vt,Qe);if(Br[c]){var L=Br[c];xo(d)?v?Qe(p,".enable(",L,");"):Qe(p,".disable(",L,");"):Qe(vt.cond(v).then(p,".enable(",L,");").else(p,".disable(",L,");")),Qe(b,".",c,"=",v,";")}else if(Pi(v)){var j=$t[c];Qe(p,".",Gr[c],"(",v,");",v.map(function(se,oe){return j+"["+oe+"]="+se}).join(";"),";")}else Qe(p,".",Gr[c],"(",v,");",b,".",c,"=",v,";")})}function Jo(vt,Qe){tn&&(vt.instancing=Qe.def(vt.shared.extensions,".angle_instanced_arrays"))}function ia(vt,Qe,Ht,lr,fr){var $t=vt.shared,b=vt.stats,p=$t.current,c=$t.timer,d=Ht.profile;function v(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var L,j;function se(tr){L=Qe.def(),tr(L,"=",v(),";"),typeof fr=="string"?tr(b,".count+=",fr,";"):tr(b,".count++;"),pn&&(lr?(j=Qe.def(),tr(j,"=",c,".getNumPendingQueries();")):tr(c,".beginQuery(",b,");"))}function oe(tr){tr(b,".cpuTime+=",v(),"-",L,";"),pn&&(lr?tr(c,".pushScopeStats(",j,",",c,".getNumPendingQueries(),",b,");"):tr(c,".endQuery();"))}function le(tr){var Cr=Qe.def(p,".profile");Qe(p,".profile=",tr,";"),Qe.exit(p,".profile=",Cr,";")}var Tt;if(d){if(xo(d)){d.enable?(se(Qe),oe(Qe.exit),le("true")):le("false");return}Tt=d.append(vt,Qe),le(Tt)}else Tt=Qe.def(p,".profile");var Xt=vt.block();se(Xt),Qe("if(",Tt,"){",Xt,"}");var Kt=vt.block();oe(Kt),Qe.exit("if(",Tt,"){",Kt,"}")}function uu(vt,Qe,Ht,lr,fr){var $t=vt.shared;function b(c){switch(c){case rc:case Dc:case bf:return 2;case yf:case Fu:case xf:return 3;case nc:case Nc:case Gf:return 4;default:return 1}}function p(c,d,v){var L=$t.gl,j=Qe.def(c,".location"),se=Qe.def($t.attributes,"[",j,"]"),oe=v.state,le=v.buffer,Tt=[v.x,v.y,v.z,v.w],Xt=["buffer","normalized","offset","stride"];function Kt(){Qe("if(!",se,".buffer){",L,".enableVertexAttribArray(",j,");}");var Cr=v.type,Fr;if(v.size?Fr=Qe.def(v.size,"||",d):Fr=d,Qe("if(",se,".type!==",Cr,"||",se,".size!==",Fr,"||",Xt.map(function(hn){return se+"."+hn+"!=="+v[hn]}).join("||"),"){",L,".bindBuffer(",el,",",le,".buffer);",L,".vertexAttribPointer(",[j,Fr,Cr,v.normalized,v.stride,v.offset],");",se,".type=",Cr,";",se,".size=",Fr,";",Xt.map(function(hn){return se+"."+hn+"="+v[hn]+";"}).join(""),"}"),tn){var ln=v.divisor;Qe("if(",se,".divisor!==",ln,"){",vt.instancing,".vertexAttribDivisorANGLE(",[j,ln],");",se,".divisor=",ln,";}")}}function tr(){Qe("if(",se,".buffer){",L,".disableVertexAttribArray(",j,");",se,".buffer=null;","}if(",dn.map(function(Cr,Fr){return se+"."+Cr+"!=="+Tt[Fr]}).join("||"),"){",L,".vertexAttrib4f(",j,",",Tt,");",dn.map(function(Cr,Fr){return se+"."+Cr+"="+Tt[Fr]+";"}).join(""),"}")}oe===ra?Kt():oe===ya?tr():(Qe("if(",oe,"===",ra,"){"),Kt(),Qe("}else{"),tr(),Qe("}"))}lr.forEach(function(c){var d=c.name,v=Ht.attributes[d],L;if(v){if(!fr(v))return;L=v.append(vt,Qe)}else{if(!fr(bc))return;var j=vt.scopeAttrib(d);K.optional(function(){vt.assert(Qe,j+".state","missing attribute "+d)}),L={},Object.keys(new Tr).forEach(function(se){L[se]=Qe.def(j,".",se)})}p(vt.link(c),b(c.info.type),L)})}function wi(vt,Qe,Ht,lr,fr){for(var $t=vt.shared,b=$t.gl,p,c=0;c<lr.length;++c){var d=lr[c],v=d.name,L=d.info.type,j=Ht.uniforms[v],se=vt.link(d),oe=se+".location",le;if(j){if(!fr(j))continue;if(xo(j)){var Tt=j.value;if(K.command(Tt!==null&&typeof Tt!="undefined",'missing uniform "'+v+'"',vt.commandStr),L===ae||L===N){K.command(typeof Tt=="function"&&(L===ae&&(Tt._reglType==="texture2d"||Tt._reglType==="framebuffer")||L===N&&(Tt._reglType==="textureCube"||Tt._reglType==="framebufferCube")),"invalid texture for uniform "+v,vt.commandStr);var Xt=vt.link(Tt._texture||Tt.color[0]._texture);Qe(b,".uniform1i(",oe,",",Xt+".bind());"),Qe.exit(Xt,".unbind();")}else if(L===yc||L===Sl||L===ee){K.optional(function(){K.command(Pi(Tt),"invalid matrix for uniform "+v,vt.commandStr),K.command(L===yc&&Tt.length===4||L===Sl&&Tt.length===9||L===ee&&Tt.length===16,"invalid length for matrix uniform "+v,vt.commandStr)});var Kt=vt.global.def("new Float32Array(["+Array.prototype.slice.call(Tt)+"])"),tr=2;L===Sl?tr=3:L===ee&&(tr=4),Qe(b,".uniformMatrix",tr,"fv(",oe,",false,",Kt,");")}else{switch(L){case yo:K.commandType(Tt,"number","uniform "+v,vt.commandStr),p="1f";break;case rc:K.command(Pi(Tt)&&Tt.length===2,"uniform "+v,vt.commandStr),p="2f";break;case yf:K.command(Pi(Tt)&&Tt.length===3,"uniform "+v,vt.commandStr),p="3f";break;case nc:K.command(Pi(Tt)&&Tt.length===4,"uniform "+v,vt.commandStr),p="4f";break;case kc:K.commandType(Tt,"boolean","uniform "+v,vt.commandStr),p="1i";break;case nf:K.commandType(Tt,"number","uniform "+v,vt.commandStr),p="1i";break;case bf:K.command(Pi(Tt)&&Tt.length===2,"uniform "+v,vt.commandStr),p="2i";break;case Dc:K.command(Pi(Tt)&&Tt.length===2,"uniform "+v,vt.commandStr),p="2i";break;case xf:K.command(Pi(Tt)&&Tt.length===3,"uniform "+v,vt.commandStr),p="3i";break;case Fu:K.command(Pi(Tt)&&Tt.length===3,"uniform "+v,vt.commandStr),p="3i";break;case Gf:K.command(Pi(Tt)&&Tt.length===4,"uniform "+v,vt.commandStr),p="4i";break;case Nc:K.command(Pi(Tt)&&Tt.length===4,"uniform "+v,vt.commandStr),p="4i";break}Qe(b,".uniform",p,"(",oe,",",Pi(Tt)?Array.prototype.slice.call(Tt):Tt,");")}continue}else le=j.append(vt,Qe)}else{if(!fr(bc))continue;le=Qe.def($t.uniforms,"[",ke.id(v),"]")}L===ae?(K(!Array.isArray(le),"must specify a scalar prop for textures"),Qe("if(",le,"&&",le,'._reglType==="framebuffer"){',le,"=",le,".color[0];","}")):L===N&&(K(!Array.isArray(le),"must specify a scalar prop for cube maps"),Qe("if(",le,"&&",le,'._reglType==="framebufferCube"){',le,"=",le,".color[0];","}")),K.optional(function(){function $n(_a,ii){vt.assert(Qe,_a,'bad data or missing for uniform "'+v+'".  '+ii)}function sa(_a){K(!Array.isArray(le),"must not specify an array type for uniform"),$n("typeof "+le+'==="'+_a+'"',"invalid type, expected "+_a)}function fa(_a,ii){Array.isArray(le)?K(le.length===_a,"must have length "+_a):$n($t.isArrayLike+"("+le+")&&"+le+".length==="+_a,"invalid vector, should have length "+_a,vt.commandStr)}function ja(_a){K(!Array.isArray(le),"must not specify a value type"),$n("typeof "+le+'==="function"&&'+le+'._reglType==="texture'+(_a===rf?"2d":"Cube")+'"',"invalid texture type",vt.commandStr)}switch(L){case nf:sa("number");break;case Dc:fa(2,"number");break;case Fu:fa(3,"number");break;case Nc:fa(4,"number");break;case yo:sa("number");break;case rc:fa(2,"number");break;case yf:fa(3,"number");break;case nc:fa(4,"number");break;case kc:sa("boolean");break;case bf:fa(2,"boolean");break;case xf:fa(3,"boolean");break;case Gf:fa(4,"boolean");break;case yc:fa(4,"number");break;case Sl:fa(9,"number");break;case ee:fa(16,"number");break;case ae:ja(rf);break;case N:ja(Lf);break}});var Cr=1;switch(L){case ae:case N:var Fr=Qe.def(le,"._texture");Qe(b,".uniform1i(",oe,",",Fr,".bind());"),Qe.exit(Fr,".unbind();");continue;case nf:case kc:p="1i";break;case Dc:case bf:p="2i",Cr=2;break;case Fu:case xf:p="3i",Cr=3;break;case Nc:case Gf:p="4i",Cr=4;break;case yo:p="1f";break;case rc:p="2f",Cr=2;break;case yf:p="3f",Cr=3;break;case nc:p="4f",Cr=4;break;case yc:p="Matrix2fv";break;case Sl:p="Matrix3fv";break;case ee:p="Matrix4fv";break}if(Qe(b,".uniform",p,"(",oe,","),p.charAt(0)==="M"){var ln=Math.pow(L-yc+2,2),hn=vt.global.def("new Float32Array(",ln,")");Array.isArray(le)?Qe("false,(",H(ln,function($n){return hn+"["+$n+"]="+le[$n]}),",",hn,")"):Qe("false,(Array.isArray(",le,")||",le," instanceof Float32Array)?",le,":(",H(ln,function($n){return hn+"["+$n+"]="+le+"["+$n+"]"}),",",hn,")")}else Cr>1?Qe(H(Cr,function($n){return Array.isArray(le)?le[$n]:le+"["+$n+"]"})):(K(!Array.isArray(le),"uniform value must not be an array"),Qe(le));Qe(");")}}function Cn(vt,Qe,Ht,lr){var fr=vt.shared,$t=fr.gl,b=fr.draw,p=lr.draw;function c(){var Fr=p.elements,ln,hn=Qe;return Fr?((Fr.contextDep&&lr.contextDynamic||Fr.propDep)&&(hn=Ht),ln=Fr.append(vt,hn)):ln=hn.def(b,".",Ns),ln&&hn("if("+ln+")"+$t+".bindBuffer("+gf+","+ln+".buffer.buffer);"),ln}function d(){var Fr=p.count,ln,hn=Qe;return Fr?((Fr.contextDep&&lr.contextDynamic||Fr.propDep)&&(hn=Ht),ln=Fr.append(vt,hn),K.optional(function(){Fr.MISSING&&vt.assert(Qe,"false","missing vertex count"),Fr.DYNAMIC&&vt.assert(hn,ln+">=0","missing vertex count")})):(ln=hn.def(b,".",qu),K.optional(function(){vt.assert(hn,ln+">=0","missing vertex count")})),ln}var v=c();function L(Fr){var ln=p[Fr];return ln?ln.contextDep&&lr.contextDynamic||ln.propDep?ln.append(vt,Ht):ln.append(vt,Qe):Qe.def(b,".",Fr)}var j=L(Xs),se=L(gc),oe=d();if(typeof oe=="number"){if(oe===0)return}else Ht("if(",oe,"){"),Ht.exit("}");var le,Tt;tn&&(le=L($l),Tt=vt.instancing);var Xt=v+".type",Kt=p.elements&&xo(p.elements);function tr(){function Fr(){Ht(Tt,".drawElementsInstancedANGLE(",[j,oe,Xt,se+"<<(("+Xt+"-"+wn+")>>1)",le],");")}function ln(){Ht(Tt,".drawArraysInstancedANGLE(",[j,se,oe,le],");")}v?Kt?Fr():(Ht("if(",v,"){"),Fr(),Ht("}else{"),ln(),Ht("}")):ln()}function Cr(){function Fr(){Ht($t+".drawElements("+[j,oe,Xt,se+"<<(("+Xt+"-"+wn+")>>1)"]+");")}function ln(){Ht($t+".drawArrays("+[j,se,oe]+");")}v?Kt?Fr():(Ht("if(",v,"){"),Fr(),Ht("}else{"),ln(),Ht("}")):ln()}tn&&(typeof le!="number"||le>=0)?typeof le=="string"?(Ht("if(",le,">0){"),tr(),Ht("}else if(",le,"<0){"),Cr(),Ht("}")):tr():Cr()}function ka(vt,Qe,Ht,lr,fr){var $t=Ea(),b=$t.proc("body",fr);return K.optional(function(){$t.commandStr=Qe.commandStr,$t.command=$t.link(Qe.commandStr)}),tn&&($t.instancing=b.def($t.shared.extensions,".angle_instanced_arrays")),vt($t,b,Ht,lr),$t.compile().body}function Qa(vt,Qe,Ht,lr){Jo(vt,Qe),Ht.useVAO?Ht.drawVAO?Qe(vt.shared.vao,".setVAO(",Ht.drawVAO.append(vt,Qe),");"):Qe(vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"):(Qe(vt.shared.vao,".setVAO(null);"),uu(vt,Qe,Ht,lr.attributes,function(){return!0})),wi(vt,Qe,Ht,lr.uniforms,function(){return!0}),Cn(vt,Qe,Qe,Ht)}function Lo(vt,Qe){var Ht=vt.proc("draw",1);Jo(vt,Ht),Ko(vt,Ht,Qe.context),$o(vt,Ht,Qe.framebuffer),Po(vt,Ht,Qe),su(vt,Ht,Qe.state),ia(vt,Ht,Qe,!1,!0);var lr=Qe.shader.progVar.append(vt,Ht);if(Ht(vt.shared.gl,".useProgram(",lr,".program);"),Qe.shader.program)Qa(vt,Ht,Qe,Qe.shader.program);else{Ht(vt.shared.vao,".setVAO(null);");var fr=vt.global.def("{}"),$t=Ht.def(lr,".id"),b=Ht.def(fr,"[",$t,"]");Ht(vt.cond(b).then(b,".call(this,a0);").else(b,"=",fr,"[",$t,"]=",vt.link(function(p){return ka(Qa,vt,Qe,p,1)}),"(",lr,");",b,".call(this,a0);"))}Object.keys(Qe.state).length>0&&Ht(vt.shared.current,".dirty=true;")}function Cu(vt,Qe,Ht,lr){vt.batchId="a1",Jo(vt,Qe);function fr(){return!0}uu(vt,Qe,Ht,lr.attributes,fr),wi(vt,Qe,Ht,lr.uniforms,fr),Cn(vt,Qe,Qe,Ht)}function Al(vt,Qe,Ht,lr){Jo(vt,Qe);var fr=Ht.contextDep,$t=Qe.def(),b="a0",p="a1",c=Qe.def();vt.shared.props=c,vt.batchId=$t;var d=vt.scope(),v=vt.scope();Qe(d.entry,"for(",$t,"=0;",$t,"<",p,";++",$t,"){",c,"=",b,"[",$t,"];",v,"}",d.exit);function L(Xt){return Xt.contextDep&&fr||Xt.propDep}function j(Xt){return!L(Xt)}if(Ht.needsContext&&Ko(vt,v,Ht.context),Ht.needsFramebuffer&&$o(vt,v,Ht.framebuffer),su(vt,v,Ht.state,L),Ht.profile&&L(Ht.profile)&&ia(vt,v,Ht,!1,!0),lr)Ht.useVAO?Ht.drawVAO?L(Ht.drawVAO)?v(vt.shared.vao,".setVAO(",Ht.drawVAO.append(vt,v),");"):d(vt.shared.vao,".setVAO(",Ht.drawVAO.append(vt,d),");"):d(vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"):(d(vt.shared.vao,".setVAO(null);"),uu(vt,d,Ht,lr.attributes,j),uu(vt,v,Ht,lr.attributes,L)),wi(vt,d,Ht,lr.uniforms,j),wi(vt,v,Ht,lr.uniforms,L),Cn(vt,d,v,Ht);else{var se=vt.global.def("{}"),oe=Ht.shader.progVar.append(vt,v),le=v.def(oe,".id"),Tt=v.def(se,"[",le,"]");v(vt.shared.gl,".useProgram(",oe,".program);","if(!",Tt,"){",Tt,"=",se,"[",le,"]=",vt.link(function(Xt){return ka(Cu,vt,Ht,Xt,2)}),"(",oe,");}",Tt,".call(this,a0[",$t,"],",$t,");")}}function Ot(vt,Qe){var Ht=vt.proc("batch",2);vt.batchId="0",Jo(vt,Ht);var lr=!1,fr=!0;Object.keys(Qe.context).forEach(function(se){lr=lr||Qe.context[se].propDep}),lr||(Ko(vt,Ht,Qe.context),fr=!1);var $t=Qe.framebuffer,b=!1;$t?($t.propDep?lr=b=!0:$t.contextDep&&lr&&(b=!0),b||$o(vt,Ht,$t)):$o(vt,Ht,null),Qe.state.viewport&&Qe.state.viewport.propDep&&(lr=!0);function p(se){return se.contextDep&&lr||se.propDep}Po(vt,Ht,Qe),su(vt,Ht,Qe.state,function(se){return!p(se)}),(!Qe.profile||!p(Qe.profile))&&ia(vt,Ht,Qe,!1,"a1"),Qe.contextDep=lr,Qe.needsContext=fr,Qe.needsFramebuffer=b;var c=Qe.shader.progVar;if(c.contextDep&&lr||c.propDep)Al(vt,Ht,Qe,null);else{var d=c.append(vt,Ht);if(Ht(vt.shared.gl,".useProgram(",d,".program);"),Qe.shader.program)Al(vt,Ht,Qe,Qe.shader.program);else{Ht(vt.shared.vao,".setVAO(null);");var v=vt.global.def("{}"),L=Ht.def(d,".id"),j=Ht.def(v,"[",L,"]");Ht(vt.cond(j).then(j,".call(this,a0,a1);").else(j,"=",v,"[",L,"]=",vt.link(function(se){return ka(Al,vt,Qe,se,2)}),"(",d,");",j,".call(this,a0,a1);"))}}Object.keys(Qe.state).length>0&&Ht(vt.shared.current,".dirty=true;")}function _r(vt,Qe){var Ht=vt.proc("scope",3);vt.batchId="a2";var lr=vt.shared,fr=lr.current;Ko(vt,Ht,Qe.context),Qe.framebuffer&&Qe.framebuffer.append(vt,Ht),ds(Object.keys(Qe.state)).forEach(function(b){var p=Qe.state[b],c=p.append(vt,Ht);Pi(c)?c.forEach(function(d,v){Ht.set(vt.next[b],"["+v+"]",d)}):Ht.set(lr.next,"."+b,c)}),ia(vt,Ht,Qe,!0,!0),[Ns,gc,qu,$l,Xs].forEach(function(b){var p=Qe.draw[b];if(!p)return;Ht.set(lr.draw,"."+b,""+p.append(vt,Ht))}),Object.keys(Qe.uniforms).forEach(function(b){var p=Qe.uniforms[b].append(vt,Ht);Array.isArray(p)&&(p="["+p.join()+"]"),Ht.set(lr.uniforms,"["+ke.id(b)+"]",p)}),Object.keys(Qe.attributes).forEach(function(b){var p=Qe.attributes[b].append(vt,Ht),c=vt.scopeAttrib(b);Object.keys(new Tr).forEach(function(d){Ht.set(c,"."+d,p[d])})}),Qe.scopeVAO&&Ht.set(lr.vao,".targetVAO",Qe.scopeVAO.append(vt,Ht));function $t(b){var p=Qe.shader[b];p&&Ht.set(lr.shader,"."+b,p.append(vt,Ht))}$t(Zs),$t(ao),Object.keys(Qe.state).length>0&&(Ht(fr,".dirty=true;"),Ht.exit(fr,".dirty=true;")),Ht("a1(",vt.shared.context,",a0,",vt.batchId,");")}function br(vt){if(typeof vt!="object"||Pi(vt))return;for(var Qe=Object.keys(vt),Ht=0;Ht<Qe.length;++Ht)if(Ke.isDynamic(vt[Qe[Ht]]))return!0;return!1}function On(vt,Qe,Ht){var lr=Qe.static[Ht];if(!lr||!br(lr))return;var fr=vt.global,$t=Object.keys(lr),b=!1,p=!1,c=!1,d=vt.global.def("{}");$t.forEach(function(L){var j=lr[L];if(Ke.isDynamic(j)){typeof j=="function"&&(j=lr[L]=Ke.unbox(j));var se=ko(j,null);b=b||se.thisDep,c=c||se.propDep,p=p||se.contextDep}else{fr(d,".",L,"=");switch(typeof j){case"number":fr(j);break;case"string":fr('"',j,'"');break;case"object":Array.isArray(j)&&fr("[",j.join(),"]");break;default:fr(vt.link(j));break}fr(";")}});function v(L,j){$t.forEach(function(se){var oe=lr[se];if(!Ke.isDynamic(oe))return;var le=L.invoke(j,oe);j(d,".",se,"=",le,";")})}Qe.dynamic[Ht]=new Ke.DynamicVariable(ca,{thisDep:b,contextDep:p,propDep:c,ref:d,append:v}),delete Qe.static[Ht]}function Ra(vt,Qe,Ht,lr,fr){var $t=Ea();$t.stats=$t.link(fr),Object.keys(Qe.static).forEach(function(p){On($t,Qe,p)}),oh.forEach(function(p){On($t,vt,p)});var b=Ss(vt,Qe,Ht,lr,$t);return Lo($t,b),_r($t,b),Ot($t,b),m($t.compile(),{destroy:function(){b.shader.program.destroy()}})}return{next:Yn,current:kr,procs:function(){var vt=Ea(),Qe=vt.proc("poll"),Ht=vt.proc("refresh"),lr=vt.block();Qe(lr),Ht(lr);var fr=vt.shared,$t=fr.gl,b=fr.next,p=fr.current;lr(p,".dirty=false;"),$o(vt,Qe),$o(vt,Ht,null,!0);var c;tn&&(c=vt.link(tn)),Nt.oes_vertex_array_object&&Ht(vt.link(Nt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var d=0;d<vr.maxAttributes;++d){var v=Ht.def(fr.attributes,"[",d,"]"),L=vt.cond(v,".buffer");L.then($t,".enableVertexAttribArray(",d,");",$t,".bindBuffer(",el,",",v,".buffer.buffer);",$t,".vertexAttribPointer(",d,",",v,".size,",v,".type,",v,".normalized,",v,".stride,",v,".offset);").else($t,".disableVertexAttribArray(",d,");",$t,".vertexAttrib4f(",d,",",v,".x,",v,".y,",v,".z,",v,".w);",v,".buffer=null;"),Ht(L),tn&&Ht(c,".vertexAttribDivisorANGLE(",d,",",v,".divisor);")}return Ht(vt.shared.vao,".currentVAO=null;",vt.shared.vao,".setVAO(",vt.shared.vao,".targetVAO);"),Object.keys(Br).forEach(function(j){var se=Br[j],oe=lr.def(b,".",j),le=vt.block();le("if(",oe,"){",$t,".enable(",se,")}else{",$t,".disable(",se,")}",p,".",j,"=",oe,";"),Ht(le),Qe("if(",oe,"!==",p,".",j,"){",le,"}")}),Object.keys(Gr).forEach(function(j){var se=Gr[j],oe=kr[j],le,Tt,Xt=vt.block();if(Xt($t,".",se,"("),Pi(oe)){var Kt=oe.length;le=vt.global.def(b,".",j),Tt=vt.global.def(p,".",j),Xt(H(Kt,function(tr){return le+"["+tr+"]"}),");",H(Kt,function(tr){return Tt+"["+tr+"]="+le+"["+tr+"];"}).join("")),Qe("if(",H(Kt,function(tr){return le+"["+tr+"]!=="+Tt+"["+tr+"]"}).join("||"),"){",Xt,"}")}else le=lr.def(b,".",j),Tt=lr.def(p,".",j),Xt(le,");",p,".",j,"=",le,";"),Qe("if(",le,"!==",Tt,"){",Xt,"}");Ht(Xt)}),vt.compile()}(),compile:Ra}}function Ks(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var uh=34918,Vh=34919,Wf=35007,If=function(ke,Nt){if(!Nt.ext_disjoint_timer_query)return null;var vr=[];function Ur(){return vr.pop()||Nt.ext_disjoint_timer_query.createQueryEXT()}function Rr(Ln){vr.push(Ln)}var Er=[];function Yr(Ln){var kr=Ur();Nt.ext_disjoint_timer_query.beginQueryEXT(Wf,kr),Er.push(kr),un(Er.length-1,Er.length,Ln)}function qr(){Nt.ext_disjoint_timer_query.endQueryEXT(Wf)}function sn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var an=[];function cn(){return an.pop()||new sn}function An(Ln){an.push(Ln)}var pn=[];function un(Ln,kr,Yn){var $r=cn();$r.startQueryIndex=Ln,$r.endQueryIndex=kr,$r.sum=0,$r.stats=Yn,pn.push($r)}var Tr=[],xr=[];function tn(){var Ln,kr,Yn=Er.length;if(Yn===0)return;xr.length=Math.max(xr.length,Yn+1),Tr.length=Math.max(Tr.length,Yn+1),Tr[0]=0,xr[0]=0;var $r=0;for(Ln=0,kr=0;kr<Er.length;++kr){var Br=Er[kr];Nt.ext_disjoint_timer_query.getQueryObjectEXT(Br,Vh)?($r+=Nt.ext_disjoint_timer_query.getQueryObjectEXT(Br,uh),Rr(Br)):Er[Ln++]=Br,Tr[kr+1]=$r,xr[kr+1]=Ln}for(Er.length=Ln,Ln=0,kr=0;kr<pn.length;++kr){var Gr=pn[kr],Xr=Gr.startQueryIndex,Hn=Gr.endQueryIndex;Gr.sum+=Tr[Hn]-Tr[Xr];var qn=xr[Xr],fn=xr[Hn];fn===qn?(Gr.stats.gpuTime+=Gr.sum/1e6,An(Gr)):(Gr.startQueryIndex=qn,Gr.endQueryIndex=fn,pn[Ln++]=Gr)}pn.length=Ln}return{beginQuery:Yr,endQuery:qr,pushScopeStats:un,update:tn,getNumPendingQueries:function(){return Er.length},clear:function(){vr.push.apply(vr,Er);for(var kr=0;kr<vr.length;kr++)Nt.ext_disjoint_timer_query.deleteQueryEXT(vr[kr]);Er.length=0,vr.length=0},restore:function(){Er.length=0,vr.length=0}}},qf=16384,Ch=256,wh=1024,Df=34962,eh="webglcontextlost",th="webglcontextrestored",Oh=1,rh=2,Nf=3;function vh(fe,ke){for(var Nt=0;Nt<fe.length;++Nt)if(fe[Nt]===ke)return Nt;return-1}function lh(fe){var ke=Wn(fe);if(!ke)return null;var Nt=ke.gl,vr=Nt.getContextAttributes(),Ur=Nt.isContextLost(),Rr=F(Nt,ke);if(!Rr)return null;var Er=Zr(),Yr=Ks(),qr=Rr.extensions,sn=If(Nt,qr),an=yr(),cn=Nt.drawingBufferWidth,An=Nt.drawingBufferHeight,pn={tick:0,time:0,viewportWidth:cn,viewportHeight:An,framebufferWidth:cn,framebufferHeight:An,drawingBufferWidth:cn,drawingBufferHeight:An,pixelRatio:ke.pixelRatio},un={},Tr={elements:null,primitive:4,count:-1,offset:0,instances:-1},xr=du(Nt,qr),tn=Xa(Nt,Yr,ke,kr),Ln=qe(Nt,qr,xr,Yr,tn);function kr(Cn){return Ln.destroyBuffer(Cn)}var Yn=Vc(Nt,qr,tn,Yr),$r=jt(Nt,Er,Yr,ke),Br=Ku(Nt,qr,xr,function(){Hn.procs.poll()},pn,Yr,ke),Gr=Jc(Nt,qr,xr,Yr,ke),Xr=ie(Nt,qr,xr,Br,Gr,Yr),Hn=Hf(Nt,Er,qr,xr,tn,Yn,Br,Xr,un,Ln,$r,Tr,pn,sn,ke),qn=Ar(Nt,Xr,Hn.procs.poll,pn,vr,qr,xr),fn=Hn.next,rn=Nt.canvas,zr=[],Ea=[],Wa=[],Un=[ke.onDestroy],Fa=null;function Pa(){if(zr.length===0){sn&&sn.update(),Fa=null;return}Fa=kt.next(Pa),su();for(var Cn=zr.length-1;Cn>=0;--Cn){var ka=zr[Cn];ka&&ka(pn,null,0)}Nt.flush(),sn&&sn.update()}function Na(){!Fa&&zr.length>0&&(Fa=kt.next(Pa))}function Ci(){Fa&&(kt.cancel(Pa),Fa=null)}function Wo(Cn){Cn.preventDefault(),Ur=!0,Ci(),Ea.forEach(function(ka){ka()})}function Mo(Cn){Nt.getError(),Ur=!1,Rr.restore(),$r.restore(),tn.restore(),Br.restore(),Gr.restore(),Xr.restore(),Ln.restore(),sn&&sn.restore(),Hn.procs.refresh(),Na(),Wa.forEach(function(ka){ka()})}rn&&(rn.addEventListener(eh,Wo,!1),rn.addEventListener(th,Mo,!1));function ti(){zr.length=0,Ci(),rn&&(rn.removeEventListener(eh,Wo),rn.removeEventListener(th,Mo)),$r.clear(),Xr.clear(),Gr.clear(),Br.clear(),Yn.clear(),tn.clear(),Ln.clear(),sn&&sn.clear(),Un.forEach(function(Cn){Cn()})}function jo(Cn){K(!!Cn,"invalid args to regl({...})"),K.type(Cn,"object","invalid args to regl({...})");function ka(fr){var $t=m({},fr);delete $t.uniforms,delete $t.attributes,delete $t.context,delete $t.vao,"stencil"in $t&&$t.stencil.op&&($t.stencil.opBack=$t.stencil.opFront=$t.stencil.op,delete $t.stencil.op);function b(p){if(p in $t){var c=$t[p];delete $t[p],Object.keys(c).forEach(function(d){$t[p+"."+d]=c[d]})}}return b("blend"),b("depth"),b("cull"),b("stencil"),b("polygonOffset"),b("scissor"),b("sample"),"vao"in fr&&($t.vao=fr.vao),$t}function Qa(fr,$t){var b={},p={};return Object.keys(fr).forEach(function(c){var d=fr[c];if(Ke.isDynamic(d)){p[c]=Ke.unbox(d,c);return}else if($t&&Array.isArray(d)){for(var v=0;v<d.length;++v)if(Ke.isDynamic(d[v])){p[c]=Ke.unbox(d,c);return}}b[c]=d}),{dynamic:p,static:b}}var Lo=Qa(Cn.context||{},!0),Cu=Qa(Cn.uniforms||{},!0),Al=Qa(Cn.attributes||{},!1),Ot=Qa(ka(Cn),!1),_r={gpuTime:0,cpuTime:0,count:0},br=Hn.compile(Ot,Al,Cu,Lo,_r),On=br.draw,Ra=br.batch,vt=br.scope,Qe=[];function Ht(fr){for(;Qe.length<fr;)Qe.push(null);return Qe}function lr(fr,$t){var b;if(Ur&&K.raise("context lost"),typeof fr=="function")return vt.call(this,null,fr,0);if(typeof $t=="function")if(typeof fr=="number")for(b=0;b<fr;++b)vt.call(this,null,$t,b);else if(Array.isArray(fr))for(b=0;b<fr.length;++b)vt.call(this,fr[b],$t,b);else return vt.call(this,fr,$t,0);else if(typeof fr=="number"){if(fr>0)return Ra.call(this,Ht(fr|0),fr|0)}else if(Array.isArray(fr)){if(fr.length)return Ra.call(this,fr,fr.length)}else return On.call(this,fr)}return m(lr,{stats:_r,destroy:function(){br.destroy()}})}var Bi=Xr.setFBO=jo({framebuffer:Ke.define.call(null,Oh,"framebuffer")});function Ss(Cn,ka){var Qa=0;Hn.procs.poll();var Lo=ka.color;Lo&&(Nt.clearColor(+Lo[0]||0,+Lo[1]||0,+Lo[2]||0,+Lo[3]||0),Qa|=qf),"depth"in ka&&(Nt.clearDepth(+ka.depth),Qa|=Ch),"stencil"in ka&&(Nt.clearStencil(ka.stencil|0),Qa|=wh),K(!!Qa,"called regl.clear with no buffer specified"),Nt.clear(Qa)}function Ko(Cn){if(K(typeof Cn=="object"&&Cn,"regl.clear() takes an object as input"),"framebuffer"in Cn)if(Cn.framebuffer&&Cn.framebuffer_reglType==="framebufferCube")for(var ka=0;ka<6;++ka)Bi(m({framebuffer:Cn.framebuffer.faces[ka]},Cn),Ss);else Bi(Cn,Ss);else Ss(null,Cn)}function $o(Cn){K.type(Cn,"function","regl.frame() callback must be a function"),zr.push(Cn);function ka(){var Qa=vh(zr,Cn);K(Qa>=0,"cannot cancel a frame twice");function Lo(){var Cu=vh(zr,Lo);zr[Cu]=zr[zr.length-1],zr.length-=1,zr.length<=0&&Ci()}zr[Qa]=Lo}return Na(),{cancel:ka}}function Po(){var Cn=fn.viewport,ka=fn.scissor_box;Cn[0]=Cn[1]=ka[0]=ka[1]=0,pn.viewportWidth=pn.framebufferWidth=pn.drawingBufferWidth=Cn[2]=ka[2]=Nt.drawingBufferWidth,pn.viewportHeight=pn.framebufferHeight=pn.drawingBufferHeight=Cn[3]=ka[3]=Nt.drawingBufferHeight}function su(){pn.tick+=1,pn.time=ia(),Po(),Hn.procs.poll()}function Jo(){Br.refresh(),Po(),Hn.procs.refresh(),sn&&sn.update()}function ia(){return(yr()-an)/1e3}Jo();function uu(Cn,ka){K.type(ka,"function","listener callback must be a function");var Qa;switch(Cn){case"frame":return $o(ka);case"lost":Qa=Ea;break;case"restore":Qa=Wa;break;case"destroy":Qa=Un;break;default:K.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qa.push(ka),{cancel:function(){for(var Cu=0;Cu<Qa.length;++Cu)if(Qa[Cu]===ka){Qa[Cu]=Qa[Qa.length-1],Qa.pop();return}}}}var wi=m(jo,{clear:Ko,prop:Ke.define.bind(null,Oh),context:Ke.define.bind(null,rh),this:Ke.define.bind(null,Nf),draw:jo({}),buffer:function(ka){return tn.create(ka,Df,!1,!1)},elements:function(ka){return Yn.create(ka,!1)},texture:Br.create2D,cube:Br.createCube,renderbuffer:Gr.create,framebuffer:Xr.create,framebufferCube:Xr.createCube,vao:Ln.createVAO,attributes:vr,frame:$o,on:uu,limits:xr,hasExtension:function(ka){return xr.extensions.indexOf(ka.toLowerCase())>=0},read:qn,destroy:ti,_gl:Nt,_refresh:Jo,poll:function(){su(),sn&&sn.update()},now:ia,stats:Yr});return ke.onDone(null,wi),wi}return lh})},fdMe:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,Z){var z=Z.callback;return z&&(m.dataArray=m.dataArray.map(z)),m}},fo6e:function(Le,E){var i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function T(m){return i.test(m)}Le.exports=T},g4R6:function(Le,E){function i(T,m,Z){return T===T&&(Z!==void 0&&(T=T<=Z?T:Z),m!==void 0&&(T=T>=m?T:m)),T}Le.exports=i},gFfm:function(Le,E){function i(T,m){for(var Z=-1,z=T==null?0:T.length;++Z<z&&!(m(T[Z],Z,T)===!1););return T}Le.exports=i},gMG2:function(Le,E,i){"use strict";i.d(E,"a",function(){return xt});var T={},m={},Z=34,z=10,o=13;function W(_t){return new Function("d","return {"+_t.map(function(Ie,De){return JSON.stringify(Ie)+": d["+De+'] || ""'}).join(",")+"}")}function D(_t,Ie){var De=W(_t);return function(ze,at){return Ie(De(ze),at,_t)}}function Y(_t){var Ie=Object.create(null),De=[];return _t.forEach(function(ze){for(var at in ze)at in Ie||De.push(Ie[at]=at)}),De}function q(_t,Ie){var De=_t+"",ze=De.length;return ze<Ie?new Array(Ie-ze+1).join(0)+De:De}function he(_t){return _t<0?"-"+q(-_t,6):_t>9999?"+"+q(_t,6):q(_t,4)}function X(_t){var Ie=_t.getUTCHours(),De=_t.getUTCMinutes(),ze=_t.getUTCSeconds(),at=_t.getUTCMilliseconds();return isNaN(_t)?"Invalid Date":he(_t.getUTCFullYear(),4)+"-"+q(_t.getUTCMonth()+1,2)+"-"+q(_t.getUTCDate(),2)+(at?"T"+q(Ie,2)+":"+q(De,2)+":"+q(ze,2)+"."+q(at,3)+"Z":ze?"T"+q(Ie,2)+":"+q(De,2)+":"+q(ze,2)+"Z":De||Ie?"T"+q(Ie,2)+":"+q(De,2)+"Z":"")}var je=function(_t){var Ie=new RegExp('["'+_t+`
\r]`),De=_t.charCodeAt(0);function ze($,G){var Ae,xe,Se=at($,function(ve,et){if(Ae)return Ae(ve,et-1);xe=ve,Ae=G?D(ve,G):W(ve)});return Se.columns=xe||[],Se}function at($,G){var Ae=[],xe=$.length,Se=0,ve=0,et,Yt=xe<=0,At=!1;$.charCodeAt(xe-1)===z&&--xe,$.charCodeAt(xe-1)===o&&--xe;function ye(){if(Yt)return m;if(At)return At=!1,T;var Ue,st=Se,Me;if($.charCodeAt(st)===Z){for(;Se++<xe&&$.charCodeAt(Se)!==Z||$.charCodeAt(++Se)===Z;);return(Ue=Se)>=xe?Yt=!0:(Me=$.charCodeAt(Se++))===z?At=!0:Me===o&&(At=!0,$.charCodeAt(Se)===z&&++Se),$.slice(st+1,Ue-1).replace(/""/g,'"')}for(;Se<xe;){if((Me=$.charCodeAt(Ue=Se++))===z)At=!0;else if(Me===o)At=!0,$.charCodeAt(Se)===z&&++Se;else if(Me!==De)continue;return $.slice(st,Ue)}return Yt=!0,$.slice(st,xe)}for(;(et=ye())!==m;){for(var be=[];et!==T&&et!==m;)be.push(et),et=ye();if(G&&(be=G(be,ve++))==null)continue;Ae.push(be)}return Ae}function Pe($,G){return $.map(function(Ae){return G.map(function(xe){return ne(Ae[xe])}).join(_t)})}function ot($,G){return G==null&&(G=Y($)),[G.map(ne).join(_t)].concat(Pe($,G)).join(`
`)}function Bt($,G){return G==null&&(G=Y($)),Pe($,G).join(`
`)}function Wt($){return $.map(sr).join(`
`)}function sr($){return $.map(ne).join(_t)}function ne($){return $==null?"":$ instanceof Date?X($):Ie.test($+="")?'"'+$.replace(/"/g,'""')+'"':$}return{parse:ze,parseRows:at,format:ot,formatBody:Bt,formatRows:Wt,formatRow:sr,formatValue:ne}},Ge=je(","),ge=Ge.parse,Ce=Ge.parseRows,ht=Ge.format,Ne=Ge.formatBody,Et=Ge.formatRows,He=Ge.formatRow,mt=Ge.formatValue,Ye=i("5zYK");function xt(_t,Ie){var De=ge(_t);return Object(Ye.a)(De,Ie)}},gQMU:function(Le,E,i){var T=i("0ZTe"),m=T("toUpperCase");Le.exports=m},gzZq:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),Z=i("D9lx"),z=i("LKzl"),o=function(){function W(D){this._binding=D}return W.prototype.to=function(D){return this._binding.type=m.BindingTypeEnum.Instance,this._binding.implementationType=D,new Z.BindingInWhenOnSyntax(this._binding)},W.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+T.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},W.prototype.toConstantValue=function(D){return this._binding.type=m.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toDynamicValue=function(D){return this._binding.type=m.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new Z.BindingInWhenOnSyntax(this._binding)},W.prototype.toConstructor=function(D){return this._binding.type=m.BindingTypeEnum.Constructor,this._binding.implementationType=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(T.INVALID_FUNCTION_BINDING);var Y=this.toConstantValue(D);return this._binding.type=m.BindingTypeEnum.Function,Y},W.prototype.toAutoFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=function(Y){var q=function(){return Y.container.get(D)};return q},new z.BindingWhenOnSyntax(this._binding)},W.prototype.toProvider=function(D){return this._binding.type=m.BindingTypeEnum.Provider,this._binding.provider=D,new z.BindingWhenOnSyntax(this._binding)},W.prototype.toService=function(D){this.toDynamicValue(function(Y){return Y.container.get(D)})},W}();E.BindingToSyntax=o},h1nZ:function(Le,E,i){"use strict";var T=i("fX6N");i.d(E,"container",function(){return T.c}),i.d(E,"createSceneContainer",function(){return T.b}),i.d(E,"createLayerContainer",function(){return T.a}),i.d(E,"lazyInject",function(){return T.d});var m=i("+em5"),Z=i("bB6j");i.d(E,"TYPES",function(){return Z.a});var z=i("8/Fi"),o=i("PUg6");i.d(E,"BlendType",function(){return o.a});var W=i("cZlC");i.d(E,"AttributeType",function(){return W.a}),i.d(E,"ScaleTypes",function(){return W.b}),i.d(E,"StyleScaleType",function(){return W.c});var D=i("O1je"),Y=i.n(D);i.o(D,"CameraUniform")&&i.d(E,"CameraUniform",function(){return D.CameraUniform}),i.o(D,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return D.CityBuildingLayer}),i.o(D,"Control")&&i.d(E,"Control",function(){return D.Control}),i.o(D,"CoordinateSystem")&&i.d(E,"CoordinateSystem",function(){return D.CoordinateSystem}),i.o(D,"CoordinateUniform")&&i.d(E,"CoordinateUniform",function(){return D.CoordinateUniform}),i.o(D,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return D.HeatmapLayer}),i.o(D,"ImageLayer")&&i.d(E,"ImageLayer",function(){return D.ImageLayer}),i.o(D,"LineLayer")&&i.d(E,"LineLayer",function(){return D.LineLayer}),i.o(D,"Logo")&&i.d(E,"Logo",function(){return D.Logo}),i.o(D,"MapServiceEvent")&&i.d(E,"MapServiceEvent",function(){return D.MapServiceEvent}),i.o(D,"Marker")&&i.d(E,"Marker",function(){return D.Marker}),i.o(D,"PointLayer")&&i.d(E,"PointLayer",function(){return D.PointLayer}),i.o(D,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return D.PolygonLayer}),i.o(D,"Popup")&&i.d(E,"Popup",function(){return D.Popup}),i.o(D,"PositionType")&&i.d(E,"PositionType",function(){return D.PositionType}),i.o(D,"RasterLayer")&&i.d(E,"RasterLayer",function(){return D.RasterLayer}),i.o(D,"Scale")&&i.d(E,"Scale",function(){return D.Scale}),i.o(D,"Scene")&&i.d(E,"Scene",function(){return D.Scene}),i.o(D,"SceneEventList")&&i.d(E,"SceneEventList",function(){return D.SceneEventList}),i.o(D,"Zoom")&&i.d(E,"Zoom",function(){return D.Zoom}),i.o(D,"gl")&&i.d(E,"gl",function(){return D.gl});var q=i("L56e");i.d(E,"MapServiceEvent",function(){return q.a});var he=i("HthE");i.d(E,"CoordinateSystem",function(){return he.a}),i.d(E,"CoordinateUniform",function(){return he.b});var X=i("/33/"),je=i.n(X);i.o(X,"CameraUniform")&&i.d(E,"CameraUniform",function(){return X.CameraUniform}),i.o(X,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return X.CityBuildingLayer}),i.o(X,"Control")&&i.d(E,"Control",function(){return X.Control}),i.o(X,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return X.HeatmapLayer}),i.o(X,"ImageLayer")&&i.d(E,"ImageLayer",function(){return X.ImageLayer}),i.o(X,"LineLayer")&&i.d(E,"LineLayer",function(){return X.LineLayer}),i.o(X,"Logo")&&i.d(E,"Logo",function(){return X.Logo}),i.o(X,"Marker")&&i.d(E,"Marker",function(){return X.Marker}),i.o(X,"PointLayer")&&i.d(E,"PointLayer",function(){return X.PointLayer}),i.o(X,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return X.PolygonLayer}),i.o(X,"Popup")&&i.d(E,"Popup",function(){return X.Popup}),i.o(X,"PositionType")&&i.d(E,"PositionType",function(){return X.PositionType}),i.o(X,"RasterLayer")&&i.d(E,"RasterLayer",function(){return X.RasterLayer}),i.o(X,"Scale")&&i.d(E,"Scale",function(){return X.Scale}),i.o(X,"Scene")&&i.d(E,"Scene",function(){return X.Scene}),i.o(X,"SceneEventList")&&i.d(E,"SceneEventList",function(){return X.SceneEventList}),i.o(X,"Zoom")&&i.d(E,"Zoom",function(){return X.Zoom}),i.o(X,"gl")&&i.d(E,"gl",function(){return X.gl});var Ge=i("EfZ0");i.d(E,"CameraUniform",function(){return Ge.a});var ge=i("riiI"),Ce=i.n(ge);i.o(ge,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),i.o(ge,"Control")&&i.d(E,"Control",function(){return ge.Control}),i.o(ge,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ge.HeatmapLayer}),i.o(ge,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ge.ImageLayer}),i.o(ge,"LineLayer")&&i.d(E,"LineLayer",function(){return ge.LineLayer}),i.o(ge,"Logo")&&i.d(E,"Logo",function(){return ge.Logo}),i.o(ge,"Marker")&&i.d(E,"Marker",function(){return ge.Marker}),i.o(ge,"PointLayer")&&i.d(E,"PointLayer",function(){return ge.PointLayer}),i.o(ge,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ge.PolygonLayer}),i.o(ge,"Popup")&&i.d(E,"Popup",function(){return ge.Popup}),i.o(ge,"PositionType")&&i.d(E,"PositionType",function(){return ge.PositionType}),i.o(ge,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ge.RasterLayer}),i.o(ge,"Scale")&&i.d(E,"Scale",function(){return ge.Scale}),i.o(ge,"Scene")&&i.d(E,"Scene",function(){return ge.Scene}),i.o(ge,"SceneEventList")&&i.d(E,"SceneEventList",function(){return ge.SceneEventList}),i.o(ge,"Zoom")&&i.d(E,"Zoom",function(){return ge.Zoom}),i.o(ge,"gl")&&i.d(E,"gl",function(){return ge.gl});var ht=i("eg+a");i.d(E,"SceneEventList",function(){return ht.a});var Ne=i("bYl4"),Et=i.n(Ne);i.o(Ne,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ne.CityBuildingLayer}),i.o(Ne,"Control")&&i.d(E,"Control",function(){return Ne.Control}),i.o(Ne,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ne.HeatmapLayer}),i.o(Ne,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ne.ImageLayer}),i.o(Ne,"LineLayer")&&i.d(E,"LineLayer",function(){return Ne.LineLayer}),i.o(Ne,"Logo")&&i.d(E,"Logo",function(){return Ne.Logo}),i.o(Ne,"Marker")&&i.d(E,"Marker",function(){return Ne.Marker}),i.o(Ne,"PointLayer")&&i.d(E,"PointLayer",function(){return Ne.PointLayer}),i.o(Ne,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ne.PolygonLayer}),i.o(Ne,"Popup")&&i.d(E,"Popup",function(){return Ne.Popup}),i.o(Ne,"PositionType")&&i.d(E,"PositionType",function(){return Ne.PositionType}),i.o(Ne,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ne.RasterLayer}),i.o(Ne,"Scale")&&i.d(E,"Scale",function(){return Ne.Scale}),i.o(Ne,"Scene")&&i.d(E,"Scene",function(){return Ne.Scene}),i.o(Ne,"Zoom")&&i.d(E,"Zoom",function(){return Ne.Zoom}),i.o(Ne,"gl")&&i.d(E,"gl",function(){return Ne.gl});var He=i("FI6e"),mt=i.n(He);i.o(He,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return He.CityBuildingLayer}),i.o(He,"Control")&&i.d(E,"Control",function(){return He.Control}),i.o(He,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return He.HeatmapLayer}),i.o(He,"ImageLayer")&&i.d(E,"ImageLayer",function(){return He.ImageLayer}),i.o(He,"LineLayer")&&i.d(E,"LineLayer",function(){return He.LineLayer}),i.o(He,"Logo")&&i.d(E,"Logo",function(){return He.Logo}),i.o(He,"Marker")&&i.d(E,"Marker",function(){return He.Marker}),i.o(He,"PointLayer")&&i.d(E,"PointLayer",function(){return He.PointLayer}),i.o(He,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return He.PolygonLayer}),i.o(He,"Popup")&&i.d(E,"Popup",function(){return He.Popup}),i.o(He,"PositionType")&&i.d(E,"PositionType",function(){return He.PositionType}),i.o(He,"RasterLayer")&&i.d(E,"RasterLayer",function(){return He.RasterLayer}),i.o(He,"Scale")&&i.d(E,"Scale",function(){return He.Scale}),i.o(He,"Scene")&&i.d(E,"Scene",function(){return He.Scene}),i.o(He,"Zoom")&&i.d(E,"Zoom",function(){return He.Zoom}),i.o(He,"gl")&&i.d(E,"gl",function(){return He.gl});var Ye=i("D+ow"),xt=i.n(Ye);i.o(Ye,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ye.CityBuildingLayer}),i.o(Ye,"Control")&&i.d(E,"Control",function(){return Ye.Control}),i.o(Ye,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ye.HeatmapLayer}),i.o(Ye,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ye.ImageLayer}),i.o(Ye,"LineLayer")&&i.d(E,"LineLayer",function(){return Ye.LineLayer}),i.o(Ye,"Logo")&&i.d(E,"Logo",function(){return Ye.Logo}),i.o(Ye,"Marker")&&i.d(E,"Marker",function(){return Ye.Marker}),i.o(Ye,"PointLayer")&&i.d(E,"PointLayer",function(){return Ye.PointLayer}),i.o(Ye,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ye.PolygonLayer}),i.o(Ye,"Popup")&&i.d(E,"Popup",function(){return Ye.Popup}),i.o(Ye,"PositionType")&&i.d(E,"PositionType",function(){return Ye.PositionType}),i.o(Ye,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ye.RasterLayer}),i.o(Ye,"Scale")&&i.d(E,"Scale",function(){return Ye.Scale}),i.o(Ye,"Scene")&&i.d(E,"Scene",function(){return Ye.Scene}),i.o(Ye,"Zoom")&&i.d(E,"Zoom",function(){return Ye.Zoom}),i.o(Ye,"gl")&&i.d(E,"gl",function(){return Ye.gl});var _t=i("AFH1");i.d(E,"PositionType",function(){return _t.a});var Ie=i("8uyu"),De=i.n(Ie);i.o(Ie,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ie.CityBuildingLayer}),i.o(Ie,"Control")&&i.d(E,"Control",function(){return Ie.Control}),i.o(Ie,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ie.HeatmapLayer}),i.o(Ie,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ie.ImageLayer}),i.o(Ie,"LineLayer")&&i.d(E,"LineLayer",function(){return Ie.LineLayer}),i.o(Ie,"Logo")&&i.d(E,"Logo",function(){return Ie.Logo}),i.o(Ie,"Marker")&&i.d(E,"Marker",function(){return Ie.Marker}),i.o(Ie,"PointLayer")&&i.d(E,"PointLayer",function(){return Ie.PointLayer}),i.o(Ie,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ie.PolygonLayer}),i.o(Ie,"Popup")&&i.d(E,"Popup",function(){return Ie.Popup}),i.o(Ie,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ie.RasterLayer}),i.o(Ie,"Scale")&&i.d(E,"Scale",function(){return Ie.Scale}),i.o(Ie,"Scene")&&i.d(E,"Scene",function(){return Ie.Scene}),i.o(Ie,"Zoom")&&i.d(E,"Zoom",function(){return Ie.Zoom}),i.o(Ie,"gl")&&i.d(E,"gl",function(){return Ie.gl});var ze=i("J7lC"),at=i.n(ze);i.o(ze,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ze.CityBuildingLayer}),i.o(ze,"Control")&&i.d(E,"Control",function(){return ze.Control}),i.o(ze,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ze.HeatmapLayer}),i.o(ze,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ze.ImageLayer}),i.o(ze,"LineLayer")&&i.d(E,"LineLayer",function(){return ze.LineLayer}),i.o(ze,"Logo")&&i.d(E,"Logo",function(){return ze.Logo}),i.o(ze,"Marker")&&i.d(E,"Marker",function(){return ze.Marker}),i.o(ze,"PointLayer")&&i.d(E,"PointLayer",function(){return ze.PointLayer}),i.o(ze,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ze.PolygonLayer}),i.o(ze,"Popup")&&i.d(E,"Popup",function(){return ze.Popup}),i.o(ze,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ze.RasterLayer}),i.o(ze,"Scale")&&i.d(E,"Scale",function(){return ze.Scale}),i.o(ze,"Scene")&&i.d(E,"Scene",function(){return ze.Scene}),i.o(ze,"Zoom")&&i.d(E,"Zoom",function(){return ze.Zoom}),i.o(ze,"gl")&&i.d(E,"gl",function(){return ze.gl});var Pe=i("QGbF"),ot=i.n(Pe);i.o(Pe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Pe.CityBuildingLayer}),i.o(Pe,"Control")&&i.d(E,"Control",function(){return Pe.Control}),i.o(Pe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Pe.HeatmapLayer}),i.o(Pe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Pe.ImageLayer}),i.o(Pe,"LineLayer")&&i.d(E,"LineLayer",function(){return Pe.LineLayer}),i.o(Pe,"Logo")&&i.d(E,"Logo",function(){return Pe.Logo}),i.o(Pe,"Marker")&&i.d(E,"Marker",function(){return Pe.Marker}),i.o(Pe,"PointLayer")&&i.d(E,"PointLayer",function(){return Pe.PointLayer}),i.o(Pe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Pe.PolygonLayer}),i.o(Pe,"Popup")&&i.d(E,"Popup",function(){return Pe.Popup}),i.o(Pe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Pe.RasterLayer}),i.o(Pe,"Scale")&&i.d(E,"Scale",function(){return Pe.Scale}),i.o(Pe,"Scene")&&i.d(E,"Scene",function(){return Pe.Scene}),i.o(Pe,"Zoom")&&i.d(E,"Zoom",function(){return Pe.Zoom}),i.o(Pe,"gl")&&i.d(E,"gl",function(){return Pe.gl});var Bt=i("V1cb"),Wt=i("bzyH"),sr=i.n(Wt);i.o(Wt,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Wt.CityBuildingLayer}),i.o(Wt,"Control")&&i.d(E,"Control",function(){return Wt.Control}),i.o(Wt,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Wt.HeatmapLayer}),i.o(Wt,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Wt.ImageLayer}),i.o(Wt,"LineLayer")&&i.d(E,"LineLayer",function(){return Wt.LineLayer}),i.o(Wt,"Logo")&&i.d(E,"Logo",function(){return Wt.Logo}),i.o(Wt,"Marker")&&i.d(E,"Marker",function(){return Wt.Marker}),i.o(Wt,"PointLayer")&&i.d(E,"PointLayer",function(){return Wt.PointLayer}),i.o(Wt,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Wt.PolygonLayer}),i.o(Wt,"Popup")&&i.d(E,"Popup",function(){return Wt.Popup}),i.o(Wt,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Wt.RasterLayer}),i.o(Wt,"Scale")&&i.d(E,"Scale",function(){return Wt.Scale}),i.o(Wt,"Scene")&&i.d(E,"Scene",function(){return Wt.Scene}),i.o(Wt,"Zoom")&&i.d(E,"Zoom",function(){return Wt.Zoom}),i.o(Wt,"gl")&&i.d(E,"gl",function(){return Wt.gl});var ne=i("0eqD"),$=i.n(ne);i.o(ne,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ne.CityBuildingLayer}),i.o(ne,"Control")&&i.d(E,"Control",function(){return ne.Control}),i.o(ne,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ne.HeatmapLayer}),i.o(ne,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ne.ImageLayer}),i.o(ne,"LineLayer")&&i.d(E,"LineLayer",function(){return ne.LineLayer}),i.o(ne,"Logo")&&i.d(E,"Logo",function(){return ne.Logo}),i.o(ne,"Marker")&&i.d(E,"Marker",function(){return ne.Marker}),i.o(ne,"PointLayer")&&i.d(E,"PointLayer",function(){return ne.PointLayer}),i.o(ne,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ne.PolygonLayer}),i.o(ne,"Popup")&&i.d(E,"Popup",function(){return ne.Popup}),i.o(ne,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ne.RasterLayer}),i.o(ne,"Scale")&&i.d(E,"Scale",function(){return ne.Scale}),i.o(ne,"Scene")&&i.d(E,"Scene",function(){return ne.Scene}),i.o(ne,"Zoom")&&i.d(E,"Zoom",function(){return ne.Zoom}),i.o(ne,"gl")&&i.d(E,"gl",function(){return ne.gl});var G=i("/Uc5"),Ae=i.n(G);i.o(G,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return G.CityBuildingLayer}),i.o(G,"Control")&&i.d(E,"Control",function(){return G.Control}),i.o(G,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return G.HeatmapLayer}),i.o(G,"ImageLayer")&&i.d(E,"ImageLayer",function(){return G.ImageLayer}),i.o(G,"LineLayer")&&i.d(E,"LineLayer",function(){return G.LineLayer}),i.o(G,"Logo")&&i.d(E,"Logo",function(){return G.Logo}),i.o(G,"Marker")&&i.d(E,"Marker",function(){return G.Marker}),i.o(G,"PointLayer")&&i.d(E,"PointLayer",function(){return G.PointLayer}),i.o(G,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return G.PolygonLayer}),i.o(G,"Popup")&&i.d(E,"Popup",function(){return G.Popup}),i.o(G,"RasterLayer")&&i.d(E,"RasterLayer",function(){return G.RasterLayer}),i.o(G,"Scale")&&i.d(E,"Scale",function(){return G.Scale}),i.o(G,"Scene")&&i.d(E,"Scene",function(){return G.Scene}),i.o(G,"Zoom")&&i.d(E,"Zoom",function(){return G.Zoom}),i.o(G,"gl")&&i.d(E,"gl",function(){return G.gl});var xe=i("RMtq"),Se=i.n(xe);i.o(xe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return xe.CityBuildingLayer}),i.o(xe,"Control")&&i.d(E,"Control",function(){return xe.Control}),i.o(xe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return xe.HeatmapLayer}),i.o(xe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return xe.ImageLayer}),i.o(xe,"LineLayer")&&i.d(E,"LineLayer",function(){return xe.LineLayer}),i.o(xe,"Logo")&&i.d(E,"Logo",function(){return xe.Logo}),i.o(xe,"Marker")&&i.d(E,"Marker",function(){return xe.Marker}),i.o(xe,"PointLayer")&&i.d(E,"PointLayer",function(){return xe.PointLayer}),i.o(xe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return xe.PolygonLayer}),i.o(xe,"Popup")&&i.d(E,"Popup",function(){return xe.Popup}),i.o(xe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return xe.RasterLayer}),i.o(xe,"Scale")&&i.d(E,"Scale",function(){return xe.Scale}),i.o(xe,"Scene")&&i.d(E,"Scene",function(){return xe.Scene}),i.o(xe,"Zoom")&&i.d(E,"Zoom",function(){return xe.Zoom}),i.o(xe,"gl")&&i.d(E,"gl",function(){return xe.gl});var ve=i("1jvM"),et=i.n(ve);i.o(ve,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ve.CityBuildingLayer}),i.o(ve,"Control")&&i.d(E,"Control",function(){return ve.Control}),i.o(ve,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ve.HeatmapLayer}),i.o(ve,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ve.ImageLayer}),i.o(ve,"LineLayer")&&i.d(E,"LineLayer",function(){return ve.LineLayer}),i.o(ve,"Logo")&&i.d(E,"Logo",function(){return ve.Logo}),i.o(ve,"Marker")&&i.d(E,"Marker",function(){return ve.Marker}),i.o(ve,"PointLayer")&&i.d(E,"PointLayer",function(){return ve.PointLayer}),i.o(ve,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ve.PolygonLayer}),i.o(ve,"Popup")&&i.d(E,"Popup",function(){return ve.Popup}),i.o(ve,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ve.RasterLayer}),i.o(ve,"Scale")&&i.d(E,"Scale",function(){return ve.Scale}),i.o(ve,"Scene")&&i.d(E,"Scene",function(){return ve.Scene}),i.o(ve,"Zoom")&&i.d(E,"Zoom",function(){return ve.Zoom}),i.o(ve,"gl")&&i.d(E,"gl",function(){return ve.gl});var Yt=i("bPkA"),At=i("PSsN"),ye=i.n(At);i.o(At,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return At.CityBuildingLayer}),i.o(At,"Control")&&i.d(E,"Control",function(){return At.Control}),i.o(At,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return At.HeatmapLayer}),i.o(At,"ImageLayer")&&i.d(E,"ImageLayer",function(){return At.ImageLayer}),i.o(At,"LineLayer")&&i.d(E,"LineLayer",function(){return At.LineLayer}),i.o(At,"Logo")&&i.d(E,"Logo",function(){return At.Logo}),i.o(At,"Marker")&&i.d(E,"Marker",function(){return At.Marker}),i.o(At,"PointLayer")&&i.d(E,"PointLayer",function(){return At.PointLayer}),i.o(At,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return At.PolygonLayer}),i.o(At,"Popup")&&i.d(E,"Popup",function(){return At.Popup}),i.o(At,"RasterLayer")&&i.d(E,"RasterLayer",function(){return At.RasterLayer}),i.o(At,"Scale")&&i.d(E,"Scale",function(){return At.Scale}),i.o(At,"Scene")&&i.d(E,"Scene",function(){return At.Scene}),i.o(At,"Zoom")&&i.d(E,"Zoom",function(){return At.Zoom}),i.o(At,"gl")&&i.d(E,"gl",function(){return At.gl});var be=i("6NqC"),Ue=i.n(be);i.o(be,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return be.CityBuildingLayer}),i.o(be,"Control")&&i.d(E,"Control",function(){return be.Control}),i.o(be,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return be.HeatmapLayer}),i.o(be,"ImageLayer")&&i.d(E,"ImageLayer",function(){return be.ImageLayer}),i.o(be,"LineLayer")&&i.d(E,"LineLayer",function(){return be.LineLayer}),i.o(be,"Logo")&&i.d(E,"Logo",function(){return be.Logo}),i.o(be,"Marker")&&i.d(E,"Marker",function(){return be.Marker}),i.o(be,"PointLayer")&&i.d(E,"PointLayer",function(){return be.PointLayer}),i.o(be,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return be.PolygonLayer}),i.o(be,"Popup")&&i.d(E,"Popup",function(){return be.Popup}),i.o(be,"RasterLayer")&&i.d(E,"RasterLayer",function(){return be.RasterLayer}),i.o(be,"Scale")&&i.d(E,"Scale",function(){return be.Scale}),i.o(be,"Scene")&&i.d(E,"Scene",function(){return be.Scene}),i.o(be,"Zoom")&&i.d(E,"Zoom",function(){return be.Zoom}),i.o(be,"gl")&&i.d(E,"gl",function(){return be.gl});var st=i("bTtR"),Me=i.n(st);i.o(st,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return st.CityBuildingLayer}),i.o(st,"Control")&&i.d(E,"Control",function(){return st.Control}),i.o(st,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return st.HeatmapLayer}),i.o(st,"ImageLayer")&&i.d(E,"ImageLayer",function(){return st.ImageLayer}),i.o(st,"LineLayer")&&i.d(E,"LineLayer",function(){return st.LineLayer}),i.o(st,"Logo")&&i.d(E,"Logo",function(){return st.Logo}),i.o(st,"Marker")&&i.d(E,"Marker",function(){return st.Marker}),i.o(st,"PointLayer")&&i.d(E,"PointLayer",function(){return st.PointLayer}),i.o(st,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return st.PolygonLayer}),i.o(st,"Popup")&&i.d(E,"Popup",function(){return st.Popup}),i.o(st,"RasterLayer")&&i.d(E,"RasterLayer",function(){return st.RasterLayer}),i.o(st,"Scale")&&i.d(E,"Scale",function(){return st.Scale}),i.o(st,"Scene")&&i.d(E,"Scene",function(){return st.Scene}),i.o(st,"Zoom")&&i.d(E,"Zoom",function(){return st.Zoom}),i.o(st,"gl")&&i.d(E,"gl",function(){return st.gl});var ft=i("o+pz");i.d(E,"gl",function(){return ft.a})},h7MG:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("doU7"),m=i("MON2"),Z=i("FV85"),z=i("xfSm"),o=i("qK8v"),W=i("ujMp"),D=i("oy+k"),Y=i("GXnB"),q=i("yMAV"),he=i("fbrv"),X=i("xiII"),je=i("dX1H");function Ge(Ye){return Ye._bindingDictionary}E.getBindingDictionary=Ge;function ge(Ye,xt,_t,Ie,De,ze){var at=Ye?z.MULTI_INJECT_TAG:z.INJECT_TAG,Pe=new Y.Metadata(at,_t),ot=new je.Target(xt,Ie,_t,Pe);if(De!==void 0){var Bt=new Y.Metadata(De,ze);ot.metadata.push(Bt)}return ot}function Ce(Ye,xt,_t,Ie,De){var ze=Et(_t.container,De.serviceIdentifier),at=[];return ze.length===T.BindingCount.NoBindingsAvailable&&_t.container.options.autoBindInjectable&&typeof De.serviceIdentifier=="function"&&Ye.getConstructorMetadata(De.serviceIdentifier).compilerGeneratedMetadata&&(_t.container.bind(De.serviceIdentifier).toSelf(),ze=Et(_t.container,De.serviceIdentifier)),xt?at=ze:at=ze.filter(function(Pe){var ot=new X.Request(Pe.serviceIdentifier,_t,Ie,Pe,De);return Pe.constraint(ot)}),ht(De.serviceIdentifier,at,De,_t.container),at}function ht(Ye,xt,_t,Ie){switch(xt.length){case T.BindingCount.NoBindingsAvailable:if(_t.isOptional())return xt;var De=W.getServiceIdentifierAsString(Ye),ze=m.NOT_REGISTERED;throw ze+=W.listMetadataForTarget(De,_t),ze+=W.listRegisteredBindingsForServiceIdentifier(Ie,De,Et),new Error(ze);case T.BindingCount.OnlyOneBindingAvailable:if(!_t.isArray())return xt;case T.BindingCount.MultipleBindingsAvailable:default:if(_t.isArray())return xt;var De=W.getServiceIdentifierAsString(Ye),ze=m.AMBIGUOUS_MATCH+" "+De;throw ze+=W.listRegisteredBindingsForServiceIdentifier(Ie,De,Et),new Error(ze)}}function Ne(Ye,xt,_t,Ie,De,ze){var at,Pe;if(De===null){at=Ce(Ye,xt,Ie,null,ze),Pe=new X.Request(_t,Ie,null,at,ze);var ot=new q.Plan(Ie,Pe);Ie.addPlan(ot)}else at=Ce(Ye,xt,Ie,De,ze),Pe=De.addChildRequest(ze.serviceIdentifier,at,ze);at.forEach(function(Bt){var Wt=null;if(ze.isArray())Wt=Pe.addChildRequest(Bt.serviceIdentifier,Bt,ze);else{if(Bt.cache)return;Wt=Pe}if(Bt.type===Z.BindingTypeEnum.Instance&&Bt.implementationType!==null){var sr=he.getDependencies(Ye,Bt.implementationType);if(!Ie.container.options.skipBaseClassChecks){var ne=he.getBaseClassDependencyCount(Ye,Bt.implementationType);if(sr.length<ne){var $=m.ARGUMENTS_LENGTH_MISMATCH(he.getFunctionName(Bt.implementationType));throw new Error($)}}sr.forEach(function(G){Ne(Ye,!1,G.serviceIdentifier,Ie,Wt,G)})}})}function Et(Ye,xt){var _t=[],Ie=Ge(Ye);return Ie.hasKey(xt)?_t=Ie.get(xt):Ye.parent!==null&&(_t=Et(Ye.parent,xt)),_t}function He(Ye,xt,_t,Ie,De,ze,at,Pe){Pe===void 0&&(Pe=!1);var ot=new D.Context(xt),Bt=ge(_t,Ie,De,"",ze,at);try{return Ne(Ye,Pe,De,ot,null,Bt),ot}catch(Wt){throw o.isStackOverflowExeption(Wt)&&(ot.plan&&W.circularDependencyToException(ot.plan.rootRequest)),Wt}}E.plan=He;function mt(Ye,xt,_t,Ie){var De=new je.Target(Z.TargetTypeEnum.Variable,"",xt,new Y.Metadata(_t,Ie)),ze=new D.Context(Ye),at=new X.Request(xt,ze,null,[],De);return at}E.createMockRequest=mt},heNW:function(Le,E){function i(T,m,Z){switch(Z.length){case 0:return T.call(m);case 1:return T.call(m,Z[0]);case 2:return T.call(m,Z[0],Z[1]);case 3:return T.call(m,Z[0],Z[1],Z[2])}return T.apply(m,Z)}Le.exports=i},hi0z:function(Le,E,i){"use strict";(function(T,m){Le.exports=m()})(this,function(){function T(he){var X=[];return he.AMapUI&&X.push(m(he.AMapUI)),he.Loca&&X.push(Z(he.Loca)),Promise.all(X)}function m(he){return new Promise(function(X,je){var Ge=[];if(he.plugins)for(var ge=0;ge<he.plugins.length;ge+=1)o.AMapUI.plugins.indexOf(he.plugins[ge])==-1&&Ge.push(he.plugins[ge]);if(W.AMapUI===z.failed)je("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(W.AMapUI===z.notload){W.AMapUI=z.loading,o.AMapUI.version=he.version||o.AMapUI.version,ge=o.AMapUI.version;var Ce=document.body||document.head,ht=document.createElement("script");ht.type="text/javascript",ht.src="https://webapi.amap.com/ui/"+ge+"/main.js",ht.onerror=function(Ne){W.AMapUI=z.failed,je("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ht.onload=function(){if(W.AMapUI=z.loaded,Ge.length)window.AMapUI.loadUI(Ge,function(){for(var Ne=0,Et=Ge.length;Ne<Et;Ne++){var He=Ge[Ne].split("/").slice(-1)[0];window.AMapUI[He]=arguments[Ne]}for(X();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(X();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Ce.appendChild(ht)}else W.AMapUI===z.loaded?he.version&&he.version!==o.AMapUI.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ge.length?window.AMapUI.loadUI(Ge,function(){for(var Ne=0,Et=Ge.length;Ne<Et;Ne++){var He=Ge[Ne].split("/").slice(-1)[0];window.AMapUI[He]=arguments[Ne]}X()}):X():he.version&&he.version!==o.AMapUI.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(Ne){Ne?je(Ne):Ge.length?window.AMapUI.loadUI(Ge,function(){for(var Et=0,He=Ge.length;Et<He;Et++){var mt=Ge[Et].split("/").slice(-1)[0];window.AMapUI[mt]=arguments[Et]}X()}):X()})})}function Z(he){return new Promise(function(X,je){if(o.AMap.version.startsWith("2.0"))je("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(W.Loca===z.failed)je("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(W.Loca===z.notload){W.Loca=z.loading,o.Loca.version=he.version||o.Loca.version;var Ge=o.Loca.version,ge=o.key,Ce=document.body||document.head,ht=document.createElement("script");ht.type="text/javascript",ht.src="https://webapi.amap.com/loca?v="+Ge+"&key="+ge,ht.onerror=function(Ne){W.Loca=z.failed,je("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ht.onload=function(){for(W.Loca=z.loaded,X();D.Loca.length;)D.Loca.splice(0,1)[0]()},Ce.appendChild(ht)}else W.Loca===z.loaded?he.version&&he.version!==o.Loca.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):X():he.version&&he.version!==o.Loca.version?je("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(Ne){Ne?je(Ne):je()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var z;(function(he){he.notload="notload",he.loading="loading",he.loaded="loaded",he.failed="failed"})(z||(z={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]},Y=[],q=function(X){typeof X=="function"&&(W.AMap===z.loaded?X(window.AMap):Y.push(X))};return{load:function(X){return new Promise(function(je,Ge){if(W.AMap==z.failed)Ge("");else if(W.AMap==z.notload){var ge=X.key,Ce=X.version,ht=X.plugins;ge?(window.AMap&&location.host!=="lbs.amap.com"&&Ge("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=ge,o.AMap.version=Ce||o.AMap.version,o.AMap.plugins=ht||o.AMap.plugins,W.AMap=z.loading,Ce=document.body||document.head,window.___onAPILoaded=function(Et){if(delete window.___onAPILoaded,Et)W.AMap=z.failed,Ge(Et);else for(W.AMap=z.loaded,T(X).then(function(){je(window.AMap)}).catch(Ge);Y.length;)Y.splice(0,1)[0]()},ht=document.createElement("script"),ht.type="text/javascript",ht.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+ge+"&plugin="+o.AMap.plugins.join(","),ht.onerror=function(Et){W.AMap=z.failed,Ge(Et)},Ce.appendChild(ht)):Ge("\u8BF7\u586B\u5199key")}else if(W.AMap==z.loaded)if(X.key&&X.key!==o.key)Ge("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(X.version&&X.version!==o.AMap.version)Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ge=[],X.plugins)for(Ce=0;Ce<X.plugins.length;Ce+=1)o.AMap.plugins.indexOf(X.plugins[Ce])==-1&&ge.push(X.plugins[Ce]);ge.length?window.AMap.plugin(ge,function(){T(X).then(function(){je(window.AMap)}).catch(Ge)}):T(X).then(function(){je(window.AMap)}).catch(Ge)}else if(X.key&&X.key!==o.key)Ge("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(X.version&&X.version!==o.AMap.version)Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Ne=[];if(X.plugins)for(Ce=0;Ce<X.plugins.length;Ce+=1)o.AMap.plugins.indexOf(X.plugins[Ce])==-1&&Ne.push(X.plugins[Ce]);q(function(){Ne.length?window.AMap.plugin(Ne,function(){T(X).then(function(){je(window.AMap)}).catch(Ge)}):T(X).then(function(){je(window.AMap)}).catch(Ge)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},W={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Le,E,i){var T=i("O0oS");function m(Z,z,o){z=="__proto__"&&T?T(Z,z,{configurable:!0,enumerable:!0,value:o,writable:!0}):Z[z]=o}Le.exports=m},iWIM:function(Le,E,i){var T=i("n3AX");function m(Z,z,o){return typeof Reflect!="undefined"&&Reflect.get?Le.exports=m=Reflect.get:Le.exports=m=function(D,Y,q){var he=T(D,Y);if(!he)return;var X=Object.getOwnPropertyDescriptor(he,Y);return X.get?X.get.call(q):X.value},m(Z,z,o||Z)}Le.exports=m},iegG:function(Le,E){function i(T){var m=T.target||T.srcElement;m.__resizeRAF__&&cancelAnimationFrame(m.__resizeRAF__),m.__resizeRAF__=requestAnimationFrame(function(){var Z=m.__resizeTrigger__,z=Z&&Z.__resizeListeners__;z&&z.forEach(function(o){o.call(Z,T)})})}var E=function(m,Z){var z=this,o=z.document,W,D=o.attachEvent;typeof navigator!="undefined"&&(W=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function Y(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",i)}if(!m.__resizeListeners__)if(m.__resizeListeners__=[],D)m.__resizeTrigger__=m,m.attachEvent("onresize",i);else{getComputedStyle(m).position==="static"&&(m.style.position="relative");var q=m.__resizeTrigger__=o.createElement("object");q.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),q.setAttribute("class","resize-sensor"),q.setAttribute("tabindex","-1"),q.__resizeElement__=m,q.onload=Y,q.type="text/html",W&&m.appendChild(q),q.data="about:blank",W||m.appendChild(q)}m.__resizeListeners__.push(Z)};Le.exports=typeof window=="undefined"?E:E.bind(window),Le.exports.unbind=function(T,m){var Z=document.attachEvent,z=T.__resizeListeners__||[];if(m){var o=z.indexOf(m);o!==-1&&z.splice(o,1)}else z=T.__resizeListeners__=[];if(!z.length){if(Z)T.detachEvent("onresize",i);else if(T.__resizeTrigger__){var W=T.__resizeTrigger__.contentDocument,D=W&&W.defaultView;D&&(D.removeEventListener("resize",i),delete D.__resizeTrigger__),T.__resizeTrigger__=!T.removeChild(T.__resizeTrigger__)}delete T.__resizeListeners__}}},itsj:function(Le,E){function i(T,m){return m==="constructor"&&typeof T[m]=="function"||m=="__proto__"?void 0:T[m]}Le.exports=i},"iz+Y":function(Le,E,i){Le.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(Le,E,i){"use strict";var T=i("cIOH"),m=i.n(T),Z=i("1GLa")},"jIg/":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=i("Ztfv");function z(o){return function(W,D,Y){var q=new m.Metadata(T.MULTI_INJECT_TAG,o);typeof Y=="number"?Z.tagParameter(W,D,Y,q):Z.tagProperty(W,D,q)}}E.multiInject=z},jYQm:function(Le,E,i){"use strict";var T=i("q1tI"),m=i.n(T),Z=Object(T.createContext)({});E.a=Z},jYx5:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=i("Ztfv");function z(){return function(o,W,D){var Y=new m.Metadata(T.OPTIONAL_TAG,!0);typeof D=="number"?Z.tagParameter(o,W,D,Y):Z.tagProperty(o,W,Y)}}E.optional=z},"jbM+":function(Le,E,i){var T=i("R/W3");function m(Z,z){var o=Z==null?0:Z.length;return!!o&&T(Z,z,0)>-1}Le.exports=m},jeLo:function(Le,E,i){var T=i("juv8"),m=i("mTTR");function Z(z){return T(z,m(z))}Le.exports=Z},juv8:function(Le,E,i){var T=i("MrPd"),m=i("hypo");function Z(z,o,W,D){var Y=!W;W||(W={});for(var q=-1,he=o.length;++q<he;){var X=o[q],je=D?D(W[X],z[X],X,W,z):void 0;je===void 0&&(je=z[X]),Y?m(W,X,je):T(W,X,je)}return W}Le.exports=Z},"k5/I":function(Le,E,i){"use strict";i.d(E,"a",function(){return xt}),i.d(E,"b",function(){return Bt}),i.d(E,"e",function(){return ne}),i.d(E,"f",function(){return Ae}),i.d(E,"c",function(){return Yt}),i.d(E,"d",function(){return gt});var T=i("lSNA"),m=i.n(T),Z=i("lwsE"),z=i.n(Z),o=i("W8MJ"),W=i.n(o),D=i("7W2i"),Y=i.n(D),q=i("a1gu"),he=i.n(q),X=i("Nsbk"),je=i.n(X),Ge=i("h1nZ"),ge=i("Hel2"),Ce=i("uhBA");function ht(tt,It){var K=Object.keys(tt);if(Object.getOwnPropertySymbols){var Ze=Object.getOwnPropertySymbols(tt);It&&(Ze=Ze.filter(function(te){return Object.getOwnPropertyDescriptor(tt,te).enumerable})),K.push.apply(K,Ze)}return K}function Ne(tt){for(var It=1;It<arguments.length;It++){var K=arguments[It]!=null?arguments[It]:{};It%2?ht(Object(K),!0).forEach(function(Ze){m()(tt,Ze,K[Ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(K)):ht(Object(K)).forEach(function(Ze){Object.defineProperty(tt,Ze,Object.getOwnPropertyDescriptor(K,Ze))})}return tt}function Et(tt){var It=He();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function He(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var mt;(function(tt){tt.TOPRIGHT="topright",tt.TOPLEFT="topleft",tt.BOTTOMRIGHT="bottomright",tt.BOTTOMLEFT="bottomleft"})(mt||(mt={}));var Ye=0,xt=function(tt){Y()(K,tt);var It=Et(K);function K(Ze){var te;return z()(this,K),te=It.call(this),te.controlOption=void 0,te.container=void 0,te.sceneContainer=void 0,te.mapsService=void 0,te.renderService=void 0,te.layerService=void 0,te.controlService=void 0,te.isShow=void 0,te.controlOption=Ne(Ne({},te.getDefault()),Ze||{}),te}return W()(K,[{key:"getDefault",value:function(){return{position:mt.TOPRIGHT,name:"".concat(Ye++)}}},{key:"setPosition",value:function(te){var Je=this.controlService;return Je&&Je.removeControl(this),this.controlOption.position=te,Je&&Je.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(te){this.mapsService=te.get(Ge.TYPES.IMapService),this.renderService=te.get(Ge.TYPES.IRendererService),this.layerService=te.get(Ge.TYPES.ILayerService),this.controlService=te.get(Ge.TYPES.IControlService),this.sceneContainer=te,this.isShow=!0,this.container=this.onAdd();var Je=this.container,zt=this.controlOption.position,cr=this.controlService.controlCorners[zt];return ge.a.addClass(Je,"l7-control"),zt.indexOf("bottom")!==-1?cr.insertBefore(Je,cr.firstChild):cr.appendChild(Je),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var te=this.container;ge.a.addClass(te,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var te=this.container;ge.a.removeClass(te,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;ge.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(te){if(this.mapsService&&te&&te.screenX>0&&te.screenY>0){var Je=this.mapsService.getContainer();Je!==null&&Je.focus()}}}]),K}(Ce.EventEmitter),_t=i("PJYZ"),Ie=i.n(_t);function De(tt){var It=ze();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function ze(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var at=function(tt){Y()(K,tt);var It=De(K);function K(Ze){var te;return z()(this,K),te=It.call(this,Ze),te.layerControlInputs=void 0,te.layers=void 0,te.lastZIndex=void 0,te.handlingClick=void 0,te.layersLink=void 0,te.baseLayersList=void 0,te.separator=void 0,te.overlaysList=void 0,te.form=void 0,te.layerControlInputs=[],te.layers=[],te.lastZIndex=0,te.handlingClick=!1,te.initLayers(),Object(ge.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ie()(te)),te}return W()(K,[{key:"getDefault",value:function(){return{collapsed:!0,position:Ge.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var te=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(Je){Je.layer.on("remove",te.onLayerChange),Je.layer.on("add",te.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(te,Je){return this.addLayer(te,Je,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var te=this.renderService.getViewportSize(),Je=te.height;ge.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var zt=Je-(this.container.offsetTop+50);return zt<this.form.clientHeight?(ge.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=zt+"px"):ge.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return ge.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var te=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(Je){Je.layer.off("remove",te.onLayerChange),Je.layer.off("add",te.onLayerChange)})}},{key:"initLayout",value:function(){var te="l7-control-layers",Je=this.container=ge.a.create("div",te),zt=this.controlOption.collapsed;Je.setAttribute("aria-haspopup","true");var cr=this.form=ge.a.create("form",te+"-list");zt&&(this.mapsService.on("click",this.collapse),Je.addEventListener("mouseenter",this.expand),Je.addEventListener("mouseleave",this.collapse)),this.layersLink=ge.a.create("a",te+"-toggle",Je);var lt=this.layersLink;lt.title="Layers",zt||this.expand(),this.baseLayersList=ge.a.create("div",te+"-base",cr),this.separator=ge.a.create("div",te+"-separator",cr),this.overlaysList=ge.a.create("div",te+"-overlays",cr),Je.appendChild(cr)}},{key:"initLayers",value:function(){var te=this,Je=this.controlOption,zt=Je.baseLayers,cr=zt===void 0?{}:zt,lt=Je.overlayers,dt=lt===void 0?{}:lt;Object.keys(cr).forEach(function(Ct,pt){te.addLayer(cr[Ct],Ct,!1)}),Object.keys(dt).forEach(function(Ct,pt){te.addLayer(dt[Ct],Ct,!0)})}},{key:"update",value:function(){if(!this.container)return this;ge.a.empty(this.baseLayersList),ge.a.empty(this.overlaysList),this.layerControlInputs=[];var te,Je,zt,cr,lt=0;for(zt=0;zt<this.layers.length;zt++)cr=this.layers[zt],this.addItem(cr),Je=Je||cr.overlay,te=te||!cr.overlay,lt+=cr.overlay?0:1;return this.controlOption.hideSingleBase&&(te=te&&lt>1,this.baseLayersList.style.display=te?"":"none"),this.separator.style.display=Je&&te?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var te=this.layerControlInputs,Je,zt,cr=this.mapsService.getZoom(),lt=te.length-1;lt>=0;lt--)if(Je=te[lt],zt=this.layerService.getLayer(Je.layerId),zt&&zt.inited){var dt=zt.getMinZoom(),Ct=zt.getMaxZoom();Je.disabled=cr<dt||cr>Ct}}},{key:"addLayer",value:function(te,Je,zt){this.mapsService&&(te.on("add",this.onLayerChange),te.on("remove",this.onLayerChange)),this.layers.push({layer:te,name:Je,overlay:zt});var cr=this.controlOption,lt=cr.sortLayers,dt=cr.sortFunction,Ct=cr.autoZIndex;lt&&this.layers.sort(function(pt,we){return dt(pt.layer,we.layer,pt.name,we.name)}),Ct&&te.setZIndex&&(this.lastZIndex++,te.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(te){this.handlingClick||this.update();var Je=this.layerService.getLayer(te.target.layerId),zt=(Je==null?void 0:Je.overlay)?te.type==="add"?"overlayadd":"overlayremove":te.type==="add"?"baselayerchange":null;zt&&this.emit(zt,Je)}},{key:"createRadioElement",value:function(te,Je){var zt='<input type="radio" class="l7-control-layers-selector" name="'+te+'"'+(Je?' checked="checked"':"")+"/>",cr=document.createElement("div");return cr.innerHTML=zt,cr.firstChild}},{key:"addItem",value:function(te){var Je=document.createElement("label"),zt=this.layerService.getLayer(te.layer.id),cr=zt&&zt.inited&&te.layer.isVisible(),lt;te.overlay?(lt=document.createElement("input"),lt.type="checkbox",lt.className="l7-control-layers-selector",lt.defaultChecked=cr):lt=this.createRadioElement("l7-base-layers",cr),this.layerControlInputs.push(lt),lt.layerId=te.layer.id,lt.addEventListener("click",this.onInputClick);var dt=document.createElement("span");dt.innerHTML=" "+te.name;var Ct=document.createElement("div");Je.appendChild(Ct),Ct.appendChild(lt),Ct.appendChild(dt);var pt=te.overlay?this.overlaysList:this.baseLayersList;return pt.appendChild(Je),this.checkDisabledLayers(),Je}},{key:"onInputClick",value:function(){var te=this.layerControlInputs,Je,zt,cr=[],lt=[];this.handlingClick=!0;for(var dt=te.length-1;dt>=0;dt--)Je=te[dt],zt=this.layerService.getLayer(Je.layerId),Je.checked?cr.push(zt):Je.checked||lt.push(zt);lt.forEach(function(Ct){Ct.hide()}),cr.forEach(function(Ct){Ct.show()}),this.handlingClick=!1}}]),K}(xt);function Pe(tt){var It=ot();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function ot(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var Bt=function(tt){Y()(K,tt);var It=Pe(K);function K(){return z()(this,K),It.apply(this,arguments)}return W()(K,[{key:"getDefault",value:function(){return{position:mt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var te="l7-control-logo",Je=ge.a.create("div",te),zt=ge.a.create("a","l7-ctrl-logo");return zt.target="_blank",zt.rel="noopener nofollow",zt.href="https://antv.alipay.com/l7",zt.setAttribute("aria-label","AntV logo"),zt.setAttribute("rel","noopener nofollow"),Je.appendChild(zt),Je}},{key:"onRemove",value:function(){return null}}]),K}(xt);function Wt(tt){var It=sr();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function sr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var ne=function(tt){Y()(K,tt);var It=Wt(K);function K(Ze){var te;return z()(this,K),te=It.call(this,Ze),te.mScale=void 0,te.iScale=void 0,Object(ge.i)(["update"],Ie()(te)),te}return W()(K,[{key:"getDefault",value:function(){return{position:mt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var te="l7-control-scale",Je=ge.a.create("div",te);this.addScales(te+"-line",Je);var zt=this.controlOption.updateWhenIdle;return this.mapsService.on(zt?"moveend":"mapmove",this.update),this.mapsService.on(zt?"zoomend":"zoomchange",this.update),this.update(),Je}},{key:"onRemove",value:function(){var te=this.controlOption.updateWhenIdle;this.mapsService.off(te?"zoomend":"zoomchange",this.update),this.mapsService.off(te?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var te=this.mapsService,Je=this.controlOption.maxWidth,zt=te.getSize()[1]/2,cr=te.containerToLngLat([0,zt]),lt=te.containerToLngLat([Je,zt]),dt=Object(ge.q)([cr.lng,cr.lat],[lt.lng,lt.lat]);this.updateScales(dt)}},{key:"updateScales",value:function(te){var Je=this.controlOption,zt=Je.metric,cr=Je.imperial;zt&&te&&this.updateMetric(te),cr&&te&&this.updateImperial(te)}},{key:"updateMetric",value:function(te){var Je=this.getRoundNum(te),zt=Je<1e3?Je+" m":Je/1e3+" km";this.updateScale(this.mScale,zt,Je/te)}},{key:"updateImperial",value:function(te){var Je=te*3.2808399,zt,cr,lt;Je>5280?(zt=Je/5280,cr=this.getRoundNum(zt),this.updateScale(this.iScale,cr+" mi",cr/zt)):(lt=this.getRoundNum(Je),this.updateScale(this.iScale,lt+" ft",lt/Je))}},{key:"updateScale",value:function(te,Je,zt){var cr=this.controlOption.maxWidth;te.style.width=Math.round(cr*zt)+"px",te.innerHTML=Je}},{key:"getRoundNum",value:function(te){var Je=Math.pow(10,(Math.floor(te)+"").length-1),zt=te/Je;return zt=zt>=10?10:zt>=5?5:zt>=3?3:zt>=2?2:1,Je*zt}},{key:"addScales",value:function(te,Je){var zt=this.controlOption,cr=zt.metric,lt=zt.imperial;cr&&(this.mScale=ge.a.create("div",te,Je)),lt&&(this.iScale=ge.a.create("div",te,Je))}}]),K}(xt);function $(tt){var It=G();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function G(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var Ae=function(tt){Y()(K,tt);var It=$(K);function K(Ze){var te;return z()(this,K),te=It.call(this,Ze),te.disabled=void 0,te.zoomInButton=void 0,te.zoomOutButton=void 0,Object(ge.i)(["updateDisabled","zoomIn","zoomOut"],Ie()(te)),te}return W()(K,[{key:"getDefault",value:function(){return{position:mt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var te="l7-control-zoom",Je=ge.a.create("div",te+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,te+"-in",Je,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,te+"-out",Je,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),Je}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(te,Je,zt,cr,lt){var dt=ge.a.create("a",zt,cr);return dt.innerHTML=te,dt.title=Je,dt.href="javascript:void(0)",dt.addEventListener("click",lt),dt}},{key:"updateDisabled",value:function(){var te=this.mapsService,Je="l7-disabled";ge.a.removeClass(this.zoomInButton,Je),ge.a.removeClass(this.zoomOutButton,Je),(this.disabled||te.getZoom()<=te.getMinZoom())&&ge.a.addClass(this.zoomOutButton,Je),(this.disabled||te.getZoom()>=te.getMaxZoom())&&ge.a.addClass(this.zoomInButton,Je)}}]),K}(xt);function xe(tt,It){var K=Object.keys(tt);if(Object.getOwnPropertySymbols){var Ze=Object.getOwnPropertySymbols(tt);It&&(Ze=Ze.filter(function(te){return Object.getOwnPropertyDescriptor(tt,te).enumerable})),K.push.apply(K,Ze)}return K}function Se(tt){for(var It=1;It<arguments.length;It++){var K=arguments[It]!=null?arguments[It]:{};It%2?xe(Object(K),!0).forEach(function(Ze){m()(tt,Ze,K[Ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(K)):xe(Object(K)).forEach(function(Ze){Object.defineProperty(tt,Ze,Object.getOwnPropertyDescriptor(K,Ze))})}return tt}function ve(tt){var It=et();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var Yt=function(tt){Y()(K,tt);var It=ve(K);function K(Ze){var te;return z()(this,K),te=It.call(this),te.markerOption=void 0,te.defaultMarker=void 0,te.popup=void 0,te.mapsService=void 0,te.sceneSerive=void 0,te.lngLat=void 0,te.scene=void 0,te.added=!1,te.eventHandle=function(Je){te.emit(Je.type,{target:Je,data:te.markerOption.extData,lngLat:te.lngLat})},te.markerOption=Se(Se({},te.getDefault()),Ze),Object(ge.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ie()(te)),te.init(),te}return W()(K,[{key:"getDefault",value:function(){return{element:void 0,anchor:ge.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(te){this.scene=te,this.mapsService=te.get(Ge.TYPES.IMapService),this.sceneSerive=te.get(Ge.TYPES.ISceneService);var Je=this.markerOption,zt=Je.element,cr=Je.draggable;return this.mapsService.getMarkerContainer().appendChild(zt),this.registerMarkerEvent(zt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var te=this.markerOption.element;return te&&ge.a.remove(te),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(te){return this.lngLat=te,Array.isArray(te)&&(this.lngLat={lng:te[0],lat:te[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(te){var Je=this;if(!this.added)return this.once("added",function(){Je.setElement(te)}),this;var zt=this.markerOption.element;return zt&&ge.a.remove(zt),this.markerOption.element=te,this.init(),this.mapsService.getMarkerContainer().appendChild(te),this.registerMarkerEvent(te),this.update(),this}},{key:"openPopup",value:function(){var te=this;if(!this.added)return this.once("added",function(){te.openPopup()}),this;var Je=this.popup;return Je?(Je.isOpen()||Je.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var te=this;this.added||this.once("added",function(){te.closePopup()});var Je=this.popup;return Je&&Je.remove(),this}},{key:"setPopup",value:function(te){return this.popup=te,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var te=this.popup;if(te)te.isOpen()?te.remove():te.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(te){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(te){this.markerOption.extData=te}},{key:"update",value:function(){if(!this.mapsService)return;var te=this.markerOption,Je=te.element,zt=te.anchor;this.updatePosition(),ge.a.setTransform(Je,"".concat(ge.e[zt]))}},{key:"onMapClick",value:function(te){var Je=this.markerOption.element;this.popup&&Je&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var te=this.markerOption,Je=te.element,zt=te.offsets,cr=this.lngLat,lt=cr.lng,dt=cr.lat,Ct=this.mapsService.getBounds(),pt=this.mapsService.getZoom();if((lt<Ct[0][0]||lt>Ct[1][0]||dt<Ct[0][1]||dt>Ct[1][1])&&pt>3){Je&&(Je.style.display="none");return}var we=this.mapsService.lngLatToContainer([lt,dt]);Je&&(Je.style.display="block",Je.style.left=we.x+zt[0]+"px",Je.style.top=we.y-zt[1]+"px")}},{key:"init",value:function(){var te=this,Je=this.markerOption.element,zt=this.markerOption,cr=zt.color,lt=zt.anchor;if(!Je){this.defaultMarker=!0,Je=ge.a.create("div"),this.markerOption.element=Je;var dt=document.createElementNS("http://www.w3.org/2000/svg","svg");dt.setAttributeNS(null,"display","block"),dt.setAttributeNS(null,"height","48px"),dt.setAttributeNS(null,"width","48px"),dt.setAttributeNS(null,"viewBox","0 0 1024 1024");var Ct=document.createElementNS("http://www.w3.org/2000/svg","path");Ct.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),Ct.setAttributeNS(null,"fill",cr),dt.appendChild(Ct),Je.appendChild(dt)}ge.a.addClass(Je,"l7-marker"),Je.addEventListener("click",function(pt){te.onMapClick(pt)}),Je.addEventListener("click",this.eventHandle),Object(ge.g)(Je,lt,"marker")}},{key:"registerMarkerEvent",value:function(te){te.addEventListener("mousemove",this.eventHandle),te.addEventListener("click",this.eventHandle),te.addEventListener("mousedown",this.eventHandle),te.addEventListener("mouseup",this.eventHandle),te.addEventListener("dblclick",this.eventHandle),te.addEventListener("contextmenu",this.eventHandle),te.addEventListener("mouseover",this.eventHandle),te.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var te=this.getElement();te.removeEventListener("mousemove",this.eventHandle),te.removeEventListener("click",this.eventHandle),te.removeEventListener("mousedown",this.eventHandle),te.removeEventListener("mouseup",this.eventHandle),te.removeEventListener("dblclick",this.eventHandle),te.removeEventListener("contextmenu",this.eventHandle),te.removeEventListener("mouseover",this.eventHandle),te.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(te){throw new Error("Method not implemented.")}},{key:"onUp",value:function(te){throw new Error("Method not implemented.")}}]),K}(Ce.EventEmitter),At=i("QkVN"),ye=i.n(At),be=i("mpbz"),Ue=i.n(be);function st(tt,It){var K=Object.keys(tt);if(Object.getOwnPropertySymbols){var Ze=Object.getOwnPropertySymbols(tt);It&&(Ze=Ze.filter(function(te){return Object.getOwnPropertyDescriptor(tt,te).enumerable})),K.push.apply(K,Ze)}return K}function Me(tt){for(var It=1;It<arguments.length;It++){var K=arguments[It]!=null?arguments[It]:{};It%2?st(Object(K),!0).forEach(function(Ze){m()(tt,Ze,K[Ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(K)):st(Object(K)).forEach(function(Ze){Object.defineProperty(tt,Ze,Object.getOwnPropertyDescriptor(K,Ze))})}return tt}function ft(tt){var It=w();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function w(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var I=function(tt){Y()(K,tt);var It=ft(K);function K(Ze){var te,Je;return z()(this,K),Je=It.call(this),Je.markers=[],Je.markerLayerOption=void 0,Je.clusterIndex=void 0,Je.points=[],Je.clusterMarkers=[],Je.mapsService=void 0,Je.scene=void 0,Je.zoom=void 0,Je.bbox=void 0,Je.markerLayerOption=ye()(Je.getDefault(),Ze),Object(ge.i)(["update"],Ie()(Je)),Je.zoom=((te=Je.markerLayerOption.clusterOption)===null||te===void 0?void 0:te.zoom)||-99,Je}return W()(K,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(te){return this.scene=te,this.mapsService=te.get(Ge.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(te){var Je=this.markerLayerOption.cluster;Je&&this.addPoint(te,this.markers.length),this.markers.push(te)}},{key:"removeMarker",value:function(te){this.markers.indexOf(te);var Je=this.markers.indexOf(te);Je>-1&&this.markers.splice(Je,1)}},{key:"getMarkers",value:function(){var te=this.markerLayerOption.cluster;return te?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var te=this;this.getMarkers().forEach(function(Je){Je.addTo(te.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(te){te.remove()}),this.clusterMarkers.forEach(function(te){te.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(te,Je){var zt=te.getLnglat(),cr=zt.lng,lt=zt.lat,dt={geometry:{type:"Point",coordinates:[cr,lt]},properties:Me(Me({},te.getExtData()),{},{marker_id:Je})};this.points.push(dt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var te=this.markerLayerOption.clusterOption,Je=te.radius,zt=te.minZoom,cr=zt===void 0?0:zt,lt=te.maxZoom;this.clusterIndex=new Ue.a({radius:Je,minZoom:cr,maxZoom:lt}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(te,Je){var zt=this,cr=te[0].concat(te[1]),lt=this.clusterIndex.getClusters(cr,Je);this.clusterMarkers.forEach(function(dt){dt.remove()}),this.clusterMarkers=[],lt.forEach(function(dt){var Ct,pt=zt.markerLayerOption.clusterOption,we=pt.field,ut=pt.method;if(dt.properties&&((Ct=dt.properties)===null||Ct===void 0?void 0:Ct.cluster_id)){var Ke,kt=zt.getLeaves((Ke=dt.properties)===null||Ke===void 0?void 0:Ke.cluster_id);if(dt.properties.clusterData=kt,we&&ut){var yr=kt==null?void 0:kt.map(function(ta){var ma=m()({},we,ta.properties[we]);return ma}),Zr=ge.c.getColumn(yr,we),hr=ge.c.getSatByColumn(ut,Zr),jn="point_"+ut;dt.properties[jn]=hr.toFixed(2)}}var yn=zt.clusterMarker(dt);zt.clusterMarkers.push(yn),yn.addTo(zt.scene)})}},{key:"getLeaves",value:function(te){var Je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,zt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return te?this.clusterIndex.getLeaves(te,Je,zt):null}},{key:"clusterMarker",value:function(te){var Je=this.markerLayerOption.clusterOption,zt=Je,cr=zt.element,lt=cr===void 0?this.generateElement.bind(this):cr,dt=new Yt({element:lt(te)}).setLnglat({lng:te.geometry.coordinates[0],lat:te.geometry.coordinates[1]});return dt}},{key:"normalMarker",value:function(te){var Je=te.properties.marker_id;return this.markers[Je]}},{key:"update",value:function(){var te=this.mapsService.getZoom(),Je=this.mapsService.getBounds();(!this.bbox||Math.abs(te-this.zoom)>=1||!Object(ge.j)(this.bbox,Je))&&(this.bbox=Object(ge.r)(Je,.5),this.zoom=Math.floor(te),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(te){var Je=ge.a.create("div","l7-marker-cluster"),zt=ge.a.create("div","",Je),cr=ge.a.create("span","",zt),lt=this.markerLayerOption.clusterOption,dt=lt.field,Ct=lt.method;te.properties.point_count=te.properties.point_count||1;var pt=dt&&Ct?te.properties["point_"+Ct]||te.properties[dt]:te.properties.point_count;return cr.textContent=pt,Je}}]),K}(Ce.EventEmitter);function J(tt,It){var K=Object.keys(tt);if(Object.getOwnPropertySymbols){var Ze=Object.getOwnPropertySymbols(tt);It&&(Ze=Ze.filter(function(te){return Object.getOwnPropertyDescriptor(tt,te).enumerable})),K.push.apply(K,Ze)}return K}function ce(tt){for(var It=1;It<arguments.length;It++){var K=arguments[It]!=null?arguments[It]:{};It%2?J(Object(K),!0).forEach(function(Ze){m()(tt,Ze,K[Ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(K)):J(Object(K)).forEach(function(Ze){Object.defineProperty(tt,Ze,Object.getOwnPropertyDescriptor(K,Ze))})}return tt}function Be(tt){var It=Xe();return function(){var Ze=je()(tt),te;if(It){var Je=je()(this).constructor;te=Reflect.construct(Ze,arguments,Je)}else te=Ze.apply(this,arguments);return he()(this,te)}}function Xe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(tt){return!1}}var gt=function(tt){Y()(K,tt);var It=Be(K);function K(Ze){var te;return z()(this,K),te=It.call(this),te.popupOption=void 0,te.mapsService=void 0,te.sceneSerive=void 0,te.lngLat=void 0,te.content=void 0,te.closeButton=void 0,te.timeoutInstance=void 0,te.container=void 0,te.tip=void 0,te.scene=void 0,te.popupOption=ce(ce({},te.getdefault()),Ze),Object(ge.i)(["update","onClickClose","remove"],Ie()(te)),te}return W()(K,[{key:"addTo",value:function(te){var Je=this;return this.mapsService=te.get(Ge.TYPES.IMapService),this.sceneSerive=te.get(Ge.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=te,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){Je.mapsService.on("click",Je.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(te){var Je=window.document.createDocumentFragment(),zt=window.document.createElement("body"),cr;for(zt.innerHTML=te;!(cr=zt.firstChild,!cr);)Je.appendChild(cr);return this.setDOMContent(Je)}},{key:"setLnglat",value:function(te){return this.lngLat=te,Array.isArray(te)&&(this.lngLat={lng:te[0],lat:te[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(te){return this.setDOMContent(window.document.createTextNode(te))}},{key:"setMaxWidth",value:function(te){return this.popupOption.maxWidth=te,this.update(),this}},{key:"setDOMContent",value:function(te){return this.createContent(),this.content.appendChild(te),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&ge.a.remove(this.content),this.content=ge.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=ge.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(te,Je,zt){var cr=window.document.createElement(te);return Je!==void 0&&(cr.className=Je),zt&&zt.appendChild(cr),cr}},{key:"removeDom",value:function(te){te.parentNode&&te.parentNode.removeChild(te)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:ge.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(te){te.stopPropagation&&te.stopPropagation(),this.remove()}},{key:"update",value:function(){var te=this,Je=this.lngLat,zt=this.popupOption,cr=zt.className,lt=zt.maxWidth,dt=zt.anchor;if(!this.mapsService||!Je||!this.content)return;var Ct=this.mapsService.getMarkerContainer();if(!this.container&&Ct){this.container=this.creatDom("div","l7-popup",Ct),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),cr&&cr.split(" ").forEach(function(we){return te.container.classList.add(we)});var pt=this.popupOption.stopPropagation;pt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(we){te.container.addEventListener(we,function(ut){ut.stopPropagation()})})}lt&&this.container.style.maxWidth!==lt&&(this.container.style.maxWidth=lt),this.updatePosition(),ge.a.setTransform(this.container,"".concat(ge.e[dt])),Object(ge.g)(this.container,dt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var te=this.lngLat,Je=te.lng,zt=te.lat,cr=this.popupOption.offsets,lt=this.mapsService.lngLatToContainer([Je,zt]);this.container.style.left=lt.x+cr[0]+"px",this.container.style.top=lt.y-cr[1]+"px"}}]),K}(Ce.EventEmitter);i("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Le,E,i){"use strict";var T=i("/kpp");E.a=T.a},"kQ+U":function(Le,E,i){"use strict";i.d(E,"a",function(){return dt});var T=i("lSNA"),m=i.n(T),Z=i("lwsE"),z=i.n(Z),o=i("W8MJ"),W=i.n(o),D=i("k5/I"),Y=i("h1nZ"),q=i("o0o1"),he=i.n(q),X=i("yXPU"),je=i.n(X),Ge=i("4cb6"),ge=i("fbvF"),Ce=i.n(ge),ht=function(){function Ct(pt,we){z()(this,Ct),this.attribute=void 0,this.buffer=void 0;var ut=we.buffer,Ke=we.offset,kt=we.stride,yr=we.normalized,Zr=we.size,hr=we.divisor;this.buffer=ut,this.attribute={buffer:ut.get(),offset:Ke||0,stride:kt||0,normalized:yr||!1,divisor:hr||0},Zr&&(this.attribute.size=Zr)}return W()(Ct,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(we){this.buffer.subData(we)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),Ct}(),Ne,Et,He,mt,Ye,xt,_t,Ie,De,ze,at,Pe,ot,Bt,Wt=(Ne={},m()(Ne,Y.gl.POINTS,"points"),m()(Ne,Y.gl.LINES,"lines"),m()(Ne,Y.gl.LINE_LOOP,"line loop"),m()(Ne,Y.gl.LINE_STRIP,"line strip"),m()(Ne,Y.gl.TRIANGLES,"triangles"),m()(Ne,Y.gl.TRIANGLE_FAN,"triangle fan"),m()(Ne,Y.gl.TRIANGLE_STRIP,"triangle strip"),Ne),sr=(Et={},m()(Et,Y.gl.STATIC_DRAW,"static"),m()(Et,Y.gl.DYNAMIC_DRAW,"dynamic"),m()(Et,Y.gl.STREAM_DRAW,"stream"),Et),ne=(He={},m()(He,Y.gl.BYTE,"int8"),m()(He,Y.gl.UNSIGNED_INT,"int16"),m()(He,Y.gl.INT,"int32"),m()(He,Y.gl.UNSIGNED_BYTE,"uint8"),m()(He,Y.gl.UNSIGNED_SHORT,"uint16"),m()(He,Y.gl.UNSIGNED_INT,"uint32"),m()(He,Y.gl.FLOAT,"float"),He),$=(mt={},m()(mt,Y.gl.ALPHA,"alpha"),m()(mt,Y.gl.LUMINANCE,"luminance"),m()(mt,Y.gl.LUMINANCE_ALPHA,"luminance alpha"),m()(mt,Y.gl.RGB,"rgb"),m()(mt,Y.gl.RGBA,"rgba"),m()(mt,Y.gl.RGBA4,"rgba4"),m()(mt,Y.gl.RGB5_A1,"rgb5 a1"),m()(mt,Y.gl.RGB565,"rgb565"),m()(mt,Y.gl.DEPTH_COMPONENT,"depth"),m()(mt,Y.gl.DEPTH_STENCIL,"depth stencil"),mt),G=(Ye={},m()(Ye,Y.gl.DONT_CARE,"dont care"),m()(Ye,Y.gl.NICEST,"nice"),m()(Ye,Y.gl.FASTEST,"fast"),Ye),Ae=(xt={},m()(xt,Y.gl.NEAREST,"nearest"),m()(xt,Y.gl.LINEAR,"linear"),m()(xt,Y.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),m()(xt,Y.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),m()(xt,Y.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),m()(xt,Y.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),xt),xe=(_t={},m()(_t,Y.gl.REPEAT,"repeat"),m()(_t,Y.gl.CLAMP_TO_EDGE,"clamp"),m()(_t,Y.gl.MIRRORED_REPEAT,"mirror"),_t),Se=(Ie={},m()(Ie,Y.gl.NONE,"none"),m()(Ie,Y.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ie),ve=(De={},m()(De,Y.gl.NEVER,"never"),m()(De,Y.gl.ALWAYS,"always"),m()(De,Y.gl.LESS,"less"),m()(De,Y.gl.LEQUAL,"lequal"),m()(De,Y.gl.GREATER,"greater"),m()(De,Y.gl.GEQUAL,"gequal"),m()(De,Y.gl.EQUAL,"equal"),m()(De,Y.gl.NOTEQUAL,"notequal"),De),et=(ze={},m()(ze,Y.gl.FUNC_ADD,"add"),m()(ze,Y.gl.MIN_EXT,"min"),m()(ze,Y.gl.MAX_EXT,"max"),m()(ze,Y.gl.FUNC_SUBTRACT,"subtract"),m()(ze,Y.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),ze),Yt=(at={},m()(at,Y.gl.ZERO,"zero"),m()(at,Y.gl.ONE,"one"),m()(at,Y.gl.SRC_COLOR,"src color"),m()(at,Y.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),m()(at,Y.gl.SRC_ALPHA,"src alpha"),m()(at,Y.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),m()(at,Y.gl.DST_COLOR,"dst color"),m()(at,Y.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),m()(at,Y.gl.DST_ALPHA,"dst alpha"),m()(at,Y.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),m()(at,Y.gl.CONSTANT_COLOR,"constant color"),m()(at,Y.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),m()(at,Y.gl.CONSTANT_ALPHA,"constant alpha"),m()(at,Y.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),m()(at,Y.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),at),At=(Pe={},m()(Pe,Y.gl.NEVER,"never"),m()(Pe,Y.gl.ALWAYS,"always"),m()(Pe,Y.gl.LESS,"less"),m()(Pe,Y.gl.LEQUAL,"lequal"),m()(Pe,Y.gl.GREATER,"greater"),m()(Pe,Y.gl.GEQUAL,"gequal"),m()(Pe,Y.gl.EQUAL,"equal"),m()(Pe,Y.gl.NOTEQUAL,"notequal"),Pe),ye=(ot={},m()(ot,Y.gl.ZERO,"zero"),m()(ot,Y.gl.KEEP,"keep"),m()(ot,Y.gl.REPLACE,"replace"),m()(ot,Y.gl.INVERT,"invert"),m()(ot,Y.gl.INCR,"increment"),m()(ot,Y.gl.DECR,"decrement"),m()(ot,Y.gl.INCR_WRAP,"increment wrap"),m()(ot,Y.gl.DECR_WRAP,"decrement wrap"),ot),be=(Bt={},m()(Bt,Y.gl.FRONT,"front"),m()(Bt,Y.gl.BACK,"back"),Bt),Ue=function(){function Ct(pt,we){z()(this,Ct),this.buffer=void 0;var ut=we.data,Ke=we.usage,kt=we.type;this.buffer=pt.buffer({data:ut,usage:sr[Ke||Y.gl.STATIC_DRAW],type:ne[kt||Y.gl.UNSIGNED_BYTE]})}return W()(Ct,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(we){var ut=we.data,Ke=we.offset;this.buffer.subdata(ut,Ke)}}]),Ct}(),st=function(){function Ct(pt,we){z()(this,Ct),this.elements=void 0;var ut=we.data,Ke=we.usage,kt=we.type,yr=we.count;this.elements=pt.elements({data:ut,usage:sr[Ke||Y.gl.STATIC_DRAW],type:ne[kt||Y.gl.UNSIGNED_BYTE],count:yr})}return W()(Ct,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(we){var ut=we.data;this.elements.subdata(ut)}},{key:"destroy",value:function(){}}]),Ct}(),Me=function(){function Ct(pt,we){z()(this,Ct),this.framebuffer=void 0;var ut=we.width,Ke=we.height,kt=we.color,yr=we.colors,Zr=we.depth,hr=we.stencil,jn={width:ut,height:Ke};Array.isArray(yr)&&(jn.colors=yr.map(function(yn){return yn.get()})),kt&&typeof kt!="boolean"&&(jn.color=kt.get()),this.framebuffer=pt.framebuffer(jn)}return W()(Ct,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(we){var ut=we.width,Ke=we.height;this.framebuffer.resize(ut,Ke)}}]),Ct}(),ft=i("cDf5"),w=i.n(ft),I=i("c6wG"),J=i.n(I),ce=i("YO3V"),Be=i.n(ce);function Xe(Ct,pt){var we=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ut=Object.getOwnPropertySymbols(Ct);pt&&(ut=ut.filter(function(Ke){return Object.getOwnPropertyDescriptor(Ct,Ke).enumerable})),we.push.apply(we,ut)}return we}function gt(Ct){for(var pt=1;pt<arguments.length;pt++){var we=arguments[pt]!=null?arguments[pt]:{};pt%2?Xe(Object(we),!0).forEach(function(ut){m()(Ct,ut,we[ut])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(we)):Xe(Object(we)).forEach(function(ut){Object.defineProperty(Ct,ut,Object.getOwnPropertyDescriptor(we,ut))})}return Ct}var tt=function(){function Ct(pt,we){z()(this,Ct),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=pt;var ut=we.vs,Ke=we.fs,kt=we.attributes,yr=we.uniforms,Zr=we.primitive,hr=we.count,jn=we.elements,yn=we.depth,ta=we.blend,ma=we.stencil,Zn=we.cull,Wn=we.instances,F={};this.options=we,yr&&(this.uniforms=this.extractUniforms(yr),Object.keys(yr).forEach(function(pe){F[pe]=pt.prop(pe)}));var H={};Object.keys(kt).forEach(function(pe){H[pe]=kt[pe].get()});var ue={attributes:H,frag:Ke,uniforms:F,vert:ut,primitive:Wt[Zr===void 0?Y.gl.TRIANGLES:Zr]};Wn&&(ue.instances=Wn),hr&&(ue.count=hr),jn&&(ue.elements=jn.get()),this.initDepthDrawParams({depth:yn},ue),this.initBlendDrawParams({blend:ta},ue),this.initStencilDrawParams({stencil:ma},ue),this.initCullDrawParams({cull:Zn},ue),this.drawCommand=pt(ue),this.drawParams=ue}return W()(Ct,[{key:"addUniforms",value:function(we){this.uniforms=gt(gt({},this.uniforms),this.extractUniforms(we))}},{key:"draw",value:function(we){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var ut=gt(gt({},this.uniforms),this.extractUniforms(we.uniforms||{})),Ke={};Object.keys(ut).forEach(function(kt){var yr=w()(ut[kt]);yr==="boolean"||yr==="number"||Array.isArray(ut[kt])||ut[kt].BYTES_PER_ELEMENT?Ke[kt]=ut[kt]:Ke[kt]=ut[kt].get()}),this.drawCommand(Ke)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(we){we.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(we,ut){var Ke=we.depth;Ke&&(ut.depth={enable:Ke.enable===void 0?!0:!!Ke.enable,mask:Ke.mask===void 0?!0:!!Ke.mask,func:ve[Ke.func||Y.gl.LESS],range:Ke.range||[0,1]})}},{key:"initBlendDrawParams",value:function(we,ut){var Ke=we.blend;if(Ke){var kt=Ke.enable,yr=Ke.func,Zr=Ke.equation,hr=Ke.color,jn=hr===void 0?[0,0,0,0]:hr;ut.blend={enable:!!kt,func:{srcRGB:Yt[yr&&yr.srcRGB||Y.gl.SRC_ALPHA],srcAlpha:Yt[yr&&yr.srcAlpha||Y.gl.SRC_ALPHA],dstRGB:Yt[yr&&yr.dstRGB||Y.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Yt[yr&&yr.dstAlpha||Y.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:et[Zr&&Zr.rgb||Y.gl.FUNC_ADD],alpha:et[Zr&&Zr.alpha||Y.gl.FUNC_ADD]},color:jn}}}},{key:"initStencilDrawParams",value:function(we,ut){var Ke=we.stencil;if(Ke){var kt=Ke.enable,yr=Ke.mask,Zr=yr===void 0?-1:yr,hr=Ke.func,jn=hr===void 0?{cmp:Y.gl.ALWAYS,ref:0,mask:-1}:hr,yn=Ke.opFront,ta=yn===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:yn,ma=Ke.opBack,Zn=ma===void 0?{fail:Y.gl.KEEP,zfail:Y.gl.KEEP,zpass:Y.gl.KEEP}:ma;ut.stencil={enable:!!kt,mask:Zr,func:gt(gt({},jn),{},{cmp:At[jn.cmp]}),opFront:{fail:ye[ta.fail],zfail:ye[ta.zfail],zpass:ye[ta.zpass]},opBack:{fail:ye[Zn.fail],zfail:ye[Zn.zfail],zpass:ye[Zn.zpass]}}}}},{key:"initCullDrawParams",value:function(we,ut){var Ke=we.cull;if(Ke){var kt=Ke.enable,yr=Ke.face,Zr=yr===void 0?Y.gl.BACK:yr;ut.cull={enable:!!kt,face:be[Zr]}}}},{key:"extractUniforms",value:function(we){var ut=this,Ke={};return Object.keys(we).forEach(function(kt){ut.extractUniformsRecursively(kt,we[kt],Ke,"")}),Ke}},{key:"extractUniformsRecursively",value:function(we,ut,Ke,kt){var yr=this;if(ut===null||typeof ut=="number"||typeof ut=="boolean"||Array.isArray(ut)&&typeof ut[0]=="number"||J()(ut)||ut===""||"resize"in ut){Ke["".concat(kt&&kt+".").concat(we)]=ut;return}Be()(ut)&&Object.keys(ut).forEach(function(Zr){yr.extractUniformsRecursively(Zr,ut[Zr],Ke,"".concat(kt&&kt+".").concat(we))}),Array.isArray(ut)&&ut.forEach(function(Zr,hr){Object.keys(Zr).forEach(function(jn){yr.extractUniformsRecursively(jn,Zr[jn],Ke,"".concat(kt&&kt+".").concat(we,"[").concat(hr,"]"))})})}}]),Ct}(),It=function(){function Ct(pt,we){z()(this,Ct),this.texture=void 0,this.width=void 0,this.height=void 0;var ut=we.data,Ke=we.type,kt=Ke===void 0?Y.gl.UNSIGNED_BYTE:Ke,yr=we.width,Zr=we.height,hr=we.flipY,jn=hr===void 0?!1:hr,yn=we.format,ta=yn===void 0?Y.gl.RGBA:yn,ma=we.mipmap,Zn=ma===void 0?!1:ma,Wn=we.wrapS,F=Wn===void 0?Y.gl.CLAMP_TO_EDGE:Wn,H=we.wrapT,ue=H===void 0?Y.gl.CLAMP_TO_EDGE:H,pe=we.aniso,rt=pe===void 0?0:pe,yt=we.alignment,Ve=yt===void 0?1:yt,ct=we.premultiplyAlpha,er=ct===void 0?!1:ct,rr=we.mag,jr=rr===void 0?Y.gl.NEAREST:rr,nn=we.min,ur=nn===void 0?Y.gl.NEAREST:nn,Wr=we.colorSpace,Tn=Wr===void 0?Y.gl.BROWSER_DEFAULT_WEBGL:Wr;this.width=yr,this.height=Zr;var mr={width:yr,height:Zr,type:ne[kt],format:$[ta],wrapS:xe[F],wrapT:xe[ue],mag:Ae[jr],min:Ae[ur],alignment:Ve,flipY:jn,colorSpace:Se[Tn],premultiplyAlpha:er,aniso:rt};ut&&(mr.data=ut),typeof Zn=="number"?mr.mipmap=G[Zn]:typeof Zn=="boolean"&&(mr.mipmap=Zn),this.texture=pt.texture(mr)}return W()(Ct,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(we)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(we){var ut=we.width,Ke=we.height;this.texture.resize(ut,Ke),this.width=ut,this.height=Ke}},{key:"destroy",value:function(){this.texture.destroy()}}]),Ct}(),K,Ze,te,Je=(K=Object(Ge.injectable)(),K(Ze=(te=function(){function Ct(){var pt=this;z()(this,Ct),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(we){return new tt(pt.gl,we)},this.createAttribute=function(we){return new ht(pt.gl,we)},this.createBuffer=function(we){return new Ue(pt.gl,we)},this.createElements=function(we){return new st(pt.gl,we)},this.createTexture2D=function(we){return new It(pt.gl,we)},this.createFramebuffer=function(we){return new Me(pt.gl,we)},this.useFramebuffer=function(we,ut){pt.gl({framebuffer:we?we.get():null})(ut)},this.clear=function(we){var ut=we.color,Ke=we.depth,kt=we.stencil,yr=we.framebuffer,Zr=yr===void 0?null:yr,hr={color:ut,depth:Ke,stencil:kt};hr.framebuffer=Zr===null?Zr:Zr.get(),pt.gl.clear(hr)},this.viewport=function(we){var ut=we.x,Ke=we.y,kt=we.width,yr=we.height;pt.gl._gl.viewport(ut,Ke,kt,yr),pt.width=kt,pt.height=yr,pt.gl._refresh()},this.readPixels=function(we){var ut=we.framebuffer,Ke=we.x,kt=we.y,yr=we.width,Zr=we.height,hr={x:Ke,y:kt,width:yr,height:Zr};return ut&&(hr.framebuffer=ut.get()),pt.gl.read(hr)},this.getViewportSize=function(){return{width:pt.gl._gl.drawingBufferWidth,height:pt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var we;return(we=pt.canvas)===null||we===void 0?void 0:we.parentElement},this.getCanvas=function(){return pt.canvas},this.getGLContext=function(){return pt.gl._gl},this.destroy=function(){pt.gl.destroy()}}return W()(Ct,[{key:"init",value:function(){var pt=je()(he.a.mark(function ut(Ke,kt){var yr=this;return he.a.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return this.canvas=Ke,hr.next=3,new Promise(function(jn,yn){Ce()({canvas:yr.canvas,attributes:{alpha:!0,antialias:kt.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:kt.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(ma,Zn){(ma||!Zn)&&yn(ma),jn(Zn)}})});case 3:this.gl=hr.sent;case 4:case"end":return hr.stop()}},ut,this)}));function we(ut,Ke){return pt.apply(this,arguments)}return we}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var we=this.getGLContext();we.disable(we.CULL_FACE)}},{key:"setDirty",value:function(we){this.isDirty=we}},{key:"getDirty",value:function(){return this.isDirty}}]),Ct}(),te))||Ze),zt=i("Hel2");function cr(Ct,pt){var we=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ut=Object.getOwnPropertySymbols(Ct);pt&&(ut=ut.filter(function(Ke){return Object.getOwnPropertyDescriptor(Ct,Ke).enumerable})),we.push.apply(we,ut)}return we}function lt(Ct){for(var pt=1;pt<arguments.length;pt++){var we=arguments[pt]!=null?arguments[pt]:{};pt%2?cr(Object(we),!0).forEach(function(ut){m()(Ct,ut,we[ut])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(we)):cr(Object(we)).forEach(function(ut){Object.defineProperty(Ct,ut,Object.getOwnPropertyDescriptor(we,ut))})}return Ct}var dt=function(){function Ct(pt){z()(this,Ct),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var we=pt.id,ut=pt.map,Ke=Object(Y.createSceneContainer)();this.container=Ke,ut.setContainer(Ke,we),Ke.bind(Y.TYPES.IRendererService).to(Je).inSingletonScope(),this.sceneService=Ke.get(Y.TYPES.ISceneService),this.mapService=Ke.get(Y.TYPES.IMapService),this.iconService=Ke.get(Y.TYPES.IIconService),this.fontService=Ke.get(Y.TYPES.IFontService),this.controlService=Ke.get(Y.TYPES.IControlService),this.layerService=Ke.get(Y.TYPES.ILayerService),this.markerService=Ke.get(Y.TYPES.IMarkerService),this.interactionService=Ke.get(Y.TYPES.IInteractionService),this.popupService=Ke.get(Y.TYPES.IPopupService),this.initComponent(we),this.sceneService.init(pt),this.initControl()}return W()(Ct,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(we){return this.sceneService.exportPng(we)}},{key:"exportMap",value:function(we){return this.sceneService.exportPng(we)}},{key:"registerRenderService",value:function(we){var ut=this;if(this.sceneService.loaded){var Ke=new we(this);Ke.init()}else this.on("loaded",function(){var kt=new we(ut);kt.init()})}},{key:"addLayer",value:function(we){var ut=Object(Y.createLayerContainer)(this.container);we.setContainer(ut),this.sceneService.addLayer(we)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(we){return this.layerService.getLayer(we)}},{key:"getLayerByName",value:function(we){return this.layerService.getLayerByName(we)}},{key:"removeLayer",value:function(we){this.layerService.remove(we)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(we,ut){this.iconService.addImage(we,ut)}},{key:"hasImage",value:function(we){return this.iconService.hasImage(we)}},{key:"removeImage",value:function(we){this.iconService.removeImage(we)}},{key:"addIconFontGlyphs",value:function(we,ut){this.fontService.addIconGlyphs(ut)}},{key:"addControl",value:function(we){this.controlService.addControl(we,this.container)}},{key:"removeControl",value:function(we){this.controlService.removeControl(we)}},{key:"getControlByName",value:function(we){return this.controlService.getControlByName(we)}},{key:"addMarker",value:function(we){this.markerService.addMarker(we)}},{key:"addMarkerLayer",value:function(we){this.markerService.addMarkerLayer(we)}},{key:"removeMarkerLayer",value:function(we){this.markerService.removeMarkerLayer(we)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(we){this.popupService.addPopup(we)}},{key:"on",value:function(we,ut){Y.SceneEventList.indexOf(we)===-1?this.mapService.on(we,ut):this.sceneService.on(we,ut)}},{key:"off",value:function(we,ut){Y.SceneEventList.indexOf(we)===-1?this.mapService.off(we,ut):this.sceneService.off(we,ut)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(we){return this.mapService.setCenter(we)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(we){return this.mapService.setPitch(we)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(we){this.mapService.setRotation(we)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(we){this.mapService.panTo(we)}},{key:"panBy",value:function(we){this.mapService.panBy(we)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(we){this.mapService.setZoom(we)}},{key:"fitBounds",value:function(we,ut){var Ke=this.sceneService.getSceneConfig(),kt=Ke.fitBoundsOptions,yr=Ke.animate;this.mapService.fitBounds(we,ut||lt(lt({},kt),{},{animate:yr}))}},{key:"setZoomAndCenter",value:function(we,ut){this.mapService.setZoomAndCenter(we,ut)}},{key:"setMapStyle",value:function(we){this.mapService.setMapStyle(we)}},{key:"setMapStatus",value:function(we){this.mapService.setMapStatus(we)}},{key:"pixelToLngLat",value:function(we){return this.mapService.pixelToLngLat(we)}},{key:"lngLatToPixel",value:function(we){return this.mapService.lngLatToPixel(we)}},{key:"containerToLngLat",value:function(we){return this.mapService.containerToLngLat(we)}},{key:"lngLatToContainer",value:function(we){return this.mapService.lngLatToContainer(we)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(we,ut){this.container.bind(Y.TYPES.IPostProcessingPass).to(we).whenTargetNamed(ut)}},{key:"initComponent",value:function(we){this.controlService.init({container:zt.a.getContainer(we)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var we=this.sceneService.getSceneConfig(),ut=we.logoVisible,Ke=we.logoPosition;ut&&this.addControl(new D.b({position:Ke}))}},{key:"map",get:function(){return this.mapService.map}}]),Ct}()},kZZr:function(Le,E,i){Le.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},l94r:function(Le,E,i){"use strict";i.d(E,"a",function(){return $});var T=i("lSNA"),m=i.n(T),Z=i("lwsE"),z=i.n(Z),o=i("W8MJ"),W=i.n(o),D=i("7W2i"),Y=i.n(D),q=i("a1gu"),he=i.n(q),X=i("Nsbk"),je=i.n(X),Ge=i("4qC0"),ge=i.n(Ge),Ce=i("lSCD"),ht=i.n(Ce),Ne=i("BkRI"),Et=i.n(Ne),He=i("xp6e"),mt=i("Hel2"),Ye=i("uhBA"),xt=i("rlAn"),_t=i("qxNg");function Ie(G){if(G.length===0)throw new Error("max requires at least one data point");for(var Ae=G[0],xe=1;xe<G.length;xe++)G[xe]>Ae&&(Ae=G[xe]);return Ae}function De(G){if(G.length===0)throw new Error("min requires at least one data point");for(var Ae=G[0],xe=1;xe<G.length;xe++)G[xe]<Ae&&(Ae=G[xe]);return Ae}function ze(G){if(G.length===0)return 0;for(var Ae=G[0],xe=0,Se,ve=1;ve<G.length;ve++)Se=Ae+G[ve]*1,Math.abs(Ae)>=Math.abs(G[ve])?xe+=Ae-Se+G[ve]:xe+=G[ve]-Se+Ae,Ae=Se;return Ae+xe*1}function at(G){if(G.length===0)throw new Error("mean requires at least one data point");return ze(G)/G.length}var Pe={min:De,max:Ie,mean:at,sum:ze};function ot(G,Ae){return G.map(function(xe){return xe[Ae]*1})}function Bt(G,Ae){var xe=Object.keys(G);if(Object.getOwnPropertySymbols){var Se=Object.getOwnPropertySymbols(G);Ae&&(Se=Se.filter(function(ve){return Object.getOwnPropertyDescriptor(G,ve).enumerable})),xe.push.apply(xe,Se)}return xe}function Wt(G){for(var Ae=1;Ae<arguments.length;Ae++){var xe=arguments[Ae]!=null?arguments[Ae]:{};Ae%2?Bt(Object(xe),!0).forEach(function(Se){m()(G,Se,xe[Se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(xe)):Bt(Object(xe)).forEach(function(Se){Object.defineProperty(G,Se,Object.getOwnPropertyDescriptor(xe,Se))})}return G}function sr(G){var Ae=ne();return function(){var Se=je()(G),ve;if(Ae){var et=je()(this).constructor;ve=Reflect.construct(Se,arguments,et)}else ve=Se.apply(this,arguments);return he()(this,ve)}}function ne(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(G){return!1}}var $=function(G){Y()(xe,G);var Ae=sr(xe);function xe(Se,ve){var et;return z()(this,xe),et=Ae.call(this),et.data=void 0,et.extent=void 0,et.hooks={init:new He.c},et.parser={type:"geojson"},et.transforms=[],et.cluster=!1,et.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},et.originData=void 0,et.rawData=void 0,et.clusterIndex=void 0,et.originData=Se,et.initCfg(ve),et.hooks.init.tap("parser",function(){et.excuteParser()}),et.hooks.init.tap("cluster",function(){et.initCluster()}),et.hooks.init.tap("transform",function(){et.executeTrans()}),et.init(),et}return W()(xe,[{key:"setData",value:function(ve,et){this.rawData=ve,this.originData=ve,this.initCfg(et),this.init(),this.emit("update")}},{key:"getClusters",value:function(ve){return this.clusterIndex.getClusters(this.extent,ve)}},{key:"getClustersLeaves",value:function(ve){return this.clusterIndex.getLeaves(ve,Infinity)}},{key:"updateClusterData",value:function(ve){var et=this,Yt=this.clusterOptions,At=Yt.method,ye=At===void 0?"sum":At,be=Yt.field,Ue=Object(mt.r)(Object(mt.h)(this.extent),2),st=this.clusterIndex.getClusters(Ue[0].concat(Ue[1]),Math.floor(ve));this.clusterOptions.zoom=ve,st.forEach(function(Me){Me.id||(Me.properties.point_count=1)}),(be||ht()(ye))&&(st=st.map(function(Me){var ft=Me.id;if(ft){var w=et.clusterIndex.getLeaves(ft,Infinity),I=w.map(function(Be){return Be.properties}),J;if(ge()(ye)&&be){var ce=ot(I,be);J=Pe[ye](ce)}ht()(ye)&&(J=ye(I)),Me.properties.stat=J}else Me.properties.point_count=1;return Me})),this.data=Object(xt.getParser)("geojson")({type:"FeatureCollection",features:st}),this.executeTrans()}},{key:"getFeatureById",value:function(ve){var et=this.parser.type,Yt=et===void 0?"geojson":et;if(Yt==="geojson"&&!this.cluster){var At=ve<this.originData.features.length?this.originData.features[ve]:"null",ye=Et()(At);if(this.transforms.length!==0){var be=this.data.dataArray.find(function(Ue){return Ue._id===ve});ye.properties=be}return ye}else return ve<this.data.dataArray.length?this.data.dataArray[ve]:"null"}},{key:"getFeatureId",value:function(ve,et){var Yt=this.data.dataArray.find(function(At){return At[ve]===name});return Yt==null?void 0:Yt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(ve){ve&&(ve.parser&&(this.parser=ve.parser),ve.transforms&&(this.transforms=ve.transforms),this.cluster=ve.cluster||!1,ve.clusterOptions&&(this.cluster=!0,this.clusterOptions=Wt(Wt({},this.clusterOptions),ve.clusterOptions)))}},{key:"excuteParser",value:function(){var ve=this.parser,et=ve.type||"geojson",Yt=Object(xt.getParser)(et);this.data=Yt(this.originData,ve),this.extent=Object(mt.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var ve=this,et=this.transforms;et.forEach(function(Yt){var At=Yt.type,ye=Object(xt.getTransform)(At)(ve.data,Yt);Object.assign(ve.data,ye)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var ve=this.clusterOptions||{};this.clusterIndex=Object(_t.a)(this.data,ve)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),xe}(Ye.EventEmitter)},lJbI:function(Le,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,Z){var z=Z.extent,o=Z.width,W=Z.height,D=Z.min,Y=Z.max,q={_id:1,dataArray:[{_id:1,data:Array.from(m),width:o,height:W,min:D,max:Y,coordinates:[[z[0],z[1]],[z[2],z[3]]]}]};return q}},mNvP:function(Le,E,i){(function(T,m){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Z;(function(z){(function(o){var W=typeof m=="object"?m:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=Y(z);typeof W.Reflect=="undefined"?W.Reflect=z:D=Y(W.Reflect,D),o(D);function Y(q,he){return function(X,je){typeof q[X]!="function"&&Object.defineProperty(q,X,{configurable:!0,writable:!0,value:je}),he&&he(X,je)}}})(function(o){var W=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",Y=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",q=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",he=typeof Object.create=="function",X={__proto__:[]}instanceof Array,je=!he&&!X,Ge={create:he?function(){return cr(Object.create(null))}:X?function(){return cr({__proto__:null})}:function(){return cr({})},has:je?function(lt,dt){return W.call(lt,dt)}:function(lt,dt){return dt in lt},get:je?function(lt,dt){return W.call(lt,dt)?lt[dt]:void 0}:function(lt,dt){return lt[dt]}},ge=Object.getPrototypeOf(Function),Ce=typeof T=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",ht=!Ce&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:te(),Ne=!Ce&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Je(),Et=!Ce&&typeof WeakMap=="function"?WeakMap:zt(),He=new Et;function mt(lt,dt,Ct,pt){if(Yt(Ct)){if(!I(lt))throw new TypeError;if(!ce(dt))throw new TypeError;return Bt(lt,dt)}else{if(!I(lt))throw new TypeError;if(!be(dt))throw new TypeError;if(!be(pt)&&!Yt(pt)&&!At(pt))throw new TypeError;return At(pt)&&(pt=void 0),Ct=w(Ct),Wt(lt,dt,Ct,pt)}}o("decorate",mt);function Ye(lt,dt){function Ct(pt,we){if(!be(pt))throw new TypeError;if(!Yt(we)&&!Be(we))throw new TypeError;xe(lt,dt,pt,we)}return Ct}o("metadata",Ye);function xt(lt,dt,Ct,pt){if(!be(Ct))throw new TypeError;return Yt(pt)||(pt=w(pt)),xe(lt,dt,Ct,pt)}o("defineMetadata",xt);function _t(lt,dt,Ct){if(!be(dt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),ne(lt,dt,Ct)}o("hasMetadata",_t);function Ie(lt,dt,Ct){if(!be(dt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),$(lt,dt,Ct)}o("hasOwnMetadata",Ie);function De(lt,dt,Ct){if(!be(dt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),G(lt,dt,Ct)}o("getMetadata",De);function ze(lt,dt,Ct){if(!be(dt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),Ae(lt,dt,Ct)}o("getOwnMetadata",ze);function at(lt,dt){if(!be(lt))throw new TypeError;return Yt(dt)||(dt=w(dt)),Se(lt,dt)}o("getMetadataKeys",at);function Pe(lt,dt){if(!be(lt))throw new TypeError;return Yt(dt)||(dt=w(dt)),ve(lt,dt)}o("getOwnMetadataKeys",Pe);function ot(lt,dt,Ct){if(!be(dt))throw new TypeError;Yt(Ct)||(Ct=w(Ct));var pt=sr(dt,Ct,!1);if(Yt(pt))return!1;if(!pt.delete(lt))return!1;if(pt.size>0)return!0;var we=He.get(dt);return we.delete(Ct),we.size>0||He.delete(dt),!0}o("deleteMetadata",ot);function Bt(lt,dt){for(var Ct=lt.length-1;Ct>=0;--Ct){var pt=lt[Ct],we=pt(dt);if(!Yt(we)&&!At(we)){if(!ce(we))throw new TypeError;dt=we}}return dt}function Wt(lt,dt,Ct,pt){for(var we=lt.length-1;we>=0;--we){var ut=lt[we],Ke=ut(dt,Ct,pt);if(!Yt(Ke)&&!At(Ke)){if(!be(Ke))throw new TypeError;pt=Ke}}return pt}function sr(lt,dt,Ct){var pt=He.get(lt);if(Yt(pt)){if(!Ct)return;pt=new ht,He.set(lt,pt)}var we=pt.get(dt);if(Yt(we)){if(!Ct)return;we=new ht,pt.set(dt,we)}return we}function ne(lt,dt,Ct){var pt=$(lt,dt,Ct);if(pt)return!0;var we=Ze(dt);return At(we)?!1:ne(lt,we,Ct)}function $(lt,dt,Ct){var pt=sr(dt,Ct,!1);return Yt(pt)?!1:Me(pt.has(lt))}function G(lt,dt,Ct){var pt=$(lt,dt,Ct);if(pt)return Ae(lt,dt,Ct);var we=Ze(dt);return At(we)?void 0:G(lt,we,Ct)}function Ae(lt,dt,Ct){var pt=sr(dt,Ct,!1);return Yt(pt)?void 0:pt.get(lt)}function xe(lt,dt,Ct,pt){var we=sr(Ct,pt,!0);we.set(lt,dt)}function Se(lt,dt){var Ct=ve(lt,dt),pt=Ze(lt);if(pt===null)return Ct;var we=Se(pt,dt);if(we.length<=0)return Ct;if(Ct.length<=0)return we;for(var ut=new Ne,Ke=[],kt=0,yr=Ct;kt<yr.length;kt++){var Zr=yr[kt],hr=ut.has(Zr);hr||(ut.add(Zr),Ke.push(Zr))}for(var jn=0,yn=we;jn<yn.length;jn++){var Zr=yn[jn],hr=ut.has(Zr);hr||(ut.add(Zr),Ke.push(Zr))}return Ke}function ve(lt,dt){var Ct=[],pt=sr(lt,dt,!1);if(Yt(pt))return Ct;for(var we=pt.keys(),ut=gt(we),Ke=0;;){var kt=It(ut);if(!kt)return Ct.length=Ke,Ct;var yr=tt(kt);try{Ct[Ke]=yr}catch(Zr){try{K(ut)}finally{throw Zr}}Ke++}}function et(lt){if(lt===null)return 1;switch(typeof lt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return lt===null?1:6;default:return 6}}function Yt(lt){return lt===void 0}function At(lt){return lt===null}function ye(lt){return typeof lt=="symbol"}function be(lt){return typeof lt=="object"?lt!==null:typeof lt=="function"}function Ue(lt,dt){switch(et(lt)){case 0:return lt;case 1:return lt;case 2:return lt;case 3:return lt;case 4:return lt;case 5:return lt}var Ct=dt===3?"string":dt===5?"number":"default",pt=Xe(lt,Y);if(pt!==void 0){var we=pt.call(lt,Ct);if(be(we))throw new TypeError;return we}return st(lt,Ct==="default"?"number":Ct)}function st(lt,dt){if(dt==="string"){var Ct=lt.toString;if(J(Ct)){var pt=Ct.call(lt);if(!be(pt))return pt}var we=lt.valueOf;if(J(we)){var pt=we.call(lt);if(!be(pt))return pt}}else{var we=lt.valueOf;if(J(we)){var pt=we.call(lt);if(!be(pt))return pt}var ut=lt.toString;if(J(ut)){var pt=ut.call(lt);if(!be(pt))return pt}}throw new TypeError}function Me(lt){return!!lt}function ft(lt){return""+lt}function w(lt){var dt=Ue(lt,3);return ye(dt)?dt:ft(dt)}function I(lt){return Array.isArray?Array.isArray(lt):lt instanceof Object?lt instanceof Array:Object.prototype.toString.call(lt)==="[object Array]"}function J(lt){return typeof lt=="function"}function ce(lt){return typeof lt=="function"}function Be(lt){switch(et(lt)){case 3:return!0;case 4:return!0;default:return!1}}function Xe(lt,dt){var Ct=lt[dt];if(Ct==null)return;if(!J(Ct))throw new TypeError;return Ct}function gt(lt){var dt=Xe(lt,q);if(!J(dt))throw new TypeError;var Ct=dt.call(lt);if(!be(Ct))throw new TypeError;return Ct}function tt(lt){return lt.value}function It(lt){var dt=lt.next();return dt.done?!1:dt}function K(lt){var dt=lt.return;dt&&dt.call(lt)}function Ze(lt){var dt=Object.getPrototypeOf(lt);if(typeof lt!="function"||lt===ge)return dt;if(dt!==ge)return dt;var Ct=lt.prototype,pt=Ct&&Object.getPrototypeOf(Ct);if(pt==null||pt===Object.prototype)return dt;var we=pt.constructor;return typeof we!="function"||we===lt?dt:we}function te(){var lt={},dt=[],Ct=function(){function Ke(kt,yr,Zr){this._index=0,this._keys=kt,this._values=yr,this._selector=Zr}return Ke.prototype["@@iterator"]=function(){return this},Ke.prototype[q]=function(){return this},Ke.prototype.next=function(){var kt=this._index;if(kt>=0&&kt<this._keys.length){var yr=this._selector(this._keys[kt],this._values[kt]);return kt+1>=this._keys.length?(this._index=-1,this._keys=dt,this._values=dt):this._index++,{value:yr,done:!1}}return{value:void 0,done:!0}},Ke.prototype.throw=function(kt){throw this._index>=0&&(this._index=-1,this._keys=dt,this._values=dt),kt},Ke.prototype.return=function(kt){return this._index>=0&&(this._index=-1,this._keys=dt,this._values=dt),{value:kt,done:!0}},Ke}();return function(){function Ke(){this._keys=[],this._values=[],this._cacheKey=lt,this._cacheIndex=-2}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ke.prototype.has=function(kt){return this._find(kt,!1)>=0},Ke.prototype.get=function(kt){var yr=this._find(kt,!1);return yr>=0?this._values[yr]:void 0},Ke.prototype.set=function(kt,yr){var Zr=this._find(kt,!0);return this._values[Zr]=yr,this},Ke.prototype.delete=function(kt){var yr=this._find(kt,!1);if(yr>=0){for(var Zr=this._keys.length,hr=yr+1;hr<Zr;hr++)this._keys[hr-1]=this._keys[hr],this._values[hr-1]=this._values[hr];return this._keys.length--,this._values.length--,kt===this._cacheKey&&(this._cacheKey=lt,this._cacheIndex=-2),!0}return!1},Ke.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=lt,this._cacheIndex=-2},Ke.prototype.keys=function(){return new Ct(this._keys,this._values,pt)},Ke.prototype.values=function(){return new Ct(this._keys,this._values,we)},Ke.prototype.entries=function(){return new Ct(this._keys,this._values,ut)},Ke.prototype["@@iterator"]=function(){return this.entries()},Ke.prototype[q]=function(){return this.entries()},Ke.prototype._find=function(kt,yr){return this._cacheKey!==kt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=kt)),this._cacheIndex<0&&yr&&(this._cacheIndex=this._keys.length,this._keys.push(kt),this._values.push(void 0)),this._cacheIndex},Ke}();function pt(Ke,kt){return Ke}function we(Ke,kt){return kt}function ut(Ke,kt){return[Ke,kt]}}function Je(){return function(){function lt(){this._map=new ht}return Object.defineProperty(lt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),lt.prototype.has=function(dt){return this._map.has(dt)},lt.prototype.add=function(dt){return this._map.set(dt,dt),this},lt.prototype.delete=function(dt){return this._map.delete(dt)},lt.prototype.clear=function(){this._map.clear()},lt.prototype.keys=function(){return this._map.keys()},lt.prototype.values=function(){return this._map.values()},lt.prototype.entries=function(){return this._map.entries()},lt.prototype["@@iterator"]=function(){return this.keys()},lt.prototype[q]=function(){return this.keys()},lt}()}function zt(){var lt=16,dt=Ge.create(),Ct=pt();return function(){function yr(){this._key=pt()}return yr.prototype.has=function(Zr){var hr=we(Zr,!1);return hr!==void 0?Ge.has(hr,this._key):!1},yr.prototype.get=function(Zr){var hr=we(Zr,!1);return hr!==void 0?Ge.get(hr,this._key):void 0},yr.prototype.set=function(Zr,hr){var jn=we(Zr,!0);return jn[this._key]=hr,this},yr.prototype.delete=function(Zr){var hr=we(Zr,!1);return hr!==void 0?delete hr[this._key]:!1},yr.prototype.clear=function(){this._key=pt()},yr}();function pt(){var yr;do yr="@@WeakMap@@"+kt();while(Ge.has(dt,yr));return dt[yr]=!0,yr}function we(yr,Zr){if(!W.call(yr,Ct)){if(!Zr)return;Object.defineProperty(yr,Ct,{value:Ge.create()})}return yr[Ct]}function ut(yr,Zr){for(var hr=0;hr<Zr;++hr)yr[hr]=Math.random()*255|0;return yr}function Ke(yr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(yr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(yr)):ut(new Uint8Array(yr),yr):ut(new Array(yr),yr)}function kt(){var yr=Ke(lt);yr[6]=yr[6]&79|64,yr[8]=yr[8]&191|128;for(var Zr="",hr=0;hr<lt;++hr){var jn=yr[hr];(hr===4||hr===6||hr===8)&&(Zr+="-"),jn<16&&(Zr+="0"),Zr+=jn.toString(16).toLowerCase()}return Zr}}function cr(lt){return lt.__=void 0,delete lt.__,lt}})})(Z||(Z={}))}).call(this,i("Q2Ig"),i("yLpj"))},mTTR:function(Le,E,i){var T=i("b80T"),m=i("QcOe"),Z=i("MMmD");function z(o){return Z(o)?T(o,!0):m(o)}Le.exports=z},mc0g:function(Le,E){function i(T){return function(m,Z,z){for(var o=-1,W=Object(m),D=z(m),Y=D.length;Y--;){var q=D[T?Y:++o];if(Z(W[q],q,W)===!1)break}return m}}Le.exports=i},mhV4:function(Le,E,i){var T=i("ZK94");Le.exports.geometry=m,Le.exports.ring=z;function m(W){var D=0,Y;switch(W.type){case"Polygon":return Z(W.coordinates);case"MultiPolygon":for(Y=0;Y<W.coordinates.length;Y++)D+=Z(W.coordinates[Y]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Y=0;Y<W.geometries.length;Y++)D+=m(W.geometries[Y]);return D}}function Z(W){var D=0;if(W&&W.length>0){D+=Math.abs(z(W[0]));for(var Y=1;Y<W.length;Y++)D-=Math.abs(z(W[Y]))}return D}function z(W){var D,Y,q,he,X,je,Ge,ge=0,Ce=W.length;if(Ce>2){for(Ge=0;Ge<Ce;Ge++)Ge===Ce-2?(he=Ce-2,X=Ce-1,je=0):Ge===Ce-1?(he=Ce-1,X=0,je=1):(he=Ge,X=Ge+1,je=Ge+2),D=W[he],Y=W[X],q=W[je],ge+=(o(q[0])-o(D[0]))*Math.sin(o(Y[1]));ge=ge*T.RADIUS*T.RADIUS/2}return ge}function o(W){return W*Math.PI/180}},mpbz:function(Le,E,i){(function(T,m){Le.exports=m()})(this,function(){"use strict";function T(Ie,De,ze,at,Pe,ot){if(Pe-at<=ze)return;var Bt=at+Pe>>1;m(Ie,De,Bt,at,Pe,ot%2),T(Ie,De,ze,at,Bt-1,ot+1),T(Ie,De,ze,Bt+1,Pe,ot+1)}function m(Ie,De,ze,at,Pe,ot){for(;Pe>at;){if(Pe-at>600){var Bt=Pe-at+1,Wt=ze-at+1,sr=Math.log(Bt),ne=.5*Math.exp(2*sr/3),$=.5*Math.sqrt(sr*ne*(Bt-ne)/Bt)*(Wt-Bt/2<0?-1:1),G=Math.max(at,Math.floor(ze-Wt*ne/Bt+$)),Ae=Math.min(Pe,Math.floor(ze+(Bt-Wt)*ne/Bt+$));m(Ie,De,ze,G,Ae,ot)}var xe=De[2*ze+ot],Se=at,ve=Pe;for(Z(Ie,De,at,ze),De[2*Pe+ot]>xe&&Z(Ie,De,at,Pe);Se<ve;){for(Z(Ie,De,Se,ve),Se++,ve--;De[2*Se+ot]<xe;)Se++;for(;De[2*ve+ot]>xe;)ve--}De[2*at+ot]===xe?Z(Ie,De,at,ve):(ve++,Z(Ie,De,ve,Pe)),ve<=ze&&(at=ve+1),ze<=ve&&(Pe=ve-1)}}function Z(Ie,De,ze,at){z(Ie,ze,at),z(De,2*ze,2*at),z(De,2*ze+1,2*at+1)}function z(Ie,De,ze){var at=Ie[De];Ie[De]=Ie[ze],Ie[ze]=at}function o(Ie,De,ze,at,Pe,ot,Bt){for(var Wt=[0,Ie.length-1,0],sr=[],ne,$;Wt.length;){var G=Wt.pop(),Ae=Wt.pop(),xe=Wt.pop();if(Ae-xe<=Bt){for(var Se=xe;Se<=Ae;Se++)ne=De[2*Se],$=De[2*Se+1],ne>=ze&&ne<=Pe&&$>=at&&$<=ot&&sr.push(Ie[Se]);continue}var ve=Math.floor((xe+Ae)/2);ne=De[2*ve],$=De[2*ve+1],ne>=ze&&ne<=Pe&&$>=at&&$<=ot&&sr.push(Ie[ve]);var et=(G+1)%2;(G===0?ze<=ne:at<=$)&&(Wt.push(xe),Wt.push(ve-1),Wt.push(et)),(G===0?Pe>=ne:ot>=$)&&(Wt.push(ve+1),Wt.push(Ae),Wt.push(et))}return sr}function W(Ie,De,ze,at,Pe,ot){for(var Bt=[0,Ie.length-1,0],Wt=[],sr=Pe*Pe;Bt.length;){var ne=Bt.pop(),$=Bt.pop(),G=Bt.pop();if($-G<=ot){for(var Ae=G;Ae<=$;Ae++)D(De[2*Ae],De[2*Ae+1],ze,at)<=sr&&Wt.push(Ie[Ae]);continue}var xe=Math.floor((G+$)/2),Se=De[2*xe],ve=De[2*xe+1];D(Se,ve,ze,at)<=sr&&Wt.push(Ie[xe]);var et=(ne+1)%2;(ne===0?ze-Pe<=Se:at-Pe<=ve)&&(Bt.push(G),Bt.push(xe-1),Bt.push(et)),(ne===0?ze+Pe>=Se:at+Pe>=ve)&&(Bt.push(xe+1),Bt.push($),Bt.push(et))}return Wt}function D(Ie,De,ze,at){var Pe=Ie-ze,ot=De-at;return Pe*Pe+ot*ot}var Y=function(De){return De[0]},q=function(De){return De[1]},he=function(De,ze,at,Pe,ot){ze===void 0&&(ze=Y),at===void 0&&(at=q),Pe===void 0&&(Pe=64),ot===void 0&&(ot=Float64Array),this.nodeSize=Pe,this.points=De;for(var Bt=De.length<65536?Uint16Array:Uint32Array,Wt=this.ids=new Bt(De.length),sr=this.coords=new ot(De.length*2),ne=0;ne<De.length;ne++)Wt[ne]=ne,sr[2*ne]=ze(De[ne]),sr[2*ne+1]=at(De[ne]);T(Wt,sr,Pe,0,Wt.length-1,0)};he.prototype.range=function(De,ze,at,Pe){return o(this.ids,this.coords,De,ze,at,Pe,this.nodeSize)},he.prototype.within=function(De,ze,at){return W(this.ids,this.coords,De,ze,at,this.nodeSize)};var X={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(De){return De}},je=function(De){this.options=Ye(Object.create(X),De),this.trees=new Array(this.options.maxZoom+1)};je.prototype.load=function(De){var ze=this.options,at=ze.log,Pe=ze.minZoom,ot=ze.maxZoom,Bt=ze.nodeSize;at&&console.time("total time");var Wt="prepare "+De.length+" points";at&&console.time(Wt),this.points=De;for(var sr=[],ne=0;ne<De.length;ne++){if(!De[ne].geometry)continue;sr.push(ge(De[ne],ne))}this.trees[ot+1]=new he(sr,xt,_t,Bt,Float32Array),at&&console.timeEnd(Wt);for(var $=ot;$>=Pe;$--){var G=+Date.now();sr=this._cluster(sr,$),this.trees[$]=new he(sr,xt,_t,Bt,Float32Array),at&&console.log("z%d: %d clusters in %dms",$,sr.length,+Date.now()-G)}return at&&console.timeEnd("total time"),this},je.prototype.getClusters=function(De,ze){var at=((De[0]+180)%360+360)%360-180,Pe=Math.max(-90,Math.min(90,De[1])),ot=De[2]===180?180:((De[2]+180)%360+360)%360-180,Bt=Math.max(-90,Math.min(90,De[3]));if(De[2]-De[0]>=360)at=-180,ot=180;else if(at>ot){var Wt=this.getClusters([at,Pe,180,Bt],ze),sr=this.getClusters([-180,Pe,ot,Bt],ze);return Wt.concat(sr)}for(var ne=this.trees[this._limitZoom(ze)],$=ne.range(Ne(at),Et(Bt),Ne(ot),Et(Pe)),G=[],Ae=0,xe=$;Ae<xe.length;Ae+=1){var Se=xe[Ae],ve=ne.points[Se];G.push(ve.numPoints?Ce(ve):this.points[ve.index])}return G},je.prototype.getChildren=function(De){var ze=this._getOriginId(De),at=this._getOriginZoom(De),Pe="No cluster with the specified id.",ot=this.trees[at];if(!ot)throw new Error(Pe);var Bt=ot.points[ze];if(!Bt)throw new Error(Pe);for(var Wt=this.options.radius/(this.options.extent*Math.pow(2,at-1)),sr=ot.within(Bt.x,Bt.y,Wt),ne=[],$=0,G=sr;$<G.length;$+=1){var Ae=G[$],xe=ot.points[Ae];xe.parentId===De&&ne.push(xe.numPoints?Ce(xe):this.points[xe.index])}if(ne.length===0)throw new Error(Pe);return ne},je.prototype.getLeaves=function(De,ze,at){ze=ze||10,at=at||0;var Pe=[];return this._appendLeaves(Pe,De,ze,at,0),Pe},je.prototype.getTile=function(De,ze,at){var Pe=this.trees[this._limitZoom(De)],ot=Math.pow(2,De),Bt=this.options,Wt=Bt.extent,sr=Bt.radius,ne=sr/Wt,$=(at-ne)/ot,G=(at+1+ne)/ot,Ae={features:[]};return this._addTileFeatures(Pe.range((ze-ne)/ot,$,(ze+1+ne)/ot,G),Pe.points,ze,at,ot,Ae),ze===0&&this._addTileFeatures(Pe.range(1-ne/ot,$,1,G),Pe.points,ot,at,ot,Ae),ze===ot-1&&this._addTileFeatures(Pe.range(0,$,ne/ot,G),Pe.points,-1,at,ot,Ae),Ae.features.length?Ae:null},je.prototype.getClusterExpansionZoom=function(De){for(var ze=this._getOriginZoom(De)-1;ze<=this.options.maxZoom;){var at=this.getChildren(De);if(ze++,at.length!==1)break;De=at[0].properties.cluster_id}return ze},je.prototype._appendLeaves=function(De,ze,at,Pe,ot){for(var Bt=this.getChildren(ze),Wt=0,sr=Bt;Wt<sr.length;Wt+=1){var ne=sr[Wt],$=ne.properties;if($&&$.cluster?ot+$.point_count<=Pe?ot+=$.point_count:ot=this._appendLeaves(De,$.cluster_id,at,Pe,ot):ot<Pe?ot++:De.push(ne),De.length===at)break}return ot},je.prototype._addTileFeatures=function(De,ze,at,Pe,ot,Bt){for(var Wt=0,sr=De;Wt<sr.length;Wt+=1){var ne=sr[Wt],$=ze[ne],G=$.numPoints,Ae={type:1,geometry:[[Math.round(this.options.extent*($.x*ot-at)),Math.round(this.options.extent*($.y*ot-Pe))]],tags:G?ht($):this.points[$.index].properties},xe=void 0;G?xe=$.id:this.options.generateId?xe=$.index:this.points[$.index].id&&(xe=this.points[$.index].id),xe!==void 0&&(Ae.id=xe),Bt.features.push(Ae)}},je.prototype._limitZoom=function(De){return Math.max(this.options.minZoom,Math.min(+De,this.options.maxZoom+1))},je.prototype._cluster=function(De,ze){for(var at=[],Pe=this.options,ot=Pe.radius,Bt=Pe.extent,Wt=Pe.reduce,sr=Pe.minPoints,ne=ot/(Bt*Math.pow(2,ze)),$=0;$<De.length;$++){var G=De[$];if(G.zoom<=ze)continue;G.zoom=ze;for(var Ae=this.trees[ze+1],xe=Ae.within(G.x,G.y,ne),Se=G.numPoints||1,ve=Se,et=0,Yt=xe;et<Yt.length;et+=1){var At=Yt[et],ye=Ae.points[At];ye.zoom>ze&&(ve+=ye.numPoints||1)}if(ve>=sr){for(var be=G.x*Se,Ue=G.y*Se,st=Wt&&Se>1?this._map(G,!0):null,Me=($<<5)+(ze+1)+this.points.length,ft=0,w=xe;ft<w.length;ft+=1){var I=w[ft],J=Ae.points[I];if(J.zoom<=ze)continue;J.zoom=ze;var ce=J.numPoints||1;be+=J.x*ce,Ue+=J.y*ce,J.parentId=Me,Wt&&(st||(st=this._map(G,!0)),Wt(st,this._map(J)))}G.parentId=Me,at.push(Ge(be/ve,Ue/ve,Me,ve,st))}else if(at.push(G),ve>1)for(var Be=0,Xe=xe;Be<Xe.length;Be+=1){var gt=Xe[Be],tt=Ae.points[gt];if(tt.zoom<=ze)continue;tt.zoom=ze,at.push(tt)}}return at},je.prototype._getOriginId=function(De){return De-this.points.length>>5},je.prototype._getOriginZoom=function(De){return(De-this.points.length)%32},je.prototype._map=function(De,ze){if(De.numPoints)return ze?Ye({},De.properties):De.properties;var at=this.points[De.index].properties,Pe=this.options.map(at);return ze&&Pe===at?Ye({},Pe):Pe};function Ge(Ie,De,ze,at,Pe){return{x:Ie,y:De,zoom:Infinity,id:ze,parentId:-1,numPoints:at,properties:Pe}}function ge(Ie,De){var ze=Ie.geometry.coordinates,at=ze[0],Pe=ze[1];return{x:Ne(at),y:Et(Pe),zoom:Infinity,index:De,parentId:-1}}function Ce(Ie){return{type:"Feature",id:Ie.id,properties:ht(Ie),geometry:{type:"Point",coordinates:[He(Ie.x),mt(Ie.y)]}}}function ht(Ie){var De=Ie.numPoints,ze=De>=1e4?Math.round(De/1e3)+"k":De>=1e3?Math.round(De/100)/10+"k":De;return Ye(Ye({},Ie.properties),{cluster:!0,cluster_id:Ie.id,point_count:De,point_count_abbreviated:ze})}function Ne(Ie){return Ie/360+.5}function Et(Ie){var De=Math.sin(Ie*Math.PI/180),ze=.5-.25*Math.log((1+De)/(1-De))/Math.PI;return ze<0?0:ze>1?1:ze}function He(Ie){return(Ie-.5)*360}function mt(Ie){var De=(180-Ie*360)*Math.PI/180;return 360*Math.atan(Math.exp(De))/Math.PI-90}function Ye(Ie,De){for(var ze in De)Ie[ze]=De[ze];return Ie}function xt(Ie){return Ie.x}function _t(Ie){return Ie.y}return je})},"mv/X":function(Le,E,i){var T=i("ljhN"),m=i("MMmD"),Z=i("wJg7"),z=i("GoyQ");function o(W,D,Y){if(!z(Y))return!1;var q=typeof D;return(q=="number"?m(Y)&&Z(D,Y.length):q=="string"&&D in Y)?T(Y[D],W):!1}Le.exports=o},"n+fv":function(Le,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return Z}),i.d(E,"length",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"copy",function(){return W}),i.d(E,"set",function(){return D}),i.d(E,"add",function(){return Y}),i.d(E,"subtract",function(){return q}),i.d(E,"multiply",function(){return he}),i.d(E,"divide",function(){return X}),i.d(E,"ceil",function(){return je}),i.d(E,"floor",function(){return Ge}),i.d(E,"min",function(){return ge}),i.d(E,"max",function(){return Ce}),i.d(E,"round",function(){return ht}),i.d(E,"scale",function(){return Ne}),i.d(E,"scaleAndAdd",function(){return Et}),i.d(E,"distance",function(){return He}),i.d(E,"squaredDistance",function(){return mt}),i.d(E,"squaredLength",function(){return Ye}),i.d(E,"negate",function(){return xt}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ie}),i.d(E,"dot",function(){return De}),i.d(E,"cross",function(){return ze}),i.d(E,"lerp",function(){return at}),i.d(E,"hermite",function(){return Pe}),i.d(E,"bezier",function(){return ot}),i.d(E,"random",function(){return Bt}),i.d(E,"transformMat4",function(){return Wt}),i.d(E,"transformMat3",function(){return sr}),i.d(E,"transformQuat",function(){return ne}),i.d(E,"rotateX",function(){return $}),i.d(E,"rotateY",function(){return G}),i.d(E,"rotateZ",function(){return Ae}),i.d(E,"angle",function(){return xe}),i.d(E,"zero",function(){return Se}),i.d(E,"str",function(){return ve}),i.d(E,"exactEquals",function(){return et}),i.d(E,"equals",function(){return Yt}),i.d(E,"sub",function(){return At}),i.d(E,"mul",function(){return ye}),i.d(E,"div",function(){return be}),i.d(E,"dist",function(){return Ue}),i.d(E,"sqrDist",function(){return st}),i.d(E,"len",function(){return Me}),i.d(E,"sqrLen",function(){return ft}),i.d(E,"forEach",function(){return w});var T=i("yU0y");function m(){var I=new T.a(3);return T.a!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function Z(I){var J=new T.a(3);return J[0]=I[0],J[1]=I[1],J[2]=I[2],J}function z(I){var J=I[0],ce=I[1],Be=I[2];return Math.hypot(J,ce,Be)}function o(I,J,ce){var Be=new T.a(3);return Be[0]=I,Be[1]=J,Be[2]=ce,Be}function W(I,J){return I[0]=J[0],I[1]=J[1],I[2]=J[2],I}function D(I,J,ce,Be){return I[0]=J,I[1]=ce,I[2]=Be,I}function Y(I,J,ce){return I[0]=J[0]+ce[0],I[1]=J[1]+ce[1],I[2]=J[2]+ce[2],I}function q(I,J,ce){return I[0]=J[0]-ce[0],I[1]=J[1]-ce[1],I[2]=J[2]-ce[2],I}function he(I,J,ce){return I[0]=J[0]*ce[0],I[1]=J[1]*ce[1],I[2]=J[2]*ce[2],I}function X(I,J,ce){return I[0]=J[0]/ce[0],I[1]=J[1]/ce[1],I[2]=J[2]/ce[2],I}function je(I,J){return I[0]=Math.ceil(J[0]),I[1]=Math.ceil(J[1]),I[2]=Math.ceil(J[2]),I}function Ge(I,J){return I[0]=Math.floor(J[0]),I[1]=Math.floor(J[1]),I[2]=Math.floor(J[2]),I}function ge(I,J,ce){return I[0]=Math.min(J[0],ce[0]),I[1]=Math.min(J[1],ce[1]),I[2]=Math.min(J[2],ce[2]),I}function Ce(I,J,ce){return I[0]=Math.max(J[0],ce[0]),I[1]=Math.max(J[1],ce[1]),I[2]=Math.max(J[2],ce[2]),I}function ht(I,J){return I[0]=Math.round(J[0]),I[1]=Math.round(J[1]),I[2]=Math.round(J[2]),I}function Ne(I,J,ce){return I[0]=J[0]*ce,I[1]=J[1]*ce,I[2]=J[2]*ce,I}function Et(I,J,ce,Be){return I[0]=J[0]+ce[0]*Be,I[1]=J[1]+ce[1]*Be,I[2]=J[2]+ce[2]*Be,I}function He(I,J){var ce=J[0]-I[0],Be=J[1]-I[1],Xe=J[2]-I[2];return Math.hypot(ce,Be,Xe)}function mt(I,J){var ce=J[0]-I[0],Be=J[1]-I[1],Xe=J[2]-I[2];return ce*ce+Be*Be+Xe*Xe}function Ye(I){var J=I[0],ce=I[1],Be=I[2];return J*J+ce*ce+Be*Be}function xt(I,J){return I[0]=-J[0],I[1]=-J[1],I[2]=-J[2],I}function _t(I,J){return I[0]=1/J[0],I[1]=1/J[1],I[2]=1/J[2],I}function Ie(I,J){var ce=J[0],Be=J[1],Xe=J[2],gt=ce*ce+Be*Be+Xe*Xe;return gt>0&&(gt=1/Math.sqrt(gt)),I[0]=J[0]*gt,I[1]=J[1]*gt,I[2]=J[2]*gt,I}function De(I,J){return I[0]*J[0]+I[1]*J[1]+I[2]*J[2]}function ze(I,J,ce){var Be=J[0],Xe=J[1],gt=J[2],tt=ce[0],It=ce[1],K=ce[2];return I[0]=Xe*K-gt*It,I[1]=gt*tt-Be*K,I[2]=Be*It-Xe*tt,I}function at(I,J,ce,Be){var Xe=J[0],gt=J[1],tt=J[2];return I[0]=Xe+Be*(ce[0]-Xe),I[1]=gt+Be*(ce[1]-gt),I[2]=tt+Be*(ce[2]-tt),I}function Pe(I,J,ce,Be,Xe,gt){var tt=gt*gt,It=tt*(2*gt-3)+1,K=tt*(gt-2)+gt,Ze=tt*(gt-1),te=tt*(3-2*gt);return I[0]=J[0]*It+ce[0]*K+Be[0]*Ze+Xe[0]*te,I[1]=J[1]*It+ce[1]*K+Be[1]*Ze+Xe[1]*te,I[2]=J[2]*It+ce[2]*K+Be[2]*Ze+Xe[2]*te,I}function ot(I,J,ce,Be,Xe,gt){var tt=1-gt,It=tt*tt,K=gt*gt,Ze=It*tt,te=3*gt*It,Je=3*K*tt,zt=K*gt;return I[0]=J[0]*Ze+ce[0]*te+Be[0]*Je+Xe[0]*zt,I[1]=J[1]*Ze+ce[1]*te+Be[1]*Je+Xe[1]*zt,I[2]=J[2]*Ze+ce[2]*te+Be[2]*Je+Xe[2]*zt,I}function Bt(I,J){J=J||1;var ce=T.c()*2*Math.PI,Be=T.c()*2-1,Xe=Math.sqrt(1-Be*Be)*J;return I[0]=Math.cos(ce)*Xe,I[1]=Math.sin(ce)*Xe,I[2]=Be*J,I}function Wt(I,J,ce){var Be=J[0],Xe=J[1],gt=J[2],tt=ce[3]*Be+ce[7]*Xe+ce[11]*gt+ce[15];return tt=tt||1,I[0]=(ce[0]*Be+ce[4]*Xe+ce[8]*gt+ce[12])/tt,I[1]=(ce[1]*Be+ce[5]*Xe+ce[9]*gt+ce[13])/tt,I[2]=(ce[2]*Be+ce[6]*Xe+ce[10]*gt+ce[14])/tt,I}function sr(I,J,ce){var Be=J[0],Xe=J[1],gt=J[2];return I[0]=Be*ce[0]+Xe*ce[3]+gt*ce[6],I[1]=Be*ce[1]+Xe*ce[4]+gt*ce[7],I[2]=Be*ce[2]+Xe*ce[5]+gt*ce[8],I}function ne(I,J,ce){var Be=ce[0],Xe=ce[1],gt=ce[2],tt=ce[3],It=J[0],K=J[1],Ze=J[2],te=Xe*Ze-gt*K,Je=gt*It-Be*Ze,zt=Be*K-Xe*It,cr=Xe*zt-gt*Je,lt=gt*te-Be*zt,dt=Be*Je-Xe*te,Ct=tt*2;return te*=Ct,Je*=Ct,zt*=Ct,cr*=2,lt*=2,dt*=2,I[0]=It+te+cr,I[1]=K+Je+lt,I[2]=Ze+zt+dt,I}function $(I,J,ce,Be){var Xe=[],gt=[];return Xe[0]=J[0]-ce[0],Xe[1]=J[1]-ce[1],Xe[2]=J[2]-ce[2],gt[0]=Xe[0],gt[1]=Xe[1]*Math.cos(Be)-Xe[2]*Math.sin(Be),gt[2]=Xe[1]*Math.sin(Be)+Xe[2]*Math.cos(Be),I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function G(I,J,ce,Be){var Xe=[],gt=[];return Xe[0]=J[0]-ce[0],Xe[1]=J[1]-ce[1],Xe[2]=J[2]-ce[2],gt[0]=Xe[2]*Math.sin(Be)+Xe[0]*Math.cos(Be),gt[1]=Xe[1],gt[2]=Xe[2]*Math.cos(Be)-Xe[0]*Math.sin(Be),I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function Ae(I,J,ce,Be){var Xe=[],gt=[];return Xe[0]=J[0]-ce[0],Xe[1]=J[1]-ce[1],Xe[2]=J[2]-ce[2],gt[0]=Xe[0]*Math.cos(Be)-Xe[1]*Math.sin(Be),gt[1]=Xe[0]*Math.sin(Be)+Xe[1]*Math.cos(Be),gt[2]=Xe[2],I[0]=gt[0]+ce[0],I[1]=gt[1]+ce[1],I[2]=gt[2]+ce[2],I}function xe(I,J){var ce=I[0],Be=I[1],Xe=I[2],gt=J[0],tt=J[1],It=J[2],K=Math.sqrt(ce*ce+Be*Be+Xe*Xe),Ze=Math.sqrt(gt*gt+tt*tt+It*It),te=K*Ze,Je=te&&De(I,J)/te;return Math.acos(Math.min(Math.max(Je,-1),1))}function Se(I){return I[0]=0,I[1]=0,I[2]=0,I}function ve(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"}function et(I,J){return I[0]===J[0]&&I[1]===J[1]&&I[2]===J[2]}function Yt(I,J){var ce=I[0],Be=I[1],Xe=I[2],gt=J[0],tt=J[1],It=J[2];return Math.abs(ce-gt)<=T.b*Math.max(1,Math.abs(ce),Math.abs(gt))&&Math.abs(Be-tt)<=T.b*Math.max(1,Math.abs(Be),Math.abs(tt))&&Math.abs(Xe-It)<=T.b*Math.max(1,Math.abs(Xe),Math.abs(It))}var At=q,ye=he,be=X,Ue=He,st=mt,Me=z,ft=Ye,w=function(){var I=m();return function(J,ce,Be,Xe,gt,tt){var It,K;for(ce||(ce=3),Be||(Be=0),Xe?K=Math.min(Xe*ce+Be,J.length):K=J.length,It=Be;It<K;It+=ce)I[0]=J[It],I[1]=J[It+1],I[2]=J[It+2],gt(I,I,tt),J[It]=I[0],J[It+1]=I[1],J[It+2]=I[2];return J}}()},n2J3:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=i("Ztfv");function z(){return function(o,W,D){var Y=new m.Metadata(T.UNMANAGED_TAG,!0);Z.tagParameter(o,W,D,Y)}}E.unmanaged=z},n3AX:function(Le,E,i){var T=i("Nsbk");function m(Z,z){for(;!Object.prototype.hasOwnProperty.call(Z,z)&&!(Z=T(Z),Z===null););return Z}Le.exports=m},"o+pz":function(Le,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m[m.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",m[m.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",m[m.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",m[m.POINTS=0]="POINTS",m[m.LINES=1]="LINES",m[m.LINE_LOOP=2]="LINE_LOOP",m[m.LINE_STRIP=3]="LINE_STRIP",m[m.TRIANGLES=4]="TRIANGLES",m[m.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",m[m.TRIANGLE_FAN=6]="TRIANGLE_FAN",m[m.ZERO=0]="ZERO",m[m.ONE=1]="ONE",m[m.SRC_COLOR=768]="SRC_COLOR",m[m.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",m[m.SRC_ALPHA=770]="SRC_ALPHA",m[m.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",m[m.DST_ALPHA=772]="DST_ALPHA",m[m.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",m[m.DST_COLOR=774]="DST_COLOR",m[m.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",m[m.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",m[m.FUNC_ADD=32774]="FUNC_ADD",m[m.BLEND_EQUATION=32777]="BLEND_EQUATION",m[m.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",m[m.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",m[m.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",m[m.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",m[m.MAX_EXT=32776]="MAX_EXT",m[m.MIN_EXT=32775]="MIN_EXT",m[m.BLEND_DST_RGB=32968]="BLEND_DST_RGB",m[m.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",m[m.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",m[m.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",m[m.CONSTANT_COLOR=32769]="CONSTANT_COLOR",m[m.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",m[m.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",m[m.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",m[m.BLEND_COLOR=32773]="BLEND_COLOR",m[m.ARRAY_BUFFER=34962]="ARRAY_BUFFER",m[m.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",m[m.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",m[m.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",m[m.STREAM_DRAW=35040]="STREAM_DRAW",m[m.STATIC_DRAW=35044]="STATIC_DRAW",m[m.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",m[m.BUFFER_SIZE=34660]="BUFFER_SIZE",m[m.BUFFER_USAGE=34661]="BUFFER_USAGE",m[m.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",m[m.FRONT=1028]="FRONT",m[m.BACK=1029]="BACK",m[m.FRONT_AND_BACK=1032]="FRONT_AND_BACK",m[m.CULL_FACE=2884]="CULL_FACE",m[m.BLEND=3042]="BLEND",m[m.DITHER=3024]="DITHER",m[m.STENCIL_TEST=2960]="STENCIL_TEST",m[m.DEPTH_TEST=2929]="DEPTH_TEST",m[m.SCISSOR_TEST=3089]="SCISSOR_TEST",m[m.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",m[m.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",m[m.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",m[m.NO_ERROR=0]="NO_ERROR",m[m.INVALID_ENUM=1280]="INVALID_ENUM",m[m.INVALID_VALUE=1281]="INVALID_VALUE",m[m.INVALID_OPERATION=1282]="INVALID_OPERATION",m[m.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",m[m.CW=2304]="CW",m[m.CCW=2305]="CCW",m[m.LINE_WIDTH=2849]="LINE_WIDTH",m[m.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",m[m.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",m[m.CULL_FACE_MODE=2885]="CULL_FACE_MODE",m[m.FRONT_FACE=2886]="FRONT_FACE",m[m.DEPTH_RANGE=2928]="DEPTH_RANGE",m[m.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",m[m.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",m[m.DEPTH_FUNC=2932]="DEPTH_FUNC",m[m.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",m[m.STENCIL_FUNC=2962]="STENCIL_FUNC",m[m.STENCIL_FAIL=2964]="STENCIL_FAIL",m[m.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",m[m.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",m[m.STENCIL_REF=2967]="STENCIL_REF",m[m.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",m[m.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",m[m.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",m[m.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",m[m.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",m[m.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",m[m.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",m[m.VIEWPORT=2978]="VIEWPORT",m[m.SCISSOR_BOX=3088]="SCISSOR_BOX",m[m.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",m[m.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",m[m.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",m[m.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",m[m.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",m[m.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",m[m.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",m[m.RED_BITS=3410]="RED_BITS",m[m.GREEN_BITS=3411]="GREEN_BITS",m[m.BLUE_BITS=3412]="BLUE_BITS",m[m.ALPHA_BITS=3413]="ALPHA_BITS",m[m.DEPTH_BITS=3414]="DEPTH_BITS",m[m.STENCIL_BITS=3415]="STENCIL_BITS",m[m.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",m[m.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",m[m.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",m[m.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",m[m.SAMPLES=32937]="SAMPLES",m[m.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",m[m.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",m[m.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",m[m.DONT_CARE=4352]="DONT_CARE",m[m.FASTEST=4353]="FASTEST",m[m.NICEST=4354]="NICEST",m[m.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",m[m.BYTE=5120]="BYTE",m[m.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",m[m.SHORT=5122]="SHORT",m[m.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",m[m.INT=5124]="INT",m[m.UNSIGNED_INT=5125]="UNSIGNED_INT",m[m.FLOAT=5126]="FLOAT",m[m.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",m[m.ALPHA=6406]="ALPHA",m[m.RGB=6407]="RGB",m[m.RGBA=6408]="RGBA",m[m.LUMINANCE=6409]="LUMINANCE",m[m.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",m[m.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",m[m.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",m[m.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",m[m.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",m[m.VERTEX_SHADER=35633]="VERTEX_SHADER",m[m.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",m[m.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",m[m.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",m[m.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",m[m.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",m[m.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",m[m.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",m[m.SHADER_TYPE=35663]="SHADER_TYPE",m[m.DELETE_STATUS=35712]="DELETE_STATUS",m[m.LINK_STATUS=35714]="LINK_STATUS",m[m.VALIDATE_STATUS=35715]="VALIDATE_STATUS",m[m.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",m[m.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",m[m.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",m[m.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",m[m.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",m[m.NEVER=512]="NEVER",m[m.LESS=513]="LESS",m[m.EQUAL=514]="EQUAL",m[m.LEQUAL=515]="LEQUAL",m[m.GREATER=516]="GREATER",m[m.NOTEQUAL=517]="NOTEQUAL",m[m.GEQUAL=518]="GEQUAL",m[m.ALWAYS=519]="ALWAYS",m[m.KEEP=7680]="KEEP",m[m.REPLACE=7681]="REPLACE",m[m.INCR=7682]="INCR",m[m.DECR=7683]="DECR",m[m.INVERT=5386]="INVERT",m[m.INCR_WRAP=34055]="INCR_WRAP",m[m.DECR_WRAP=34056]="DECR_WRAP",m[m.VENDOR=7936]="VENDOR",m[m.RENDERER=7937]="RENDERER",m[m.VERSION=7938]="VERSION",m[m.NEAREST=9728]="NEAREST",m[m.LINEAR=9729]="LINEAR",m[m.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",m[m.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",m[m.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",m[m.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",m[m.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",m[m.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",m[m.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",m[m.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",m[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE=5890]="TEXTURE",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",m[m.TEXTURE0=33984]="TEXTURE0",m[m.TEXTURE1=33985]="TEXTURE1",m[m.TEXTURE2=33986]="TEXTURE2",m[m.TEXTURE3=33987]="TEXTURE3",m[m.TEXTURE4=33988]="TEXTURE4",m[m.TEXTURE5=33989]="TEXTURE5",m[m.TEXTURE6=33990]="TEXTURE6",m[m.TEXTURE7=33991]="TEXTURE7",m[m.TEXTURE8=33992]="TEXTURE8",m[m.TEXTURE9=33993]="TEXTURE9",m[m.TEXTURE10=33994]="TEXTURE10",m[m.TEXTURE11=33995]="TEXTURE11",m[m.TEXTURE12=33996]="TEXTURE12",m[m.TEXTURE13=33997]="TEXTURE13",m[m.TEXTURE14=33998]="TEXTURE14",m[m.TEXTURE15=33999]="TEXTURE15",m[m.TEXTURE16=34e3]="TEXTURE16",m[m.TEXTURE17=34001]="TEXTURE17",m[m.TEXTURE18=34002]="TEXTURE18",m[m.TEXTURE19=34003]="TEXTURE19",m[m.TEXTURE20=34004]="TEXTURE20",m[m.TEXTURE21=34005]="TEXTURE21",m[m.TEXTURE22=34006]="TEXTURE22",m[m.TEXTURE23=34007]="TEXTURE23",m[m.TEXTURE24=34008]="TEXTURE24",m[m.TEXTURE25=34009]="TEXTURE25",m[m.TEXTURE26=34010]="TEXTURE26",m[m.TEXTURE27=34011]="TEXTURE27",m[m.TEXTURE28=34012]="TEXTURE28",m[m.TEXTURE29=34013]="TEXTURE29",m[m.TEXTURE30=34014]="TEXTURE30",m[m.TEXTURE31=34015]="TEXTURE31",m[m.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",m[m.REPEAT=10497]="REPEAT",m[m.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",m[m.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",m[m.FLOAT_VEC2=35664]="FLOAT_VEC2",m[m.FLOAT_VEC3=35665]="FLOAT_VEC3",m[m.FLOAT_VEC4=35666]="FLOAT_VEC4",m[m.INT_VEC2=35667]="INT_VEC2",m[m.INT_VEC3=35668]="INT_VEC3",m[m.INT_VEC4=35669]="INT_VEC4",m[m.BOOL=35670]="BOOL",m[m.BOOL_VEC2=35671]="BOOL_VEC2",m[m.BOOL_VEC3=35672]="BOOL_VEC3",m[m.BOOL_VEC4=35673]="BOOL_VEC4",m[m.FLOAT_MAT2=35674]="FLOAT_MAT2",m[m.FLOAT_MAT3=35675]="FLOAT_MAT3",m[m.FLOAT_MAT4=35676]="FLOAT_MAT4",m[m.SAMPLER_2D=35678]="SAMPLER_2D",m[m.SAMPLER_CUBE=35680]="SAMPLER_CUBE",m[m.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",m[m.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",m[m.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",m[m.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",m[m.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",m[m.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",m[m.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",m[m.COMPILE_STATUS=35713]="COMPILE_STATUS",m[m.LOW_FLOAT=36336]="LOW_FLOAT",m[m.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",m[m.HIGH_FLOAT=36338]="HIGH_FLOAT",m[m.LOW_INT=36339]="LOW_INT",m[m.MEDIUM_INT=36340]="MEDIUM_INT",m[m.HIGH_INT=36341]="HIGH_INT",m[m.FRAMEBUFFER=36160]="FRAMEBUFFER",m[m.RENDERBUFFER=36161]="RENDERBUFFER",m[m.RGBA4=32854]="RGBA4",m[m.RGB5_A1=32855]="RGB5_A1",m[m.RGB565=36194]="RGB565",m[m.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",m[m.STENCIL_INDEX=6401]="STENCIL_INDEX",m[m.STENCIL_INDEX8=36168]="STENCIL_INDEX8",m[m.DEPTH_STENCIL=34041]="DEPTH_STENCIL",m[m.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",m[m.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",m[m.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",m[m.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",m[m.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",m[m.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",m[m.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",m[m.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",m[m.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",m[m.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",m[m.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",m[m.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",m[m.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",m[m.NONE=0]="NONE",m[m.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",m[m.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",m[m.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",m[m.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",m[m.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",m[m.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",m[m.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",m[m.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",m[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",m[m.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",m[m.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",m[m.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(T||(T={}))},"oCl/":function(Le,E,i){var T=i("CH3K"),m=i("LcsW"),Z=i("MvSz"),z=i("0ycA"),o=Object.getOwnPropertySymbols,W=o?function(D){for(var Y=[];D;)T(Y,Z(D)),D=m(D);return Y}:z;Le.exports=W},oIFs:function(Le,E,i){Le.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(Le,E,i){var T=i("Nsbk"),m=i("SksO"),Z=i("xfeJ"),z=i("sXyB");function o(W){var D=typeof Map=="function"?new Map:void 0;return Le.exports=o=function(q){if(q===null||!Z(q))return q;if(typeof q!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(q))return D.get(q);D.set(q,he)}function he(){return z(q,arguments,T(this).constructor)}return he.prototype=Object.create(q.prototype,{constructor:{value:he,enumerable:!1,writable:!0,configurable:!0}}),m(he,q)},o(W)}Le.exports=o},oaX6:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),Z=i("Ztfv");function z(o){return function(W,D,Y){var q=new m.Metadata(T.NAME_TAG,o);Z.tagParameter(W,D,Y,q)}}E.targetName=z},"otv/":function(Le,E,i){var T=i("nmnc"),m=T?T.prototype:void 0,Z=m?m.valueOf:void 0;function z(o){return Z?Object(Z.call(o)):{}}Le.exports=z},"oy+k":function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function Z(z){this.id=T.id(),this.container=z}return Z.prototype.addPlan=function(z){this.plan=z},Z.prototype.setCurrentRequest=function(z){this.currentRequest=z},Z}();E.Context=m},pFRH:function(Le,E,i){var T=i("cvCv"),m=i("O0oS"),Z=i("zZ0H"),z=m?function(o,W){return m(o,"toString",{configurable:!0,enumerable:!1,value:T(W),writable:!0})}:Z;Le.exports=z},q4HE:function(Le,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",z=T+m+Z,o="\\ufe0e\\ufe0f",W="["+i+"]",D="["+z+"]",Y="\\ud83c[\\udffb-\\udfff]",q="(?:"+D+"|"+Y+")",he="[^"+i+"]",X="(?:\\ud83c[\\udde6-\\uddff]){2}",je="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="\\u200d",ge=q+"?",Ce="["+o+"]?",ht="(?:"+Ge+"(?:"+[he,X,je].join("|")+")"+Ce+ge+")*",Ne=Ce+ge+ht,Et="(?:"+[he+D+"?",D,X,je,W].join("|")+")",He=RegExp(Y+"(?="+Y+")|"+Et+Ne,"g");function mt(Ye){for(var xt=He.lastIndex=0;He.test(Ye);)++xt;return xt}Le.exports=mt},qK8v:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(Z){return Z instanceof RangeError||Z.message===T.STACK_OVERFLOW}E.isStackOverflowExeption=m},qRkn:function(Le,E,i){var T=i("3cYt"),m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Z=T(m);Le.exports=Z},qd8s:function(Le,E,i){(function(T,m){var Z=200,z="__lodash_hash_undefined__",o=800,W=16,D=9007199254740991,Y="[object Arguments]",q="[object Array]",he="[object AsyncFunction]",X="[object Boolean]",je="[object Date]",Ge="[object Error]",ge="[object Function]",Ce="[object GeneratorFunction]",ht="[object Map]",Ne="[object Number]",Et="[object Null]",He="[object Object]",mt="[object Proxy]",Ye="[object RegExp]",xt="[object Set]",_t="[object String]",Ie="[object Undefined]",De="[object WeakMap]",ze="[object ArrayBuffer]",at="[object DataView]",Pe="[object Float32Array]",ot="[object Float64Array]",Bt="[object Int8Array]",Wt="[object Int16Array]",sr="[object Int32Array]",ne="[object Uint8Array]",$="[object Uint8ClampedArray]",G="[object Uint16Array]",Ae="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,Se=/^\[object .+?Constructor\]$/,ve=/^(?:0|[1-9]\d*)$/,et={};et[Pe]=et[ot]=et[Bt]=et[Wt]=et[sr]=et[ne]=et[$]=et[G]=et[Ae]=!0,et[Y]=et[q]=et[ze]=et[X]=et[at]=et[je]=et[Ge]=et[ge]=et[ht]=et[Ne]=et[He]=et[Ye]=et[xt]=et[_t]=et[De]=!1;var Yt=typeof T=="object"&&T&&T.Object===Object&&T,At=typeof self=="object"&&self&&self.Object===Object&&self,ye=Yt||At||Function("return this")(),be=E&&!E.nodeType&&E,Ue=be&&typeof m=="object"&&m&&!m.nodeType&&m,st=Ue&&Ue.exports===be,Me=st&&Yt.process,ft=function(){try{var wt=Ue&&Ue.require&&Ue.require("util").types;return wt||Me&&Me.binding&&Me.binding("util")}catch(qt){}}(),w=ft&&ft.isTypedArray;function I(wt,qt,wr){switch(wr.length){case 0:return wt.call(qt);case 1:return wt.call(qt,wr[0]);case 2:return wt.call(qt,wr[0],wr[1]);case 3:return wt.call(qt,wr[0],wr[1],wr[2])}return wt.apply(qt,wr)}function J(wt,qt){for(var wr=-1,Xn=Array(wt);++wr<wt;)Xn[wr]=qt(wr);return Xn}function ce(wt){return function(qt){return wt(qt)}}function Be(wt,qt){return wt==null?void 0:wt[qt]}function Xe(wt,qt){return function(wr){return wt(qt(wr))}}var gt=Array.prototype,tt=Function.prototype,It=Object.prototype,K=ye["__core-js_shared__"],Ze=tt.toString,te=It.hasOwnProperty,Je=function(){var wt=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return wt?"Symbol(src)_1."+wt:""}(),zt=It.toString,cr=Ze.call(Object),lt=RegExp("^"+Ze.call(te).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dt=st?ye.Buffer:void 0,Ct=ye.Symbol,pt=ye.Uint8Array,we=dt?dt.allocUnsafe:void 0,ut=Xe(Object.getPrototypeOf,Object),Ke=Object.create,kt=It.propertyIsEnumerable,yr=gt.splice,Zr=Ct?Ct.toStringTag:void 0,hr=function(){try{var wt=So(Object,"defineProperty");return wt({},"",{}),wt}catch(qt){}}(),jn=dt?dt.isBuffer:void 0,yn=Math.max,ta=Date.now,ma=So(ye,"Map"),Zn=So(Object,"create"),Wn=function(){function wt(){}return function(qt){if(!Ao(qt))return{};if(Ke)return Ke(qt);wt.prototype=qt;var wr=new wt;return wt.prototype=void 0,wr}}();function F(wt){var qt=-1,wr=wt==null?0:wt.length;for(this.clear();++qt<wr;){var Xn=wt[qt];this.set(Xn[0],Xn[1])}}function H(){this.__data__=Zn?Zn(null):{},this.size=0}function ue(wt){var qt=this.has(wt)&&delete this.__data__[wt];return this.size-=qt?1:0,qt}function pe(wt){var qt=this.__data__;if(Zn){var wr=qt[wt];return wr===z?void 0:wr}return te.call(qt,wt)?qt[wt]:void 0}function rt(wt){var qt=this.__data__;return Zn?qt[wt]!==void 0:te.call(qt,wt)}function yt(wt,qt){var wr=this.__data__;return this.size+=this.has(wt)?0:1,wr[wt]=Zn&&qt===void 0?z:qt,this}F.prototype.clear=H,F.prototype.delete=ue,F.prototype.get=pe,F.prototype.has=rt,F.prototype.set=yt;function Ve(wt){var qt=-1,wr=wt==null?0:wt.length;for(this.clear();++qt<wr;){var Xn=wt[qt];this.set(Xn[0],Xn[1])}}function ct(){this.__data__=[],this.size=0}function er(wt){var qt=this.__data__,wr=Fi(qt,wt);if(wr<0)return!1;var Xn=qt.length-1;return wr==Xn?qt.pop():yr.call(qt,wr,1),--this.size,!0}function rr(wt){var qt=this.__data__,wr=Fi(qt,wt);return wr<0?void 0:qt[wr][1]}function jr(wt){return Fi(this.__data__,wt)>-1}function nn(wt,qt){var wr=this.__data__,Xn=Fi(wr,wt);return Xn<0?(++this.size,wr.push([wt,qt])):wr[Xn][1]=qt,this}Ve.prototype.clear=ct,Ve.prototype.delete=er,Ve.prototype.get=rr,Ve.prototype.has=jr,Ve.prototype.set=nn;function ur(wt){var qt=-1,wr=wt==null?0:wt.length;for(this.clear();++qt<wr;){var Xn=wt[qt];this.set(Xn[0],Xn[1])}}function Wr(){this.size=0,this.__data__={hash:new F,map:new(ma||Ve),string:new F}}function Tn(wt){var qt=as(this,wt).delete(wt);return this.size-=qt?1:0,qt}function mr(wt){return as(this,wt).get(wt)}function Jr(wt){return as(this,wt).has(wt)}function vn(wt,qt){var wr=as(this,wt),Xn=wr.size;return wr.set(wt,qt),this.size+=wr.size==Xn?0:1,this}ur.prototype.clear=Wr,ur.prototype.delete=Tn,ur.prototype.get=mr,ur.prototype.has=Jr,ur.prototype.set=vn;function Kn(wt){var qt=this.__data__=new Ve(wt);this.size=qt.size}function _n(){this.__data__=new Ve,this.size=0}function Hr(wt){var qt=this.__data__,wr=qt.delete(wt);return this.size=qt.size,wr}function oa(wt){return this.__data__.get(wt)}function Mr(wt){return this.__data__.has(wt)}function va(wt,qt){var wr=this.__data__;if(wr instanceof Ve){var Xn=wr.__data__;if(!ma||Xn.length<Z-1)return Xn.push([wt,qt]),this.size=++wr.size,this;wr=this.__data__=new ur(Xn)}return wr.set(wt,qt),this.size=wr.size,this}Kn.prototype.clear=_n,Kn.prototype.delete=Hr,Kn.prototype.get=oa,Kn.prototype.has=Mr,Kn.prototype.set=va;function ha(wt,qt){var wr=Ml(wt),Xn=!wr&&nl(wt),Xa=!wr&&!Xn&&bs(wt),ni=!wr&&!Xn&&!Xa&&al(wt),to=wr||Xn||Xa||ni,Sa=to?J(wt.length,String):[],Ii=Sa.length;for(var qo in wt)(qt||te.call(wt,qo))&&!(to&&(qo=="length"||Xa&&(qo=="offset"||qo=="parent")||ni&&(qo=="buffer"||qo=="byteLength"||qo=="byteOffset")||so(qo,Ii)))&&Sa.push(qo);return Sa}function da(wt,qt,wr){(wr!==void 0&&!To(wt[qt],wr)||wr===void 0&&!(qt in wt))&&xa(wt,qt,wr)}function Ki(wt,qt,wr){var Xn=wt[qt];(!(te.call(wt,qt)&&To(Xn,wr))||wr===void 0&&!(qt in wt))&&xa(wt,qt,wr)}function Fi(wt,qt){for(var wr=wt.length;wr--;)if(To(wt[wr][0],qt))return wr;return-1}function xa(wt,qt,wr){qt=="__proto__"&&hr?hr(wt,qt,{configurable:!0,enumerable:!0,value:wr,writable:!0}):wt[qt]=wr}var di=_o();function Ga(wt){return wt==null?wt===void 0?Ie:Et:Zr&&Zr in Object(wt)?Ol(wt):en(wt)}function In(wt){return is(wt)&&Ga(wt)==Y}function Oi(wt){if(!Ao(wt)||Re(wt))return!1;var qt=Vu(wt)?lt:Se;return qt.test(Do(wt))}function $i(wt){return is(wt)&&tu(wt.length)&&!!et[Ga(wt)]}function Ti(wt){if(!Ao(wt))return dr(wt);var qt=Mt(wt),wr=[];for(var Xn in wt)Xn=="constructor"&&(qt||!te.call(wt,Xn))||wr.push(Xn);return wr}function Io(wt,qt,wr,Xn,Xa){if(wt===qt)return;di(qt,function(ni,to){if(Xa||(Xa=new Kn),Ao(ni))fu(wt,qt,to,wr,Io,Xn,Xa);else{var Sa=Xn?Xn(zn(wt,to),ni,to+"",wt,qt,Xa):void 0;Sa===void 0&&(Sa=ni),da(wt,to,Sa)}},$a)}function fu(wt,qt,wr,Xn,Xa,ni,to){var Sa=zn(wt,wr),Ii=zn(qt,wr),qo=to.get(Ii);if(qo){da(wt,wr,qo);return}var gi=ni?ni(Sa,Ii,wr+"",wt,qt,to):void 0,os=gi===void 0;if(os){var ru=Ml(Ii),pu=!ru&&bs(Ii),ss=!ru&&!pu&&al(Ii);gi=Ii,ru||pu||ss?Ml(Sa)?gi=Sa:uf(Sa)?gi=Pu(Sa):pu?(os=!1,gi=ws(Ii,!0)):ss?(os=!1,gi=Za(Ii,!0)):gi=[]:Gu(Ii)||nl(Ii)?(gi=Sa,nl(Sa)?gi=Ms(Sa):(!Ao(Sa)||Vu(Sa))&&(gi=Os(Ii))):os=!1}os&&(to.set(Ii,gi),Xa(gi,Ii,Xn,ni,to),to.delete(Ii)),da(wt,wr,gi)}function hu(wt,qt){return Gi(xn(wt,qt,il),wt+"")}var pa=hr?function(wt,qt){return hr(wt,"toString",{configurable:!0,enumerable:!1,value:Wu(qt),writable:!0})}:il;function ws(wt,qt){if(qt)return wt.slice();var wr=wt.length,Xn=we?we(wr):new wt.constructor(wr);return wt.copy(Xn),Xn}function po(wt){var qt=new wt.constructor(wt.byteLength);return new pt(qt).set(new pt(wt)),qt}function Za(wt,qt){var wr=qt?po(wt.buffer):wt.buffer;return new wt.constructor(wr,wt.byteOffset,wt.length)}function Pu(wt,qt){var wr=-1,Xn=wt.length;for(qt||(qt=Array(Xn));++wr<Xn;)qt[wr]=wt[wr];return qt}function Mi(wt,qt,wr,Xn){var Xa=!wr;wr||(wr={});for(var ni=-1,to=qt.length;++ni<to;){var Sa=qt[ni],Ii=Xn?Xn(wr[Sa],wt[Sa],Sa,wr,wt):void 0;Ii===void 0&&(Ii=wt[Sa]),Xa?xa(wr,Sa,Ii):Ki(wr,Sa,Ii)}return wr}function _i(wt){return hu(function(qt,wr){var Xn=-1,Xa=wr.length,ni=Xa>1?wr[Xa-1]:void 0,to=Xa>2?wr[2]:void 0;for(ni=wt.length>3&&typeof ni=="function"?(Xa--,ni):void 0,to&&du(wr[0],wr[1],to)&&(ni=Xa<3?void 0:ni,Xa=1),qt=Object(qt);++Xn<Xa;){var Sa=wr[Xn];Sa&&wt(qt,Sa,Xn,ni)}return qt})}function _o(wt){return function(qt,wr,Xn){for(var Xa=-1,ni=Object(qt),to=Xn(qt),Sa=to.length;Sa--;){var Ii=to[wt?Sa:++Xa];if(wr(ni[Ii],Ii,ni)===!1)break}return qt}}function as(wt,qt){var wr=wt.__data__;return Ft(qt)?wr[typeof qt=="string"?"string":"hash"]:wr.map}function So(wt,qt){var wr=Be(wt,qt);return Oi(wr)?wr:void 0}function Ol(wt){var qt=te.call(wt,Zr),wr=wt[Zr];try{wt[Zr]=void 0;var Xn=!0}catch(ni){}var Xa=zt.call(wt);return Xn&&(qt?wt[Zr]=wr:delete wt[Zr]),Xa}function Os(wt){return typeof wt.constructor=="function"&&!Mt(wt)?Wn(ut(wt)):{}}function so(wt,qt){var wr=typeof wt;return qt=qt==null?D:qt,!!qt&&(wr=="number"||wr!="symbol"&&ve.test(wt))&&wt>-1&&wt%1==0&&wt<qt}function du(wt,qt,wr){if(!Ao(wr))return!1;var Xn=typeof qt;return(Xn=="number"?eu(wr)&&so(qt,wr.length):Xn=="string"&&qt in wr)?To(wr[qt],wt):!1}function Ft(wt){var qt=typeof wt;return qt=="string"||qt=="number"||qt=="symbol"||qt=="boolean"?wt!=="__proto__":wt===null}function Re(wt){return!!Je&&Je in wt}function Mt(wt){var qt=wt&&wt.constructor,wr=typeof qt=="function"&&qt.prototype||It;return wt===wr}function dr(wt){var qt=[];if(wt!=null)for(var wr in Object(wt))qt.push(wr);return qt}function en(wt){return zt.call(wt)}function xn(wt,qt,wr){return qt=yn(qt===void 0?wt.length-1:qt,0),function(){for(var Xn=arguments,Xa=-1,ni=yn(Xn.length-qt,0),to=Array(ni);++Xa<ni;)to[Xa]=Xn[qt+Xa];Xa=-1;for(var Sa=Array(qt+1);++Xa<qt;)Sa[Xa]=Xn[Xa];return Sa[qt]=wr(to),I(wt,this,Sa)}}function zn(wt,qt){return qt==="constructor"&&typeof wt[qt]=="function"||qt=="__proto__"?void 0:wt[qt]}var Gi=mo(pa);function mo(wt){var qt=0,wr=0;return function(){var Xn=ta(),Xa=W-(Xn-wr);if(wr=Xn,Xa>0){if(++qt>=o)return arguments[0]}else qt=0;return wt.apply(void 0,arguments)}}function Do(wt){if(wt!=null){try{return Ze.call(wt)}catch(qt){}try{return wt+""}catch(qt){}}return""}function To(wt,qt){return wt===qt||wt!==wt&&qt!==qt}var nl=In(function(){return arguments}())?In:function(wt){return is(wt)&&te.call(wt,"callee")&&!kt.call(wt,"callee")},Ml=Array.isArray;function eu(wt){return wt!=null&&tu(wt.length)&&!Vu(wt)}function uf(wt){return is(wt)&&eu(wt)}var bs=jn||sc;function Vu(wt){if(!Ao(wt))return!1;var qt=Ga(wt);return qt==ge||qt==Ce||qt==he||qt==mt}function tu(wt){return typeof wt=="number"&&wt>-1&&wt%1==0&&wt<=D}function Ao(wt){var qt=typeof wt;return wt!=null&&(qt=="object"||qt=="function")}function is(wt){return wt!=null&&typeof wt=="object"}function Gu(wt){if(!is(wt)||Ga(wt)!=He)return!1;var qt=ut(wt);if(qt===null)return!0;var wr=te.call(qt,"constructor")&&qt.constructor;return typeof wr=="function"&&wr instanceof wr&&Ze.call(wr)==cr}var al=w?ce(w):$i;function Ms(wt){return Mi(wt,$a(wt))}function $a(wt){return eu(wt)?ha(wt,!0):Ti(wt)}var Hu=_i(function(wt,qt,wr,Xn){Io(wt,qt,wr,Xn)});function Wu(wt){return function(){return wt}}function il(wt){return wt}function sc(){return!1}m.exports=Hu}).call(this,i("yLpj"),i("YuTi")(Le))},quyA:function(Le,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",z=T+m+Z,o="\\ufe0e\\ufe0f",W="\\u200d",D=RegExp("["+W+i+z+o+"]");function Y(q){return D.test(q)}Le.exports=Y},qxNg:function(Le,E,i){"use strict";i.d(E,"a",function(){return D});var T=i("lSNA"),m=i.n(T),Z=i("mpbz"),z=i.n(Z);function o(q,he){var X=Object.keys(q);if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(q);he&&(je=je.filter(function(Ge){return Object.getOwnPropertyDescriptor(q,Ge).enumerable})),X.push.apply(X,je)}return X}function W(q){for(var he=1;he<arguments.length;he++){var X=arguments[he]!=null?arguments[he]:{};he%2?o(Object(X),!0).forEach(function(je){m()(q,je,X[je])}):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(X)):o(Object(X)).forEach(function(je){Object.defineProperty(q,je,Object.getOwnPropertyDescriptor(X,je))})}return q}function D(q,he){var X=he.radius,je=X===void 0?40:X,Ge=he.maxZoom,ge=Ge===void 0?18:Ge,Ce=he.minZoom,ht=Ce===void 0?0:Ce,Ne=he.zoom,Et=Ne===void 0?2:Ne;if(q.pointIndex){var He=q.pointIndex.getClusters(q.extent,Math.floor(Et));return q.dataArray=Y(He),q}var mt=new z.a({radius:je,minZoom:ht,maxZoom:ge}),Ye={type:"FeatureCollection",features:[]};return Ye.features=q.dataArray.map(function(xt){return{type:"Feature",geometry:{type:"Point",coordinates:xt.coordinates},properties:W({},xt)}}),mt.load(Ye.features),mt}function Y(q){return q.map(function(he,X){return W({coordinates:he.geometry.coordinates,_id:X+1},he.properties)})}},riiI:function(Le,E){},rlAn:function(Le,E,i){"use strict";var T=i("ISu3"),m=i("gMG2"),Z=i("5gLl"),z=i("BpBL"),o=i("5zYK"),W=i("lJbI"),D=i("l94r"),Y=i("qxNg"),q=i("Y8BV"),he=i("VIsB"),X=i("+VLl"),je=i("aF1E"),Ge=i("fdMe");i.d(E,"getTransform",function(){return T.b}),i.d(E,"getParser",function(){return T.a});var ge=i("U1ZX"),Ce=i.n(ge);E.default=D.a,Object(T.c)("geojson",Z.a),Object(T.c)("image",z.a),Object(T.c)("csv",m.a),Object(T.c)("json",o.a),Object(T.c)("raster",W.a),Object(T.d)("cluster",Y.a),Object(T.d)("filter",q.a),Object(T.d)("join",je.a),Object(T.d)("map",Ge.a),Object(T.d)("grid",he.a),Object(T.d)("hexagon",X.a)},rxlC:function(Le,E,i){"use strict";Le.exports=m,Le.exports.default=m;var T=1e20;function m(o,W,D,Y,q,he){this.fontSize=o||24,this.buffer=W===void 0?3:W,this.cutoff=Y||.25,this.fontFamily=q||"sans-serif",this.fontWeight=he||"normal",this.radius=D||8;var X=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=X,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(X*X),this.gridInner=new Float64Array(X*X),this.f=new Float64Array(X),this.d=new Float64Array(X),this.z=new Float64Array(X+1),this.v=new Int16Array(X),this.middle=Math.round(X/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}m.prototype.draw=function(o){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(o,this.buffer,this.middle);for(var W=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),Y=0;Y<this.size*this.size;Y++){var q=W.data[Y*4+3]/255;this.gridOuter[Y]=q===1?0:q===0?T:Math.pow(Math.max(0,.5-q),2),this.gridInner[Y]=q===1?T:q===0?0:Math.pow(Math.max(0,q-.5),2)}for(Z(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Z(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),Y=0;Y<this.size*this.size;Y++){var he=this.gridOuter[Y]-this.gridInner[Y];D[Y]=Math.max(0,Math.min(255,Math.round(255-255*(he/this.radius+this.cutoff))))}return D};function Z(o,W,D,Y,q,he,X){for(var je=0;je<W;je++){for(var Ge=0;Ge<D;Ge++)Y[Ge]=o[Ge*W+je];for(z(Y,q,he,X,D),Ge=0;Ge<D;Ge++)o[Ge*W+je]=q[Ge]}for(Ge=0;Ge<D;Ge++){for(je=0;je<W;je++)Y[je]=o[Ge*W+je];for(z(Y,q,he,X,W),je=0;je<W;je++)o[Ge*W+je]=Math.sqrt(q[je])}}function z(o,W,D,Y,q){D[0]=0,Y[0]=-T,Y[1]=+T;for(var he=1,X=0;he<q;he++){for(var je=(o[he]+he*he-(o[D[X]]+D[X]*D[X]))/(2*he-2*D[X]);je<=Y[X];)X--,je=(o[he]+he*he-(o[D[X]]+D[X]*D[X]))/(2*he-2*D[X]);X++,D[X]=he,Y[X]=je,Y[X+1]=+T}for(he=0,X=0;he<q;he++){for(;Y[X+1]<he;)X++;W[he]=(he-D[X])*(he-D[X])+o[D[X]]}}},sGsY:function(Le,E,i){"use strict";var T=i("lSNA"),m=i.n(T),Z=i("pVnL"),z=i.n(Z),o=i("q1tI"),W=i("TSYQ"),D=i.n(W),Y=i("H84U"),q=i("/ezw"),he=i("B6l+"),X=i.n(he),je=function(ve){var et=ve.value,Yt=ve.formatter,At=ve.precision,ye=ve.decimalSeparator,be=ve.groupSeparator,Ue=be===void 0?"":be,st=ve.prefixCls,Me;if(typeof Yt=="function")Me=Yt(et);else{var ft=String(et),w=ft.match(/^(-?)(\d*)(\.(\d+))?$/);if(!w||ft==="-")Me=ft;else{var I=w[1],J=w[2]||"0",ce=w[4]||"";J=J.replace(/\B(?=(\d{3})+(?!\d))/g,Ue),typeof At=="number"&&(ce=X()(ce,At,"0").slice(0,At)),ce&&(ce="".concat(ye).concat(ce)),Me=[o.createElement("span",{key:"int",className:"".concat(st,"-content-value-int")},I,J),ce&&o.createElement("span",{key:"decimal",className:"".concat(st,"-content-value-decimal")},ce)]}}return o.createElement("span",{className:"".concat(st,"-content-value")},Me)},Ge=je,ge=function(ve){var et=ve.prefixCls,Yt=ve.className,At=ve.style,ye=ve.valueStyle,be=ve.value,Ue=be===void 0?0:be,st=ve.title,Me=ve.valueRender,ft=ve.prefix,w=ve.suffix,I=ve.loading,J=ve.direction,ce=ve.onMouseEnter,Be=ve.onMouseLeave,Xe=o.createElement(Ge,z()({},ve,{value:Ue})),gt=D()(et,m()({},"".concat(et,"-rtl"),J==="rtl"),Yt);return o.createElement("div",{className:gt,style:At,onMouseEnter:ce,onMouseLeave:Be},st&&o.createElement("div",{className:"".concat(et,"-title")},st),o.createElement(q.a,{paragraph:!1,loading:I},o.createElement("div",{style:ye,className:"".concat(et,"-content")},ft&&o.createElement("span",{className:"".concat(et,"-content-prefix")},ft),Me?Me(Xe):Xe,w&&o.createElement("span",{className:"".concat(et,"-content-suffix")},w))))};ge.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Ce=Object(Y.c)({prefixCls:"statistic"})(ge),ht=Ce,Ne=i("lwsE"),Et=i.n(Ne),He=i("W8MJ"),mt=i.n(He),Ye=i("7W2i"),xt=i.n(Ye),_t=i("LQ03"),Ie=i.n(_t),De=i("J4zp"),ze=i.n(De),at=i("QQZ/"),Pe=i.n(at),ot=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Bt(Se,ve){var et=Se,Yt=/\[[^\]]*]/g,At=(ve.match(Yt)||[]).map(function(st){return st.slice(1,-1)}),ye=ve.replace(Yt,"[]"),be=ot.reduce(function(st,Me){var ft=ze()(Me,2),w=ft[0],I=ft[1];if(st.indexOf(w)!==-1){var J=Math.floor(et/I);return et-=J*I,st.replace(new RegExp("".concat(w,"+"),"g"),function(ce){var Be=ce.length;return Pe()(J.toString(),Be,"0")})}return st},ye),Ue=0;return be.replace(Yt,function(){var st=At[Ue];return Ue+=1,st})}function Wt(Se,ve){var et=ve.format,Yt=et===void 0?"":et,At=new Date(Se).getTime(),ye=Date.now(),be=Math.max(At-ye,0);return Bt(be,Yt)}var sr=i("0n0R"),ne=1e3/30;function $(Se){return new Date(Se).getTime()}var G=function(Se){xt()(et,Se);var ve=Ie()(et);function et(){var Yt;return Et()(this,et),Yt=ve.apply(this,arguments),Yt.syncTimer=function(){var At=Yt.props.value,ye=$(At);ye>=Date.now()?Yt.startTimer():Yt.stopTimer()},Yt.startTimer=function(){if(Yt.countdownId)return;Yt.countdownId=window.setInterval(function(){Yt.forceUpdate()},ne)},Yt.stopTimer=function(){var At=Yt.props,ye=At.onFinish,be=At.value;if(Yt.countdownId){clearInterval(Yt.countdownId),Yt.countdownId=void 0;var Ue=$(be);ye&&Ue<Date.now()&&ye()}},Yt.formatCountdown=function(At,ye){var be=Yt.props.format;return Wt(At,z()(z()({},ye),{format:be}))},Yt.valueRender=function(At){return Object(sr.a)(At,{title:void 0})},Yt}return mt()(et,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return o.createElement(ht,z()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),et}(o.Component);G.defaultProps={format:"HH:mm:ss"};var Ae=G;ht.Countdown=Ae;var xe=E.a=ht},sKgW:function(Le,E){var i=9007199254740991,T=Math.floor;function m(Z,z){var o="";if(!Z||z<1||z>i)return o;do z%2&&(o+=Z),z=T(z/2),z&&(Z+=Z);while(z);return o}Le.exports=m},sXyB:function(Le,E,i){var T=i("SksO"),m=i("b48C");function Z(z,o,W){return m()?Le.exports=Z=Reflect.construct:Le.exports=Z=function(Y,q,he){var X=[null];X.push.apply(X,q);var je=Function.bind.apply(Y,X),Ge=new je;return he&&T(Ge,he.prototype),Ge},Z.apply(null,arguments)}Le.exports=Z},sgoq:function(Le,E,i){var T=i("asDA"),m=i("TKrE"),Z=i("6nK8"),z="['\u2019]",o=RegExp(z,"g");function W(D){return function(Y){return T(Z(m(Y).replace(o,"")),D,"")}}Le.exports=W},sxDa:function(Le,E,i){"use strict";i.d(E,"e",function(){return Ia}),i.d(E,"f",function(){return Fl}),i.d(E,"d",function(){return Fs}),i.d(E,"a",function(){return as}),i.d(E,"c",function(){return Ii}),i.d(E,"g",function(){return Yo}),i.d(E,"b",function(){return il});var T=i("h1nZ"),m=i("lwsE"),Z=i.n(m),z=i("W8MJ"),o=i.n(z),W=i("7W2i"),D=i.n(W),Y=i("a1gu"),q=i.n(Y),he=i("Nsbk"),X=i.n(he),je=i("QILm"),Ge=i.n(je),ge=i("lSNA"),Ce=i.n(ge),ht=i("yG8O"),Ne=i.n(ht),Et=i("PJYZ"),He=i.n(Et),mt=i("U+yc"),Ye=i.n(mt),xt=i("1ABj"),_t=i("GoyQ"),Ie=i.n(_t),De=i("lSCD"),ze=i.n(De),at=i("xp6e"),Pe=i("Hel2"),ot=i("uhBA"),Bt=i("4U9+"),Wt=i.n(Bt),sr=i("4cb6"),ne,$,G,Ae,xe,Se;function ve(h){return h.map(function(S){return typeof S=="string"&&(S=[S,{}]),S})}var et=(ne=Object(sr.injectable)(),$=Object(sr.inject)(T.TYPES.IGlobalConfigService),ne(G=(Ae=(Se=function(){function h(){Z()(this,h),Ne()(this,"configService",xe,this),this.enabled=void 0}return o()(h,[{key:"apply",value:function(_,x){var C=this,M=x.rendererService,U=x.postProcessingPassFactory,re=x.normalPassFactory;_.hooks.init.tap("MultiPassRendererPlugin",function(){var me=_.getLayerConfig(),Fe=me.enableMultiPassRenderer,Pt=me.passes,Jt=Pt===void 0?[]:Pt;C.enabled=!!Fe&&_.getLayerConfig().enableMultiPassRenderer!==!1,C.enabled&&(_.multiPassRenderer=C.createMultiPassRenderer(_,Jt,U,re),_.multiPassRenderer.setRenderFlag(!0))}),_.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(_,x,C,M){var U=_.multiPassRenderer,re=_.getLayerConfig(),me=re.enablePicking,Fe=re.enableTAA;return me&&U.add(M("pixelPicking")),U}}]),h}(),Se),xe=Ye()(Ae.prototype,"configService",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae))||G),Yt,At=(Yt={},Ce()(Yt,T.BlendType.additive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:1,dstAlpha:1}}),Ce()(Yt,T.BlendType.normal,{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Ce()(Yt,T.BlendType.subtractive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:T.gl.ZERO,dstAlpha:T.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:T.gl.FUNC_SUBTRACT,alpha:T.gl.FUNC_SUBTRACT}}),Ce()(Yt,T.BlendType.max,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MAX_EXT}}),Ce()(Yt,T.BlendType.min,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MIN_EXT}}),Yt),ye={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},be,Ue,st,Me,ft,w,I,J;function ce(h,S){var _;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(_=Be(h))||S&&h&&typeof h.length=="number"){_&&(h=_);var x=0,C=function(){};return{s:C,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Fe){throw Fe},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,re;return{s:function(){_=h[Symbol.iterator]()},n:function(){var Fe=_.next();return M=Fe.done,Fe},e:function(Fe){U=!0,re=Fe},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw re}}}}function Be(h,S){if(!h)return;if(typeof h=="string")return Xe(h,S);var _=Object.prototype.toString.call(h).slice(8,-1);if(_==="Object"&&h.constructor&&(_=h.constructor.name),_==="Map"||_==="Set")return Array.from(h);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return Xe(h,S)}function Xe(h,S){(S==null||S>h.length)&&(S=h.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=h[_];return x}function gt(h,S){var _=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),_.push.apply(_,x)}return _}function tt(h){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?gt(Object(_),!0).forEach(function(x){Ce()(h,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):gt(Object(_)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(_,x))})}return h}function It(h){var S=K();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function K(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ze=0,te=(be=Object(T.lazyInject)(T.TYPES.ILogService),Ue=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),st=Object(T.lazyInject)(T.TYPES.IShaderModuleService),Me=(J=function(h){D()(_,h);var S=It(_);function _(){var x,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Z()(this,_),x=S.call(this),x.id="".concat(Ze++),x.name="".concat(Ze),x.type=void 0,x.visible=!0,x.zIndex=0,x.minZoom=void 0,x.maxZoom=void 0,x.inited=!1,x.layerModelNeedUpdate=!1,x.pickedFeatureID=null,x.selectedFeatureID=null,x.styleNeedUpdate=!1,x.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},x.hooks={init:new at.b,afterInit:new at.b,beforeRender:new at.b,beforeRenderData:new at.d,afterRender:new at.c,beforePickingEncode:new at.c,afterPickingEncode:new at.c,beforeHighlight:new at.c(["pickedColor"]),afterHighlight:new at.c,beforeSelect:new at.c(["pickedColor"]),afterSelect:new at.c,beforeDestroy:new at.c,afterDestroy:new at.c},x.models=[],x.multiPassRenderer=void 0,x.plugins=void 0,x.sourceOption=void 0,x.layerModel=void 0,Ne()(x,"logger",ft,He()(x)),Ne()(x,"configService",w,He()(x)),Ne()(x,"shaderModuleService",I,He()(x)),x.cameraService=void 0,x.coordinateService=void 0,x.iconService=void 0,x.fontService=void 0,x.rendererService=void 0,x.layerService=void 0,x.interactionService=void 0,x.mapService=void 0,x.styleAttributeService=void 0,x.layerSource=void 0,x.postProcessingPassFactory=void 0,x.normalPassFactory=void 0,x.animateOptions={enable:!1},x.container=void 0,x.encodedData=void 0,x.configSchema=void 0,x.currentPickId=null,x.rawConfig=void 0,x.needUpdateConfig=void 0,x.pendingStyleAttributes=[],x.scaleOptions={},x.animateStartTime=void 0,x.aniamateStatus=!1,x.sourceEvent=function(){x.dataState.dataSourceNeedUpdate=!0;var M=x.getLayerConfig(),U=M.autoFit,re=M.fitBoundsOptions;U&&x.fitBounds(re),x.emit("dataUpdate"),x.reRender()},x.name=C.name||x.id,x.zIndex=C.zIndex||0,x.rawConfig=C,x}return o()(_,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(C){if(!this.inited)this.needUpdateConfig=tt(tt({},this.needUpdateConfig),C);else{var M=this.container.get(T.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,tt(tt(tt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),C)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(C){this.container=C}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(C){return this.plugins.push(C),this}},{key:"init",value:function(){var C=this,M=this.container.get(T.TYPES.SceneID),U=this.rawConfig.enableMultiPassRenderer,re=U===void 0?!1:U;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:re}),this.iconService=this.container.get(T.TYPES.IIconService),this.fontService=this.container.get(T.TYPES.IFontService),this.rendererService=this.container.get(T.TYPES.IRendererService),this.layerService=this.container.get(T.TYPES.ILayerService),this.interactionService=this.container.get(T.TYPES.IInteractionService),this.mapService=this.container.get(T.TYPES.IMapService),this.cameraService=this.container.get(T.TYPES.ICameraService),this.coordinateService=this.container.get(T.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(T.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(T.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(T.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(T.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(Jt){var Ir=Jt.attributeName,Pr=Jt.attributeField,gn=Jt.attributeValues,Pn=Jt.updateOptions;C.styleAttributeService.updateStyleAttribute(Ir,{scale:tt({field:Pr},C.splitValuesAndCallbackInAttribute(gn,C.getLayerConfig()[Ir]))},Pn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(T.TYPES.ILayerPlugin);var me=ce(this.plugins),Fe;try{for(me.s();!(Fe=me.n()).done;){var Pt=Fe.value;Pt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(Jt){me.e(Jt)}finally{me.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(tt(tt({},this.getDefaultConfig()),this.rawConfig));var C=this.getLayerConfig(),M=C.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(C,M,U){return this.updateStyleAttribute("color",C,M,U),this}},{key:"size",value:function(C,M,U){return this.updateStyleAttribute("size",C,M,U),this}},{key:"filter",value:function(C,M,U){return this.updateStyleAttribute("filter",C,M,U),this}},{key:"shape",value:function(C,M,U){return this.updateStyleAttribute("shape",C,M,U),this}},{key:"label",value:function(C,M,U){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:C,attributeValues:M,updateOptions:U}),this}},{key:"animate",value:function(C){var M={};return Ie()(C)?(M.enable=!0,M=tt(tt({},M),C)):M.enable=C,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(C,M){return this.sourceOption={data:C,options:M},this}},{key:"setData",value:function(C,M){var U=this;return this.inited?this.layerSource.setData(C,M):this.on("inited",function(){U.layerSource.setData(C,M)}),this}},{key:"style",value:function(C){var M=this,U=C.passes,re=Ge()(C,["passes"]);return U&&ve(U).forEach(function(me){var Fe=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(me[0]);Fe&&Fe.updateOptions(me[1])}),this.rawConfig=tt(tt({},this.rawConfig),re),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(C,M){return Ie()(C)?this.scaleOptions=tt(tt({},this.scaleOptions),C):this.scaleOptions[C]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(C){var M={};return M.enableHighlight=Ie()(C)?!0:C,Ie()(C)?(M.enableHighlight=!0,C.color&&(M.highlightColor=C.color)):M.enableHighlight=!!C,this.updateLayerConfig(M),this}},{key:"setActive",value:function(C,M){var U=this;if(Ie()(C)){var re=C.x,me=re===void 0?0:re,Fe=C.y,Pt=Fe===void 0?0:Fe;this.updateLayerConfig({highlightColor:Ie()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:me,y:Pt})}else this.updateLayerConfig({pickedFeatureID:C,highlightColor:Ie()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Pe.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"select",value:function(C){var M={};return M.enableSelect=Ie()(C)?!0:C,Ie()(C)?(M.enableSelect=!0,C.color&&(M.selectColor=C.color)):M.enableSelect=!!C,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(C,M){var U=this;if(Ie()(C)){var re=C.x,me=re===void 0?0:re,Fe=C.y,Pt=Fe===void 0?0:Fe;this.updateLayerConfig({selectColor:Ie()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:me,y:Pt})}else this.updateLayerConfig({pickedFeatureID:C,selectColor:Ie()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Pe.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"setBlend",value:function(C){this.updateLayerConfig({blend:C}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(C){return this.zIndex=C,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(C){this.currentPickId=C}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(C){this.selectedFeatureID=C}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var C=this.mapService.getZoom(),M=this.getLayerConfig(),U=M.visible,re=M.minZoom,me=re===void 0?-Infinity:re,Fe=M.maxZoom,Pt=Fe===void 0?Infinity:Fe;return!!U&&C>=me&&C<=Pt}},{key:"setMinZoom",value:function(C){return this.updateLayerConfig({minZoom:C}),this}},{key:"getMinZoom",value:function(){var C=this.getLayerConfig(),M=C.minZoom;return M}},{key:"getMaxZoom",value:function(){var C=this.getLayerConfig(),M=C.maxZoom;return M}},{key:"get",value:function(C){var M=this.getLayerConfig();return M[C]}},{key:"setMaxZoom",value:function(C){return this.updateLayerConfig({maxZoom:C}),this}},{key:"fitBounds",value:function(C){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),U=M.extent,re=U.some(function(me){return Math.abs(me)===Infinity});return re?this:(this.mapService.fitBounds([[U[0],U[1]],[U[2],U[3]]],C),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(C){return C.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(C){return C.needRescale||C.needRemapping||C.needRegenerateVertices}).length}},{key:"setSource",value:function(C){this.layerSource=C;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(C){this.encodedData=C}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Wt()([ye,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(C){var M=this.styleAttributeService.getLayerAttributeScale(C);if(M){if(M.ticks){var U=M.ticks().map(function(me){return Ce()({value:me},C,M(me))});return U}else if(M.invertExtent){var re=M.range().map(function(me){return Ce()({value:M.invertExtent(me)},C,me)});return re}}else return[]}},{key:"pick",value:function(C){var M=C.x,U=C.y;this.interactionService.triggerHover({x:M,y:U})}},{key:"buildLayerModel",value:function(C){var M=C.moduleName,U=C.vertexShader,re=C.fragmentShader,me=C.triangulation,Fe=Ge()(C,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:U,fs:re});var Pt=this.shaderModuleService.getModule(M),Jt=Pt.vs,Ir=Pt.fs,Pr=Pt.uniforms,gn=this.rendererService.createModel,Pn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,me),Rn=Pn.attributes,Oa=Pn.elements;return gn(tt({attributes:Rn,uniforms:Pr,fs:Ir,vs:Jt,elements:Oa,blend:At[T.BlendType.normal]},Fe))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(C){var M=this.getLayerConfig(),U=M.enableHighlight,re=U===void 0?!0:U,me=M.enableSelect,Fe=me===void 0?!0:me,Pt=this.eventNames().indexOf(C)!==-1||this.eventNames().indexOf("un"+C)!==-1;return(C==="click"||C==="dblclick")&&Fe&&(Pt=!0),C==="mousemove"&&(re||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Pt=!0),this.isVisible()&&Pt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var C=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:C.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(C,M){return{values:ze()(C)?void 0:C||M,callback:ze()(C)?C:void 0}}},{key:"updateStyleAttribute",value:function(C,M,U,re){this.inited?this.styleAttributeService.updateStyleAttribute(C,{scale:tt({field:M},this.splitValuesAndCallbackInAttribute(U,this.getLayerConfig()[M]))},re):this.pendingStyleAttributes.push({attributeName:C,attributeField:M,attributeValues:U,updateOptions:re})}}]),_}(ot.EventEmitter),J),ft=Ye()(Me.prototype,"logger",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Ye()(Me.prototype,"configService",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Ye()(Me.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me),Je,zt,cr,lt,dt,Ct,pt=(Je=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),zt=Object(T.lazyInject)(T.TYPES.IShaderModuleService),cr=(Ct=function(){function h(S){Z()(this,h),this.triangulation=void 0,this.layer=void 0,Ne()(this,"configService",lt,this),Ne()(this,"shaderModuleService",dt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=S,this.rendererService=S.getContainer().get(T.TYPES.IRendererService),this.styleAttributeService=S.getContainer().get(T.TYPES.IStyleAttributeService),this.mapService=S.getContainer().get(T.TYPES.IMapService),this.iconService=S.getContainer().get(T.TYPES.IIconService),this.fontService=S.getContainer().get(T.TYPES.IFontService),this.cameraService=S.getContainer().get(T.TYPES.ICameraService),this.layerService=S.getContainer().get(T.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return o()(h,[{key:"getBlend",value:function(){var _=this.layer.getLayerConfig(),x=_.blend,C=x===void 0?"normal":x;return At[T.BlendType[C]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(_){return[_.enable?0:1,_.duration||4,_.interval||.2,_.trailLength||.1]}},{key:"startModelAnimate",value:function(){var _=this.layer.getLayerConfig(),x=_.animateOption;x.enable&&this.layer.setAnimateStartTime()}}]),h}(),Ct),lt=Ye()(cr.prototype,"configService",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt=Ye()(cr.prototype,"shaderModuleService",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cr),we=i("J4zp"),ut=i.n(we),Ke=i("RIqP"),kt=i.n(Ke),yr=i("VmRL"),Zr=i.n(yr),hr=i("IOcx"),jn=hr.c.create(),yn=hr.c.create(),ta=hr.c.create(),ma=hr.c.create(),Zn=hr.c.create();function Wn(h,S,_,x,C){hr.c.add(h,_,x),hr.c.normalize(h,h),S=hr.c.fromValues(-h[1],h[0]);var M=hr.c.fromValues(-_[1],_[0]);return[C/hr.c.dot(S,M),S]}function F(h,S){return hr.c.set(h,-S[1],S[0])}function H(h,S,_){return hr.c.sub(h,S,_),hr.c.normalize(h,h),h}function ue(h,S){return h[0]===S[0]&&h[1]===S[1]}function pe(h){for(var S=new Map,_=0;_<h.length;_++){var x=h[0].toString()+"-"+h[1].toString();S.get(x)?(h.splice(_,1),_++):S.set(x,x)}return h}var rt=function(){function h(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=hr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=S.join||"miter",this.cap=S.cap||"butt",this.miterLimit=S.miterLimit||10,this.thickness=S.thickness||1,this.dash=S.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return o()(h,[{key:"extrude",value:function(_){var x=this.complex;if(_.length<=1)return x;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var C=_.length,M=x.startIndex,U=1;U<C;U++){var re=_[U-1],me=_[U],Fe=U<_.length-1?_[U+1]:null,Pt=this.segment(x,M,re,me,Fe);M+=Pt}if(this.dash)for(var Jt=0;Jt<x.positions.length/6;Jt++)x.positions[Jt*6+5]=this.totalDistance;return x.startIndex=x.positions.length/6,x}},{key:"segment",value:function(_,x,C,M,U){var re=0,me=_.indices,Fe=_.positions,Pt=_.normals,Jt=this.cap==="square",Ir=this.join==="bevel",Pr=Object(Pe.d)([M[0],M[1]]),gn=Object(Pe.d)([C[0],C[1]]);H(ta,Pr,gn);var Pn=0;if(this.dash&&(Pn=this.lineSegmentDistance(Pr,gn),this.totalDistance+=Pn),this.normal||(this.normal=hr.c.create(),F(this.normal,ta)),!this.started)if(this.started=!0,Jt){var Rn=hr.c.create(),Oa=hr.c.create();hr.c.add(Rn,this.normal,ta),hr.c.add(Oa,this.normal,ta),Pt.push(Oa[0],Oa[1],0),Pt.push(Rn[0],Rn[1],0),Fe.push(C[0],C[1],0,this.totalDistance-Pn,-this.thickness,0),Fe.push(C[0],C[1],0,this.totalDistance-Pn,this.thickness,0)}else this.extrusions(Fe,Pt,C,this.normal,this.thickness,this.totalDistance-Pn);if(me.push(x+0,x+1,x+2),U){var ri=Object(Pe.d)([U[0],U[1]]);ue(Pr,ri)&&hr.c.add(ri,Pr,hr.c.normalize(ri,hr.c.subtract(ri,Pr,gn))),H(ma,ri,Pr);var fi=Wn(Zn,hr.c.create(),ta,ma,this.thickness),ho=ut()(fi,2),La=ho[0],zo=ho[1],ns=hr.c.dot(Zn,this.normal)<0?-1:1,qs=Ir;if(!qs&&this.join==="miter"){var ei=La;ei>this.miterLimit&&(qs=!0)}qs?(Pt.push(this.normal[0],this.normal[1],0),Pt.push(zo[0],zo[1],0),Fe.push(M[0],M[1],0,this.totalDistance,-this.thickness*ns,0),Fe.push(M[0],M[1],0,this.totalDistance,this.thickness*ns,0),me.push.apply(me,kt()(this.lastFlip!==-ns?[x,x+2,x+3]:[x+2,x+1,x+3])),me.push(x+2,x+3,x+4),F(jn,ma),hr.c.copy(this.normal,jn),Pt.push(this.normal[0],this.normal[1],0),Fe.push(M[0],M[1],0,this.totalDistance,-this.thickness*ns,0),re+=3):(this.extrusions(Fe,Pt,M,zo,La,this.totalDistance),me.push.apply(me,kt()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),ns=-1,hr.c.copy(this.normal,zo),re+=2),this.lastFlip=ns}else{if(F(this.normal,ta),Jt){var qa=hr.c.create(),ci=hr.c.create();hr.c.sub(ci,ta,this.normal),hr.c.add(qa,ta,this.normal),Pt.push(ci[0],ci[1],0),Pt.push(qa[0],qa[1],0),Fe.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Fe.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Fe,Pt,M,this.normal,this.thickness,this.totalDistance);me.push.apply(me,kt()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),re+=2}return re}},{key:"extrusions",value:function(_,x,C,M,U,re){x.push(M[0],M[1],0),x.push(M[0],M[1],0),_.push(C[0],C[1],0,re,-U,0),_.push(C[0],C[1],0,re,U,0)}},{key:"lineSegmentDistance",value:function(_,x){var C=x[0]-_[0],M=x[1]-_[1];return Math.sqrt(C*C+M*M)}}]),h}(),yt=i("UB5X"),Ve=i.n(yt);function ct(h){if(Ve()(h[0]))return h;if(Ve()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ve()(h[0][0][0])){var S=h,_=0,x=0,C=0;return S.forEach(function(M){M.forEach(function(U){_+=U[0],x+=U[1],C++})}),[_/C,x/C,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function er(h){var S=h[0][0],_=h[0][h[0].length-1];S[0]===_[0]&&S[1]===_[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var x=h[0].length,C=Zr.a.flatten(h),M=C.vertices,U=C.dimensions,re=[],me=[],Fe=0;Fe<M.length/U;Fe++)U===2?re.push(M[Fe*2],M[Fe*2+1],1):re.push(M[Fe*3],M[Fe*3+1],1);var Pt=Zr()(C.vertices,C.holes,C.dimensions);me.push.apply(me,kt()(Pt));for(var Jt=function(gn){var Pn=C.vertices.slice(gn*U,(gn+1)*U),Rn=C.vertices.slice((gn+1)*U,(gn+2)*U);Rn.length===0&&(Rn=C.vertices.slice(0,U));var Oa=re.length/3;re.push(Pn[0],Pn[1],1,Rn[0],Rn[1],1,Pn[0],Pn[1],0,Rn[0],Rn[1],0),me.push.apply(me,kt()([0,2,1,2,3,1].map(function(qa){return qa+Oa})))},Ir=0;Ir<x;Ir++)Jt(Ir);return{positions:re,index:me}}function rr(h){var S=Zr.a.flatten(h),_=Zr()(S.vertices,S.holes,S.dimensions);return{positions:S.vertices,index:_}}function jr(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=h[0][0],x=h[0][h[0].length-1];_[0]===x[0]&&_[1]===x[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var C=h[0].length,M=Zr.a.flatten(h),U=M.vertices,re=M.dimensions,me=[],Fe=[],Pt=[],Jt=0;Jt<U.length/re;Jt++)re===2?me.push(U[Jt*2],U[Jt*2+1],1,-1,-1):me.push(U[Jt*3],U[Jt*3+1],1,-1,-1),Pt.push(0,0,1);var Ir=Zr()(M.vertices,M.holes,M.dimensions);Fe.push.apply(Fe,kt()(Ir));for(var Pr=function(Rn){var Oa=M.vertices.slice(Rn*re,(Rn+1)*re),qa=M.vertices.slice((Rn+1)*re,(Rn+2)*re);qa.length===0&&(qa=M.vertices.slice(0,re));var ci=me.length/5;me.push(Oa[0],Oa[1],1,0,0,qa[0],qa[1],1,.1,0,Oa[0],Oa[1],0,0,.8,qa[0],qa[1],0,.1,.8);var ri=nn([qa[0],qa[1],1],[Oa[0],Oa[1],0],[Oa[0],Oa[1],1],S);Pt.push.apply(Pt,kt()(ri).concat(kt()(ri),kt()(ri),kt()(ri))),Fe.push.apply(Fe,kt()([1,2,0,3,2,1].map(function(fi){return fi+ci})))},gn=0;gn<C;gn++)Pr(gn);return{positions:me,index:Fe,normals:Pt}}function nn(h,S,_){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=hr.d.create(),M=hr.d.create(),U=hr.d.create();x&&(h=Object(Pe.p)(h),S=Object(Pe.p)(S),_=Object(Pe.p)(_));var re=hr.d.fromValues.apply(hr.d,kt()(h)),me=hr.d.fromValues.apply(hr.d,kt()(S)),Fe=hr.d.fromValues.apply(hr.d,kt()(_));hr.d.sub(C,Fe,me),hr.d.sub(M,re,me),hr.d.cross(U,C,M);var Pt=hr.d.create();return hr.d.normalize(Pt,U),Pt}var ur,Wr;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Wr||(Wr={}));var Tn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(Tn||(Tn={}));function mr(h){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=Math.PI*2/h,x=[],C=0;C<h;C++)x.push(_*C+S*Math.PI/12);var M=x.map(function(U){var re=Math.sin(U+Math.PI/4),me=Math.cos(U+Math.PI/4);return[re,me,0]});return M}function Jr(){return mr(30)}function vn(){return mr(4)}function Kn(){return mr(3)}function _n(){return mr(6,1)}function Hr(){return mr(5)}var oa=(ur={},Ce()(ur,Tn.CIRCLE,Jr),Ce()(ur,Tn.HEXAGON,_n),Ce()(ur,Tn.TRIANGLE,Kn),Ce()(ur,Tn.SQUARE,vn),Ce()(ur,Tn.PENTAGON,Hr),Ce()(ur,Wr.CYLINDER,Jr),Ce()(ur,Wr.HEXAGONCOLUMN,_n),Ce()(ur,Wr.TRIANGLECOLUMN,Kn),Ce()(ur,Wr.SQUARECOLUMN,vn),Ce()(ur,Wr.PENTAGONCOLUMN,Hr),ur),Mr={};function va(h){var S=ct(h.coordinates);return{vertices:[].concat(kt()(S),kt()(S),kt()(S),kt()(S)),indices:[0,1,2,2,3,0],size:S.length}}function ha(h){var S=h.shape,_=$i(S,!1),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function da(h){var S=ct(h.coordinates);return{vertices:kt()(S),indices:[0],size:S.length}}function Ki(h){var S=h.coordinates,_=S;Array.isArray(_[0][0])||(_=[S]);var x=new rt({dash:!0,join:"bevel"});_.forEach(function(M){x.extrude(M)});var C=x.complex;return{vertices:C.positions,indices:C.indices,normals:C.normals,size:6}}function Fi(h){var S=h.coordinates,_=Zr.a.flatten(S),x=_.vertices,C=_.dimensions,M=_.holes;return{indices:Zr()(x,M,C),vertices:x,size:C}}function xa(h){var S=h.coordinates,_=jr(S,!0),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function di(h){var S=h.shape,_=hu(S),x=_.positions,C=_.index;return{vertices:x,indices:C,size:3}}function Ga(h){var S=h.coordinates,_=[].concat(kt()(S[0]),[0,0,1,S[1][0],S[0][1],0,1,1],kt()(S[1]),[0,1,0],kt()(S[0]),[0,0,1],kt()(S[1]),[0,1,0,S[0][0],S[1][1],0,0,0]),x=[0,1,2,3,4,5];return{vertices:_,indices:x,size:5}}function In(h){for(var S=30,_=h.coordinates,x=[],C=[],M=function(me){x.push(me,1,me,_[0][0],_[0][1],_[1][0],_[1][1],me,-1,me,_[0][0],_[0][1],_[1][0],_[1][1]),me!==S-1&&C.push.apply(C,kt()([0,1,2,1,3,2].map(function(Fe){return me*2+Fe})))},U=0;U<S;U++)M(U);return{vertices:x,indices:C,size:7}}function Oi(h){var S=h.coordinates;S.length===2&&S.push(0);var _=h.size,x=pa(-1,1),C=pa(1,1),M=pa(-1,-1),U=pa(1,-1),re=[].concat(kt()(S),kt()(x),kt()(S),kt()(M),kt()(S),kt()(U),kt()(S),kt()(C)),me=[0,1,2,3,0,2];return{vertices:re,indices:me,size:5}}function $i(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Mr&&Mr[h])return Mr[h];var _=oa[h]?oa[h]():oa.cylinder(),x=jr([_],S);return Mr[h]=x,x}function Ti(h,S){for(var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=new Float32Array(h.length/_*3),M,U,re,me=hr.d.create(),Fe=hr.d.create(),Pt=hr.d.create(),Jt=0,Ir=S.length;Jt<Ir;Jt+=3){M=S[Jt+0]*3,U=S[Jt+1]*3,re=S[Jt+2]*3;var Pr=[h[M],h[M+1]],gn=[h[U],h[U+1]],Pn=[h[re],h[re+1]];x&&(Pr=Object(Pe.p)(Pr),gn=Object(Pe.p)(gn),Pn=Object(Pe.p)(Pn));var Rn=Pr,Oa=ut()(Rn,2),qa=Oa[0],ci=Oa[1],ri=hr.d.fromValues(qa,ci,h[M+2]),fi=gn,ho=ut()(fi,2),La=ho[0],zo=ho[1],ns=hr.d.fromValues(La,zo,h[U+2]),qs=Pn,ei=ut()(qs,2),gs=ei[0],Xo=ei[1],dl=hr.d.fromValues(gs,Xo,h[re+2]);hr.d.sub(me,dl,ns),hr.d.sub(Fe,ri,ns),hr.d.cross(Pt,me,Fe),C[M]+=me[0],C[M+1]+=me[1],C[M+2]+=me[2],C[U]+=me[0],C[U+1]+=me[1],C[U+2]+=me[2],C[re]+=me[0],C[re+1]+=me[1],C[re+2]+=me[2]}return Io(C),C}function Io(h){for(var S=0,_=h.length;S<_;S+=3){var x=hr.d.fromValues(h[S],h[S+1],h[S+2]),C=hr.d.create();hr.d.normalize(C,x),h.set(C,S)}}function fu(h){var S=h[0][0],_=h[0][h[0].length-1];return S[0]===_[0]&&S[1]===_[1]}function hu(h){var S=["cylinder","triangleColumn","hexagonColumn","squareColumn"],_=oa[h]?oa[h]():oa.circle(),x=S.indexOf(h)===-1?rr([_]):er([_]);return x}function pa(h,S){var _=(h+1)/2,x=(S+1)/2;return[_,x]}function ws(h){var S=po();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function po(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Za=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pu=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Mi=function(h){D()(_,h);var S=ws(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,re=C.baseColor,me=re===void 0?"rgb(16,16,16)":re,Fe=C.brightColor,Pt=Fe===void 0?"rgb(255,176,38)":Fe,Jt=C.windowColor,Ir=Jt===void 0?"rgb(30,60,89)":Jt,Pr=C.time,gn=Pr===void 0?0:Pr;return{u_opacity:U,u_baseColor:Object(Pe.s)(me),u_brightColor:Object(Pe.s)(Pt),u_windowColor:Object(Pe.s)(Ir),u_time:this.layer.getLayerAnimateTime()||gn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Pu,fragmentShader:Za,triangulation:xa})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,re,me,Fe){return Fe}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?10:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){var Fe=M.size;return[re[3],re[4]]}}})}}]),_}(pt);function _i(h){var S=_o();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var as=function(h){D()(_,h);var S=_i(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){this.layerModel=new Mi(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(C){this.updateLayerConfig({time:C})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),_}(te);function So(h){var S=Ol();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ol(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Os=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,so=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,du=function(h){D()(_,h);var S=So(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,re=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:re||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Os,fragmentShader:so,triangulation:di,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var re=M.coordinates;return[re[0],re[1],0]}}})}}]),_}(pt);function Ft(h){var S=Re();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Re(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Mt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,dr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,en=function(h){D()(_,h);var S=Ft(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,re=C.angle;return{u_opacity:M||1,u_coverage:U||1,u_angle:re||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Mt,fragmentShader:dr,triangulation:ha,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size;return Array.isArray(Fe)?[Fe[0]]:[Fe]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,re,me,Fe){return Fe}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var re=M.coordinates;return[re[0],re[1],0]}}})}}]),_}(pt);function xn(h,S){for(var _=[],x=[],C=[],M=h+1,U=S+1,re=h/2,me=S/2,Fe=0;Fe<U;Fe++)for(var Pt=Fe-me,Jt=0;Jt<M;Jt++){var Ir=Jt-re;x.push(Ir/re,-Pt/me,0),C.push(Jt/h),C.push(1-Fe/S)}for(var Pr=0;Pr<S;Pr++)for(var gn=0;gn<h;gn++){var Pn=gn+M*Pr,Rn=gn+M*(Pr+1),Oa=gn+1+M*(Pr+1),qa=gn+1+M*Pr;_.push(Pn,Rn,qa),_.push(Rn,Oa,qa)}return{vertices:x,indices:_,uvs:C}}function zn(h,S){var _=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),_.push.apply(_,x)}return _}function Gi(h){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?zn(Object(_),!0).forEach(function(x){Ce()(h,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):zn(Object(_)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(_,x))})}return h}function mo(h){var S=Do();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Do(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var To=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,nl=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Ml=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,eu=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,uf=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,bs=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Vu=function(h){D()(_,h);var S=mo(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x.heatmapFramerBuffer=void 0,x.intensityModel=void 0,x.colorModel=void 0,x.shapeType=void 0,x}return o()(_,[{key:"render",value:function(){var C=this,M=this.rendererService,U=M.clear,re=M.useFramebuffer;re(this.heatmapFramerBuffer,function(){U({color:[0,0,0,0],depth:1,stencil:0,framebuffer:C.heatmapFramerBuffer}),C.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var C,M=this.rendererService,U=M.createFramebuffer,re=M.clear,me=M.getViewportSize,Fe=M.createTexture2D,Pt=M.useFramebuffer,Jt=this.styleAttributeService.getLayerStyleAttribute("shape"),Ir=(Jt==null||((C=Jt.scale)===null||C===void 0)?void 0:C.field)||"heatmap";this.shapeType=Ir,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Ir==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Pr=this.layer.getLayerConfig(),gn=Pr.rampColors,Pn=Object(Pe.n)(gn),Rn=me(),Oa=Rn.width,qa=Rn.height;return this.heatmapFramerBuffer=U({color:Fe({width:Math.floor(Oa/4),height:Math.floor(qa/4),wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.LINEAR,mag:T.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:T.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){return[re[3],re[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?1:Fe;return[Pt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:uf,fragmentShader:eu,triangulation:Oi,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:T.gl.ONE,srcAlpha:1,dstRGB:T.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:bs,fs:Ml});var C=this.shaderModuleService.getModule("heatmapColor"),M=C.vs,U=C.fs,re=C.uniforms,me=this.rendererService,Fe=me.createAttribute,Pt=me.createElements,Jt=me.createBuffer,Ir=me.createModel;return Ir({vs:M,fs:U,attributes:{a_Position:Fe({buffer:Jt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:T.gl.FLOAT}),size:3}),a_Uv:Fe({buffer:Jt({data:[0,1,1,1,0,0,1,0],type:T.gl.FLOAT}),size:2})},uniforms:Gi({},re),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Pt({data:[0,2,1,2,3,1],type:T.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.intensity,re=U===void 0?10:U,me=C.radius,Fe=me===void 0?5:me;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Fe,u_intensity:re}})}},{key:"drawColorMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=hr.b.invert(hr.b.create(),hr.b.fromValues.apply(hr.b,kt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:kt()(U)}})}},{key:"build3dHeatMap",value:function(){var C=this.rendererService.getViewportSize,M=C(),U=M.width,re=M.height,me=xn(U/4,re/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:nl,fs:To});var Fe=this.shaderModuleService.getModule("heatmap3dColor"),Pt=Fe.vs,Jt=Fe.fs,Ir=Fe.uniforms,Pr=this.rendererService,gn=Pr.createAttribute,Pn=Pr.createElements,Rn=Pr.createBuffer,Oa=Pr.createModel;return Oa({vs:Pt,fs:Jt,attributes:{a_Position:gn({buffer:Rn({data:me.vertices,type:T.gl.FLOAT}),size:3}),a_Uv:gn({buffer:Rn({data:me.uvs,type:T.gl.FLOAT}),size:2})},primitive:T.gl.TRIANGLES,uniforms:Gi({},Ir),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,srcAlpha:1,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:Pn({data:me.indices,type:T.gl.UNSIGNED_INT,count:me.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var C=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),U=M.rampColors,re=Object(Pe.n)(U);this.colorTexture=C({data:new Uint8Array(re.data),width:re.width,height:re.height,wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.NEAREST,mag:T.gl.NEAREST,flipY:!1})}}]),_}(pt);function tu(h){var S=Ao();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ao(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var is=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Gu=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,al=function(h){D()(_,h);var S=tu(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,re=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:re||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Gu,fragmentShader:is,triangulation:di,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var re=M.coordinates;return[re[0],re[1],0]}}})}}]),_}(pt),Ms={heatmap:Vu,heatmap3d:Vu,grid:du,grid3d:en,hexagon:al},$a=Ms;function Hu(h){var S=Wu();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Wu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var il=function(h){D()(_,h);var S=Hu(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="HeatMapLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new $a[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var C=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(U){return U.draw({uniforms:C.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=this.getLayerConfig(),re=U.shape3d,me=this.getSource(),Fe=me.data.type,Pt=(M==null||((C=M.scale)===null||C===void 0)?void 0:C.field)||"heatmap";return Pt==="heatmap"||Pt==="heatmap3d"?"heatmap":Fe==="hexagon"?(re==null?void 0:re.indexOf(Pt))===-1?"hexagon":"grid3d":Fe==="grid"?(re==null?void 0:re.indexOf(Pt))===-1?"grid":"grid3d":"heatmap"}}]),_}(te);function sc(h){var S=wt();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function wt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var qt=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
}
`,wr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Xn=function(h){D()(_,h);var S=sc(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var C=this,M=this.layer.getSource(),U=this.rendererService.createTexture2D;return this.texture=U({height:0,width:0}),M.data.images.then(function(re){C.texture=U({data:re[0],width:re[0].width,height:re[0].height}),C.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:wr,fragmentShader:qt,triangulation:Ga,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){return[re[3],re[4]]}}})}}]),_}(pt),Xa={image:Xn},ni=Xa;function to(h){var S=Sa();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Sa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ii=function(h){D()(_,h);var S=to(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="ImageLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new ni[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={image:{}};return M[C]}},{key:"getModelType",value:function(){return"image"}}]),_}(te);function qo(h){var S=gi();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function gi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var os=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,ru=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,pu={solid:0,dash:1},ss=function(h){D()(_,h);var S=qo(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,re=U===void 0?"solid":U,me=C.dashArray,Fe=me===void 0?[10,5]:me;return Fe.length===2&&Fe.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:pu[re||"solid"],u_dash_array:Fe,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:ru,fragmentShader:os,triangulation:In,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?1:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,re,me){return[re[3],re[4],re[5],re[6]]}}})}}]),_}(pt);function Zu(h){var S=mu();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function mu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ol=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,Lu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Xu={solid:0,dash:1},uc=function(h){D()(_,h);var S=Zu(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,re=U===void 0?"solid":U,me=C.dashArray,Fe=me===void 0?[10,5]:me;return Fe.length===2&&Fe.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:Xu[re]||0,u_dash_array:Fe}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:ol,fragmentShader:Lu,triangulation:In,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?1:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,re,me){return[re[3],re[4],re[5],re[6]]}}})}}]),_}(pt);function lf(h){var S=Ec();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ec(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Hi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Vc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,Gc={solid:0,dash:1},Tf=function(h){D()(_,h);var S=lf(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,re=U===void 0?"solid":U,me=C.dashArray,Fe=me===void 0?[10,5]:me;return Fe.length===2&&Fe.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:Gc[re]||0,u_dash_array:Fe}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Vc,fragmentShader:Hi,triangulation:In,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?1:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,re,me){return[re[3],re[4],re[5],re[6]]}}})}}]),_}(pt);function Hc(h){var S=_f();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function _f(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  // gl_FragColor.a *= u_opacity * blur ;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ru=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,Pl={solid:0,dash:1},nu=function(h){D()(_,h);var S=Hc(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,re=U===void 0?"solid":U,me=C.dashArray,Fe=me===void 0?[10,5,0,0]:me;return Fe.length===2&&Fe.push(0,0),{u_opacity:M||1,u_line_type:Pl[re],u_dash_array:Fe}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Ru,fragmentShader:Pi,triangulation:Ki,primitive:T.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var C=this.layer.getLayerConfig(),M=C.lineType,U=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,Fe,Pt,Jt){return[Pt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,Fe,Pt,Jt){return[Pt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(me,Fe,Pt,Jt){var Ir=me.size,Pr=Ir===void 0?1:Ir;return Array.isArray(Pr)?[Pr[0],Pr[1]]:[Pr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(me,Fe,Pt,Jt,Ir){return Ir}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:T.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(me,Fe,Pt,Jt){return[Pt[4]]}}})}}]),_}(pt),Wc={arc:ss,arc3d:uc,greatcircle:Tf,line:nu},lc=Wc;function vu(h){var S=Zc();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Zc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fs=function(h){D()(_,h);var S=vu(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="LineLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new lc[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[C]}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U||"line"}}]),_}(te);function au(h){var S=Ll();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ll(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Tc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,yi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));
  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,cc=function(h){D()(_,h);var S=au(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:yi,fragmentShader:Tc,triangulation:ha,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,re,me){var Fe=M.size;if(Fe){var Pt=[];return Array.isArray(Fe)&&(Pt=Fe.length===2?[Fe[0],Fe[0],Fe[1]]:Fe),Array.isArray(Fe)||(Pt=[Fe]),Pt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,re,me,Fe){return Fe}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var re=ct(M.coordinates);return[re[0],re[1],0]}}})}}]),_}(pt);function Uf(h){var S=fc();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function fc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Bf=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,_c=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width));
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,Rl=function(h){D()(_,h);var S=Uf(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,re=C.stroke,me=re===void 0?"rgb(0,0,0,0)":re,Fe=C.strokeWidth,Pt=Fe===void 0?1:Fe,Jt=C.strokeOpacity,Ir=Jt===void 0?1:Jt;return{u_opacity:U,u_stroke_width:Pt,u_stroke_color:Object(Pe.s)(me),u_stroke_opacity:Ir}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),va)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:_c,fragmentShader:Bf,triangulation:va,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(C){return[C.enable?0:1,C.speed||1,C.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:T.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,re,me,Fe){var Pt=[1,1,-1,1,-1,-1,1,-1],Jt=Fe%4*2;return[Pt[Jt],Pt[Jt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,re,me,Fe){var Pt=U.size,Jt=Pt===void 0?5:Pt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:T.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,re,me,Fe){var Pt=U.shape,Jt=Pt===void 0?2:Pt,Ir=C.layer.getLayerConfig().shape2d,Pr=Ir.indexOf(Jt);return[Pr]}}})}}]),_}(pt);function pl(h){var S=Ps();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var hc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Fo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;

   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Il=function(h){D()(_,h);var S=pl(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var C=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){C.updateTexture(),C.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Fo,fragmentShader:hc,triangulation:da,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,re,me,Fe){var Pt=U.size;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,re,me,Fe){var Pt=C.fontService.mapping,Jt=U.shape,Ir=C.fontService.getGlyph(Jt),Pr=Pt[Ir],gn=Pr.x,Pn=Pr.y;return[gn,Pn]}}})}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.fontWeight,re=U===void 0?"normal":U,me=M.fontFamily,Fe=me===void 0?"sans-serif":me,Pt=this.layer.getEncodedData(),Jt=[];Pt.forEach(function(Ir){var Pr=Ir.shape,gn=Pr===void 0?"":Pr;gn=gn.toString();var Pn=C.fontService.getGlyph(gn);Jt.indexOf(Pn)===-1&&Jt.push(Pn)}),this.fontService.setFontOptions({characterSet:Jt,fontWeight:re,fontFamily:Fe,fontSize:48})}}]),_}(pt);function ml(h){var S=Xc();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Xc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var vl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,iu=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;

   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Yc=function(h){D()(_,h);var S=ml(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.updateTexture=function(){var re=x.rendererService.createTexture2D;if(x.texture){x.texture.update({data:x.iconService.getCanvas()}),x.layer.render();return}x.texture=re({data:x.iconService.getCanvas(),mag:T.gl.LINEAR,min:T.gl.LINEAR,width:1024,height:x.iconService.canvasHeight||128})},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:iu,fragmentShader:vl,triangulation:da,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,re,me,Fe){var Pt=U.size,Jt=Pt===void 0?5:Pt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,re,me,Fe){var Pt=C.iconService.getIconMap(),Jt=U.shape,Ir=Pt[Jt]||{x:0,y:0},Pr=Ir.x,gn=Ir.y;return[Pr,gn]}}})}}]),_}(pt);function Sf(h){var S=Af();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Af(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dl=`
uniform float u_opacity : 1;
varying vec4 v_color;
#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,dc=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;
#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(project_pos);
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function Sc(h){var S=h.coordinates;return{vertices:kt()(S),indices:[0],size:S.length}}var Nl=function(h){D()(_,h);var S=Sf(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,re=C.stroke,me=re===void 0?"rgb(0,0,0,0)":re,Fe=C.strokeWidth,Pt=Fe===void 0?1:Fe;return{u_opacity:U,u_stroke_width:Pt,u_stroke_color:Object(Pe.s)(me)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:dc,fragmentShader:Dl,triangulation:Sc,depth:{enable:!1},primitive:T.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?1:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:T.BlendType.additive}}}]),_}(pt);function Yu(h,S){var _;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(_=Cf(h))||S&&h&&typeof h.length=="number"){_&&(h=_);var x=0,C=function(){};return{s:C,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Fe){throw Fe},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,re;return{s:function(){_=h[Symbol.iterator]()},n:function(){var Fe=_.next();return M=Fe.done,Fe},e:function(Fe){U=!0,re=Fe},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw re}}}}function Cf(h,S){if(!h)return;if(typeof h=="string")return gl(h,S);var _=Object.prototype.toString.call(h).slice(8,-1);if(_==="Object"&&h.constructor&&(_=h.constructor.name),_==="Map"||_==="Set")return Array.from(h);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return gl(h,S)}function gl(h,S){(S==null||S>h.length)&&(S=h.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=h[_];return x}var pc=function(){function h(S,_,x){Z()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var C=this.boxCells;this.xCellCount=Math.ceil(S/x),this.yCellCount=Math.ceil(_/x);for(var M=0;M<this.xCellCount*this.yCellCount;M++)C.push([]);this.boxKeys=[],this.bboxes=[],this.width=S,this.height=_,this.xScale=this.xCellCount/S,this.yScale=this.yCellCount/_,this.boxUid=0}return o()(h,[{key:"insert",value:function(_,x,C,M,U){this.forEachCell(x,C,M,U,this.insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(M),this.bboxes.push(U)}},{key:"query",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!1,U)}},{key:"hitTest",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!0,U)}},{key:"insertBoxCell",value:function(_,x,C,M,U,re){this.boxCells[U].push(re)}},{key:"queryHitTest",value:function(_,x,C,M,U,re){if(C<0||_>this.width||M<0||x>this.height)return U?!1:[];var me=[];if(_<=0&&x<=0&&this.width<=C&&this.height<=M){if(U)return!0;for(var Fe=0;Fe<this.boxKeys.length;Fe++)me.push({key:this.boxKeys[Fe],x1:this.bboxes[Fe*4],y1:this.bboxes[Fe*4+1],x2:this.bboxes[Fe*4+2],y2:this.bboxes[Fe*4+3]});return re?me.filter(re):me}var Pt={hitTest:U,seenUids:{box:{},circle:{}}};return this.forEachCell(_,x,C,M,this.queryCell,me,Pt,re),U?me.length>0:me}},{key:"queryCell",value:function(_,x,C,M,U,re,me,Fe){var Pt=me.seenUids,Jt=this.boxCells[U];if(Jt!==null){var Ir=this.bboxes,Pr=Yu(Jt),gn;try{for(Pr.s();!(gn=Pr.n()).done;){var Pn=gn.value;if(!Pt.box[Pn]){Pt.box[Pn]=!0;var Rn=Pn*4;if(_<=Ir[Rn+2]&&x<=Ir[Rn+3]&&C>=Ir[Rn+0]&&M>=Ir[Rn+1]&&(!Fe||Fe(this.boxKeys[Pn]))){if(me.hitTest)return re.push(!0),!0;re.push({key:this.boxKeys[Pn],x1:Ir[Rn],y1:Ir[Rn+1],x2:Ir[Rn+2],y2:Ir[Rn+3]})}}}}catch(Oa){Pr.e(Oa)}finally{Pr.f()}}return!1}},{key:"forEachCell",value:function(_,x,C,M,U,re,me,Fe){for(var Pt=this.convertToXCellCoord(_),Jt=this.convertToYCellCoord(x),Ir=this.convertToXCellCoord(C),Pr=this.convertToYCellCoord(M),gn=Pt;gn<=Ir;gn++)for(var Pn=Jt;Pn<=Pr;Pn++){var Rn=this.xCellCount*Pn+gn;if(U.call(this,_,x,C,M,Rn,re,me,Fe))return}}},{key:"convertToXCellCoord",value:function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))}},{key:"convertToYCellCoord",value:function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))}}]),h}(),Co=pc,Vf=function(){function h(S,_){Z()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=S,this.height=_,this.viewportPadding=Math.max(S,_),this.grid=new Co(S+this.viewportPadding,_+this.viewportPadding,25),this.screenRightBoundary=S+this.viewportPadding,this.screenBottomBoundary=_+this.viewportPadding,this.gridRightBoundary=S+2*this.viewportPadding,this.gridBottomBoundary=_+2*this.viewportPadding}return o()(h,[{key:"placeCollisionBox",value:function(_){var x=_.x1+_.anchorPointX+this.viewportPadding,C=_.y1+_.anchorPointY+this.viewportPadding,M=_.x2+_.anchorPointX+this.viewportPadding,U=_.y2+_.anchorPointY+this.viewportPadding;return!this.isInsideGrid(x,C,M,U)||this.grid.hitTest(x,C,M,U)?{box:[]}:{box:[x,C,M,U]}}},{key:"insertCollisionBox",value:function(_,x){var C={featureIndex:x};this.grid.insert(C,_[0],_[1],_[2],_[3])}},{key:"project",value:function(_,x,C){var M=hr.e.fromValues(x,C,0,1),U=hr.e.create(),re=hr.b.fromValues.apply(hr.b,kt()(_));return hr.e.transformMat4(U,M,re),{x:(U[0]/U[3]+1)/2*this.width+this.viewportPadding,y:(-U[1]/U[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(_,x,C,M){return C>=0&&_<this.gridRightBoundary&&M>=0&&x<this.gridBottomBoundary}}]),h}();function Kc(h,S){var _;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(_=Ac(h))||S&&h&&typeof h.length=="number"){_&&(h=_);var x=0,C=function(){};return{s:C,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Fe){throw Fe},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,re;return{s:function(){_=h[Symbol.iterator]()},n:function(){var Fe=_.next();return M=Fe.done,Fe},e:function(Fe){U=!0,re=Fe},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw re}}}}function Ac(h,S){if(!h)return;if(typeof h=="string")return cf(h,S);var _=Object.prototype.toString.call(h).slice(8,-1);if(_==="Object"&&h.constructor&&(_=h.constructor.name),_==="Map"||_==="Set")return Array.from(h);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return cf(h,S)}function cf(h,S){(S==null||S>h.length)&&(S=h.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=h[_];return x}function ff(h){var S=.5,_=.5;switch(h){case"right":case"top-right":case"bottom-right":S=1;break;case"left":case"top-left":case"bottom-left":S=0;break;default:S=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":_=1;break;case"top":case"top-right":case"top-left":_=0;break;default:_=.5}return{horizontalAlign:S,verticalAlign:_}}function hf(h,S,_,x,C){if(!C)return;var M=h[x],U=M.glyph;if(U)for(var re=S[U].advance*M.scale,me=(h[x].x+re)*C,Fe=_;Fe<=x;Fe++)h[Fe].x-=me}function kl(h,S,_,x,C,M,U){var re=(S-_)*C,me=(-x*U+.5)*M,Fe=Kc(h),Pt;try{for(Fe.s();!(Pt=Fe.n()).done;){var Jt=Pt.value;Jt.x+=re,Jt.y+=me}}catch(Ir){Fe.e(Ir)}finally{Fe.f()}}function jl(h,S,_,x,C,M,U){var re=-8,me=0,Fe=re,Pt=0,Jt=h.positionedGlyphs,Ir=M==="right"?1:M==="left"?0:.5,Pr=Jt.length;_.forEach(function(qa){if(qa.split("").forEach(function(ri){var fi=S[ri],ho=0;fi&&(Jt.push({glyph:ri,x:me,y:Fe+ho,vertical:!1,scale:1,metrics:fi}),me+=fi.advance+U)}),Jt.length!==Pr){var ci=me-U;Pt=Math.max(ci,Pt),hf(Jt,S,Pr,Jt.length-1,Ir)}me=0,Fe+=x});var gn=ff(C),Pn=gn.horizontalAlign,Rn=gn.verticalAlign;kl(Jt,Ir,Pn,Rn,Pt,x,_.length);var Oa=Fe-re;h.top+=-Rn*Oa,h.bottom=h.top+Oa,h.left+=-Pn*Pt,h.right=h.left+Pt}function zl(h,S,_,x,C,M){var U=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],re=h.split(`
`),me=[],Fe={positionedGlyphs:me,top:U[1],bottom:U[1],left:U[0],right:U[0],lineCount:re.length,text:h};return jl(Fe,S,re,_,x,C,M),me.length?Fe:!1}function Di(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],_=arguments.length>2?arguments[2]:void 0,x=h.positionedGlyphs,C=x===void 0?[]:x,M=[],U=Kc(C),re;try{for(U.s();!(re=U.n()).done;){var me=re.value,Fe=me.metrics,Pt=4,Jt=Fe.advance*me.scale/2,Ir=_?[me.x+Jt,me.y]:[0,0],Pr=_?[0,0]:[me.x+Jt+S[0],me.y+S[1]],gn=(0-Pt)*me.scale-Jt+Pr[0],Pn=(0-Pt)*me.scale+Pr[1],Rn=gn+Fe.width*me.scale,Oa=Pn+Fe.height*me.scale,qa={x:gn,y:Pn},ci={x:Rn,y:Pn},ri={x:gn,y:Oa},fi={x:Rn,y:Oa};M.push({tl:qa,tr:ci,bl:ri,br:fi,tex:Fe,glyphOffset:Ir})}}catch(ho){U.e(ho)}finally{U.f()}return M}function ou(h,S){var _;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(_=Uo(h))||S&&h&&typeof h.length=="number"){_&&(h=_);var x=0,C=function(){};return{s:C,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Fe){throw Fe},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,re;return{s:function(){_=h[Symbol.iterator]()},n:function(){var Fe=_.next();return M=Fe.done,Fe},e:function(Fe){U=!0,re=Fe},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw re}}}}function Uo(h,S){if(!h)return;if(typeof h=="string")return Bo(h,S);var _=Object.prototype.toString.call(h).slice(8,-1);if(_==="Object"&&h.constructor&&(_=h.constructor.name),_==="Map"||_==="Set")return Array.from(h);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return Bo(h,S)}function Bo(h,S){(S==null||S>h.length)&&(S=h.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=h[_];return x}function ui(h){var S=li();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function li(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var sl=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,us=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function mc(h){var S=this,_=h.id,x=[],C=[];if(!S.glyphInfoMap||!S.glyphInfoMap[_])return{vertices:[],indices:[],size:7};var M=S.glyphInfoMap[_].centroid,U=M.length===2?[M[0],M[1],0]:M;return S.glyphInfoMap[_].glyphQuads.forEach(function(re,me){x.push.apply(x,kt()(U).concat([re.tex.x,re.tex.y+re.tex.height,re.tl.x,re.tl.y],kt()(U),[re.tex.x+re.tex.width,re.tex.y+re.tex.height,re.tr.x,re.tr.y],kt()(U),[re.tex.x+re.tex.width,re.tex.y,re.br.x,re.br.y],kt()(U),[re.tex.x,re.tex.y,re.bl.x,re.bl.y])),C.push(0+me*4,1+me*4,2+me*4,2+me*4,3+me*4,0+me*4)}),{vertices:x,indices:C,size:7}}var wf=function(h){D()(_,h);var S=ui(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.glyphInfo=void 0,x.glyphInfoMap={},x.texture=void 0,x.currentZoom=-1,x.extent=void 0,x.textureHeight=0,x.textCount=0,x.preTextStyle={},x.buildModels=function(){return x.initGlyph(),x.updateTexture(),x.filterGlyphs(),[x.layer.buildLayerModel({moduleName:"pointText",vertexShader:us,fragmentShader:sl,triangulation:mc.bind(He()(x)),depth:{enable:!1},blend:x.getBlend()})]},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,re=C.stroke,me=re===void 0?"#fff":re,Fe=C.strokeWidth,Pt=Fe===void 0?0:Fe,Jt=C.strokeOpacity,Ir=Jt===void 0?1:Jt,Pr=C.textAnchor,gn=Pr===void 0?"center":Pr,Pn=C.textAllowOverlap,Rn=Pn===void 0?!1:Pn,Oa=C.halo,qa=Oa===void 0?.5:Oa,ci=C.gamma,ri=ci===void 0?2:ci,fi=this.fontService,ho=fi.canvas,La=fi.mapping;return Object.keys(La).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(La).length),this.preTextStyle={textAnchor:gn,textAllowOverlap:Rn},{u_opacity:U,u_stroke_opacity:Ir,u_sdf_map:this.texture,u_stroke:Object(Pe.s)(me),u_halo_blur:qa,u_gamma_scale:ri,u_sdf_map_size:[ho.width,ho.height],u_strokeWidth:Pt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var C=this.layer.getLayerConfig(),M=C.textAnchor,U=M===void 0?"center":M,re=C.textAllowOverlap,me=re===void 0?!0:re;return this.preTextStyle={textAnchor:U,textAllowOverlap:me},this.buildModels()}},{key:"needUpdate",value:function(){var C=this.layer.getLayerConfig(),M=C.textAllowOverlap,U=M===void 0?!1:M,re=this.mapService.getZoom(),me=this.mapService.getBounds(),Fe=Object(Pe.j)(this.extent,me);return!U&&(Math.abs(this.currentZoom-re)>1||!Fe)||U!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:T.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){return[re[5],re[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?12:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:T.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){return[re[3],re[4]]}}})}},{key:"textExtent",value:function(){var C=this.mapService.getBounds();return Object(Pe.r)(C,.5)}},{key:"initTextFont",value:function(){var C=this.layer.getLayerConfig(),M=C.fontWeight,U=M===void 0?"400":M,re=C.fontFamily,me=re===void 0?"sans-serif":re,Fe=this.layer.getEncodedData(),Pt=[];Fe.forEach(function(Jt){var Ir=Jt.shape,Pr=Ir===void 0?"":Ir;Pr=Pr.toString();var gn=ou(Pr),Pn;try{for(gn.s();!(Pn=gn.n()).done;){var Rn=Pn.value;Pt.indexOf(Rn)===-1&&Pt.push(Rn)}}catch(Oa){gn.e(Oa)}finally{gn.f()}}),this.fontService.setFontOptions({characterSet:Pt,fontWeight:U,fontFamily:me})}},{key:"generateGlyphLayout",value:function(){var C=this,M=this.fontService.mapping,U=this.layer.getLayerConfig(),re=U.spacing,me=re===void 0?2:re,Fe=U.textAnchor,Pt=Fe===void 0?"center":Fe,Jt=U.textOffset,Ir=this.layer.getEncodedData();this.glyphInfo=Ir.map(function(Pr){var gn=Pr.shape,Pn=gn===void 0?"":gn,Rn=Pr.coordinates,Oa=Pr.id,qa=Pr.size,ci=qa===void 0?1:qa,ri=zl(Pn.toString(),M,ci,Pt,"center",me,Jt),fi=Di(ri,Jt,!1);return Pr.shaping=ri,Pr.glyphQuads=fi,Pr.centroid=ct(Rn),C.glyphInfoMap[Oa]={shaping:ri,glyphQuads:fi,centroid:ct(Rn)},Pr})}},{key:"filterGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.padding,re=U===void 0?[4,4]:U,me=M.textAllowOverlap,Fe=me===void 0?!1:me;if(Fe)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Pt=this.rendererService.getViewportSize(),Jt=Pt.width,Ir=Pt.height,Pr=new Vf(Jt,Ir),gn=this.glyphInfo.filter(function(Pn){var Rn=Pn.shaping,Oa=Pn.id,qa=Oa===void 0?0:Oa,ci=Pn.centroid,ri=Pn.size,fi=ri/24,ho=C.mapService.lngLatToContainer(ci),La=Pr.placeCollisionBox({x1:Rn.left*fi-re[0],x2:Rn.right*fi+re[0],y1:Rn.top*fi-re[1],y2:Rn.bottom*fi+re[1],anchorPointX:ho.x,anchorPointY:ho.y}),zo=La.box;return zo&&zo.length?(Pr.insertCollisionBox(zo,qa),!0):!1});gn.forEach(function(Pn){C.glyphInfoMap[Pn.id]=Pn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:us,fragmentShader:sl,triangulation:mc.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),_}(pt),Of={fill:Rl,image:Yc,normal:Nl,extrude:cc,text:wf,icon:Il},No=Of;function yl(h){var S=oi();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function oi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ia=function(h){D()(_,h);var S=yl(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PointLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new No[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[C]}},{key:"getModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,re=M.shape3d,me=this.iconService.getIconMap(),Fe=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(Fe){var Pt=Fe.shape;return Pt==="dot"?"normal":(U==null?void 0:U.indexOf(Pt))!==-1?"fill":(re==null?void 0:re.indexOf(Pt))!==-1?"extrude":me.hasOwnProperty(Pt)?"image":this.fontService.getGlyph(Pt)!==""?"icon":"text"}else return"normal"}}]),_}(te);function xs(h){var S=ls();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function ls(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Iu=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,bn=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Es=function(h){D()(_,h);var S=xs(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:bn,fragmentShader:Iu,triangulation:xa})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,re,me,Fe){return Fe}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,re,me){var Fe=M.size,Pt=Fe===void 0?10:Fe;return Array.isArray(Pt)?[Pt[0]]:[Pt]}}})}}]),_}(pt);function Us(h){var S=Cc();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Cc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gu=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,yu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,bu=function(h){D()(_,h);var S=Us(_);function _(){return Z()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:yu,fragmentShader:gu,triangulation:Fi,depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),_}(pt),Sn={fill:bu,line:nu,extrude:Es,text:wf,point_fill:Rl,point_image:Yc,point_normal:Nl,point_extrude:cc},Si=Sn;function $c(h){var S=wc();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function wc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fl=function(h){D()(_,h);var S=$c(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Si[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U==="fill"?"fill":U==="extrude"?"extrude":U==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,re=M.shape3d,me=this.iconService.getIconMap(),Fe=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(Fe){var Pt=Fe.shape;return Pt==="dot"?"point_normal":(U==null?void 0:U.indexOf(Pt))!==-1?"point_fill":(re==null?void 0:re.indexOf(Pt))!==-1?"point_extrude":me.hasOwnProperty(Pt)?"point_image":"text"}else return"fill"}}]),_}(te);function Du(h){var S=Ua();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Oc=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,Bs=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,bl=function(h){D()(_,h);var S=Du(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,re=C.clampLow,me=re===void 0?!0:re,Fe=C.clampHigh,Pt=Fe===void 0?!0:Fe,Jt=C.noDataValue,Ir=Jt===void 0?-9999999:Jt,Pr=C.domain,gn=Pr===void 0?[0,1]:Pr;return this.updateColorTexure(),{u_opacity:U||1,u_texture:this.texture,u_domain:gn,u_clampLow:me,u_clampHigh:typeof Pt!="undefined"?Pt:me,u_noDataValue:Ir,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var C=this.layer.getSource(),M=this.rendererService.createTexture2D,U=C.data.dataArray[0];this.texture=M({data:U.data,width:U.width,height:U.height,format:T.gl.LUMINANCE,type:T.gl.FLOAT});var re=this.layer.getLayerConfig(),me=re.rampColors,Fe=Object(Pe.n)(me);return this.colorTexture=M({data:Fe.data,width:Fe.width,height:Fe.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:Bs,fragmentShader:Oc,triangulation:Ga,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,re,me){return[re[3],re[4]]}}})}},{key:"updateColorTexure",value:function(){var C=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),U=M.rampColors,re=Object(Pe.n)(U);this.colorTexture=C({data:re.data,width:re.width,height:re.height,flipY:!1})}}]),_}(pt),df={raster:bl,raster3d:bl},Mc=df;function Ul(h){var S=Ls();return function(){var x=X()(h),C;if(S){var M=X()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return q()(this,C)}}function Ls(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Yo=function(h){D()(_,h);var S=Ul(_);function _(){var x;Z()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="RasterLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Mc[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={raster:{},raster3d:{}};return M[C]}},{key:"getModelType",value:function(){return"raster"}}]),_}(te),Ji,bi,Qi,Ku,vo,es,xu,Nu;function Vo(h,S){var _=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),_.push.apply(_,x)}return _}function xl(h){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?Vo(Object(_),!0).forEach(function(x){Ce()(h,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):Vo(Object(_)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(_,x))})}return h}var Vn=(Ji=Object(sr.injectable)(),bi=Object(sr.inject)(T.TYPES.IGlobalConfigService),Qi=Object(sr.inject)(T.TYPES.ILogService),Ji(Ku=(vo=(Nu=function(){function h(){Z()(this,h),Ne()(this,"configService",es,this),Ne()(this,"logger",xu,this)}return o()(h,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("DataMappingPlugin",function(){C.generateMaping(_,{styleAttributeService:M})}),_.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return _.dataState.dataMappingNeedUpdate=!1,C.generateMaping(_,{styleAttributeService:M}),!0}),_.hooks.beforeRender.tap("DataMappingPlugin",function(){if(_.layerModelNeedUpdate)return;var U=M.getLayerStyleAttributes()||[],re=M.getLayerStyleAttribute("filter"),me=_.getSource().data.dataArray,Fe=U.filter(function(Jt){return Jt.needRemapping}),Pt=me;(re==null?void 0:re.needRemapping)&&(re==null?void 0:re.scale)&&(Pt=me.filter(function(Jt){return C.applyAttributeMapping(re,Jt)[0]})),Fe.length&&((re==null?void 0:re.needRemapping)?(_.setEncodedData(C.mapping(U,Pt)),re.needRemapping=!1):_.setEncodedData(C.mapping(Fe,Pt,_.getEncodedData())),C.logger.debug("remapping finished"),_.emit("remapping",null))})}},{key:"generateMaping",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],re=M.getLayerStyleAttribute("filter"),me=_.getSource().data.dataArray,Fe=me;(re==null?void 0:re.scale)&&(Fe=me.filter(function(Pt){return C.applyAttributeMapping(re,Pt)[0]})),_.setEncodedData(this.mapping(U,Fe))}},{key:"mapping",value:function(_,x,C){var M=this;return x.map(function(U,re){var me=C?C[re]:{},Fe=xl({id:U._id,coordinates:U.coordinates},me);return _.filter(function(Pt){return Pt.scale!==void 0}).forEach(function(Pt){var Jt=M.applyAttributeMapping(Pt,U);Pt.needRemapping=!1,Pt.name==="color"&&(Jt=Jt.map(function(Ir){return Object(Pe.s)(Ir)})),Fe[Pt.name]=Array.isArray(Jt)&&Jt.length===1?Jt[0]:Jt}),Fe})}},{key:"applyAttributeMapping",value:function(_,x){var C;if(!_.scale)return[];var M=(_==null||((C=_.scale)===null||C===void 0)?void 0:C.scalers)||[],U=[];return M.forEach(function(re){var me,Fe=re.field;(x.hasOwnProperty(Fe)||((me=_.scale)===null||me===void 0?void 0:me.type)==="variable")&&U.push(x[Fe])}),_.mapping?_.mapping(U):[]}}]),h}(),Nu),es=Ye()(vo.prototype,"configService",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu=Ye()(vo.prototype,"logger",[Qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vo))||Ku),la=i("rlAn"),go,$u,Vs,Ui=(go=Object(sr.injectable)(),go($u=(Vs=function(){function h(){Z()(this,h),this.mapService=void 0}return o()(h,[{key:"apply",value:function(_){var x=this;this.mapService=_.getContainer().get(T.TYPES.IMapService),_.hooks.init.tap("DataSourcePlugin",function(){var C=_.sourceOption,M=C.data,U=C.options;_.setSource(new la.default(M,U)),x.updateClusterData(_)}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var C=x.updateClusterData(_),M=_.dataState.dataSourceNeedUpdate;return _.dataState.dataSourceNeedUpdate=!1,C||M})}},{key:"updateClusterData",value:function(_){var x=_.getSource(),C=x.cluster,M=x.clusterOptions,U=M.zoom,re=U===void 0?0:U,me=M.maxZoom,Fe=me===void 0?16:me,Pt=this.mapService.getZoom()-1;return C&&Math.abs(re-Pt)>1&&Fe>re?(x.updateClusterData(Math.floor(Pt)),!0):!1}}]),h}(),Vs))||$u),cs=i("7tbW"),Jc=i.n(cs),Gs=i("4qC0"),Li=i.n(Gs),Ni=i("J2iB"),Bl=i.n(Ni),Eu=function(h,S){return h<S?-1:h>S?1:h>=S?0:NaN},Vl=function(h){return h.length===1&&(h=vc(h)),{left:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;h(_[U],x)<0?C=U+1:M=U}return C},right:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;h(_[U],x)>0?M=U:C=U+1}return C}}};function vc(h){return function(S,_){return Eu(h(S),_)}}var ku=Vl(Eu),ts=ku.right,Ju=ku.left,ul=ts,Mf=function(h,S){S==null&&(S=Gl);for(var _=0,x=h.length-1,C=h[0],M=new Array(x<0?0:x);_<x;)M[_]=S(C,C=h[++_]);return M};function Gl(h,S){return[h,S]}var Qc=function(h,S,_){var x=h.length,C=S.length,M=new Array(x*C),U,re,me,Fe;for(_==null&&(_=Gl),U=me=0;U<x;++U)for(Fe=h[U],re=0;re<C;++re,++me)M[me]=_(Fe,S[re]);return M},pf=function(h,S){return S<h?-1:S>h?1:S>=h?0:NaN},Ts=function(h){return h===null?NaN:+h},ju=function(h,S){var _=h.length,x=0,C=-1,M=0,U,re,me=0;if(S==null)for(;++C<_;)isNaN(U=Ts(h[C]))||(re=U-M,M+=re/++x,me+=re*(U-M));else for(;++C<_;)isNaN(U=Ts(S(h[C],C,h)))||(re=U-M,M+=re/++x,me+=re*(U-M));if(x>1)return me/(x-1)},ll=function(h,S){var _=ju(h,S);return _&&Math.sqrt(_)},mf=function(h,S){var _=h.length,x=-1,C,M,U;if(S==null){for(;++x<_;)if((C=h[x])!=null&&C>=C)for(M=U=C;++x<_;)(C=h[x])!=null&&(M>C&&(M=C),U<C&&(U=C))}else for(;++x<_;)if((C=S(h[x],x,h))!=null&&C>=C)for(M=U=C;++x<_;)(C=S(h[x],x,h))!=null&&(M>C&&(M=C),U<C&&(U=C));return[M,U]},El=Array.prototype,Hl=El.slice,cl=El.map,Rs=function(h){return function(){return h}},Tl=function(h){return h},Wl=function(h,S,_){h=+h,S=+S,_=(C=arguments.length)<2?(S=h,h=0,1):C<3?1:+_;for(var x=-1,C=Math.max(0,Math.ceil((S-h)/_))|0,M=new Array(C);++x<C;)M[x]=h+x*_;return M},Qu=Math.sqrt(50),s=Math.sqrt(10),a=Math.sqrt(2),n=function(h,S,_){var x,C=-1,M,U,re;if(S=+S,h=+h,_=+_,h===S&&_>0)return[h];if((x=S<h)&&(M=h,h=S,S=M),(re=l(h,S,_))===0||!isFinite(re))return[];if(re>0)for(h=Math.ceil(h/re),S=Math.floor(S/re),U=new Array(M=Math.ceil(S-h+1));++C<M;)U[C]=(h+C)*re;else for(h=Math.floor(h*re),S=Math.ceil(S*re),U=new Array(M=Math.ceil(h-S+1));++C<M;)U[C]=(h-C)/re;return x&&U.reverse(),U};function l(h,S,_){var x=(S-h)/Math.max(0,_),C=Math.floor(Math.log(x)/Math.LN10),M=x/Math.pow(10,C);return C>=0?(M>=Qu?10:M>=s?5:M>=a?2:1)*Math.pow(10,C):-Math.pow(10,-C)/(M>=Qu?10:M>=s?5:M>=a?2:1)}function y(h,S,_){var x=Math.abs(S-h)/Math.max(0,_),C=Math.pow(10,Math.floor(Math.log(x)/Math.LN10)),M=x/C;return M>=Qu?C*=10:M>=s?C*=5:M>=a&&(C*=2),S<h?-C:C}var O=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},R=function(){var h=Tl,S=mf,_=O;function x(C){var M,U=C.length,re,me=new Array(U);for(M=0;M<U;++M)me[M]=h(C[M],M,C);var Fe=S(me),Pt=Fe[0],Jt=Fe[1],Ir=_(me,Pt,Jt);Array.isArray(Ir)||(Ir=y(Pt,Jt,Ir),Ir=Wl(Math.ceil(Pt/Ir)*Ir,Jt,Ir));for(var Pr=Ir.length;Ir[0]<=Pt;)Ir.shift(),--Pr;for(;Ir[Pr-1]>Jt;)Ir.pop(),--Pr;var gn=new Array(Pr+1),Pn;for(M=0;M<=Pr;++M)Pn=gn[M]=[],Pn.x0=M>0?Ir[M-1]:Pt,Pn.x1=M<Pr?Ir[M]:Jt;for(M=0;M<U;++M)re=me[M],Pt<=re&&re<=Jt&&gn[ul(Ir,re,0,Pr)].push(C[M]);return gn}return x.value=function(C){return arguments.length?(h=typeof C=="function"?C:Rs(C),x):h},x.domain=function(C){return arguments.length?(S=typeof C=="function"?C:Rs([C[0],C[1]]),x):S},x.thresholds=function(C){return arguments.length?(_=typeof C=="function"?C:Array.isArray(C)?Rs(Hl.call(C)):Rs(C),x):_},x},k=function(h,S,_){if(_==null&&(_=Ts),!(x=h.length))return;if((S=+S)<=0||x<2)return+_(h[0],0,h);if(S>=1)return+_(h[x-1],x-1,h);var x,C=(x-1)*S,M=Math.floor(C),U=+_(h[M],M,h),re=+_(h[M+1],M+1,h);return U+(re-U)*(C-M)},ie=function(h,S,_){return h=cl.call(h,Ts).sort(Eu),Math.ceil((_-S)/(2*(k(h,.75)-k(h,.25))*Math.pow(h.length,-1/3)))},Ee=function(h,S,_){return Math.ceil((_-S)/(3.5*ll(h)*Math.pow(h.length,-1/3)))},We=function(h,S){var _=h.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=h[x])!=null&&C>=C)for(M=C;++x<_;)(C=h[x])!=null&&C>M&&(M=C)}else for(;++x<_;)if((C=S(h[x],x,h))!=null&&C>=C)for(M=C;++x<_;)(C=S(h[x],x,h))!=null&&C>M&&(M=C);return M},$e=function(h,S){var _=h.length,x=_,C=-1,M,U=0;if(S==null)for(;++C<_;)isNaN(M=Ts(h[C]))?--x:U+=M;else for(;++C<_;)isNaN(M=Ts(S(h[C],C,h)))?--x:U+=M;if(x)return U/x},qe=function(h,S){var _=h.length,x=-1,C,M=[];if(S==null)for(;++x<_;)isNaN(C=Ts(h[x]))||M.push(C);else for(;++x<_;)isNaN(C=Ts(S(h[x],x,h)))||M.push(C);return k(M.sort(Eu),.5)},Lt=function(h){for(var S=h.length,_,x=-1,C=0,M,U;++x<S;)C+=h[x].length;for(M=new Array(C);--S>=0;)for(U=h[S],_=U.length;--_>=0;)M[--C]=U[_];return M},Rt=function(h,S){var _=h.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=h[x])!=null&&C>=C)for(M=C;++x<_;)(C=h[x])!=null&&M>C&&(M=C)}else for(;++x<_;)if((C=S(h[x],x,h))!=null&&C>=C)for(M=C;++x<_;)(C=S(h[x],x,h))!=null&&M>C&&(M=C);return M},Gt=function(h,S){for(var _=S.length,x=new Array(_);_--;)x[_]=h[S[_]];return x},Dt=function(h,S){if(!(_=h.length))return;var _,x=0,C=0,M,U=h[C];for(S==null&&(S=Eu);++x<_;)(S(M=h[x],U)<0||S(U,U)!==0)&&(U=M,C=x);if(S(U,U)===0)return C},jt=function(h,S,_){for(var x=(_==null?h.length:_)-(S=S==null?0:+S),C,M;x;)M=Math.random()*x--|0,C=h[x+S],h[x+S]=h[M+S],h[M+S]=C;return h},ir=function(h,S){var _=h.length,x=-1,C,M=0;if(S==null)for(;++x<_;)(C=+h[x])&&(M+=C);else for(;++x<_;)(C=+S(h[x],x,h))&&(M+=C);return M},Qt=function(h){if(!(M=h.length))return[];for(var S=-1,_=Rt(h,Lr),x=new Array(_);++S<_;)for(var C=-1,M,U=x[S]=new Array(M);++C<M;)U[C]=h[C][S];return x};function Lr(h){return h.length}var gr=function(){return Qt(arguments)};function Ar(h,S){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(S).domain(h);break}return this}function Or(h,S){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(S).domain(h);break}return this}var Kr="$";function Qr(){}Qr.prototype=dn.prototype={constructor:Qr,has:function(S){return Kr+S in this},get:function(S){return this[Kr+S]},set:function(S,_){return this[Kr+S]=_,this},remove:function(S){var _=Kr+S;return _ in this&&delete this[_]},clear:function(){for(var S in this)S[0]===Kr&&delete this[S]},keys:function(){var S=[];for(var _ in this)_[0]===Kr&&S.push(_.slice(1));return S},values:function(){var S=[];for(var _ in this)_[0]===Kr&&S.push(this[_]);return S},entries:function(){var S=[];for(var _ in this)_[0]===Kr&&S.push({key:_.slice(1),value:this[_]});return S},size:function(){var S=0;for(var _ in this)_[0]===Kr&&++S;return S},empty:function(){for(var S in this)if(S[0]===Kr)return!1;return!0},each:function(S){for(var _ in this)_[0]===Kr&&S(this[_],_.slice(1),this)}};function dn(h,S){var _=new Qr;if(h instanceof Qr)h.each(function(re,me){_.set(me,re)});else if(Array.isArray(h)){var x=-1,C=h.length,M;if(S==null)for(;++x<C;)_.set(x,h[x]);else for(;++x<C;)_.set(S(M=h[x],x,h),M)}else if(h)for(var U in h)_.set(U,h[U]);return _}var wn=dn,ra=function(){var h=[],S=[],_,x,C;function M(re,me,Fe,Pt){if(me>=h.length)return _!=null&&re.sort(_),x!=null?x(re):re;for(var Jt=-1,Ir=re.length,Pr=h[me++],gn,Pn,Rn=wn(),Oa,qa=Fe();++Jt<Ir;)(Oa=Rn.get(gn=Pr(Pn=re[Jt])+""))?Oa.push(Pn):Rn.set(gn,[Pn]);return Rn.each(function(ci,ri){Pt(qa,ri,M(ci,me,Fe,Pt))}),qa}function U(re,me){if(++me>h.length)return re;var Fe,Pt=S[me-1];return x!=null&&me>=h.length?Fe=re.entries():(Fe=[],re.each(function(Jt,Ir){Fe.push({key:Ir,values:U(Jt,me)})})),Pt!=null?Fe.sort(function(Jt,Ir){return Pt(Jt.key,Ir.key)}):Fe}return C={object:function(me){return M(me,0,ya,Ta)},map:function(me){return M(me,0,Ja,Mn)},entries:function(me){return U(M(me,0,Ja,Mn),0)},key:function(me){return h.push(me),C},sortKeys:function(me){return S[h.length-1]=me,C},sortValues:function(me){return _=me,C},rollup:function(me){return x=me,C}}};function ya(){return{}}function Ta(h,S,_){h[S]=_}function Ja(){return wn()}function Mn(h,S,_){h.set(S,_)}function ba(){}var ca=wn.prototype;ba.prototype=Fn.prototype={constructor:ba,has:ca.has,add:function(S){return S+="",this[Kr+S]=S,this},remove:ca.remove,clear:ca.clear,values:ca.keys,size:ca.size,empty:ca.empty,each:ca.each};function Fn(h,S){var _=new ba;if(h instanceof ba)h.each(function(M){_.add(M)});else if(h){var x=-1,C=h.length;if(S==null)for(;++x<C;)_.add(h[x]);else for(;++x<C;)_.add(S(h[x],x,h))}return _}var Ma=Fn,Qn=function(h){var S=[];for(var _ in h)S.push(_);return S},Da=function(h){var S=[];for(var _ in h)S.push(h[_]);return S},ai=function(h){var S=[];for(var _ in h)S.push({key:_,value:h[_]});return S},uo=Array.prototype,ro=uo.map,Wi=uo.slice,xi={name:"implicit"};function no(){var h=wn(),S=[],_=[],x=xi;function C(M){var U=M+"",re=h.get(U);if(!re){if(x!==xi)return x;h.set(U,re=S.push(M))}return _[(re-1)%_.length]}return C.domain=function(M){if(!arguments.length)return S.slice();S=[],h=wn();for(var U=-1,re=M.length,me,Fe;++U<re;)h.has(Fe=(me=M[U])+"")||h.set(Fe,S.push(me));return C},C.range=function(M){return arguments.length?(_=Wi.call(M),C):_.slice()},C.unknown=function(M){return arguments.length?(x=M,C):x},C.copy=function(){return no(S,_).unknown(x)},Ar.apply(C,arguments),C}function Go(){var h=no().unknown(void 0),S=h.domain,_=h.range,x=[0,1],C,M,U=!1,re=0,me=0,Fe=.5;delete h.unknown;function Pt(){var Jt=S().length,Ir=x[1]<x[0],Pr=x[Ir-0],gn=x[1-Ir];C=(gn-Pr)/Math.max(1,Jt-re+me*2),U&&(C=Math.floor(C)),Pr+=(gn-Pr-C*(Jt-re))*Fe,M=C*(1-re),U&&(Pr=Math.round(Pr),M=Math.round(M));var Pn=Wl(Jt).map(function(Rn){return Pr+C*Rn});return _(Ir?Pn.reverse():Pn)}return h.domain=function(Jt){return arguments.length?(S(Jt),Pt()):S()},h.range=function(Jt){return arguments.length?(x=[+Jt[0],+Jt[1]],Pt()):x.slice()},h.rangeRound=function(Jt){return x=[+Jt[0],+Jt[1]],U=!0,Pt()},h.bandwidth=function(){return M},h.step=function(){return C},h.round=function(Jt){return arguments.length?(U=!!Jt,Pt()):U},h.padding=function(Jt){return arguments.length?(re=Math.min(1,me=+Jt),Pt()):re},h.paddingInner=function(Jt){return arguments.length?(re=Math.min(1,Jt),Pt()):re},h.paddingOuter=function(Jt){return arguments.length?(me=+Jt,Pt()):me},h.align=function(Jt){return arguments.length?(Fe=Math.max(0,Math.min(1,Jt)),Pt()):Fe},h.copy=function(){return Go(S(),x).round(U).paddingInner(re).paddingOuter(me).align(Fe)},Ar.apply(Pt(),arguments)}function Tu(h){var S=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return Tu(S())},h}function _l(){return Tu(Go.apply(null,arguments).paddingInner(1))}var Hs=i("FmoU");function fs(h,S,_,x,C){var M=h*h,U=M*h;return((1-3*h+3*M-U)*S+(4-6*M+3*U)*_+(1+3*h+3*M-3*U)*x+U*C)/6}var Ws=function(h){var S=h.length-1;return function(_){var x=_<=0?_=0:_>=1?(_=1,S-1):Math.floor(_*S),C=h[x],M=h[x+1],U=x>0?h[x-1]:2*C-M,re=x<S-1?h[x+2]:2*M-C;return fs((_-x/S)*S,U,C,M,re)}},Zl=function(h){var S=h.length;return function(_){var x=Math.floor(((_%=1)<0?++_:_)*S),C=h[(x+S-1)%S],M=h[x%S],U=h[(x+1)%S],re=h[(x+2)%S];return fs((_-x/S)*S,C,M,U,re)}},_u=function(h){return function(){return h}};function Is(h,S){return function(_){return h+_*S}}function Xl(h,S,_){return h=Math.pow(h,_),S=Math.pow(S,_)-h,_=1/_,function(x){return Math.pow(h+x*S,_)}}function Su(h,S){var _=S-h;return _?Is(h,_>180||_<-180?_-360*Math.round(_/360):_):_u(isNaN(h)?S:h)}function Yl(h){return(h=+h)===1?Au:function(S,_){return _-S?Xl(S,_,h):_u(isNaN(S)?_:S)}}function Au(h,S){var _=S-h;return _?Is(h,_):_u(isNaN(h)?S:h)}var wo=function h(S){var _=Yl(S);function x(C,M){var U=_((C=Object(Hs.b)(C)).r,(M=Object(Hs.b)(M)).r),re=_(C.g,M.g),me=_(C.b,M.b),Fe=Au(C.opacity,M.opacity);return function(Pt){return C.r=U(Pt),C.g=re(Pt),C.b=me(Pt),C.opacity=Fe(Pt),C+""}}return x.gamma=h,x}(1);function zu(h){return function(S){var _=S.length,x=new Array(_),C=new Array(_),M=new Array(_),U,re;for(U=0;U<_;++U)re=Object(Hs.b)(S[U]),x[U]=re.r||0,C[U]=re.g||0,M[U]=re.b||0;return x=h(x),C=h(C),M=h(M),re.opacity=1,function(me){return re.r=x(me),re.g=C(me),re.b=M(me),re+""}}}var Kl=zu(Ws),qc=zu(Zl),Oo=function(h,S){S||(S=[]);var _=h?Math.min(S.length,h.length):0,x=S.slice(),C;return function(M){for(C=0;C<_;++C)x[C]=h[C]*(1-M)+S[C]*M;return x}};function Ds(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var rs=function(h,S){return(Ds(S)?Oo:Zi)(h,S)};function Zi(h,S){var _=S?S.length:0,x=h?Math.min(_,h.length):0,C=new Array(x),M=new Array(_),U;for(U=0;U<x;++U)C[U]=Ys(h[U],S[U]);for(;U<_;++U)M[U]=S[U];return function(re){for(U=0;U<x;++U)M[U]=C[U](re);return M}}var Zs=function(h,S){var _=new Date;return h=+h,S=+S,function(x){return _.setTime(h*(1-x)+S*x),_}},ao=function(h,S){return h=+h,S=+S,function(_){return h*(1-_)+S*_}},Ns=function(h,S){var _={},x={},C;(h===null||typeof h!="object")&&(h={}),(S===null||typeof S!="object")&&(S={});for(C in S)C in h?_[C]=Ys(h[C],S[C]):x[C]=S[C];return function(M){for(C in _)x[C]=_[C](M);return x}},Xs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qu=new RegExp(Xs.source,"g");function gc(h){return function(){return h}}function $l(h){return function(S){return h(S)+""}}var Jl=function(h,S){var _=Xs.lastIndex=qu.lastIndex=0,x,C,M,U=-1,re=[],me=[];for(h=h+"",S=S+"";(x=Xs.exec(h))&&(C=qu.exec(S));)(M=C.index)>_&&(M=S.slice(_,M),re[U]?re[U]+=M:re[++U]=M),(x=x[0])===(C=C[0])?re[U]?re[U]+=C:re[++U]=C:(re[++U]=null,me.push({i:U,x:ao(x,C)})),_=qu.lastIndex;return _<S.length&&(M=S.slice(_),re[U]?re[U]+=M:re[++U]=M),re.length<2?me[0]?$l(me[0].x):gc(S):(S=me.length,function(Fe){for(var Pt=0,Jt;Pt<S;++Pt)re[(Jt=me[Pt]).i]=Jt.x(Fe);return re.join("")})},Ys=function(h,S){var _=typeof S,x;return S==null||_==="boolean"?_u(S):(_==="number"?ao:_==="string"?(x=Object(Hs.a)(S))?(S=x,wo):Jl:S instanceof Hs.a?wo:S instanceof Date?Zs:Ds(S)?Oo:Array.isArray(S)?Zi:typeof S.valueOf!="function"&&typeof S.toString!="function"||isNaN(S)?Ns:ao)(h,S)},Ho=function(h,S){return h=+h,S=+S,function(_){return Math.round(h*(1-_)+S*_)}},ef=function(h){return function(){return h}},Ql=function(h){return+h},ql=[0,1];function _s(h){return h}function ec(h,S){return(S-=h=+h)?function(_){return(_-h)/S}:ef(isNaN(S)?NaN:.5)}function vf(h){var S=h[0],_=h[h.length-1],x;return S>_&&(x=S,S=_,_=x),function(C){return Math.max(S,Math.min(_,C))}}function Pf(h,S,_){var x=h[0],C=h[1],M=S[0],U=S[1];return C<x?(x=ec(C,x),M=_(U,M)):(x=ec(x,C),M=_(M,U)),function(re){return M(x(re))}}function oh(h,S,_){var x=Math.min(h.length,S.length)-1,C=new Array(x),M=new Array(x),U=-1;for(h[x]<h[0]&&(h=h.slice().reverse(),S=S.slice().reverse());++U<x;)C[U]=ec(h[U],h[U+1]),M[U]=_(S[U],S[U+1]);return function(re){var me=ul(h,re,1,x)-1;return M[me](C[me](re))}}function el(h,S){return S.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function gf(){var h=ql,S=ql,_=Ys,x,C,M,U=_s,re,me,Fe;function Pt(){return re=Math.min(h.length,S.length)>2?oh:Pf,me=Fe=null,Jt}function Jt(Ir){return isNaN(Ir=+Ir)?M:(me||(me=re(h.map(x),S,_)))(x(U(Ir)))}return Jt.invert=function(Ir){return U(C((Fe||(Fe=re(S,h.map(x),ao)))(Ir)))},Jt.domain=function(Ir){return arguments.length?(h=ro.call(Ir,Ql),U===_s||(U=vf(h)),Pt()):h.slice()},Jt.range=function(Ir){return arguments.length?(S=Wi.call(Ir),Pt()):S.slice()},Jt.rangeRound=function(Ir){return S=Wi.call(Ir),_=Ho,Pt()},Jt.clamp=function(Ir){return arguments.length?(U=Ir?vf(h):_s,Jt):U!==_s},Jt.interpolate=function(Ir){return arguments.length?(_=Ir,Pt()):_},Jt.unknown=function(Ir){return arguments.length?(M=Ir,Jt):M},function(Ir,Pr){return x=Ir,C=Pr,Pt()}}function tc(h,S){return gf()(h,S)}var tf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rf(h){if(!(S=tf.exec(h)))throw new Error("invalid format: "+h);var S;return new Lf({fill:S[1],align:S[2],sign:S[3],symbol:S[4],zero:S[5],width:S[6],comma:S[7],precision:S[8]&&S[8].slice(1),trim:S[9],type:S[10]})}rf.prototype=Lf.prototype;function Lf(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}Lf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var $f=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Pc(h,S){if((_=(h=S?h.toExponential(S-1):h.toExponential()).indexOf("e"))<0)return null;var _,x=h.slice(0,_);return[x.length>1?x[0]+x.slice(2):x,+h.slice(_+1)]}var Lc=function(h){return h=Pc(Math.abs(h)),h?h[1]:NaN},Rc=function(h,S){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Lc(S)/3)))*3-Lc(Math.abs(h)))},Jf=function(h,S){return function(_,x){for(var C=_.length,M=[],U=0,re=h[0],me=0;C>0&&re>0&&!(me+re+1>x&&(re=Math.max(1,x-me)),M.push(_.substring(C-=re,C+re)),(me+=re+1)>x);)re=h[U=(U+1)%h.length];return M.reverse().join(S)}},Rf=function(h){return function(S){return S.replace(/[0-9]/g,function(_){return h[+_]})}},Qf=function(h){e:for(var S=h.length,_=1,x=-1,C;_<S;++_)switch(h[_]){case".":x=C=_;break;case"0":x===0&&(x=_),C=_;break;default:if(!+h[_])break e;x>0&&(x=0);break}return x>0?h.slice(0,x)+h.slice(C+1):h},Ic,sh=function(h,S){var _=Pc(h,S);if(!_)return h+"";var x=_[0],C=_[1],M=C-(Ic=Math.max(-8,Math.min(8,Math.floor(C/3)))*3)+1,U=x.length;return M===U?x:M>U?x+new Array(M-U+1).join("0"):M>0?x.slice(0,M)+"."+x.slice(M):"0."+new Array(1-M).join("0")+Pc(h,Math.max(0,S+M-1))[0]},yo=function(h,S){var _=Pc(h,S);if(!_)return h+"";var x=_[0],C=_[1];return C<0?"0."+new Array(-C).join("0")+x:x.length>C+1?x.slice(0,C+1)+"."+x.slice(C+1):x+new Array(C-x.length+2).join("0")},rc={"%":function(S,_){return(S*100).toFixed(_)},b:function(S){return Math.round(S).toString(2)},c:function(S){return S+""},d:$f,e:function(S,_){return S.toExponential(_)},f:function(S,_){return S.toFixed(_)},g:function(S,_){return S.toPrecision(_)},o:function(S){return Math.round(S).toString(8)},p:function(S,_){return yo(S*100,_)},r:yo,s:sh,X:function(S){return Math.round(S).toString(16).toUpperCase()},x:function(S){return Math.round(S).toString(16)}},yf=function(h){return h},nc=Array.prototype.map,nf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Dc=function(h){var S=h.grouping===void 0||h.thousands===void 0?yf:Jf(nc.call(h.grouping,Number),h.thousands+""),_=h.currency===void 0?"":h.currency[0]+"",x=h.currency===void 0?"":h.currency[1]+"",C=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?yf:Rf(nc.call(h.numerals,String)),U=h.percent===void 0?"%":h.percent+"",re=h.minus===void 0?"-":h.minus+"",me=h.nan===void 0?"NaN":h.nan+"";function Fe(Jt){Jt=rf(Jt);var Ir=Jt.fill,Pr=Jt.align,gn=Jt.sign,Pn=Jt.symbol,Rn=Jt.zero,Oa=Jt.width,qa=Jt.comma,ci=Jt.precision,ri=Jt.trim,fi=Jt.type;fi==="n"?(qa=!0,fi="g"):rc[fi]||(ci===void 0&&(ci=12),ri=!0,fi="g"),(Rn||Ir==="0"&&Pr==="=")&&(Rn=!0,Ir="0",Pr="=");var ho=Pn==="$"?_:Pn==="#"&&/[boxX]/.test(fi)?"0"+fi.toLowerCase():"",La=Pn==="$"?x:/[%p]/.test(fi)?U:"",zo=rc[fi],ns=/[defgprs%]/.test(fi);ci=ci===void 0?6:/[gprs]/.test(fi)?Math.max(1,Math.min(21,ci)):Math.max(0,Math.min(20,ci));function qs(ei){var gs=ho,Xo=La,dl,Kh,ph;if(fi==="c")Xo=zo(ei)+Xo,ei="";else{ei=+ei;var mh=ei<0||1/ei<0;if(ei=isNaN(ei)?me:zo(Math.abs(ei),ci),ri&&(ei=Qf(ei)),mh&&+ei===0&&gn!=="+"&&(mh=!1),gs=(mh?gn==="("?gn:re:gn==="-"||gn==="("?"":gn)+gs,Xo=(fi==="s"?nf[8+Ic/3]:"")+Xo+(mh&&gn==="("?")":""),ns){for(dl=-1,Kh=ei.length;++dl<Kh;)if(ph=ei.charCodeAt(dl),48>ph||ph>57){Xo=(ph===46?C+ei.slice(dl+1):ei.slice(dl))+Xo,ei=ei.slice(0,dl);break}}}qa&&!Rn&&(ei=S(ei,Infinity));var Ah=gs.length+ei.length+Xo.length,af=Ah<Oa?new Array(Oa-Ah+1).join(Ir):"";qa&&Rn&&(ei=S(af+ei,af.length?Oa-Xo.length:Infinity),af="");switch(Pr){case"<":ei=gs+ei+Xo+af;break;case"=":ei=gs+af+ei+Xo;break;case"^":ei=af.slice(0,Ah=af.length>>1)+gs+ei+Xo+af.slice(Ah);break;default:ei=af+gs+ei+Xo;break}return M(ei)}return qs.toString=function(){return Jt+""},qs}function Pt(Jt,Ir){var Pr=Fe((Jt=rf(Jt),Jt.type="f",Jt)),gn=Math.max(-8,Math.min(8,Math.floor(Lc(Ir)/3)))*3,Pn=Math.pow(10,-gn),Rn=nf[8+gn/3];return function(Oa){return Pr(Pn*Oa)+Rn}}return{format:Fe,formatPrefix:Pt}},Fu,Nc,kc;bf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function bf(h){return Fu=Dc(h),Nc=Fu.format,kc=Fu.formatPrefix,Fu}var xf=function(h,S){return h=Math.abs(h),S=Math.abs(S)-h,Math.max(0,Lc(S)-Lc(h))+1},Gf=function(h){return Math.max(0,-Lc(Math.abs(h)))},yc=function(h,S,_,x){var C=y(h,S,_),M;x=rf(x==null?",f":x);switch(x.type){case"s":{var U=Math.max(Math.abs(h),Math.abs(S));return x.precision==null&&!isNaN(M=Rc(C,U))&&(x.precision=M),kc(x,U)}case"":case"e":case"g":case"p":case"r":{x.precision==null&&!isNaN(M=xf(C,Math.max(Math.abs(h),Math.abs(S))))&&(x.precision=M-(x.type==="e"));break}case"f":case"%":{x.precision==null&&!isNaN(M=Gf(C))&&(x.precision=M-(x.type==="%")*2);break}}return Nc(x)};function Sl(h){var S=h.domain;return h.ticks=function(_){var x=S();return n(x[0],x[x.length-1],_==null?10:_)},h.tickFormat=function(_,x){var C=S();return yc(C[0],C[C.length-1],_==null?10:_,x)},h.nice=function(_){_==null&&(_=10);var x=S(),C=0,M=x.length-1,U=x[C],re=x[M],me;return re<U&&(me=U,U=re,re=me,me=C,C=M,M=me),me=l(U,re,_),me>0?(U=Math.floor(U/me)*me,re=Math.ceil(re/me)*me,me=l(U,re,_)):me<0&&(U=Math.ceil(U*me)/me,re=Math.floor(re*me)/me,me=l(U,re,_)),me>0?(x[C]=Math.floor(U/me)*me,x[M]=Math.ceil(re/me)*me,S(x)):me<0&&(x[C]=Math.ceil(U*me)/me,x[M]=Math.floor(re*me)/me,S(x)),h},h}function ee(){var h=tc(_s,_s);return h.copy=function(){return el(h,ee())},Ar.apply(h,arguments),Sl(h)}function ae(h){var S;function _(x){return isNaN(x=+x)?S:x}return _.invert=_,_.domain=_.range=function(x){return arguments.length?(h=ro.call(x,Ql),_):h.slice()},_.unknown=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return ae(h).unknown(S)},h=arguments.length?ro.call(h,Ql):[0,1],Sl(_)}var N=function(h,S){h=h.slice();var _=0,x=h.length-1,C=h[_],M=h[x],U;return M<C&&(U=_,_=x,x=U,U=C,C=M,M=U),h[_]=S.floor(C),h[x]=S.ceil(M),h};function V(h){return Math.log(h)}function Te(h){return Math.exp(h)}function it(h){return-Math.log(-h)}function Zt(h){return-Math.exp(-h)}function ar(h){return isFinite(h)?+("1e"+h):h<0?0:h}function nr(h){return h===10?ar:h===Math.E?Math.exp:function(S){return Math.pow(h,S)}}function Dr(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(S){return Math.log(S)/h})}function on(h){return function(S){return-h(-S)}}function Gn(h){var S=h(V,Te),_=S.domain,x=10,C,M;function U(){return C=Dr(x),M=nr(x),_()[0]<0?(C=on(C),M=on(M),h(it,Zt)):h(V,Te),S}return S.base=function(re){return arguments.length?(x=+re,U()):x},S.domain=function(re){return arguments.length?(_(re),U()):_()},S.ticks=function(re){var me=_(),Fe=me[0],Pt=me[me.length-1],Jt;(Jt=Pt<Fe)&&(Ir=Fe,Fe=Pt,Pt=Ir);var Ir=C(Fe),Pr=C(Pt),gn,Pn,Rn,Oa=re==null?10:+re,qa=[];if(!(x%1)&&Pr-Ir<Oa)if(Ir=Math.round(Ir)-1,Pr=Math.round(Pr)+1,Fe>0)for(;Ir<Pr;++Ir)for(Pn=1,gn=M(Ir);Pn<x;++Pn){if(Rn=gn*Pn,Rn<Fe)continue;if(Rn>Pt)break;qa.push(Rn)}else for(;Ir<Pr;++Ir)for(Pn=x-1,gn=M(Ir);Pn>=1;--Pn){if(Rn=gn*Pn,Rn<Fe)continue;if(Rn>Pt)break;qa.push(Rn)}else qa=n(Ir,Pr,Math.min(Pr-Ir,Oa)).map(M);return Jt?qa.reverse():qa},S.tickFormat=function(re,me){if(me==null&&(me=x===10?".0e":","),typeof me!="function"&&(me=Nc(me)),re===Infinity)return me;re==null&&(re=10);var Fe=Math.max(1,x*re/S.ticks().length);return function(Pt){var Jt=Pt/M(Math.round(C(Pt)));return Jt*x<x-.5&&(Jt*=x),Jt<=Fe?me(Pt):""}},S.nice=function(){return _(N(_(),{floor:function(me){return M(Math.floor(C(me)))},ceil:function(me){return M(Math.ceil(C(me)))}}))},S}function na(){var h=Gn(gf()).domain([1,10]);return h.copy=function(){return el(h,na()).base(h.base())},Ar.apply(h,arguments),h}function aa(h){return function(S){return Math.sign(S)*Math.log1p(Math.abs(S/h))}}function si(h){return function(S){return Math.sign(S)*Math.expm1(Math.abs(S))*h}}function Ya(h){var S=1,_=h(aa(S),si(S));return _.constant=function(x){return arguments.length?h(aa(S=+x),si(S)):S},Sl(_)}function Ri(){var h=Ya(gf());return h.copy=function(){return el(h,Ri()).constant(h.constant())},Ar.apply(h,arguments)}function Ha(h){return function(S){return S<0?-Math.pow(-S,h):Math.pow(S,h)}}function qi(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function hs(h){return h<0?-h*h:h*h}function Xi(h){var S=h(_s,_s),_=1;function x(){return _===1?h(_s,_s):_===.5?h(qi,hs):h(Ha(_),Ha(1/_))}return S.exponent=function(C){return arguments.length?(_=+C,x()):_},Sl(S)}function pi(){var h=Xi(gf());return h.copy=function(){return el(h,pi()).exponent(h.exponent())},Ar.apply(h,arguments),h}function ks(){return pi.apply(null,arguments).exponent(.5)}function Yi(){var h=[],S=[],_=[],x;function C(){var U=0,re=Math.max(1,S.length);for(_=new Array(re-1);++U<re;)_[U-1]=k(h,U/re);return M}function M(U){return isNaN(U=+U)?x:S[ul(_,U)]}return M.invertExtent=function(U){var re=S.indexOf(U);return re<0?[NaN,NaN]:[re>0?_[re-1]:h[0],re<_.length?_[re]:h[h.length-1]]},M.domain=function(U){if(!arguments.length)return h.slice();h=[];for(var re=0,me=U.length,Fe;re<me;++re)(Fe=U[re],Fe!=null&&!isNaN(Fe=+Fe))&&h.push(Fe);return h.sort(Eu),C()},M.range=function(U){return arguments.length?(S=Wi.call(U),C()):S.slice()},M.unknown=function(U){return arguments.length?(x=U,M):x},M.quantiles=function(){return _.slice()},M.copy=function(){return Yi().domain(h).range(S).unknown(x)},Ar.apply(M,arguments)}function bo(){var h=0,S=1,_=1,x=[.5],C=[0,1],M;function U(me){return me<=me?C[ul(x,me,0,_)]:M}function re(){var me=-1;for(x=new Array(_);++me<_;)x[me]=((me+1)*S-(me-_)*h)/(_+1);return U}return U.domain=function(me){return arguments.length?(h=+me[0],S=+me[1],re()):[h,S]},U.range=function(me){return arguments.length?(_=(C=Wi.call(me)).length-1,re()):C.slice()},U.invertExtent=function(me){var Fe=C.indexOf(me);return Fe<0?[NaN,NaN]:Fe<1?[h,x[0]]:Fe>=_?[x[_-1],S]:[x[Fe-1],x[Fe]]},U.unknown=function(me){return arguments.length&&(M=me),U},U.thresholds=function(){return x.slice()},U.copy=function(){return bo().domain([h,S]).range(C).unknown(M)},Ar.apply(Sl(U),arguments)}function ds(){var h=[.5],S=[0,1],_,x=1;function C(M){return M<=M?S[ul(h,M,0,x)]:_}return C.domain=function(M){return arguments.length?(h=Wi.call(M),x=Math.min(h.length,S.length-1),C):h.slice()},C.range=function(M){return arguments.length?(S=Wi.call(M),x=Math.min(h.length,S.length-1),C):S.slice()},C.invertExtent=function(M){var U=S.indexOf(M);return[h[U-1],h[U]]},C.unknown=function(M){return arguments.length?(_=M,C):_},C.copy=function(){return ds().domain(h).range(S).unknown(_)},Ar.apply(C,arguments)}var Ai=new Date,xo=new Date;function Aa(h,S,_,x){function C(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return C.floor=function(M){return h(M=new Date(+M)),M},C.ceil=function(M){return h(M=new Date(M-1)),S(M,1),h(M),M},C.round=function(M){var U=C(M),re=C.ceil(M);return M-U<re-M?U:re},C.offset=function(M,U){return S(M=new Date(+M),U==null?1:Math.floor(U)),M},C.range=function(M,U,re){var me=[],Fe;if(M=C.ceil(M),re=re==null?1:Math.floor(re),!(M<U)||!(re>0))return me;do me.push(Fe=new Date(+M)),S(M,re),h(M);while(Fe<M&&M<U);return me},C.filter=function(M){return Aa(function(U){if(U>=U)for(;h(U),!M(U);)U.setTime(U-1)},function(U,re){if(U>=U)if(re<0)for(;++re<=0;)for(;S(U,-1),!M(U););else for(;--re>=0;)for(;S(U,1),!M(U););})},_&&(C.count=function(M,U){return Ai.setTime(+M),xo.setTime(+U),h(Ai),h(xo),Math.floor(_(Ai,xo))},C.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?C.filter(x?function(U){return x(U)%M===0}:function(U){return C.count(0,U)%M===0}):C}),C}var ko=Aa(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,S){h.setFullYear(h.getFullYear()+S)},function(h,S){return S.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});ko.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Aa(function(S){S.setFullYear(Math.floor(S.getFullYear()/h)*h),S.setMonth(0,1),S.setHours(0,0,0,0)},function(S,_){S.setFullYear(S.getFullYear()+_*h)})};var bc=ko,Hf=ko.range,Ks=Aa(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,S){h.setMonth(h.getMonth()+S)},function(h,S){return S.getMonth()-h.getMonth()+(S.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),uh=Ks,Vh=Ks.range,Wf=1e3,If=6e4,qf=36e5,Ch=864e5,wh=6048e5;function Df(h){return Aa(function(S){S.setDate(S.getDate()-(S.getDay()+7-h)%7),S.setHours(0,0,0,0)},function(S,_){S.setDate(S.getDate()+_*7)},function(S,_){return(_-S-(_.getTimezoneOffset()-S.getTimezoneOffset())*If)/wh})}var eh=Df(0),th=Df(1),Oh=Df(2),rh=Df(3),Nf=Df(4),vh=Df(5),lh=Df(6),fe=eh.range,ke=th.range,Nt=Oh.range,vr=rh.range,Ur=Nf.range,Rr=vh.range,Er=lh.range,Yr=Aa(function(h){h.setHours(0,0,0,0)},function(h,S){h.setDate(h.getDate()+S)},function(h,S){return(S-h-(S.getTimezoneOffset()-h.getTimezoneOffset())*If)/Ch},function(h){return h.getDate()-1}),qr=Yr,sn=Yr.range,an=Aa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Wf-h.getMinutes()*If)},function(h,S){h.setTime(+h+S*qf)},function(h,S){return(S-h)/qf},function(h){return h.getHours()}),cn=an,An=an.range,pn=Aa(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Wf)},function(h,S){h.setTime(+h+S*If)},function(h,S){return(S-h)/If},function(h){return h.getMinutes()}),un=pn,Tr=pn.range,xr=Aa(function(h){h.setTime(h-h.getMilliseconds())},function(h,S){h.setTime(+h+S*Wf)},function(h,S){return(S-h)/Wf},function(h){return h.getUTCSeconds()}),tn=xr,Ln=xr.range,kr=Aa(function(){},function(h,S){h.setTime(+h+S)},function(h,S){return S-h});kr.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?Aa(function(S){S.setTime(Math.floor(S/h)*h)},function(S,_){S.setTime(+S+_*h)},function(S,_){return(_-S)/h}):kr};var Yn=kr,$r=kr.range;function Br(h){return Aa(function(S){S.setUTCDate(S.getUTCDate()-(S.getUTCDay()+7-h)%7),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCDate(S.getUTCDate()+_*7)},function(S,_){return(_-S)/wh})}var Gr=Br(0),Xr=Br(1),Hn=Br(2),qn=Br(3),fn=Br(4),rn=Br(5),zr=Br(6),Ea=Gr.range,Wa=Xr.range,Un=Hn.range,Fa=qn.range,Pa=fn.range,Na=rn.range,Ci=zr.range,Wo=Aa(function(h){h.setUTCHours(0,0,0,0)},function(h,S){h.setUTCDate(h.getUTCDate()+S)},function(h,S){return(S-h)/Ch},function(h){return h.getUTCDate()-1}),Mo=Wo,ti=Wo.range,jo=Aa(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,S){h.setUTCFullYear(h.getUTCFullYear()+S)},function(h,S){return S.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});jo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Aa(function(S){S.setUTCFullYear(Math.floor(S.getUTCFullYear()/h)*h),S.setUTCMonth(0,1),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCFullYear(S.getUTCFullYear()+_*h)})};var Bi=jo,Ss=jo.range;function Ko(h){if(0<=h.y&&h.y<100){var S=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return S.setFullYear(h.y),S}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function $o(h){if(0<=h.y&&h.y<100){var S=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return S.setUTCFullYear(h.y),S}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function Po(h,S,_){return{y:h,m:S,d:_,H:0,M:0,S:0,L:0}}function su(h){var S=h.dateTime,_=h.date,x=h.time,C=h.periods,M=h.days,U=h.shortDays,re=h.months,me=h.shortMonths,Fe=Qa(C),Pt=Lo(C),Jt=Qa(M),Ir=Lo(M),Pr=Qa(U),gn=Lo(U),Pn=Qa(re),Rn=Lo(re),Oa=Qa(me),qa=Lo(me),ci={a:mh,A:Ah,b:af,B:hd,c:null,d:se,e:se,f:Kt,g:ii,G:io,H:oe,I:le,j:Tt,L:Xt,m:tr,M:Cr,p:dd,q:ld,Q:$s,s:ah,S:Fr,u:ln,U:hn,V:sa,w:fa,W:ja,x:null,X:null,y:_a,Y:Ka,Z:Ca,"%":ch},ri={a:pd,A:$h,b:md,B:nd,c:null,d:Ba,e:Ba,f:nh,g:zf,G:Gh,H:ac,I:ic,j:lu,L:Cl,m:jc,M:wl,p:yd,q:vd,Q:$s,s:ah,S:js,u:kf,U:oo,V:Uu,w:jf,W:lo,x:null,X:null,y:fl,Y:zc,Z:xc,"%":ch},fi={a:qs,A:ei,b:gs,B:Xo,c:dl,d:lr,e:lr,f:d,g:Ra,G:On,H:$t,I:$t,j:fr,L:c,m:Ht,M:b,p:ns,q:Qe,Q:L,s:j,S:p,u:Al,U:Ot,V:_r,w:Cu,W:br,x:Kh,X:ph,y:Ra,Y:On,Z:vt,"%":v};ci.x=ho(_,ci),ci.X=ho(x,ci),ci.c=ho(S,ci),ri.x=ho(_,ri),ri.X=ho(x,ri),ri.c=ho(S,ri);function ho(Va,eo){return function(hi){var Dn=[],Bc=-1,ys=0,of=Va.length,sf,oc,Jh;for(hi instanceof Date||(hi=new Date(+hi));++Bc<of;)Va.charCodeAt(Bc)===37&&(Dn.push(Va.slice(ys,Bc)),(oc=Jo[sf=Va.charAt(++Bc)])!=null?sf=Va.charAt(++Bc):oc=sf==="e"?" ":"0",(Jh=eo[sf])&&(sf=Jh(hi,oc)),Dn.push(sf),ys=Bc+1);return Dn.push(Va.slice(ys,Bc)),Dn.join("")}}function La(Va,eo){return function(hi){var Dn=Po(1900,void 0,1),Bc=zo(Dn,Va,hi+="",0),ys,of;if(Bc!=hi.length)return null;if("Q"in Dn)return new Date(Dn.Q);if("s"in Dn)return new Date(Dn.s*1e3+("L"in Dn?Dn.L:0));if(eo&&!("Z"in Dn)&&(Dn.Z=0),"p"in Dn&&(Dn.H=Dn.H%12+Dn.p*12),Dn.m===void 0&&(Dn.m="q"in Dn?Dn.q:0),"V"in Dn){if(Dn.V<1||Dn.V>53)return null;"w"in Dn||(Dn.w=1),"Z"in Dn?(ys=$o(Po(Dn.y,0,1)),of=ys.getUTCDay(),ys=of>4||of===0?Xr.ceil(ys):Xr(ys),ys=Mo.offset(ys,(Dn.V-1)*7),Dn.y=ys.getUTCFullYear(),Dn.m=ys.getUTCMonth(),Dn.d=ys.getUTCDate()+(Dn.w+6)%7):(ys=Ko(Po(Dn.y,0,1)),of=ys.getDay(),ys=of>4||of===0?th.ceil(ys):th(ys),ys=qr.offset(ys,(Dn.V-1)*7),Dn.y=ys.getFullYear(),Dn.m=ys.getMonth(),Dn.d=ys.getDate()+(Dn.w+6)%7)}else("W"in Dn||"U"in Dn)&&("w"in Dn||(Dn.w="u"in Dn?Dn.u%7:"W"in Dn?1:0),of="Z"in Dn?$o(Po(Dn.y,0,1)).getUTCDay():Ko(Po(Dn.y,0,1)).getDay(),Dn.m=0,Dn.d="W"in Dn?(Dn.w+6)%7+Dn.W*7-(of+5)%7:Dn.w+Dn.U*7-(of+6)%7);return"Z"in Dn?(Dn.H+=Dn.Z/100|0,Dn.M+=Dn.Z%100,$o(Dn)):Ko(Dn)}}function zo(Va,eo,hi,Dn){for(var Bc=0,ys=eo.length,of=hi.length,sf,oc;Bc<ys;){if(Dn>=of)return-1;if(sf=eo.charCodeAt(Bc++),sf===37){if(sf=eo.charAt(Bc++),oc=fi[sf in Jo?eo.charAt(Bc++):sf],!oc||(Dn=oc(Va,hi,Dn))<0)return-1}else if(sf!=hi.charCodeAt(Dn++))return-1}return Dn}function ns(Va,eo,hi){var Dn=Fe.exec(eo.slice(hi));return Dn?(Va.p=Pt[Dn[0].toLowerCase()],hi+Dn[0].length):-1}function qs(Va,eo,hi){var Dn=Pr.exec(eo.slice(hi));return Dn?(Va.w=gn[Dn[0].toLowerCase()],hi+Dn[0].length):-1}function ei(Va,eo,hi){var Dn=Jt.exec(eo.slice(hi));return Dn?(Va.w=Ir[Dn[0].toLowerCase()],hi+Dn[0].length):-1}function gs(Va,eo,hi){var Dn=Oa.exec(eo.slice(hi));return Dn?(Va.m=qa[Dn[0].toLowerCase()],hi+Dn[0].length):-1}function Xo(Va,eo,hi){var Dn=Pn.exec(eo.slice(hi));return Dn?(Va.m=Rn[Dn[0].toLowerCase()],hi+Dn[0].length):-1}function dl(Va,eo,hi){return zo(Va,S,eo,hi)}function Kh(Va,eo,hi){return zo(Va,_,eo,hi)}function ph(Va,eo,hi){return zo(Va,x,eo,hi)}function mh(Va){return U[Va.getDay()]}function Ah(Va){return M[Va.getDay()]}function af(Va){return me[Va.getMonth()]}function hd(Va){return re[Va.getMonth()]}function dd(Va){return C[+(Va.getHours()>=12)]}function ld(Va){return 1+~~(Va.getMonth()/3)}function pd(Va){return U[Va.getUTCDay()]}function $h(Va){return M[Va.getUTCDay()]}function md(Va){return me[Va.getUTCMonth()]}function nd(Va){return re[Va.getUTCMonth()]}function yd(Va){return C[+(Va.getUTCHours()>=12)]}function vd(Va){return 1+~~(Va.getUTCMonth()/3)}return{format:function(eo){var hi=ho(eo+="",ci);return hi.toString=function(){return eo},hi},parse:function(eo){var hi=La(eo+="",!1);return hi.toString=function(){return eo},hi},utcFormat:function(eo){var hi=ho(eo+="",ri);return hi.toString=function(){return eo},hi},utcParse:function(eo){var hi=La(eo+="",!0);return hi.toString=function(){return eo},hi}}}var Jo={"-":"",_:" ","0":"0"},ia=/^\s*\d+/,uu=/^%/,wi=/[\\^$*+?|[\]().{}]/g;function Cn(h,S,_){var x=h<0?"-":"",C=(x?-h:h)+"",M=C.length;return x+(M<_?new Array(_-M+1).join(S)+C:C)}function ka(h){return h.replace(wi,"\\$&")}function Qa(h){return new RegExp("^(?:"+h.map(ka).join("|")+")","i")}function Lo(h){for(var S={},_=-1,x=h.length;++_<x;)S[h[_].toLowerCase()]=_;return S}function Cu(h,S,_){var x=ia.exec(S.slice(_,_+1));return x?(h.w=+x[0],_+x[0].length):-1}function Al(h,S,_){var x=ia.exec(S.slice(_,_+1));return x?(h.u=+x[0],_+x[0].length):-1}function Ot(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.U=+x[0],_+x[0].length):-1}function _r(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.V=+x[0],_+x[0].length):-1}function br(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.W=+x[0],_+x[0].length):-1}function On(h,S,_){var x=ia.exec(S.slice(_,_+4));return x?(h.y=+x[0],_+x[0].length):-1}function Ra(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.y=+x[0]+(+x[0]>68?1900:2e3),_+x[0].length):-1}function vt(h,S,_){var x=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(S.slice(_,_+6));return x?(h.Z=x[1]?0:-(x[2]+(x[3]||"00")),_+x[0].length):-1}function Qe(h,S,_){var x=ia.exec(S.slice(_,_+1));return x?(h.q=x[0]*3-3,_+x[0].length):-1}function Ht(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.m=x[0]-1,_+x[0].length):-1}function lr(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.d=+x[0],_+x[0].length):-1}function fr(h,S,_){var x=ia.exec(S.slice(_,_+3));return x?(h.m=0,h.d=+x[0],_+x[0].length):-1}function $t(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.H=+x[0],_+x[0].length):-1}function b(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.M=+x[0],_+x[0].length):-1}function p(h,S,_){var x=ia.exec(S.slice(_,_+2));return x?(h.S=+x[0],_+x[0].length):-1}function c(h,S,_){var x=ia.exec(S.slice(_,_+3));return x?(h.L=+x[0],_+x[0].length):-1}function d(h,S,_){var x=ia.exec(S.slice(_,_+6));return x?(h.L=Math.floor(x[0]/1e3),_+x[0].length):-1}function v(h,S,_){var x=uu.exec(S.slice(_,_+1));return x?_+x[0].length:-1}function L(h,S,_){var x=ia.exec(S.slice(_));return x?(h.Q=+x[0],_+x[0].length):-1}function j(h,S,_){var x=ia.exec(S.slice(_));return x?(h.s=+x[0],_+x[0].length):-1}function se(h,S){return Cn(h.getDate(),S,2)}function oe(h,S){return Cn(h.getHours(),S,2)}function le(h,S){return Cn(h.getHours()%12||12,S,2)}function Tt(h,S){return Cn(1+qr.count(bc(h),h),S,3)}function Xt(h,S){return Cn(h.getMilliseconds(),S,3)}function Kt(h,S){return Xt(h,S)+"000"}function tr(h,S){return Cn(h.getMonth()+1,S,2)}function Cr(h,S){return Cn(h.getMinutes(),S,2)}function Fr(h,S){return Cn(h.getSeconds(),S,2)}function ln(h){var S=h.getDay();return S===0?7:S}function hn(h,S){return Cn(eh.count(bc(h)-1,h),S,2)}function $n(h){var S=h.getDay();return S>=4||S===0?Nf(h):Nf.ceil(h)}function sa(h,S){return h=$n(h),Cn(Nf.count(bc(h),h)+(bc(h).getDay()===4),S,2)}function fa(h){return h.getDay()}function ja(h,S){return Cn(th.count(bc(h)-1,h),S,2)}function _a(h,S){return Cn(h.getFullYear()%100,S,2)}function ii(h,S){return h=$n(h),Cn(h.getFullYear()%100,S,2)}function Ka(h,S){return Cn(h.getFullYear()%1e4,S,4)}function io(h,S){var _=h.getDay();return h=_>=4||_===0?Nf(h):Nf.ceil(h),Cn(h.getFullYear()%1e4,S,4)}function Ca(h){var S=h.getTimezoneOffset();return(S>0?"-":(S*=-1,"+"))+Cn(S/60|0,"0",2)+Cn(S%60,"0",2)}function Ba(h,S){return Cn(h.getUTCDate(),S,2)}function ac(h,S){return Cn(h.getUTCHours(),S,2)}function ic(h,S){return Cn(h.getUTCHours()%12||12,S,2)}function lu(h,S){return Cn(1+Mo.count(Bi(h),h),S,3)}function Cl(h,S){return Cn(h.getUTCMilliseconds(),S,3)}function nh(h,S){return Cl(h,S)+"000"}function jc(h,S){return Cn(h.getUTCMonth()+1,S,2)}function wl(h,S){return Cn(h.getUTCMinutes(),S,2)}function js(h,S){return Cn(h.getUTCSeconds(),S,2)}function kf(h){var S=h.getUTCDay();return S===0?7:S}function oo(h,S){return Cn(Gr.count(Bi(h)-1,h),S,2)}function wu(h){var S=h.getUTCDay();return S>=4||S===0?fn(h):fn.ceil(h)}function Uu(h,S){return h=wu(h),Cn(fn.count(Bi(h),h)+(Bi(h).getUTCDay()===4),S,2)}function jf(h){return h.getUTCDay()}function lo(h,S){return Cn(Xr.count(Bi(h)-1,h),S,2)}function fl(h,S){return Cn(h.getUTCFullYear()%100,S,2)}function zf(h,S){return h=wu(h),Cn(h.getUTCFullYear()%100,S,2)}function zc(h,S){return Cn(h.getUTCFullYear()%1e4,S,4)}function Gh(h,S){var _=h.getUTCDay();return h=_>=4||_===0?fn(h):fn.ceil(h),Cn(h.getUTCFullYear()%1e4,S,4)}function xc(){return"+0000"}function ch(){return"%"}function $s(h){return+h}function ah(h){return Math.floor(+h/1e3)}var gh,e,t,r,u;f({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function f(h){return gh=su(h),e=gh.format,t=gh.parse,r=gh.utcFormat,u=gh.utcParse,gh}var g=1e3,A=g*60,P=A*60,B=P*24,Q=B*7,de=B*30,_e=B*365;function Oe(h){return new Date(h)}function nt(h){return h instanceof Date?+h:+new Date(+h)}function St(h,S,_,x,C,M,U,re,me){var Fe=tc(_s,_s),Pt=Fe.invert,Jt=Fe.domain,Ir=me(".%L"),Pr=me(":%S"),gn=me("%I:%M"),Pn=me("%I %p"),Rn=me("%a %d"),Oa=me("%b %d"),qa=me("%B"),ci=me("%Y"),ri=[[U,1,g],[U,5,5*g],[U,15,15*g],[U,30,30*g],[M,1,A],[M,5,5*A],[M,15,15*A],[M,30,30*A],[C,1,P],[C,3,3*P],[C,6,6*P],[C,12,12*P],[x,1,B],[x,2,2*B],[_,1,Q],[S,1,de],[S,3,3*de],[h,1,_e]];function fi(La){return(U(La)<La?Ir:M(La)<La?Pr:C(La)<La?gn:x(La)<La?Pn:S(La)<La?_(La)<La?Rn:Oa:h(La)<La?qa:ci)(La)}function ho(La,zo,ns,qs){if(La==null&&(La=10),typeof La=="number"){var ei=Math.abs(ns-zo)/La,gs=Vl(function(Xo){return Xo[2]}).right(ri,ei);gs===ri.length?(qs=y(zo/_e,ns/_e,La),La=h):gs?(gs=ri[ei/ri[gs-1][2]<ri[gs][2]/ei?gs-1:gs],qs=gs[1],La=gs[0]):(qs=Math.max(y(zo,ns,La),1),La=re)}return qs==null?La:La.every(qs)}return Fe.invert=function(La){return new Date(Pt(La))},Fe.domain=function(La){return arguments.length?Jt(ro.call(La,nt)):Jt().map(Oe)},Fe.ticks=function(La,zo){var ns=Jt(),qs=ns[0],ei=ns[ns.length-1],gs=ei<qs,Xo;return gs&&(Xo=qs,qs=ei,ei=Xo),Xo=ho(La,qs,ei,zo),Xo=Xo?Xo.range(qs,ei+1):[],gs?Xo.reverse():Xo},Fe.tickFormat=function(La,zo){return zo==null?fi:me(zo)},Fe.nice=function(La,zo){var ns=Jt();return(La=ho(La,ns[0],ns[ns.length-1],zo))?Jt(N(ns,La)):Fe},Fe.copy=function(){return el(Fe,St(h,S,_,x,C,M,U,re,me))},Fe}var bt=function(){return Ar.apply(St(bc,uh,eh,qr,cn,un,tn,Yn,e).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Vt=Aa(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,S){h.setUTCMonth(h.getUTCMonth()+S)},function(h,S){return S.getUTCMonth()-h.getUTCMonth()+(S.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),Ut=Vt,or=Vt.range,pr=Aa(function(h){h.setUTCMinutes(0,0,0)},function(h,S){h.setTime(+h+S*qf)},function(h,S){return(S-h)/qf},function(h){return h.getUTCHours()}),Sr=pr,Vr=pr.range,Nr=Aa(function(h){h.setUTCSeconds(0,0)},function(h,S){h.setTime(+h+S*If)},function(h,S){return(S-h)/If},function(h){return h.getUTCMinutes()}),mn=Nr,En=Nr.range,Bn=function(){return Ar.apply(St(Bi,Ut,Gr,Mo,Sr,mn,tn,Yn,r).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function ea(){var h=0,S=1,_,x,C,M,U=_s,re=!1,me;function Fe(Pt){return isNaN(Pt=+Pt)?me:U(C===0?.5:(Pt=(M(Pt)-_)*C,re?Math.max(0,Math.min(1,Pt)):Pt))}return Fe.domain=function(Pt){return arguments.length?(_=M(h=+Pt[0]),x=M(S=+Pt[1]),C=_===x?0:1/(x-_),Fe):[h,S]},Fe.clamp=function(Pt){return arguments.length?(re=!!Pt,Fe):re},Fe.interpolator=function(Pt){return arguments.length?(U=Pt,Fe):U},Fe.unknown=function(Pt){return arguments.length?(me=Pt,Fe):me},function(Pt){return M=Pt,_=Pt(h),x=Pt(S),C=_===x?0:1/(x-_),Fe}}function kn(h,S){return S.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Nn(){var h=Sl(ea()(_s));return h.copy=function(){return kn(h,Nn())},Or.apply(h,arguments)}function wa(){var h=Gn(ea()).domain([1,10]);return h.copy=function(){return kn(h,wa()).base(h.base())},Or.apply(h,arguments)}function ua(){var h=Ya(ea());return h.copy=function(){return kn(h,ua()).constant(h.constant())},Or.apply(h,arguments)}function Jn(){var h=Xi(ea());return h.copy=function(){return kn(h,Jn()).exponent(h.exponent())},Or.apply(h,arguments)}function mi(){return Jn.apply(null,arguments).exponent(.5)}function za(){var h=[],S=_s;function _(x){if(!isNaN(x=+x))return S((ul(h,x)-1)/(h.length-1))}return _.domain=function(x){if(!arguments.length)return h.slice();h=[];for(var C=0,M=x.length,U;C<M;++C)(U=x[C],U!=null&&!isNaN(U=+U))&&h.push(U);return h.sort(Eu),_},_.interpolator=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return za(S).domain(h)},Or.apply(_,arguments)}function Vi(){var h=0,S=.5,_=1,x,C,M,U,re,me=_s,Fe,Pt=!1,Jt;function Ir(Pr){return isNaN(Pr=+Pr)?Jt:(Pr=.5+((Pr=+Fe(Pr))-C)*(Pr<C?U:re),me(Pt?Math.max(0,Math.min(1,Pr)):Pr))}return Ir.domain=function(Pr){return arguments.length?(x=Fe(h=+Pr[0]),C=Fe(S=+Pr[1]),M=Fe(_=+Pr[2]),U=x===C?0:.5/(C-x),re=C===M?0:.5/(M-C),Ir):[h,S,_]},Ir.clamp=function(Pr){return arguments.length?(Pt=!!Pr,Ir):Pt},Ir.interpolator=function(Pr){return arguments.length?(me=Pr,Ir):me},Ir.unknown=function(Pr){return arguments.length?(Jt=Pr,Ir):Jt},function(Pr){return Fe=Pr,x=Pr(h),C=Pr(S),M=Pr(_),U=x===C?0:.5/(C-x),re=C===M?0:.5/(M-C),Ir}}function ga(){var h=Sl(Vi()(_s));return h.copy=function(){return kn(h,ga())},Or.apply(h,arguments)}function vi(){var h=Gn(Vi()).domain([.1,1,10]);return h.copy=function(){return kn(h,vi()).base(h.base())},Or.apply(h,arguments)}function Ro(){var h=Ya(Vi());return h.copy=function(){return kn(h,Ro()).constant(h.constant())},Or.apply(h,arguments)}function Qo(){var h=Xi(Vi());return h.copy=function(){return kn(h,Qo()).exponent(h.exponent())},Or.apply(h,arguments)}function cu(){return Qo.apply(null,arguments).exponent(.5)}var ki,As,Zo,ps,tl,zs,hl,Ou,ms,Bu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ei=(ki={},Ce()(ki,T.ScaleTypes.LINEAR,ee),Ce()(ki,T.ScaleTypes.POWER,pi),Ce()(ki,T.ScaleTypes.LOG,na),Ce()(ki,T.ScaleTypes.IDENTITY,ae),Ce()(ki,T.ScaleTypes.TIME,bt),Ce()(ki,T.ScaleTypes.QUANTILE,Yi),Ce()(ki,T.ScaleTypes.QUANTIZE,bo),Ce()(ki,T.ScaleTypes.THRESHOLD,ds),Ce()(ki,T.ScaleTypes.CAT,no),ki),ji=(As=Object(sr.injectable)(),Zo=Object(sr.inject)(T.TYPES.IGlobalConfigService),ps=Object(sr.inject)(T.TYPES.ILogService),As(tl=(zs=(ms=function(){function h(){Z()(this,h),Ne()(this,"configService",hl,this),Ne()(this,"logger",Ou,this),this.scaleCache={},this.scaleOptions={}}return o()(h,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),re=_.getSource().data.dataArray;if(re.length===0)return;C.caculateScalesForAttributes(U||[],re)}),_.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),re=_.getSource().data.dataArray;return C.caculateScalesForAttributes(U||[],re),_.layerModelNeedUpdate=!0,!0}),_.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(_.layerModelNeedUpdate)return;C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes();if(U){var re=_.getSource().data.dataArray;if(re.length===0)return;var me=U.filter(function(Fe){return Fe.needRescale});me.length&&(C.caculateScalesForAttributes(me,re),C.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(_){return!isNaN(parseFloat(_))&&isFinite(_)}},{key:"caculateScalesForAttributes",value:function(_,x){var C=this;this.scaleCache={},_.forEach(function(M){if(M.scale){var U=M.scale,re=M.name;U.names=C.parseFields(M.scale.field||[]);var me=[];U.names.forEach(function(Fe){me.push(C.getOrCreateScale(Fe,M,x))}),me.some(function(Fe){return Fe.type===T.StyleScaleType.VARIABLE})?(U.type=T.StyleScaleType.VARIABLE,me.forEach(function(Fe){if(!U.callback){var Pt;if(U.values&&U.values!=="text"){var Jt;if(((Jt=Fe.option)===null||Jt===void 0?void 0:Jt.type)==="linear"&&U.values.length>2){var Ir=Fe.scale.ticks(U.values.length);re==="color"&&Fe.scale.domain(Ir)}Fe.scale.range(U.values)}else((Pt=Fe.option)===null||Pt===void 0?void 0:Pt.type)==="cat"&&Fe.scale.range(Fe.option.domain)}})):(U.type=T.StyleScaleType.CONSTANT,U.defaultValues=me.map(function(Fe,Pt){return Fe.scale(U.names[Pt])})),U.scalers=me.map(function(Fe){return{field:Fe.field,func:Fe.scale,option:Fe.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(_,x,C){var M,U=[_,x.name].join("_"),re=(M=x.scale)===null||M===void 0?void 0:M.values,me=this.createScale(_,x.name,re,C);return me}},{key:"parseFields",value:function(_){return Array.isArray(_)?_:Li()(_)?_.split("*"):[_]}},{key:"createScale",value:function(_,x,C,M){var U,re=this.scaleOptions[x]&&this.scaleOptions[x].field===_?this.scaleOptions[x]:this.scaleOptions[_],me={field:_,scale:void 0,type:T.StyleScaleType.VARIABLE,option:re};if(!M||!M.length)return re&&re.type?me.scale=this.createDefaultScale(re):(me.scale=no([_]),me.type=T.StyleScaleType.CONSTANT),me;var Fe=(U=M.find(function(Ir){return!Bl()(Ir[_])}))===null||U===void 0?void 0:U[_];if(this.isNumber(_)||Bl()(Fe)&&!re)me.scale=no([_]),me.type=T.StyleScaleType.CONSTANT;else{var Pt=re&&re.type||this.getDefaultType(Fe);C==="text"&&(Pt=T.ScaleTypes.CAT);var Jt=this.createDefaultScaleConfig(Pt,_,M);Object.assign(Jt,re),me.scale=this.createDefaultScale(Jt),me.option=Jt}return me}},{key:"getDefaultType",value:function(_){var x=T.ScaleTypes.LINEAR;return typeof _=="string"&&(x=Bu.test(_)?T.ScaleTypes.TIME:T.ScaleTypes.CAT),x}},{key:"createDefaultScaleConfig",value:function(_,x,C){var M={type:_},U=(C==null?void 0:C.map(function(re){return re[x]}))||[];return _!==T.ScaleTypes.CAT&&_!==T.ScaleTypes.QUANTILE?M.domain=mf(U):_===T.ScaleTypes.CAT?M.domain=Jc()(U):_===T.ScaleTypes.QUANTILE&&(M.domain=U),M}},{key:"createDefaultScale",value:function(_){var x=_.type,C=_.domain,M=Ei[x]();return C&&M.domain(C),M}}]),h}(),ms),hl=Ye()(zs.prototype,"configService",[Zo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ou=Ye()(zs.prototype,"logger",[ps],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs))||tl),co,zi,rl,Js,Eo,Qs,fo,Cs;function Fc(h,S){var _=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),_.push.apply(_,x)}return _}function Ff(h){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?Fc(Object(_),!0).forEach(function(x){Ce()(h,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):Fc(Object(_)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(_,x))})}return h}var Uc=(co=Object(sr.injectable)(),zi=Object(sr.inject)(T.TYPES.ICameraService),rl=Object(sr.inject)(T.TYPES.IRendererService),co(Js=(Eo=(Cs=function(){function h(){Z()(this,h),Ne()(this,"cameraService",Qs,this),Ne()(this,"rendererService",fo,this)}return o()(h,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){_.models.forEach(function(x){x.addUniforms(Ff({},_.layerModel.getAnimateUniforms()))})})}}]),h}(),Cs),Qs=Ye()(Eo.prototype,"cameraService",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fo=Ye()(Eo.prototype,"rendererService",[rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eo))||Js),Mu,Zf,ih=(Mu=Object(sr.injectable)(),Mu(Zf=function(){function h(){Z()(this,h)}return o()(h,[{key:"apply",value:function(_){_.hooks.init.tap("LayerModelPlugin",function(){_.prepareBuildModel(),_.buildModels(),_.styleNeedUpdate=!1}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return _.prepareBuildModel(),_.clearModels(),_.buildModels(),_.layerModelNeedUpdate=!1,!1})}}]),h}())||Zf),Xf,Mh,Yf=(Xf=Object(sr.injectable)(),Xf(Mh=function(){function h(){Z()(this,h)}return o()(h,[{key:"apply",value:function(_){_.hooks.afterInit.tap("LayerStylePlugin",function(){_.updateLayerConfig({});var x=_.getLayerConfig(),C=x.autoFit,M=x.fitBoundsOptions;C&&setTimeout(function(){_.fitBounds(M)},100)})}}]),h}())||Mh),Ph,Lh;function yh(h,S){var _=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),_.push.apply(_,x)}return _}function fh(h){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?yh(Object(_),!0).forEach(function(x){Ce()(h,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(_)):yh(Object(_)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(_,x))})}return h}var Rh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Qh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},hh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Ih={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},ad=["ambient","diffuse","specular"];function Dh(h){var S={u_DirectionalLights:new Array(3).fill(fh({},hh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(fh({},Ih)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Qh]),h.forEach(function(_,x){var C=_.type,M=C===void 0?"directional":C,U=Ge()(_,["type"]),re=Rh[M].lights,me=Rh[M].num,Fe=S[me];S[re][Fe]=fh(fh({},S[re][Fe]),U),S[me]++}),S}var dh=(Ph=Object(sr.injectable)(),Ph(Lh=function(){function h(){Z()(this,h)}return o()(h,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LightingPlugin",function(){var x=_.getLayerConfig(),C=x.enableLighting;C&&_.models.forEach(function(M){return M.addUniforms(fh({},Dh()))})})}}]),h}())||Lh),Nh,Hh,bh={NONE:0,ENCODE:1,HIGHLIGHT:2},kh=(Nh=Object(sr.injectable)(),Nh(Hh=function(){function h(){Z()(this,h)}return o()(h,[{key:"apply",value:function(_,x){var C=x.rendererService,M=x.styleAttributeService;_.hooks.init.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),re=U.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:T.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(Fe,Pt){var Jt=Fe.id;return re?Object(Pe.l)(Jt):[0,0,0]}}})}),_.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),re=U.enablePicking;re&&_.isVisible()&&_.models.forEach(function(me){return me.addUniforms({u_PickingStage:bh.ENCODE})})}),_.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),re=U.enablePicking;re&&_.isVisible()&&_.models.forEach(function(me){return me.addUniforms({u_PickingStage:bh.HIGHLIGHT})})}),_.hooks.beforeHighlight.tap("PixelPickingPlugin",function(U){var re=_.getLayerConfig(),me=re.highlightColor,Fe=typeof me=="string"?Object(Pe.s)(me):me||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Pe.k)(new Uint8Array(U))}),_.models.forEach(function(Pt){return Pt.addUniforms({u_PickingStage:bh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Fe.map(function(Jt){return Jt*255})})})}),_.hooks.beforeSelect.tap("PixelPickingPlugin",function(U){var re=_.getLayerConfig(),me=re.selectColor,Fe=typeof me=="string"?Object(Pe.s)(me):me||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Pe.k)(new Uint8Array(U))}),_.models.forEach(function(Pt){return Pt.addUniforms({u_PickingStage:bh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Fe.map(function(Jt){return Jt*255})})})})}}]),h}())||Hh),Wh,Zh,xh,jh,zh,Fh,Xh=(Wh=Object(sr.injectable)(),Zh=Object(sr.inject)(T.TYPES.ILogService),Wh(xh=(jh=(Fh=function(){function h(){Z()(this,h),Ne()(this,"logger",zh,this)}return o()(h,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("RegisterStyleAttributePlugin",function(){C.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(_){_.registerStyleAttribute({name:"position",type:T.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(C,M,U){return U.length===2?[U[0],U[1],0]:[U[0],U[1],U[2]]}}}),_.registerStyleAttribute({name:"filter",type:T.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(C,M){var U=C.filter;return U?[1]:[0]}}}),_.registerStyleAttribute({name:"color",type:T.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(C,M){var U=C.color;return!U||!U.length?[1,1,1,1]:U}}})}}]),h}(),Fh),zh=Ye()(jh.prototype,"logger",[Zh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jh))||xh),Eh,Uh,Th,_h,Bh,Sh,qh,id,ed,od,sd=(Eh=Object(sr.injectable)(),Uh=Object(sr.inject)(T.TYPES.ICameraService),Th=Object(sr.inject)(T.TYPES.ICoordinateSystemService),_h=Object(sr.inject)(T.TYPES.IRendererService),Eh(Bh=(Sh=(od=function(){function h(){Z()(this,h),Ne()(this,"cameraService",qh,this),Ne()(this,"coordinateSystemService",id,this),Ne()(this,"rendererService",ed,this)}return o()(h,[{key:"apply",value:function(_){var x=this;_.hooks.beforeRender.tap("ShaderUniformPlugin",function(){x.coordinateSystemService.refresh();var C=x.rendererService.getViewportSize(),M=C.width,U=C.height;_.models.forEach(function(re){var me;return re.addUniforms((me={},Ce()(me,T.CameraUniform.ProjectionMatrix,x.cameraService.getProjectionMatrix()),Ce()(me,T.CameraUniform.ViewMatrix,x.cameraService.getViewMatrix()),Ce()(me,T.CameraUniform.ViewProjectionMatrix,x.cameraService.getViewProjectionMatrix()),Ce()(me,T.CameraUniform.Zoom,x.cameraService.getZoom()),Ce()(me,T.CameraUniform.ZoomScale,x.cameraService.getZoomScale()),Ce()(me,T.CameraUniform.FocalDistance,x.cameraService.getFocalDistance()),Ce()(me,T.CameraUniform.CameraPosition,x.cameraService.getCameraPosition()),Ce()(me,T.CoordinateUniform.CoordinateSystem,x.coordinateSystemService.getCoordinateSystem()),Ce()(me,T.CoordinateUniform.ViewportCenter,x.coordinateSystemService.getViewportCenter()),Ce()(me,T.CoordinateUniform.ViewportCenterProjection,x.coordinateSystemService.getViewportCenterProjection()),Ce()(me,T.CoordinateUniform.PixelsPerDegree,x.coordinateSystemService.getPixelsPerDegree()),Ce()(me,T.CoordinateUniform.PixelsPerDegree2,x.coordinateSystemService.getPixelsPerDegree2()),Ce()(me,T.CoordinateUniform.PixelsPerMeter,x.coordinateSystemService.getPixelsPerMeter()),Ce()(me,"u_ViewportSize",[M,U]),Ce()(me,"u_DevicePixelRatio",window.devicePixelRatio),Ce()(me,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ce()(me,"u_PickingBuffer",_.getLayerConfig().pickingBuffer||0),me))})})}}]),h}(),od),qh=Ye()(Sh.prototype,"cameraService",[Uh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),id=Ye()(Sh.prototype,"coordinateSystemService",[Th],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ed=Ye()(Sh.prototype,"rendererService",[_h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sh))||Bh),gd,cd,Yh=(gd=Object(sr.injectable)(),gd(cd=function(){function h(){Z()(this,h)}return o()(h,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("UpdateModelPlugin",function(){_.layerModel&&_.layerModel.needUpdate()})}}]),h}())||cd),vs,Ef,fd,Kf,td,ud,rd=(vs=Object(sr.injectable)(),Ef=Object(sr.inject)(T.TYPES.ILogService),vs(fd=(Kf=(ud=function(){function h(){Z()(this,h),Ne()(this,"logger",td,this)}return o()(h,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("UpdateStyleAttributePlugin",function(){C.initStyleAttribute(_,{styleAttributeService:M})}),_.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(_.layerModelNeedUpdate)return;C.updateStyleAtrribute(_,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],re=M.getLayerStyleAttribute("filter"),me=M.getLayerStyleAttribute("shape");if(re&&re.needRegenerateVertices||me&&me.needRegenerateVertices){_.layerModelNeedUpdate=!0,U.forEach(function(Fe){return Fe.needRegenerateVertices=!1});return}U.filter(function(Fe){return Fe.needRegenerateVertices}).forEach(function(Fe){M.updateAttributeByFeatureRange(Fe.name,_.getEncodedData(),Fe.featureRange.startIndex,Fe.featureRange.endIndex),Fe.needRegenerateVertices=!1,C.logger.debug("regenerate vertex attributes: ".concat(Fe.name," finished"))})}},{key:"initStyleAttribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[];U.filter(function(re){return re.needRegenerateVertices}).forEach(function(re){M.updateAttributeByFeatureRange(re.name,_.getEncodedData(),re.featureRange.startIndex,re.featureRange.endIndex),re.needRegenerateVertices=!1,C.logger.debug("init vertex attributes: ".concat(re.name," finished"))})}}]),h}(),ud),td=Ye()(Kf.prototype,"logger",[Ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kf))||fd);T.container.bind(T.TYPES.ILayerPlugin).to(Ui).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Xh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(ji).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Vn).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Yf).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(rd).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Yh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(et).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(sd).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Uc).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(dh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(kh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(ih).inRequestScope()},t2Dn:function(Le,E,i){var T=i("hypo"),m=i("ljhN");function Z(z,o,W){(W!==void 0&&!m(z[o],W)||W===void 0&&!(o in z))&&T(z,o,W)}Le.exports=Z},u6S6:function(Le,E,i){var T=i("6acW"),m=i("sgoq"),Z=m(function(z,o,W){return o=o.toLowerCase(),z+(W?T(o):o)});Le.exports=Z},uhBA:function(Le,E,i){"use strict";var T=Object.prototype.hasOwnProperty,m="~";function Z(){}Object.create&&(Z.prototype=Object.create(null),new Z().__proto__||(m=!1));function z(Y,q,he){this.fn=Y,this.context=q,this.once=he||!1}function o(Y,q,he,X,je){if(typeof he!="function")throw new TypeError("The listener must be a function");var Ge=new z(he,X||Y,je),ge=m?m+q:q;return Y._events[ge]?Y._events[ge].fn?Y._events[ge]=[Y._events[ge],Ge]:Y._events[ge].push(Ge):(Y._events[ge]=Ge,Y._eventsCount++),Y}function W(Y,q){--Y._eventsCount===0?Y._events=new Z:delete Y._events[q]}function D(){this._events=new Z,this._eventsCount=0}D.prototype.eventNames=function(){var q=[],he,X;if(this._eventsCount===0)return q;for(X in he=this._events)T.call(he,X)&&q.push(m?X.slice(1):X);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(he)):q},D.prototype.listeners=function(q){var he=m?m+q:q,X=this._events[he];if(!X)return[];if(X.fn)return[X.fn];for(var je=0,Ge=X.length,ge=new Array(Ge);je<Ge;je++)ge[je]=X[je].fn;return ge},D.prototype.listenerCount=function(q){var he=m?m+q:q,X=this._events[he];return X?X.fn?1:X.length:0},D.prototype.emit=function(q,he,X,je,Ge,ge){var Ce=m?m+q:q;if(!this._events[Ce])return!1;var ht=this._events[Ce],Ne=arguments.length,Et,He;if(ht.fn){ht.once&&this.removeListener(q,ht.fn,void 0,!0);switch(Ne){case 1:return ht.fn.call(ht.context),!0;case 2:return ht.fn.call(ht.context,he),!0;case 3:return ht.fn.call(ht.context,he,X),!0;case 4:return ht.fn.call(ht.context,he,X,je),!0;case 5:return ht.fn.call(ht.context,he,X,je,Ge),!0;case 6:return ht.fn.call(ht.context,he,X,je,Ge,ge),!0}for(He=1,Et=new Array(Ne-1);He<Ne;He++)Et[He-1]=arguments[He];ht.fn.apply(ht.context,Et)}else{var mt=ht.length,Ye;for(He=0;He<mt;He++){ht[He].once&&this.removeListener(q,ht[He].fn,void 0,!0);switch(Ne){case 1:ht[He].fn.call(ht[He].context);break;case 2:ht[He].fn.call(ht[He].context,he);break;case 3:ht[He].fn.call(ht[He].context,he,X);break;case 4:ht[He].fn.call(ht[He].context,he,X,je);break;default:if(!Et)for(Ye=1,Et=new Array(Ne-1);Ye<Ne;Ye++)Et[Ye-1]=arguments[Ye];ht[He].fn.apply(ht[He].context,Et)}}}return!0},D.prototype.on=function(q,he,X){return o(this,q,he,X,!1)},D.prototype.once=function(q,he,X){return o(this,q,he,X,!0)},D.prototype.removeListener=function(q,he,X,je){var Ge=m?m+q:q;if(!this._events[Ge])return this;if(!he)return W(this,Ge),this;var ge=this._events[Ge];if(ge.fn)ge.fn===he&&(!je||ge.once)&&(!X||ge.context===X)&&W(this,Ge);else{for(var Ce=0,ht=[],Ne=ge.length;Ce<Ne;Ce++)(ge[Ce].fn!==he||je&&!ge[Ce].once||X&&ge[Ce].context!==X)&&ht.push(ge[Ce]);ht.length?this._events[Ge]=ht.length===1?ht[0]:ht:W(this,Ge)}return this},D.prototype.removeAllListeners=function(q){var he;return q?(he=m?m+q:q,this._events[he]&&W(this,he)):(this._events=new Z,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=m,D.EventEmitter=D,Le.exports=D},ujMp:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(q){if(typeof q=="function"){var he=q;return he.name}else{if(typeof q=="symbol")return q.toString();var he=q;return he}}E.getServiceIdentifierAsString=m;function Z(q,he,X){var je="",Ge=X(q,he);return Ge.length!==0&&(je=`
Registered bindings:`,Ge.forEach(function(ge){var Ce="Object";ge.implementationType!==null&&(Ce=Y(ge.implementationType)),je=je+`
 `+Ce,ge.constraint.metaData&&(je=je+" - "+ge.constraint.metaData)})),je}E.listRegisteredBindingsForServiceIdentifier=Z;function z(q,he){return q.parentRequest===null?!1:q.parentRequest.serviceIdentifier===he?!0:z(q.parentRequest,he)}function o(q){function he(je,Ge){Ge===void 0&&(Ge=[]);var ge=m(je.serviceIdentifier);return Ge.push(ge),je.parentRequest!==null?he(je.parentRequest,Ge):Ge}var X=he(q);return X.reverse().join(" --> ")}function W(q){q.childRequests.forEach(function(he){if(z(he,he.serviceIdentifier)){var X=o(he);throw new Error(T.CIRCULAR_DEPENDENCY+" "+X)}else W(he)})}E.circularDependencyToException=W;function D(q,he){if(he.isTagged()||he.isNamed()){var X="",je=he.getNamedTag(),Ge=he.getCustomTags();return je!==null&&(X+=je.toString()+`
`),Ge!==null&&Ge.forEach(function(ge){X+=ge.toString()+`
`})," "+q+`
 `+q+" - "+X}else return" "+q}E.listMetadataForTarget=D;function Y(q){if(q.name)return q.name;var he=q.toString(),X=he.match(/^function\s*([^\s(]+)/);return X?X[1]:"Anonymous function: "+he}E.getFunctionName=Y},"vN+2":function(Le,E){function i(){}Le.exports=i},"w/wX":function(Le,E,i){var T=i("QqLw"),m=i("ExA7"),Z="[object Set]";function z(o){return m(o)&&T(o)==Z}Le.exports=z},w26f:function(Le,E,i){(function(T){var m=200,Z="__lodash_hash_undefined__",z=1/0,o="[object Function]",W="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,Y=/^\[object .+?Constructor\]$/,q=typeof T=="object"&&T&&T.Object===Object&&T,he=typeof self=="object"&&self&&self.Object===Object&&self,X=q||he||Function("return this")();function je(ut,Ke){var kt=ut?ut.length:0;return!!kt&&Ce(ut,Ke,0)>-1}function Ge(ut,Ke,kt){for(var yr=-1,Zr=ut?ut.length:0;++yr<Zr;)if(kt(Ke,ut[yr]))return!0;return!1}function ge(ut,Ke,kt,yr){for(var Zr=ut.length,hr=kt+(yr?1:-1);yr?hr--:++hr<Zr;)if(Ke(ut[hr],hr,ut))return hr;return-1}function Ce(ut,Ke,kt){if(Ke!==Ke)return ge(ut,ht,kt);for(var yr=kt-1,Zr=ut.length;++yr<Zr;)if(ut[yr]===Ke)return yr;return-1}function ht(ut){return ut!==ut}function Ne(ut,Ke){return ut.has(Ke)}function Et(ut,Ke){return ut==null?void 0:ut[Ke]}function He(ut){var Ke=!1;if(ut!=null&&typeof ut.toString!="function")try{Ke=!!(ut+"")}catch(kt){}return Ke}function mt(ut){var Ke=-1,kt=Array(ut.size);return ut.forEach(function(yr){kt[++Ke]=yr}),kt}var Ye=Array.prototype,xt=Function.prototype,_t=Object.prototype,Ie=X["__core-js_shared__"],De=function(){var ut=/[^.]+$/.exec(Ie&&Ie.keys&&Ie.keys.IE_PROTO||"");return ut?"Symbol(src)_1."+ut:""}(),ze=xt.toString,at=_t.hasOwnProperty,Pe=_t.toString,ot=RegExp("^"+ze.call(at).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=Ye.splice,Wt=te(X,"Map"),sr=te(X,"Set"),ne=te(Object,"create");function $(ut){var Ke=-1,kt=ut?ut.length:0;for(this.clear();++Ke<kt;){var yr=ut[Ke];this.set(yr[0],yr[1])}}function G(){this.__data__=ne?ne(null):{}}function Ae(ut){return this.has(ut)&&delete this.__data__[ut]}function xe(ut){var Ke=this.__data__;if(ne){var kt=Ke[ut];return kt===Z?void 0:kt}return at.call(Ke,ut)?Ke[ut]:void 0}function Se(ut){var Ke=this.__data__;return ne?Ke[ut]!==void 0:at.call(Ke,ut)}function ve(ut,Ke){var kt=this.__data__;return kt[ut]=ne&&Ke===void 0?Z:Ke,this}$.prototype.clear=G,$.prototype.delete=Ae,$.prototype.get=xe,$.prototype.has=Se,$.prototype.set=ve;function et(ut){var Ke=-1,kt=ut?ut.length:0;for(this.clear();++Ke<kt;){var yr=ut[Ke];this.set(yr[0],yr[1])}}function Yt(){this.__data__=[]}function At(ut){var Ke=this.__data__,kt=gt(Ke,ut);if(kt<0)return!1;var yr=Ke.length-1;return kt==yr?Ke.pop():Bt.call(Ke,kt,1),!0}function ye(ut){var Ke=this.__data__,kt=gt(Ke,ut);return kt<0?void 0:Ke[kt][1]}function be(ut){return gt(this.__data__,ut)>-1}function Ue(ut,Ke){var kt=this.__data__,yr=gt(kt,ut);return yr<0?kt.push([ut,Ke]):kt[yr][1]=Ke,this}et.prototype.clear=Yt,et.prototype.delete=At,et.prototype.get=ye,et.prototype.has=be,et.prototype.set=Ue;function st(ut){var Ke=-1,kt=ut?ut.length:0;for(this.clear();++Ke<kt;){var yr=ut[Ke];this.set(yr[0],yr[1])}}function Me(){this.__data__={hash:new $,map:new(Wt||et),string:new $}}function ft(ut){return Ze(this,ut).delete(ut)}function w(ut){return Ze(this,ut).get(ut)}function I(ut){return Ze(this,ut).has(ut)}function J(ut,Ke){return Ze(this,ut).set(ut,Ke),this}st.prototype.clear=Me,st.prototype.delete=ft,st.prototype.get=w,st.prototype.has=I,st.prototype.set=J;function ce(ut){var Ke=-1,kt=ut?ut.length:0;for(this.__data__=new st;++Ke<kt;)this.add(ut[Ke])}function Be(ut){return this.__data__.set(ut,Z),this}function Xe(ut){return this.__data__.has(ut)}ce.prototype.add=ce.prototype.push=Be,ce.prototype.has=Xe;function gt(ut,Ke){for(var kt=ut.length;kt--;)if(dt(ut[kt][0],Ke))return kt;return-1}function tt(ut){if(!pt(ut)||zt(ut))return!1;var Ke=Ct(ut)||He(ut)?ot:Y;return Ke.test(cr(ut))}function It(ut,Ke,kt){var yr=-1,Zr=je,hr=ut.length,jn=!0,yn=[],ta=yn;if(kt)jn=!1,Zr=Ge;else if(hr>=m){var ma=Ke?null:K(ut);if(ma)return mt(ma);jn=!1,Zr=Ne,ta=new ce}else ta=Ke?[]:yn;e:for(;++yr<hr;){var Zn=ut[yr],Wn=Ke?Ke(Zn):Zn;if(Zn=kt||Zn!==0?Zn:0,jn&&Wn===Wn){for(var F=ta.length;F--;)if(ta[F]===Wn)continue e;Ke&&ta.push(Wn),yn.push(Zn)}else Zr(ta,Wn,kt)||(ta!==yn&&ta.push(Wn),yn.push(Zn))}return yn}var K=sr&&1/mt(new sr([,-0]))[1]==z?function(ut){return new sr(ut)}:we;function Ze(ut,Ke){var kt=ut.__data__;return Je(Ke)?kt[typeof Ke=="string"?"string":"hash"]:kt.map}function te(ut,Ke){var kt=Et(ut,Ke);return tt(kt)?kt:void 0}function Je(ut){var Ke=typeof ut;return Ke=="string"||Ke=="number"||Ke=="symbol"||Ke=="boolean"?ut!=="__proto__":ut===null}function zt(ut){return!!De&&De in ut}function cr(ut){if(ut!=null){try{return ze.call(ut)}catch(Ke){}try{return ut+""}catch(Ke){}}return""}function lt(ut){return ut&&ut.length?It(ut):[]}function dt(ut,Ke){return ut===Ke||ut!==ut&&Ke!==Ke}function Ct(ut){var Ke=pt(ut)?Pe.call(ut):"";return Ke==o||Ke==W}function pt(ut){var Ke=typeof ut;return!!ut&&(Ke=="object"||Ke=="function")}function we(){}Le.exports=lt}).call(this,i("yLpj"))},wclG:function(Le,E,i){var T=i("pFRH"),m=i("88Gu"),Z=m(T);Le.exports=Z},wnjb:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function Z(){}return Z.prototype.getConstructorMetadata=function(z){var o=Reflect.getMetadata(T.PARAM_TYPES,z),W=Reflect.getMetadata(T.TAGGED,z);return{compilerGeneratedMetadata:o,userGeneratedMetadata:W||{}}},Z.prototype.getPropertiesMetadata=function(z){var o=Reflect.getMetadata(T.TAGGED_PROP,z)||[];return o},Z}();E.MetadataReader=m},wrZu:function(Le,E,i){var T=i("+K+b"),m=i("XYm9"),Z=i("b2z7"),z=i("otv/"),o=i("yP5f"),W="[object Boolean]",D="[object Date]",Y="[object Map]",q="[object Number]",he="[object RegExp]",X="[object Set]",je="[object String]",Ge="[object Symbol]",ge="[object ArrayBuffer]",Ce="[object DataView]",ht="[object Float32Array]",Ne="[object Float64Array]",Et="[object Int8Array]",He="[object Int16Array]",mt="[object Int32Array]",Ye="[object Uint8Array]",xt="[object Uint8ClampedArray]",_t="[object Uint16Array]",Ie="[object Uint32Array]";function De(ze,at,Pe){var ot=ze.constructor;switch(at){case ge:return T(ze);case W:case D:return new ot(+ze);case Ce:return m(ze,Pe);case ht:case Ne:case Et:case He:case mt:case Ye:case xt:case _t:case Ie:return o(ze,Pe);case Y:return new ot;case q:case je:return new ot(ze);case he:return Z(ze);case X:return new ot;case Ge:return z(ze)}}Le.exports=De},wy8a:function(Le,E,i){var T=i("KxBF");function m(Z,z,o){var W=Z.length;return o=o===void 0?W:o,!z&&o>=W?Z:T(Z,z,o)}Le.exports=m},xfSm:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.NAMED_TAG="named",E.NAME_TAG="name",E.UNMANAGED_TAG="unmanaged",E.OPTIONAL_TAG="optional",E.INJECT_TAG="inject",E.MULTI_INJECT_TAG="multi_inject",E.TAGGED="inversify:tagged",E.TAGGED_PROP="inversify:tagged_props",E.PARAM_TYPES="inversify:paramtypes",E.DESIGN_PARAM_TYPES="design:paramtypes",E.POST_CONSTRUCT="post_construct"},xfeJ:function(Le,E){function i(T){return Function.toString.call(T).indexOf("[native code]")!==-1}Le.exports=i},xiII:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function Z(z,o,W,D,Y){this.id=T.id(),this.serviceIdentifier=z,this.parentContext=o,this.parentRequest=W,this.target=Y,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=W===null?new Map:null}return Z.prototype.addChildRequest=function(z,o,W){var D=new Z(z,this.parentContext,this,o,W);return this.childRequests.push(D),D},Z}();E.Request=m},xp6e:function(Le,E,i){"use strict";(function(T){i.d(E,"a",function(){return xe}),i.d(E,"b",function(){return Yt}),i.d(E,"c",function(){return ne}),i.d(E,"d",function(){return et});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function m(At,ye,be,Ue){function st(Me){return Me instanceof be?Me:new be(function(ft){ft(Me)})}return new(be||(be=Promise))(function(Me,ft){function w(ce){try{J(Ue.next(ce))}catch(Be){ft(Be)}}function I(ce){try{J(Ue.throw(ce))}catch(Be){ft(Be)}}function J(ce){ce.done?Me(ce.value):st(ce.value).then(w,I)}J((Ue=Ue.apply(At,ye||[])).next())})}function Z(At,ye){var be={label:0,sent:function(){if(Me[0]&1)throw Me[1];return Me[1]},trys:[],ops:[]},Ue,st,Me,ft;return ft={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(ft[Symbol.iterator]=function(){return this}),ft;function w(J){return function(ce){return I([J,ce])}}function I(J){if(Ue)throw new TypeError("Generator is already executing.");for(;be;)try{if(Ue=1,st&&(Me=J[0]&2?st.return:J[0]?st.throw||((Me=st.return)&&Me.call(st),0):st.next)&&!(Me=Me.call(st,J[1])).done)return Me;(st=0,Me)&&(J=[J[0]&2,Me.value]);switch(J[0]){case 0:case 1:Me=J;break;case 4:return be.label++,{value:J[1],done:!1};case 5:be.label++,st=J[1],J=[0];continue;case 7:J=be.ops.pop(),be.trys.pop();continue;default:if(!(Me=be.trys,Me=Me.length>0&&Me[Me.length-1])&&(J[0]===6||J[0]===2)){be=0;continue}if(J[0]===3&&(!Me||J[1]>Me[0]&&J[1]<Me[3])){be.label=J[1];break}if(J[0]===6&&be.label<Me[1]){be.label=Me[1],Me=J;break}if(Me&&be.label<Me[2]){be.label=Me[2],be.ops.push(J);break}Me[2]&&be.ops.pop(),be.trys.pop();continue}J=ye.call(At,be)}catch(ce){J=[6,ce],st=0}finally{Ue=Me=0}if(J[0]&5)throw J[1];return{value:J[0]?J[1]:void 0,done:!0}}}function z(At,ye){var be=typeof Symbol=="function"&&At[Symbol.iterator];if(!be)return At;var Ue=be.call(At),st,Me=[],ft;try{for(;(ye===void 0||ye-- >0)&&!(st=Ue.next()).done;)Me.push(st.value)}catch(w){ft={error:w}}finally{try{st&&!st.done&&(be=Ue.return)&&be.call(Ue)}finally{if(ft)throw ft.error}}return Me}function o(){for(var At=[],ye=0;ye<arguments.length;ye++)At=At.concat(z(arguments[ye]));return At}function W(At){return At&&At.__esModule&&Object.prototype.hasOwnProperty.call(At,"default")?At.default:At}function D(At,ye){return ye={exports:{}},At(ye,ye.exports),ye.exports}var Y=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Ue){return Ue&&typeof Ue.length=="number"&&Ue.length>=0&&Ue.length%1===0}At.exports=ye.default});W(Y);var q=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=function(be){return function(){for(var Ue=[],st=arguments.length;st--;)Ue[st]=arguments[st];var Me=Ue.pop();return be.call(this,Ue,Me)}},At.exports=ye.default});W(q);var he=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.fallback=st,ye.wrap=Me;var be=ye.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ue=ye.hasNextTick=typeof T=="object"&&typeof T.nextTick=="function";function st(w){setTimeout(w,0)}function Me(w){return function(I){for(var J=[],ce=arguments.length-1;ce-- >0;)J[ce]=arguments[ce+1];return w(function(){return I.apply(void 0,J)})}}var ft;be?ft=setImmediate:Ue?ft=T.nextTick:ft=st,ye.default=Me(ft)});W(he);var X=he.fallback,je=he.wrap,Ge=he.hasSetImmediate,ge=he.hasNextTick,Ce=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Me;var be=st(q),Ue=st(he);function st(I){return I&&I.__esModule?I:{default:I}}function Me(I){return(0,ht.isAsync)(I)?function(){for(var J=[],ce=arguments.length;ce--;)J[ce]=arguments[ce];var Be=J.pop(),Xe=I.apply(this,J);return ft(Xe,Be)}:(0,be.default)(function(J,ce){var Be;try{Be=I.apply(this,J)}catch(Xe){return ce(Xe)}if(Be&&typeof Be.then=="function")return ft(Be,ce);ce(null,Be)})}function ft(I,J){return I.then(function(ce){w(J,null,ce)},function(ce){w(J,ce&&ce.message?ce:new Error(ce))})}function w(I,J,ce){try{I(J,ce)}catch(Be){(0,Ue.default)(function(Xe){throw Xe},Be)}}At.exports=ye.default});W(Ce);var ht=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.isAsyncIterable=ye.isAsyncGenerator=ye.isAsync=void 0;var be=Ue(Ce);function Ue(I){return I&&I.__esModule?I:{default:I}}function st(I){return I[Symbol.toStringTag]==="AsyncFunction"}function Me(I){return I[Symbol.toStringTag]==="AsyncGenerator"}function ft(I){return typeof I[Symbol.asyncIterator]=="function"}function w(I){if(typeof I!="function")throw new Error("expected a function");return st(I)?(0,be.default)(I):I}ye.default=w,ye.isAsync=st,ye.isAsyncGenerator=Me,ye.isAsyncIterable=ft});W(ht);var Ne=ht.isAsyncIterable,Et=ht.isAsyncGenerator,He=ht.isAsync,mt=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Ue,st){if(st===void 0&&(st=Ue.length),!st)throw new Error("arity is undefined");function Me(){for(var ft=this,w=[],I=arguments.length;I--;)w[I]=arguments[I];return typeof w[st-1]=="function"?Ue.apply(this,w):new Promise(function(J,ce){w[st-1]=function(Be){for(var Xe=[],gt=arguments.length-1;gt-- >0;)Xe[gt]=arguments[gt+1];if(Be)return ce(Be);J(Xe.length>1?Xe:Xe[0])},Ue.apply(ft,w)})}return Object.defineProperty(Me,"name",{configurable:!0,value:"awaitable("+Ue.name+")"}),Me}At.exports=ye.default});W(mt);var Ye=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=Me(Y),Ue=Me(ht),st=Me(mt);function Me(ft){return ft&&ft.__esModule?ft:{default:ft}}ye.default=(0,st.default)(function(ft,w,I){var J=(0,be.default)(w)?[]:{};ft(w,function(ce,Be,Xe){(0,Ue.default)(ce)(function(gt){for(var tt,It=[],K=arguments.length-1;K-- >0;)It[K]=arguments[K+1];It.length<2&&(tt=It,It=tt[0]),J[Be]=It,Xe(gt)})},function(ce){return I(ce,J)})},3),At.exports=ye.default});W(Ye);var xt=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Ue){function st(){for(var Me=[],ft=arguments.length;ft--;)Me[ft]=arguments[ft];if(Ue===null)return;var w=Ue;Ue=null,w.apply(this,Me)}return Object.assign(st,Ue),st}At.exports=ye.default});W(xt);var _t=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=function(be){return be[Symbol.iterator]&&be[Symbol.iterator]()},At.exports=ye.default});W(_t);var Ie=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=I;var be=st(Y),Ue=st(_t);function st(J){return J&&J.__esModule?J:{default:J}}function Me(J){var ce=-1,Be=J.length;return function(){return++ce<Be?{value:J[ce],key:ce}:null}}function ft(J){var ce=-1;return function(){var Xe=J.next();return Xe.done?null:(ce++,{value:Xe.value,key:ce})}}function w(J){var ce=J?Object.keys(J):[],Be=-1,Xe=ce.length;return function(){var tt=ce[++Be];return Be<Xe?{value:J[tt],key:tt}:null}}function I(J){if((0,be.default)(J))return Me(J);var ce=(0,Ue.default)(J);return ce?ft(ce):w(J)}At.exports=ye.default});W(Ie);var De=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=be;function be(Ue){return function(){for(var st=[],Me=arguments.length;Me--;)st[Me]=arguments[Me];if(Ue===null)throw new Error("Callback was already called.");var ft=Ue;Ue=null,ft.apply(this,st)}}At.exports=ye.default});W(De);var ze=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be={};ye.default=be,At.exports=ye.default});W(ze);var at=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=st;var be=Ue(ze);function Ue(Me){return Me&&Me.__esModule?Me:{default:Me}}function st(Me,ft,w,I){var J=!1,ce=!1,Be=!1,Xe=0,gt=0;function tt(){if(Xe>=ft||Be||J)return;Be=!0,Me.next().then(function(Ze){var te=Ze.value,Je=Ze.done;if(ce||J)return;if(Be=!1,Je){J=!0,Xe<=0&&I(null);return}Xe++,w(te,gt,It),gt++,tt()}).catch(K)}function It(Ze,te){if(Xe-=1,ce)return;if(Ze)return K(Ze);if(Ze===!1){J=!0,ce=!0;return}if(te===be.default||J&&Xe<=0)return J=!0,I(null);tt()}function K(Ze){if(ce)return;Be=!1,J=!0,I(Ze)}tt()}At.exports=ye.default});W(at);var Pe=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=w(xt),Ue=w(Ie),st=w(De),Me=w(at),ft=w(ze);function w(I){return I&&I.__esModule?I:{default:I}}ye.default=function(I){return function(J,ce,Be){if(Be=(0,be.default)(Be),I<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!J)return Be(null);if((0,ht.isAsyncGenerator)(J))return(0,Me.default)(J,I,ce,Be);if((0,ht.isAsyncIterable)(J))return(0,Me.default)(J[Symbol.asyncIterator](),I,ce,Be);var Xe=(0,Ue.default)(J),gt=!1,tt=!1,It=0,K=!1;function Ze(Je,zt){if(tt)return;if(It-=1,Je)gt=!0,Be(Je);else if(Je===!1)gt=!0,tt=!0;else{if(zt===ft.default||gt&&It<=0)return gt=!0,Be(null);K||te()}}function te(){for(K=!0;It<I&&!gt;){var Je=Xe();if(Je===null){gt=!0,It<=0&&Be(null);return}It+=1,ce(Je.value,Je.key,(0,st.default)(Ze))}K=!1}te()}},At.exports=ye.default});W(Pe);var ot=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=Me(Pe),Ue=Me(ht),st=Me(mt);function Me(w){return w&&w.__esModule?w:{default:w}}function ft(w,I,J,ce){return(0,be.default)(I)(w,(0,Ue.default)(J),ce)}ye.default=(0,st.default)(ft,4),At.exports=ye.default});W(ot);var Bt=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=st(ot),Ue=st(mt);function st(ft){return ft&&ft.__esModule?ft:{default:ft}}function Me(ft,w,I){return(0,be.default)(ft,1,w,I)}ye.default=(0,Ue.default)(Me,3),At.exports=ye.default});W(Bt);var Wt=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Me;var be=st(Ye),Ue=st(Bt);function st(ft){return ft&&ft.__esModule?ft:{default:ft}}function Me(ft,w){return(0,be.default)(Ue.default,ft,w)}At.exports=ye.default}),sr=W(Wt),ne=function(){function At(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];this.args=[],this.tasks=[]}return At.prototype.call=function(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];return this.args=be,sr(this.tasks)},At.prototype.tap=function(ye,be){var Ue=this;this.tasks.push(function(st){be.apply(void 0,o(Ue.args)),st(null,ye)})},At}(),$=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=J(Y),Ue=J(ze),st=J(ot),Me=J(xt),ft=J(De),w=J(ht),I=J(mt);function J(gt){return gt&&gt.__esModule?gt:{default:gt}}function ce(gt,tt,It){It=(0,Me.default)(It);var K=0,Ze=0,te=gt.length,Je=!1;te===0&&It(null);function zt(cr,lt){if(cr===!1&&(Je=!0),Je===!0)return;cr?It(cr):(++Ze===te||lt===Ue.default)&&It(null)}for(;K<te;K++)tt(gt[K],K,(0,ft.default)(zt))}function Be(gt,tt,It){return(0,st.default)(gt,Infinity,tt,It)}function Xe(gt,tt,It){var K=(0,be.default)(gt)?ce:Be;return K(gt,(0,w.default)(tt),It)}ye.default=(0,I.default)(Xe,3),At.exports=ye.default});W($);var G=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=Me;var be=st($),Ue=st(Ye);function st(ft){return ft&&ft.__esModule?ft:{default:ft}}function Me(ft,w){return(0,Ue.default)(be.default,ft,w)}At.exports=ye.default}),Ae=W(G),xe=function(){function At(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];this.tasks=[]}return At.prototype.promise=function(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];return Ae(this.tasks)},At.prototype.tapPromise=function(ye,be){var Ue=this;this.tasks.push(function(st){return m(Ue,void 0,void 0,function(){return Z(this,function(Me){switch(Me.label){case 0:return[4,be()];case 1:return Me.sent(),st(null,ye),[2]}})})})},At}(),Se=D(function(At,ye){Object.defineProperty(ye,"__esModule",{value:!0});var be=ft(xt),Ue=ft(De),st=ft(ht),Me=ft(mt);function ft(I){return I&&I.__esModule?I:{default:I}}function w(I,J){if(J=(0,be.default)(J),!Array.isArray(I))return J(new Error("First argument to waterfall must be an array of functions"));if(!I.length)return J();var ce=0;function Be(gt){var tt=(0,st.default)(I[ce++]);tt.apply(void 0,gt.concat([(0,Ue.default)(Xe)]))}function Xe(gt){for(var tt=[],It=arguments.length-1;It-- >0;)tt[It]=arguments[It+1];if(gt===!1)return;if(gt||ce===I.length)return J.apply(void 0,[gt].concat(tt));Be(tt)}Be([])}ye.default=(0,Me.default)(w),At.exports=ye.default}),ve=W(Se),et=function(){function At(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];this.tasks=[]}return At.prototype.call=function(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];return ve(this.tasks)},At.prototype.tap=function(ye,be){this.tasks.length===0?this.tasks.push(function(Ue){var st=be();Ue(st?null:!1,st)}):this.tasks.push(function(Ue,st){var Me=be();st(Me?null:!1,ye)})},At}(),Yt=function(){function At(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];this.tasks=[]}return At.prototype.call=function(){for(var ye=arguments,be=[],Ue=0;Ue<arguments.length;Ue++)be[Ue]=ye[Ue];return sr(this.tasks)},At.prototype.tap=function(ye,be){this.tasks.push(function(Ue){var st=be();Ue(st,ye)})},At}()}).call(this,i("Q2Ig"))},yG8O:function(Le,E){function i(T,m,Z,z){if(!Z)return;Object.defineProperty(T,m,{enumerable:Z.enumerable,configurable:Z.configurable,writable:Z.writable,value:Z.initializer?Z.initializer.call(z):void 0})}Le.exports=i},yHx3:function(Le,E){var i=Object.prototype,T=i.hasOwnProperty;function m(Z){var z=Z.length,o=new Z.constructor(z);return z&&typeof Z[0]=="string"&&T.call(Z,"index")&&(o.index=Z.index,o.input=Z.input),o}Le.exports=m},yLV6:function(Le,E,i){var T;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(m,Z,z,o){"use strict";var W=["","webkit","Moz","MS","ms","o"],D=Z.createElement("div"),Y="function",q=Math.round,he=Math.abs,X=Date.now;function je(Ft,Re,Mt){return setTimeout(mt(Ft,Mt),Re)}function Ge(Ft,Re,Mt){return Array.isArray(Ft)?(ge(Ft,Mt[Re],Mt),!0):!1}function ge(Ft,Re,Mt){var dr;if(!Ft)return;if(Ft.forEach)Ft.forEach(Re,Mt);else if(Ft.length!==o)for(dr=0;dr<Ft.length;)Re.call(Mt,Ft[dr],dr,Ft),dr++;else for(dr in Ft)Ft.hasOwnProperty(dr)&&Re.call(Mt,Ft[dr],dr,Ft)}function Ce(Ft,Re,Mt){var dr="DEPRECATED METHOD: "+Re+`
`+Mt+` AT 
`;return function(){var en=new Error("get-stack-trace"),xn=en&&en.stack?en.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",zn=m.console&&(m.console.warn||m.console.log);return zn&&zn.call(m.console,dr,xn),Ft.apply(this,arguments)}}var ht;typeof Object.assign!="function"?ht=function(Re){if(Re===o||Re===null)throw new TypeError("Cannot convert undefined or null to object");for(var Mt=Object(Re),dr=1;dr<arguments.length;dr++){var en=arguments[dr];if(en!==o&&en!==null)for(var xn in en)en.hasOwnProperty(xn)&&(Mt[xn]=en[xn])}return Mt}:ht=Object.assign;var Ne=Ce(function(Re,Mt,dr){for(var en=Object.keys(Mt),xn=0;xn<en.length;)(!dr||dr&&Re[en[xn]]===o)&&(Re[en[xn]]=Mt[en[xn]]),xn++;return Re},"extend","Use `assign`."),Et=Ce(function(Re,Mt){return Ne(Re,Mt,!0)},"merge","Use `assign`.");function He(Ft,Re,Mt){var dr=Re.prototype,en;en=Ft.prototype=Object.create(dr),en.constructor=Ft,en._super=dr,Mt&&ht(en,Mt)}function mt(Ft,Re){return function(){return Ft.apply(Re,arguments)}}function Ye(Ft,Re){return typeof Ft==Y?Ft.apply(Re&&Re[0]||o,Re):Ft}function xt(Ft,Re){return Ft===o?Re:Ft}function _t(Ft,Re,Mt){ge(at(Re),function(dr){Ft.addEventListener(dr,Mt,!1)})}function Ie(Ft,Re,Mt){ge(at(Re),function(dr){Ft.removeEventListener(dr,Mt,!1)})}function De(Ft,Re){for(;Ft;){if(Ft==Re)return!0;Ft=Ft.parentNode}return!1}function ze(Ft,Re){return Ft.indexOf(Re)>-1}function at(Ft){return Ft.trim().split(/\s+/g)}function Pe(Ft,Re,Mt){if(Ft.indexOf&&!Mt)return Ft.indexOf(Re);for(var dr=0;dr<Ft.length;){if(Mt&&Ft[dr][Mt]==Re||!Mt&&Ft[dr]===Re)return dr;dr++}return-1}function ot(Ft){return Array.prototype.slice.call(Ft,0)}function Bt(Ft,Re,Mt){for(var dr=[],en=[],xn=0;xn<Ft.length;){var zn=Re?Ft[xn][Re]:Ft[xn];Pe(en,zn)<0&&dr.push(Ft[xn]),en[xn]=zn,xn++}return Mt&&(Re?dr=dr.sort(function(mo,Do){return mo[Re]>Do[Re]}):dr=dr.sort()),dr}function Wt(Ft,Re){for(var Mt,dr,en=Re[0].toUpperCase()+Re.slice(1),xn=0;xn<W.length;){if(Mt=W[xn],dr=Mt?Mt+en:Re,dr in Ft)return dr;xn++}return o}var sr=1;function ne(){return sr++}function $(Ft){var Re=Ft.ownerDocument||Ft;return Re.defaultView||Re.parentWindow||m}var G=/mobile|tablet|ip(ad|hone|od)|android/i,Ae="ontouchstart"in m,xe=Wt(m,"PointerEvent")!==o,Se=Ae&&G.test(navigator.userAgent),ve="touch",et="pen",Yt="mouse",At="kinect",ye=25,be=1,Ue=2,st=4,Me=8,ft=1,w=2,I=4,J=8,ce=16,Be=w|I,Xe=J|ce,gt=Be|Xe,tt=["x","y"],It=["clientX","clientY"];function K(Ft,Re){var Mt=this;this.manager=Ft,this.callback=Re,this.element=Ft.element,this.target=Ft.options.inputTarget,this.domHandler=function(dr){Ye(Ft.options.enable,[Ft])&&Mt.handler(dr)},this.init()}K.prototype={handler:function(){},init:function(){this.evEl&&_t(this.element,this.evEl,this.domHandler),this.evTarget&&_t(this.target,this.evTarget,this.domHandler),this.evWin&&_t($(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ie(this.element,this.evEl,this.domHandler),this.evTarget&&Ie(this.target,this.evTarget,this.domHandler),this.evWin&&Ie($(this.element),this.evWin,this.domHandler)}};function Ze(Ft){var Re,Mt=Ft.options.inputClass;return Mt?Re=Mt:xe?Re=Wn:Se?Re=ct:Ae?Re=nn:Re=jn,new Re(Ft,te)}function te(Ft,Re,Mt){var dr=Mt.pointers.length,en=Mt.changedPointers.length,xn=Re&be&&dr-en===0,zn=Re&(st|Me)&&dr-en===0;Mt.isFirst=!!xn,Mt.isFinal=!!zn,xn&&(Ft.session={}),Mt.eventType=Re,Je(Ft,Mt),Ft.emit("hammer.input",Mt),Ft.recognize(Mt),Ft.session.prevInput=Mt}function Je(Ft,Re){var Mt=Ft.session,dr=Re.pointers,en=dr.length;Mt.firstInput||(Mt.firstInput=lt(Re)),en>1&&!Mt.firstMultiple?Mt.firstMultiple=lt(Re):en===1&&(Mt.firstMultiple=!1);var xn=Mt.firstInput,zn=Mt.firstMultiple,Gi=zn?zn.center:xn.center,mo=Re.center=dt(dr);Re.timeStamp=X(),Re.deltaTime=Re.timeStamp-xn.timeStamp,Re.angle=ut(Gi,mo),Re.distance=we(Gi,mo),zt(Mt,Re),Re.offsetDirection=pt(Re.deltaX,Re.deltaY);var Do=Ct(Re.deltaTime,Re.deltaX,Re.deltaY);Re.overallVelocityX=Do.x,Re.overallVelocityY=Do.y,Re.overallVelocity=he(Do.x)>he(Do.y)?Do.x:Do.y,Re.scale=zn?kt(zn.pointers,dr):1,Re.rotation=zn?Ke(zn.pointers,dr):0,Re.maxPointers=Mt.prevInput?Re.pointers.length>Mt.prevInput.maxPointers?Re.pointers.length:Mt.prevInput.maxPointers:Re.pointers.length,cr(Mt,Re);var To=Ft.element;De(Re.srcEvent.target,To)&&(To=Re.srcEvent.target),Re.target=To}function zt(Ft,Re){var Mt=Re.center,dr=Ft.offsetDelta||{},en=Ft.prevDelta||{},xn=Ft.prevInput||{};(Re.eventType===be||xn.eventType===st)&&(en=Ft.prevDelta={x:xn.deltaX||0,y:xn.deltaY||0},dr=Ft.offsetDelta={x:Mt.x,y:Mt.y}),Re.deltaX=en.x+(Mt.x-dr.x),Re.deltaY=en.y+(Mt.y-dr.y)}function cr(Ft,Re){var Mt=Ft.lastInterval||Re,dr=Re.timeStamp-Mt.timeStamp,en,xn,zn,Gi;if(Re.eventType!=Me&&(dr>ye||Mt.velocity===o)){var mo=Re.deltaX-Mt.deltaX,Do=Re.deltaY-Mt.deltaY,To=Ct(dr,mo,Do);xn=To.x,zn=To.y,en=he(To.x)>he(To.y)?To.x:To.y,Gi=pt(mo,Do),Ft.lastInterval=Re}else en=Mt.velocity,xn=Mt.velocityX,zn=Mt.velocityY,Gi=Mt.direction;Re.velocity=en,Re.velocityX=xn,Re.velocityY=zn,Re.direction=Gi}function lt(Ft){for(var Re=[],Mt=0;Mt<Ft.pointers.length;)Re[Mt]={clientX:q(Ft.pointers[Mt].clientX),clientY:q(Ft.pointers[Mt].clientY)},Mt++;return{timeStamp:X(),pointers:Re,center:dt(Re),deltaX:Ft.deltaX,deltaY:Ft.deltaY}}function dt(Ft){var Re=Ft.length;if(Re===1)return{x:q(Ft[0].clientX),y:q(Ft[0].clientY)};for(var Mt=0,dr=0,en=0;en<Re;)Mt+=Ft[en].clientX,dr+=Ft[en].clientY,en++;return{x:q(Mt/Re),y:q(dr/Re)}}function Ct(Ft,Re,Mt){return{x:Re/Ft||0,y:Mt/Ft||0}}function pt(Ft,Re){return Ft===Re?ft:he(Ft)>=he(Re)?Ft<0?w:I:Re<0?J:ce}function we(Ft,Re,Mt){Mt||(Mt=tt);var dr=Re[Mt[0]]-Ft[Mt[0]],en=Re[Mt[1]]-Ft[Mt[1]];return Math.sqrt(dr*dr+en*en)}function ut(Ft,Re,Mt){Mt||(Mt=tt);var dr=Re[Mt[0]]-Ft[Mt[0]],en=Re[Mt[1]]-Ft[Mt[1]];return Math.atan2(en,dr)*180/Math.PI}function Ke(Ft,Re){return ut(Re[1],Re[0],It)+ut(Ft[1],Ft[0],It)}function kt(Ft,Re){return we(Re[0],Re[1],It)/we(Ft[0],Ft[1],It)}var yr={mousedown:be,mousemove:Ue,mouseup:st},Zr="mousedown",hr="mousemove mouseup";function jn(){this.evEl=Zr,this.evWin=hr,this.pressed=!1,K.apply(this,arguments)}He(jn,K,{handler:function(Re){var Mt=yr[Re.type];if(Mt&be&&Re.button===0&&(this.pressed=!0),Mt&Ue&&Re.which!==1&&(Mt=st),!this.pressed)return;Mt&st&&(this.pressed=!1),this.callback(this.manager,Mt,{pointers:[Re],changedPointers:[Re],pointerType:Yt,srcEvent:Re})}});var yn={pointerdown:be,pointermove:Ue,pointerup:st,pointercancel:Me,pointerout:Me},ta={2:ve,3:et,4:Yt,5:At},ma="pointerdown",Zn="pointermove pointerup pointercancel";m.MSPointerEvent&&!m.PointerEvent&&(ma="MSPointerDown",Zn="MSPointerMove MSPointerUp MSPointerCancel");function Wn(){this.evEl=ma,this.evWin=Zn,K.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}He(Wn,K,{handler:function(Re){var Mt=this.store,dr=!1,en=Re.type.toLowerCase().replace("ms",""),xn=yn[en],zn=ta[Re.pointerType]||Re.pointerType,Gi=zn==ve,mo=Pe(Mt,Re.pointerId,"pointerId");if(xn&be&&(Re.button===0||Gi)?mo<0&&(Mt.push(Re),mo=Mt.length-1):xn&(st|Me)&&(dr=!0),mo<0)return;Mt[mo]=Re,this.callback(this.manager,xn,{pointers:Mt,changedPointers:[Re],pointerType:zn,srcEvent:Re}),dr&&Mt.splice(mo,1)}});var F={touchstart:be,touchmove:Ue,touchend:st,touchcancel:Me},H="touchstart",ue="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=H,this.evWin=ue,this.started=!1,K.apply(this,arguments)}He(pe,K,{handler:function(Re){var Mt=F[Re.type];if(Mt===be&&(this.started=!0),!this.started)return;var dr=rt.call(this,Re,Mt);Mt&(st|Me)&&dr[0].length-dr[1].length===0&&(this.started=!1),this.callback(this.manager,Mt,{pointers:dr[0],changedPointers:dr[1],pointerType:ve,srcEvent:Re})}});function rt(Ft,Re){var Mt=ot(Ft.touches),dr=ot(Ft.changedTouches);return Re&(st|Me)&&(Mt=Bt(Mt.concat(dr),"identifier",!0)),[Mt,dr]}var yt={touchstart:be,touchmove:Ue,touchend:st,touchcancel:Me},Ve="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=Ve,this.targetIds={},K.apply(this,arguments)}He(ct,K,{handler:function(Re){var Mt=yt[Re.type],dr=er.call(this,Re,Mt);if(!dr)return;this.callback(this.manager,Mt,{pointers:dr[0],changedPointers:dr[1],pointerType:ve,srcEvent:Re})}});function er(Ft,Re){var Mt=ot(Ft.touches),dr=this.targetIds;if(Re&(be|Ue)&&Mt.length===1)return dr[Mt[0].identifier]=!0,[Mt,Mt];var en,xn,zn=ot(Ft.changedTouches),Gi=[],mo=this.target;if(xn=Mt.filter(function(Do){return De(Do.target,mo)}),Re===be)for(en=0;en<xn.length;)dr[xn[en].identifier]=!0,en++;for(en=0;en<zn.length;)dr[zn[en].identifier]&&Gi.push(zn[en]),Re&(st|Me)&&delete dr[zn[en].identifier],en++;return Gi.length?[Bt(xn.concat(Gi),"identifier",!0),Gi]:void 0}var rr=2500,jr=25;function nn(){K.apply(this,arguments);var Ft=mt(this.handler,this);this.touch=new ct(this.manager,Ft),this.mouse=new jn(this.manager,Ft),this.primaryTouch=null,this.lastTouches=[]}He(nn,K,{handler:function(Re,Mt,dr){var en=dr.pointerType==ve,xn=dr.pointerType==Yt;if(xn&&dr.sourceCapabilities&&dr.sourceCapabilities.firesTouchEvents)return;if(en)ur.call(this,Mt,dr);else if(xn&&Tn.call(this,dr))return;this.callback(Re,Mt,dr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ur(Ft,Re){Ft&be?(this.primaryTouch=Re.changedPointers[0].identifier,Wr.call(this,Re)):Ft&(st|Me)&&Wr.call(this,Re)}function Wr(Ft){var Re=Ft.changedPointers[0];if(Re.identifier===this.primaryTouch){var Mt={x:Re.clientX,y:Re.clientY};this.lastTouches.push(Mt);var dr=this.lastTouches,en=function(){var zn=dr.indexOf(Mt);zn>-1&&dr.splice(zn,1)};setTimeout(en,rr)}}function Tn(Ft){for(var Re=Ft.srcEvent.clientX,Mt=Ft.srcEvent.clientY,dr=0;dr<this.lastTouches.length;dr++){var en=this.lastTouches[dr],xn=Math.abs(Re-en.x),zn=Math.abs(Mt-en.y);if(xn<=jr&&zn<=jr)return!0}return!1}var mr=Wt(D.style,"touchAction"),Jr=mr!==o,vn="compute",Kn="auto",_n="manipulation",Hr="none",oa="pan-x",Mr="pan-y",va=Ki();function ha(Ft,Re){this.manager=Ft,this.set(Re)}ha.prototype={set:function(Re){Re==vn&&(Re=this.compute()),Jr&&this.manager.element.style&&va[Re]&&(this.manager.element.style[mr]=Re),this.actions=Re.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Re=[];return ge(this.manager.recognizers,function(Mt){Ye(Mt.options.enable,[Mt])&&(Re=Re.concat(Mt.getTouchAction()))}),da(Re.join(" "))},preventDefaults:function(Re){var Mt=Re.srcEvent,dr=Re.offsetDirection;if(this.manager.session.prevented){Mt.preventDefault();return}var en=this.actions,xn=ze(en,Hr)&&!va[Hr],zn=ze(en,Mr)&&!va[Mr],Gi=ze(en,oa)&&!va[oa];if(xn){var mo=Re.pointers.length===1,Do=Re.distance<2,To=Re.deltaTime<250;if(mo&&Do&&To)return}if(Gi&&zn)return;if(xn||zn&&dr&Be||Gi&&dr&Xe)return this.preventSrc(Mt)},preventSrc:function(Re){this.manager.session.prevented=!0,Re.preventDefault()}};function da(Ft){if(ze(Ft,Hr))return Hr;var Re=ze(Ft,oa),Mt=ze(Ft,Mr);return Re&&Mt?Hr:Re||Mt?Re?oa:Mr:ze(Ft,_n)?_n:Kn}function Ki(){if(!Jr)return!1;var Ft={},Re=m.CSS&&m.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Mt){Ft[Mt]=Re?m.CSS.supports("touch-action",Mt):!0}),Ft}var Fi=1,xa=2,di=4,Ga=8,In=Ga,Oi=16,$i=32;function Ti(Ft){this.options=ht({},this.defaults,Ft||{}),this.id=ne(),this.manager=null,this.options.enable=xt(this.options.enable,!0),this.state=Fi,this.simultaneous={},this.requireFail=[]}Ti.prototype={defaults:{},set:function(Re){return ht(this.options,Re),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Re){if(Ge(Re,"recognizeWith",this))return this;var Mt=this.simultaneous;return Re=hu(Re,this),Mt[Re.id]||(Mt[Re.id]=Re,Re.recognizeWith(this)),this},dropRecognizeWith:function(Re){return Ge(Re,"dropRecognizeWith",this)?this:(Re=hu(Re,this),delete this.simultaneous[Re.id],this)},requireFailure:function(Re){if(Ge(Re,"requireFailure",this))return this;var Mt=this.requireFail;return Re=hu(Re,this),Pe(Mt,Re)===-1&&(Mt.push(Re),Re.requireFailure(this)),this},dropRequireFailure:function(Re){if(Ge(Re,"dropRequireFailure",this))return this;Re=hu(Re,this);var Mt=Pe(this.requireFail,Re);return Mt>-1&&this.requireFail.splice(Mt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Re){return!!this.simultaneous[Re.id]},emit:function(Re){var Mt=this,dr=this.state;function en(xn){Mt.manager.emit(xn,Re)}dr<Ga&&en(Mt.options.event+Io(dr)),en(Mt.options.event),Re.additionalEvent&&en(Re.additionalEvent),dr>=Ga&&en(Mt.options.event+Io(dr))},tryEmit:function(Re){if(this.canEmit())return this.emit(Re);this.state=$i},canEmit:function(){for(var Re=0;Re<this.requireFail.length;){if(!(this.requireFail[Re].state&($i|Fi)))return!1;Re++}return!0},recognize:function(Re){var Mt=ht({},Re);if(!Ye(this.options.enable,[this,Mt])){this.reset(),this.state=$i;return}this.state&(In|Oi|$i)&&(this.state=Fi),this.state=this.process(Mt),this.state&(xa|di|Ga|Oi)&&this.tryEmit(Mt)},process:function(Re){},getTouchAction:function(){},reset:function(){}};function Io(Ft){return Ft&Oi?"cancel":Ft&Ga?"end":Ft&di?"move":Ft&xa?"start":""}function fu(Ft){return Ft==ce?"down":Ft==J?"up":Ft==w?"left":Ft==I?"right":""}function hu(Ft,Re){var Mt=Re.manager;return Mt?Mt.get(Ft):Ft}function pa(){Ti.apply(this,arguments)}He(pa,Ti,{defaults:{pointers:1},attrTest:function(Re){var Mt=this.options.pointers;return Mt===0||Re.pointers.length===Mt},process:function(Re){var Mt=this.state,dr=Re.eventType,en=Mt&(xa|di),xn=this.attrTest(Re);return en&&(dr&Me||!xn)?Mt|Oi:en||xn?dr&st?Mt|Ga:Mt&xa?Mt|di:xa:$i}});function ws(){pa.apply(this,arguments),this.pX=null,this.pY=null}He(ws,pa,{defaults:{event:"pan",threshold:10,pointers:1,direction:gt},getTouchAction:function(){var Re=this.options.direction,Mt=[];return Re&Be&&Mt.push(Mr),Re&Xe&&Mt.push(oa),Mt},directionTest:function(Re){var Mt=this.options,dr=!0,en=Re.distance,xn=Re.direction,zn=Re.deltaX,Gi=Re.deltaY;return xn&Mt.direction||(Mt.direction&Be?(xn=zn===0?ft:zn<0?w:I,dr=zn!=this.pX,en=Math.abs(Re.deltaX)):(xn=Gi===0?ft:Gi<0?J:ce,dr=Gi!=this.pY,en=Math.abs(Re.deltaY))),Re.direction=xn,dr&&en>Mt.threshold&&xn&Mt.direction},attrTest:function(Re){return pa.prototype.attrTest.call(this,Re)&&(this.state&xa||!(this.state&xa)&&this.directionTest(Re))},emit:function(Re){this.pX=Re.deltaX,this.pY=Re.deltaY;var Mt=fu(Re.direction);Mt&&(Re.additionalEvent=this.options.event+Mt),this._super.emit.call(this,Re)}});function po(){pa.apply(this,arguments)}He(po,pa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Hr]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.scale-1)>this.options.threshold||this.state&xa)},emit:function(Re){if(Re.scale!==1){var Mt=Re.scale<1?"in":"out";Re.additionalEvent=this.options.event+Mt}this._super.emit.call(this,Re)}});function Za(){Ti.apply(this,arguments),this._timer=null,this._input=null}He(Za,Ti,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Kn]},process:function(Re){var Mt=this.options,dr=Re.pointers.length===Mt.pointers,en=Re.distance<Mt.threshold,xn=Re.deltaTime>Mt.time;if(this._input=Re,!en||!dr||Re.eventType&(st|Me)&&!xn)this.reset();else if(Re.eventType&be)this.reset(),this._timer=je(function(){this.state=In,this.tryEmit()},Mt.time,this);else if(Re.eventType&st)return In;return $i},reset:function(){clearTimeout(this._timer)},emit:function(Re){if(this.state!==In)return;Re&&Re.eventType&st?this.manager.emit(this.options.event+"up",Re):(this._input.timeStamp=X(),this.manager.emit(this.options.event,this._input))}});function Pu(){pa.apply(this,arguments)}He(Pu,pa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Hr]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.rotation)>this.options.threshold||this.state&xa)}});function Mi(){pa.apply(this,arguments)}He(Mi,pa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Be|Xe,pointers:1},getTouchAction:function(){return ws.prototype.getTouchAction.call(this)},attrTest:function(Re){var Mt=this.options.direction,dr;return Mt&(Be|Xe)?dr=Re.overallVelocity:Mt&Be?dr=Re.overallVelocityX:Mt&Xe&&(dr=Re.overallVelocityY),this._super.attrTest.call(this,Re)&&Mt&Re.offsetDirection&&Re.distance>this.options.threshold&&Re.maxPointers==this.options.pointers&&he(dr)>this.options.velocity&&Re.eventType&st},emit:function(Re){var Mt=fu(Re.offsetDirection);Mt&&this.manager.emit(this.options.event+Mt,Re),this.manager.emit(this.options.event,Re)}});function _i(){Ti.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}He(_i,Ti,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_n]},process:function(Re){var Mt=this.options,dr=Re.pointers.length===Mt.pointers,en=Re.distance<Mt.threshold,xn=Re.deltaTime<Mt.time;if(this.reset(),Re.eventType&be&&this.count===0)return this.failTimeout();if(en&&xn&&dr){if(Re.eventType!=st)return this.failTimeout();var zn=this.pTime?Re.timeStamp-this.pTime<Mt.interval:!0,Gi=!this.pCenter||we(this.pCenter,Re.center)<Mt.posThreshold;this.pTime=Re.timeStamp,this.pCenter=Re.center,!Gi||!zn?this.count=1:this.count+=1,this._input=Re;var mo=this.count%Mt.taps;if(mo===0)return this.hasRequireFailures()?(this._timer=je(function(){this.state=In,this.tryEmit()},Mt.interval,this),xa):In}return $i},failTimeout:function(){return this._timer=je(function(){this.state=$i},this.options.interval,this),$i},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==In&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function _o(Ft,Re){return Re=Re||{},Re.recognizers=xt(Re.recognizers,_o.defaults.preset),new Ol(Ft,Re)}_o.VERSION="2.0.7",_o.defaults={domEvents:!1,touchAction:vn,enable:!0,inputTarget:null,inputClass:null,preset:[[Pu,{enable:!1}],[po,{enable:!1},["rotate"]],[Mi,{direction:Be}],[ws,{direction:Be},["swipe"]],[_i],[_i,{event:"doubletap",taps:2},["tap"]],[Za]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var as=1,So=2;function Ol(Ft,Re){this.options=ht({},_o.defaults,Re||{}),this.options.inputTarget=this.options.inputTarget||Ft,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ft,this.input=Ze(this),this.touchAction=new ha(this,this.options.touchAction),Os(this,!0),ge(this.options.recognizers,function(Mt){var dr=this.add(new Mt[0](Mt[1]));Mt[2]&&dr.recognizeWith(Mt[2]),Mt[3]&&dr.requireFailure(Mt[3])},this)}Ol.prototype={set:function(Re){return ht(this.options,Re),Re.touchAction&&this.touchAction.update(),Re.inputTarget&&(this.input.destroy(),this.input.target=Re.inputTarget,this.input.init()),this},stop:function(Re){this.session.stopped=Re?So:as},recognize:function(Re){var Mt=this.session;if(Mt.stopped)return;this.touchAction.preventDefaults(Re);var dr,en=this.recognizers,xn=Mt.curRecognizer;(!xn||xn&&xn.state&In)&&(xn=Mt.curRecognizer=null);for(var zn=0;zn<en.length;)dr=en[zn],Mt.stopped!==So&&(!xn||dr==xn||dr.canRecognizeWith(xn))?dr.recognize(Re):dr.reset(),!xn&&dr.state&(xa|di|Ga)&&(xn=Mt.curRecognizer=dr),zn++},get:function(Re){if(Re instanceof Ti)return Re;for(var Mt=this.recognizers,dr=0;dr<Mt.length;dr++)if(Mt[dr].options.event==Re)return Mt[dr];return null},add:function(Re){if(Ge(Re,"add",this))return this;var Mt=this.get(Re.options.event);return Mt&&this.remove(Mt),this.recognizers.push(Re),Re.manager=this,this.touchAction.update(),Re},remove:function(Re){if(Ge(Re,"remove",this))return this;if(Re=this.get(Re),Re){var Mt=this.recognizers,dr=Pe(Mt,Re);dr!==-1&&(Mt.splice(dr,1),this.touchAction.update())}return this},on:function(Re,Mt){if(Re===o)return;if(Mt===o)return;var dr=this.handlers;return ge(at(Re),function(en){dr[en]=dr[en]||[],dr[en].push(Mt)}),this},off:function(Re,Mt){if(Re===o)return;var dr=this.handlers;return ge(at(Re),function(en){Mt?dr[en]&&dr[en].splice(Pe(dr[en],Mt),1):delete dr[en]}),this},emit:function(Re,Mt){this.options.domEvents&&so(Re,Mt);var dr=this.handlers[Re]&&this.handlers[Re].slice();if(!dr||!dr.length)return;Mt.type=Re,Mt.preventDefault=function(){Mt.srcEvent.preventDefault()};for(var en=0;en<dr.length;)dr[en](Mt),en++},destroy:function(){this.element&&Os(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Os(Ft,Re){var Mt=Ft.element;if(!Mt.style)return;var dr;ge(Ft.options.cssProps,function(en,xn){dr=Wt(Mt.style,xn),Re?(Ft.oldCssProps[dr]=Mt.style[dr],Mt.style[dr]=en):Mt.style[dr]=Ft.oldCssProps[dr]||""}),Re||(Ft.oldCssProps={})}function so(Ft,Re){var Mt=Z.createEvent("Event");Mt.initEvent(Ft,!0,!0),Mt.gesture=Re,Re.target.dispatchEvent(Mt)}ht(_o,{INPUT_START:be,INPUT_MOVE:Ue,INPUT_END:st,INPUT_CANCEL:Me,STATE_POSSIBLE:Fi,STATE_BEGAN:xa,STATE_CHANGED:di,STATE_ENDED:Ga,STATE_RECOGNIZED:In,STATE_CANCELLED:Oi,STATE_FAILED:$i,DIRECTION_NONE:ft,DIRECTION_LEFT:w,DIRECTION_RIGHT:I,DIRECTION_UP:J,DIRECTION_DOWN:ce,DIRECTION_HORIZONTAL:Be,DIRECTION_VERTICAL:Xe,DIRECTION_ALL:gt,Manager:Ol,Input:K,TouchAction:ha,TouchInput:ct,MouseInput:jn,PointerEventInput:Wn,TouchMouseInput:nn,SingleTouchInput:pe,Recognizer:Ti,AttrRecognizer:pa,Tap:_i,Pan:ws,Swipe:Mi,Pinch:po,Rotate:Pu,Press:Za,on:_t,off:Ie,each:ge,merge:Et,extend:Ne,assign:ht,inherit:He,bindFn:mt,prefixed:Wt});var du=typeof m!="undefined"?m:typeof self!="undefined"?self:{};du.Hammer=_o,!(T=function(){return _o}.call(E,i,E,Le),T!==o&&(Le.exports=T))})(window,document,"Hammer")},yMAV:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(Z,z){this.parentContext=Z,this.rootRequest=z}return m}();E.Plan=T},yP5f:function(Le,E,i){var T=i("+K+b");function m(Z,z){var o=z?T(Z.buffer):Z.buffer;return new Z.constructor(o,Z.byteOffset,Z.length)}Le.exports=m},yU0y:function(Le,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"a",function(){return m}),i.d(E,"c",function(){return Z});var T=1e-6,m=typeof Float32Array!="undefined"?Float32Array:Array,Z=Math.random;function z(Y){m=Y}var o=Math.PI/180;function W(Y){return Y*o}function D(Y,q){return Math.abs(Y-q)<=T*Math.max(1,Math.abs(Y),Math.abs(q))}Math.hypot||(Math.hypot=function(){for(var Y=0,q=arguments.length;q--;)Y+=arguments[q]*arguments[q];return Math.sqrt(Y)})},yXPU:function(Le,E){function i(m,Z,z,o,W,D,Y){try{var q=m[D](Y),he=q.value}catch(X){z(X);return}q.done?Z(he):Promise.resolve(he).then(o,W)}function T(m){return function(){var Z=this,z=arguments;return new Promise(function(o,W){var D=m.apply(Z,z);function Y(he){i(D,o,W,Y,q,"next",he)}function q(he){i(D,o,W,Y,q,"throw",he)}Y(void 0)})}}Le.exports=T},ycre:function(Le,E,i){var T=i("711d"),m=T("length");Le.exports=m},z4Hk:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("RR/i"),Z=function(){function z(o){this._binding=o}return z.prototype.when=function(o){return this._binding.constraint=o,new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetNamed=function(o){return this._binding.constraint=m.namedConstraint(o),new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(o){var W=o.target!==null&&!o.target.isNamed()&&!o.target.isTagged();return W},new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetTagged=function(o,W){return this._binding.constraint=m.taggedConstraint(o)(W),new T.BindingOnSyntax(this._binding)},z.prototype.whenInjectedInto=function(o){return this._binding.constraint=function(W){return m.typeConstraint(o)(W.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentNamed=function(o){return this._binding.constraint=function(W){return m.namedConstraint(o)(W.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentTagged=function(o,W){return this._binding.constraint=function(D){return m.taggedConstraint(o)(W)(D.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorIs=function(o){return this._binding.constraint=function(W){return m.traverseAncerstors(W,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorIs=function(o){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorNamed=function(o){return this._binding.constraint=function(W){return m.traverseAncerstors(W,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorNamed=function(o){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorTagged=function(o,W){return this._binding.constraint=function(D){return m.traverseAncerstors(D,m.taggedConstraint(o)(W))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorTagged=function(o,W){return this._binding.constraint=function(D){return!m.traverseAncerstors(D,m.taggedConstraint(o)(W))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorMatches=function(o){return this._binding.constraint=function(W){return m.traverseAncerstors(W,o)},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorMatches=function(o){return this._binding.constraint=function(W){return!m.traverseAncerstors(W,o)},new T.BindingOnSyntax(this._binding)},z}();E.BindingWhenSyntax=Z},zEVN:function(Le,E,i){var T=i("Gi0A"),m=i("sEf8"),Z=i("mdPL"),z=Z&&Z.isMap,o=z?m(z):T;Le.exports=o},zZ0H:function(Le,E){function i(T){return T}Le.exports=i},zZPE:function(Le,E){var i="[object Object]";function T(je){var Ge=!1;if(je!=null&&typeof je.toString!="function")try{Ge=!!(je+"")}catch(ge){}return Ge}function m(je,Ge){return function(ge){return je(Ge(ge))}}var Z=Function.prototype,z=Object.prototype,o=Z.toString,W=z.hasOwnProperty,D=o.call(Object),Y=z.toString,q=m(Object.getPrototypeOf,Object);function he(je){return!!je&&typeof je=="object"}function X(je){if(!he(je)||Y.call(je)!=i||T(je))return!1;var Ge=q(je);if(Ge===null)return!0;var ge=W.call(Ge,"constructor")&&Ge.constructor;return typeof ge=="function"&&ge instanceof ge&&o.call(ge)==D}Le.exports=X},zoYe:function(Le,E,i){var T=i("nmnc"),m=i("eUgh"),Z=i("Z0cm"),z=i("/9aa"),o=1/0,W=T?T.prototype:void 0,D=W?W.toString:void 0;function Y(q){if(typeof q=="string")return q;if(Z(q))return m(q,Y)+"";if(z(q))return D?D.call(q):"";var he=q+"";return he=="0"&&1/q==-o?"-0":he}Le.exports=Y},zvhG:function(Le,E){Le.exports=i;function i(T,m,Z,z){this.cx=3*T,this.bx=3*(Z-T)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(z-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=T,this.p1y=z,this.p2x=Z,this.p2y=z}i.prototype.sampleCurveX=function(T){return((this.ax*T+this.bx)*T+this.cx)*T},i.prototype.sampleCurveY=function(T){return((this.ay*T+this.by)*T+this.cy)*T},i.prototype.sampleCurveDerivativeX=function(T){return(3*this.ax*T+2*this.bx)*T+this.cx},i.prototype.solveCurveX=function(T,m){typeof m=="undefined"&&(m=1e-6);var Z,z,o,W,D;for(o=T,D=0;D<8;D++){if(W=this.sampleCurveX(o)-T,Math.abs(W)<m)return o;var Y=this.sampleCurveDerivativeX(o);if(Math.abs(Y)<1e-6)break;o=o-W/Y}if(Z=0,z=1,o=T,o<Z)return Z;if(o>z)return z;for(;Z<z;){if(W=this.sampleCurveX(o),Math.abs(W-T)<m)return o;T>W?Z=o:z=o,o=(z-Z)*.5+Z}return o},i.prototype.solve=function(T,m){return this.sampleCurveY(this.solveCurveX(T,m))}},zxMA:function(Le,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(Z){this.str=Z}return m.prototype.startsWith=function(Z){return this.str.indexOf(Z)===0},m.prototype.endsWith=function(Z){var z="",o=Z.split("").reverse().join("");return z=this.str.split("").reverse().join(""),this.startsWith.call({str:z},o)},m.prototype.contains=function(Z){return this.str.indexOf(Z)!==-1},m.prototype.equals=function(Z){return this.str===Z},m.prototype.value=function(){return this.str},m}();E.QueryableString=T}}]);
